핵심은 **"엑셀 파일을 Dify가 읽기 좋게(CSV) 먹여주고, 프롬프트로 예쁘게 출력하라고 시키는 것"**입니다.

1단계: 엑셀 파일 전처리 (가장 중요) ★★★
Dify는 .xlsx도 지원하지만, 수십 개 항목이 있는 표는 **CSV(쉼표로 구분된 파일)**로 변환해서 올리는 게 인식률이 훨씬 좋습니다.

엑셀 파일 열기:

첫 번째 줄(Row 1)은 무조건 **항목명(Header)**이어야 합니다. (예: PartNo, Size, NozzleType, Vendor, Spec1...)

**병합된 셀(Merge)**이 있다면 전부 해제하고 빈칸은 채우세요.

불필요한 장식(제목, 결재란 등) 다 지우고, 순수 데이터만 남기세요.

CSV로 저장:

다른 이름으로 저장 -> 파일 형식을 CSV UTF-8 (쉼표로 분리) (*.csv) 로 선택해서 저장합니다.

파일명 예시: npm_parts_library.csv

2단계: 지식(Knowledge) 만들기
데이터를 Dify의 뇌에 집어넣는 과정입니다.

Dify 상단 메뉴 Knowledge (지식) -> Create Knowledge.

Import Text Data 선택.

Upload File: 방금 만든 .csv 파일을 업로드합니다.

설정 (Text Pre-processing):

Custom 선택.

Separator: \n (줄바꿈) 선택.

중요: CSV를 올리면 Dify가 보통 알아서 표 형식을 인식하려고 합니다. 만약 옵션에 "Table" 모드가 있다면 그걸 쓰시고, 없다면 General로 하되 청크(Chunk) 설정을 확인합니다.

Tip: Dify는 CSV의 한 행(Row)을 하나의 텍스트 덩어리로 묶어서 저장합니다.

예: PartNo: 1005R, Size: 1.0x0.5, Vendor: Samsung ...

Save & Process:

i9 CPU가 열심히 돌면서 데이터를 벡터화(임베딩)해서 저장합니다. "Completed" 뜰 때까지 대기.

3단계: 챗봇 앱(App) 만들기
사용자가 질문할 채팅창을 만듭니다.

상단 Studio (스튜디오) -> Create from Blank.

Chat App 선택.

Name: NPM 부품 라이브러리 (원하는 이름).

Icon: 기어 모양이나 칩 모양 등 예쁜 거 선택 -> Create.

4단계: 뇌 연결 및 프롬프트 설정 (핵심)
이제 앱 설정 화면입니다. 왼쪽(설정)을 만지면 오른쪽(미리보기)이 바뀝니다.

1. 지식 연결 (Context)
왼쪽 Context 항목의 Add 버튼 클릭.

아까 만든 npm_parts_library 지식을 선택하고 Add.

2. 모델 선택
우측 상단 모델이 smd-ai (아까 브릿지로 연결한 회사 AI)로 되어 있는지 확인.

3. 프롬프트 작성 (Instructions)
Prompt(명령어) 칸에 아래 내용을 복사해서 붙여넣으세요. (이게 AI를 교육시키는 겁니다.)

Plaintext
너는 SMD 공정의 'NPM 장비 부품 전문가'야.
사용자가 특정 '부품명(Part Name)'이나 코드를 물어보면, 지식(Context)에서 해당 부품을 찾아 상세 정보를 정리해서 보여줘.

[답변 규칙]
1. 사용자가 물어본 부품이 데이터에 있으면, 엑셀 표의 내용을 기반으로 답변해.
2. 답변은 읽기 좋게 **마크다운 표(Table)** 형식이나 **글머리 기호**로 정리해줘.
3. 특히 작업자에게 중요한 [Size, Nozzle Type, Feeder Type, Vendor] 정보는 반드시 포함해.
4. 데이터에 없는 부품이면 "해당 부품은 라이브러리에 없습니다."라고 정직하게 말해. 거짓말 금지.

[출력 예시]
"요청하신 [R1005] 부품 정보입니다."
| 항목 | 내용 |
| --- | --- |
| 부품명 | R1005 |
| 사이즈 | 1005 (0402) |
| 사용 노즐 | 230C |
| 피더 | 8mm Double |
| 공급사 | 삼성전기 |
...
5단계: 테스트 및 배포
테스트:

오른쪽 Preview 채팅창에 엑셀에 있는 부품명을 입력해 보세요.

"R1608 부품 정보 줘"

튜닝 (답변이 이상하면?):

만약 AI가 정보를 못 찾으면, Context 설정 옆에 Setting을 눌러서 Search Mode를 확인하세요.

Hybrid Search나 Vector Search가 기본인데, Top K값을 3~5 정도로 늘려주면 더 잘 찾습니다.

배포 (Service):

테스트가 잘 되면 우측 상단 Publish -> Update 클릭.

Overview 메뉴로 이동 -> Public URL 쪽에 있는 링크를 복사.

이 링크를 팀원들에게 뿌리면 끝입니다. (팀원들은 로그인 필요 없이 바로 채팅 가능)

요약
엑셀을 CSV로 저장한다. (헤더 필수)

Knowledge에 업로드한다.

Studio에서 챗봇 만들고 Context에 추가한다.

프롬프트에 **"표로 정리해줘"**라고 적는다.

Publish 누르고 링크 공유한다.

지금 바로 CSV 변환부터 시작하세요!