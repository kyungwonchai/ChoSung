해결 방법론 (가이드)
해결의 핵심은 **"서비스에게 화면(DISPLAY)의 위치를 알려주는 것"**과 **"올바른 사용자 권한으로 실행하는 것"**입니다.

방법 1: PM2를 사용할 때
PM2는 보통 님 계정으로 실행되므로 권한 문제는 적습니다. 환경 변수 주입만 해주면 됩니다.

가장 쉬운 해결책 (CLI 명령): PM2로 프로세스를 시작할 때 명시적으로 화면 정보를 넘겨줍니다.

Bash

# 기존 프로세스 삭제
pm2 delete app

# 화면 정보(:0)를 주입하며 시작
# --no-daemon 등은 필요에 따라
DISPLAY=:0 pm2 start app.py --name "vscode-opener"
더 정석적인 해결책 (ecosystem.config.js): 프로젝트 루트에 설정 파일을 만들어서 관리하는 것이 좋습니다.

ecosystem.config.js 생성:

JavaScript

module.exports = {
  apps : [{
    name   : "vscode-opener",
    script : "./app.py",
    env: {
      "DISPLAY": ":0",  // 핵심: 화면 번호 지정
      "XAUTHORITY": "/home/사용자명/.Xauthority" // (선택) 권한 파일 경로
    }
  }]
}
실행: pm2 start ecosystem.config.js

방법 2: Systemd (systemctl) 서비스를 사용할 때
Systemd는 더 엄격합니다. 파일 하나하나 지정해줘야 합니다.

/etc/systemd/system/vscode-opener.service 작성 가이드

핵심은 User와 Environment 두 줄입니다.

Ini, TOML

[Unit]
Description=VSCode Remote Opener Web Service
After=network.target

[Service]
# 1. 실행할 사용자 지정 (필수! root로 하면 VS Code 안 뜸)
User=사용자ID (예: ubuntu)
Group=사용자ID

# 2. 작업 디렉토리 (app.py가 있는 곳)
WorkingDirectory=/home/사용자ID/NetworkFolderIndexer

# 3. 환경 변수 주입 (가장 중요 ★★★)
# 화면이 :0 번임을 명시
Environment="DISPLAY=:0"
# 필요한 경우 Xauthority 경로 명시 (대부분 DISPLAY만으로 되지만 안되면 추가)
Environment="XAUTHORITY=/home/사용자ID/.Xauthority"
# 파이썬 출력 버퍼링 끄기 (로그 바로 보게)
Environment="PYTHONUNBUFFERED=1"

# 4. 실행 명령 (전체 경로 권장)
ExecStart=/usr/bin/python3 /home/사용자ID/NetworkFolderIndexer/app.py

Restart=always

[Install]
WantedBy=multi-user.target
적용 순서:

파일 저장 (sudo nano ...)

sudo systemctl daemon-reload

sudo systemctl start vscode-opener

3. 체크 포인트 (내 DISPLAY 번호 확인법)
만약 위대로 했는데도 안 된다면, 님의 화면 번호가 :0이 아닐 수도 있습니다. 터미널에서 확인해보세요.

Bash

echo $DISPLAY
대부분 :0 또는 :1입니다.

이 번호를 위의 설정(DISPLAY=...)에 그대로 적어주셔야 합니다.

요약
현상: 서비스(PM2/Systemd)는 눈(화면 정보)이 없어서 창을 못 띄움.

해결: "네가 띄울 화면은 0번이야"라고 DISPLAY=:0 환경 변수를 강제로 찔러 넣어줘야 함.

주의: 반드시 로그인된 데스크톱 사용자 계정으로 서비스를 실행해야 함 (Root 금