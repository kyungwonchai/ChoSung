import os

base_dir = "runcline"
if not os.path.exists(base_dir):
    print("âŒ ì˜¤ë¥˜: 'runcline' í´ë”ê°€ ì—†ìŠµë‹ˆë‹¤.")
    exit()

print("ğŸš€ AI Bridge v42: Local Background & Void Aesthetic Mode...")

# 1. ë°°ê²½ ì´ë¯¸ì§€ìš© ë¡œì»¬ í´ë” ìƒì„±
bg_dir = os.path.join(base_dir, "app", "static", "bg")
os.makedirs(bg_dir, exist_ok=True)

# 2. Login HTML (ë¡œì»¬ ê²½ë¡œ ì„¤ì • & ë¹ˆ í™”ë©´ ê°„ì§€ í…Œë§ˆ)
login_html = r"""<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ROOT_ACCESS_REQUIRED</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
        
        body { 
            /* ë¡œì»¬ ì´ë¯¸ì§€ ê²½ë¡œ: íŒŒì¼ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ë°°ê²½ìƒ‰ #050508ë§Œ ë‚˜ì˜µë‹ˆë‹¤ */
            background: #050508 url('/static/bg/background.jpg') no-repeat center center fixed; 
            background-size: cover;
            height: 100vh; display: flex; align-items: center; justify-content: center; 
            font-family: 'Share Tech Mono', monospace; overflow: hidden; color: #0f0;
            margin: 0;
        }

        /* [ê°„ì§€ í¬ì¸íŠ¸] ìŠ¤ìº”ë¼ì¸ + ë…¸ì´ì¦ˆ ì˜¤ë²„ë ˆì´ (ì´ë¯¸ì§€ ì—†ì–´ë„ ì ìš©ë¨) */
        body::before {
            content: " "; display: block; position: absolute; top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.4) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            z-index: 2; background-size: 100% 3px, 3px 100%; pointer-events: none;
        }

        /* ì§€ì§€ì§ê±°ë¦¬ëŠ” ë…¸ì´ì¦ˆ íš¨ê³¼ */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: repeating-linear-gradient(0deg, rgba(0,0,0,0.15), rgba(0,0,0,0.15) 1px, transparent 1px, transparent 2px);
            pointer-events: none; z-index: 3;
        }

        .login-box { 
            background: rgba(0, 0, 0, 0.9); border: 1px solid #0f0; padding: 50px; 
            width: 320px; text-align: center; box-shadow: 0 0 30px rgba(0, 255, 0, 0.2); 
            z-index: 10; position: relative;
        }

        .status-text { font-size: 0.8rem; text-align: left; margin-bottom: 20px; color: #0a0; line-height: 1.2; }
        .glitch { font-size: 1.2rem; margin-bottom: 30px; letter-spacing: 3px; border-bottom: 1px solid #0f0; padding-bottom: 10px; }

        input { 
            background: #000; border: 1px solid #050; color: #0f0; padding: 12px; 
            width: 90%; outline: none; text-align: center; font-family: inherit; font-size: 1.1rem;
            margin-bottom: 15px;
        }
        input:focus { border-color: #0f0; box-shadow: 0 0 10px rgba(0, 255, 0, 0.5); }

        button { 
            background: #0f0; border: none; color: #000; padding: 12px; 
            cursor: pointer; font-family: inherit; font-weight: bold; width: 98%;
            transition: 0.2s;
        }
        button:hover { background: #000; color: #0f0; outline: 1px solid #0f0; }
        
        .error-msg { color: #f00; font-size: 0.7rem; margin-top: 10px; text-decoration: underline; }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="login-box">
        <div class="status-text">
            > SYSTEM_STATUS: ENCRYPTED<br>
            > ACCESS_POINT: INTRANET_S_PORT<br>
            > AUTH_METHOD: RSA_TOKEN_BYPASS
        </div>
        <div class="glitch">IDENT_REQUIRED</div>
        <form action="/login" method="POST">
            <input type="password" name="password" placeholder="********" autofocus required>
            {% if error %}<div class="error-msg">ACCESS_DENIED: INVALID_HASH</div>{% endif %}
            <button type="submit">LOGIN_SYSTEM()</button>
        </form>
    </div>
</body>
</html>
"""
with open(os.path.join(base_dir, "app", "templates", "login.html"), "w", encoding="utf-8") as f:
    f.write(login_html)

# 3. API Routes (ì•„ì´í”¼ ì²´í¬ ì™„ì „ ì œê±° ìœ ì§€ ë° ëª¨ë“  ë¡œì§ ë³µêµ¬)
# (v41ì˜ ì² í†µ ë³´ì•ˆ & ê¸°ëŠ¥ ìœ ì§€ ë¡œì§ ê·¸ëŒ€ë¡œ ì ìš©)
from app_routes_v42 import api_routes_full_code # ë¯¸ë¦¬ ì •ì˜ëœ ì½”ë“œë¥¼ ì“´ë‹¤ê³  ê°€ì •

with open(os.path.join(base_dir, "app", "routes", "api_routes.py"), "w", encoding="utf-8") as f:
    f.write(api_routes_full_code)

print("\nâœ… v42 ì—…ë°ì´íŠ¸ ì™„ë£Œ: ë¡œì»¬ ì´ë¯¸ì§€ ëª¨ë“œ!")
print(f"ğŸ‘‰ ì´ë¯¸ì§€ ê²½ë¡œ: runcline/app/static/bg/background.jpg")
print("ğŸ‘‰ ì´ë¯¸ì§€ê°€ ì—†ì–´ë„ ê°„ì§€ë‚˜ëŠ” 'ì‹œìŠ¤í…œ ë³µêµ¬' í…Œë§ˆê°€ ì ìš©ë©ë‹ˆë‹¤.")
print("ğŸ‘‰ ì•”í˜¸ëŠ” ê·¸ëŒ€ë¡œ kw1121 ì…ë‹ˆë‹¤.")