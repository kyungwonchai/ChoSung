사용자가 느끼는 데이터 크기(10MB)와 SSMS 상의 할당 공간(139GB)의 차이가 크고, '사용 가능한 공간'조차 거의 없다면(10MB), 트랜잭션 로그 파일(.ldf)이 비대해진 경우일 확률이 매우 높습니다.

SQL Server에서 데이터베이스 용량은 **데이터 파일(.mdf)**과 **로그 파일(.ldf)**의 합입니다. 실제 테이블 데이터가 적더라도, 로그 파일이 관리가 안 되면 수백 GB까지 커질 수 있습니다.

아래 순서대로 원인을 파악하고 축소하십시오.

1단계: 어떤 파일이 비만인지 확인 (MDF vs LDF)
먼저 139GB가 데이터 때문인지, 로그 때문인지 정확히 구분해야 합니다.

SQL

SELECT 
    name AS [FileName],
    type_desc AS [FileType],
    CAST((size * 8.0) / 1024 AS NUMERIC(18, 2)) AS [SizeMB],
    CAST((size * 8.0) / 1024 / 1024 AS NUMERIC(18, 2)) AS [SizeGB],
    physical_name AS [FilePath]
FROM sys.database_files;
결과 해석:

FileType이 LOG인 파일이 130GB 이상이라면 -> 트랜잭션 로그 문제 (99% 확률) -> [해결책 A]로 이동.

FileType이 ROWS인 파일이 130GB 이상이라면 -> 데이터 파일 문제 -> [해결책 B]로 이동.

[해결책 A] 로그 파일(.ldf)이 거대한 경우 (가장 유력)
복구 모델이 'Full(전체)'로 되어 있는데 트랜잭션 로그 백업을 하지 않으면 로그가 무한정 쌓여 디스크를 차지합니다.

방법 1: 복구 모델을 'Simple(단순)'로 변경 후 축소 (특정 시점 복구가 필요 없고, 마지막 전체 백업 이후의 데이터 손실을 감수할 수 있는 개발/테스트 서버나 일반적인 운영 환경인 경우)

SQL

-- 1. 복구 모델을 Simple로 변경 (로그를 자동으로 비움)
ALTER DATABASE [데이터베이스명] SET RECOVERY SIMPLE;
GO

-- 2. 로그 파일 축소 (목표 크기: 10MB)
-- 아래 '논리적로그파일명'은 위 1단계 쿼리의 name 컬럼 값입니다 (보통 _log로 끝남)
DBCC SHRINKFILE ('논리적로그파일명', 10);
GO

-- 3. 필요시 다시 Full로 복구 (선택 사항)
-- ALTER DATABASE [데이터베이스명] SET RECOVERY FULL;
방법 2: 로그 백업 수행 후 축소 (운영 환경 권장) 데이터 유실이 절대 없어야 한다면, 로그 백업을 수행하여 로그 공간을 '사용 가능' 상태로 만든 뒤 축소해야 합니다.

[해결책 B] 데이터 파일(.mdf)이 거대한 경우
데이터는 없는데 데이터 파일이 크다면, 과거에 대량의 데이터를 지웠으나(DELETE) 디스크 공간이 OS로 반환되지 않은 상태입니다. 하지만 '사용 가능한 공간'이 10MB뿐이라면, SQL Server는 그 공간을 **"사용 중"**이라고 인식하고 있을 수 있습니다.

1. 통계 갱신 오류 확인 (유령 데이터) SSMS가 용량을 잘못 표시하는 경우가 있습니다. 실제 사용량을 다시 계산하도록 강제합니다.

SQL

-- 실제 사용량을 재계산하여 카탈로그 뷰 갱신
DBCC UPDATEUSAGE ([데이터베이스명]);
이후 다시 SSMS 속성을 확인해보세요. '사용 가능한 공간'이 늘어났다면 SHRINKFILE로 줄일 수 있습니다.

2. 데이터 파일 강제 축소 여유 공간이 확보되었다면 아래 명령어로 파일을 줄입니다.

SQL

-- 데이터 파일 축소 (여유 공간을 OS로 반환)
-- '논리적데이터파일명'은 1단계 쿼리의 name 값
DBCC SHRINKFILE ('논리적데이터파일명', TRUNCATEONLY);
TRUNCATEONLY: 파일 끝의 빈 공간만 잘라냅니다. (빠르고 부하가 적음)

그래도 안 줄어들면 뒤의 TRUNCATEONLY를 빼고 실행해야 하지만, 이는 데이터 조각화(Fragmentation)를 유발하므로 야간에 수행해야 합니다.

요약
대부분의 경우 [해결책 A]의 방법 1 (복구 모델 Simple 변경 -> DBCC SHRINKFILE)을 수행하면 139GB가 즉시 줄어들 것입니다.

실행 전 반드시 **[데이터베이스명]**과 **[논리적파일명]**을 확인하고 백업을 먼저 받아두시