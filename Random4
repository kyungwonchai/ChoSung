데스크톱(RDP)이 갑자기 안 될 때, SSH로 접속하신 상태라면 다음 단계별 명령어로 서비스를 강제 재시작하고 상태를 점검해 보시기 바랍니다.

윈도우 터미널(PowerShell/CMD)이 아닌 SSH(Linux Shell)를 통해 윈도우를 제어하는 상황이므로, powershell 명령어를 앞에 붙여서 실행해야 합니다.

1. RDP 서비스 재시작 (가장 기본)
가장 먼저 RDP의 핵심 서비스인 TermService를 재시작합니다.

Bash
# 서비스 강제 재시작
powershell "Restart-Service -Name TermService -Force"
2. 방화벽 상태 확인 및 허용
방화벽 설정이 꼬였을 수 있습니다. RDP 포트(3389)가 열려 있는지 확인하고 다시 허용합니다.

Bash
# RDP 방화벽 규칙 활성화
powershell "Enable-NetFirewallRule -DisplayGroup 'Remote Desktop'"
3. RDP 허용 레지스트리 강제 활성화
간혹 설정 값이 풀리는 경우가 있습니다. 레지스트리 값을 직접 수정하여 외부 접속을 허용합니다.

Bash
# RDP 접속 허용 (fDenyTSConnections를 0으로 설정)
powershell "Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name 'fDenyTSConnections' -Value 0"

# 네트워크 수준 인증(NLA) 일시적 비활성화 (접속 트러블슈팅용)
powershell "Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -Name 'UserAuthentication' -Value 0"
4. 포트 리스닝 상태 확인
현재 윈도우가 3389 포트로 신호를 기다리고 있는지 확인합니다.

Bash
powershell "netstat -an | findstr 3389"
결과에 LISTENING이 뜨지 않는다면 서비스가 정상적으로 올라오지 않은 것입니다.

💡 경원님을 위한 추가 체크리스트
만약 위 명령어로도 안 된다면, 최근 윈도우 업데이트로 인해 네트워크 프로필이 '공용(Public)'으로 바뀌었을 가능성이 큽니다. 공용 네트워크에서는 보안상 RDP가 차단됩니다.

네트워크를 '개인(Private)'으로 강제 변경:

Bash
powershell "Get-NetConnectionProfile | Set-NetConnectionProfile -NetworkCategory Private"
위 명령어들을 순서대로 입력해 보시고, 여전히 접속이 안 된다면 발생하는 에러 메시지를 알려주세요. 바로 다음 해결책을 찾아보겠습니다. 어떤 단계부터 진행해 볼까요?