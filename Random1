using System;
using System.Windows.Forms;
using System.Timers;

namespace DailyJobWinFormsApp
{
    public partial class MainForm : Form
    {
        private System.Timers.Timer timer;

        public MainForm()
        {
            InitializeComponent();

            // 폼 로드 시 타이머를 설정합니다.
            SetupTimer();
        }

        private void SetupTimer()
        {
            // 타이머를 생성하고 설정합니다.
            timer = new System.Timers.Timer();
            timer.Interval = GetTimeUntil3AM(); // 3시까지 남은 시간을 계산하여 설정합니다.
            timer.Elapsed += Timer_Elapsed;
            timer.AutoReset = true;

            // 타이머를 시작합니다.
            timer.Start();
        }

        private double GetTimeUntil3AM()
        {
            // 현재 시간과 3시의 시간 차이를 계산하여 반환합니다.
            DateTime now = DateTime.Now;
            DateTime targetTime = now.Date.AddDays(1).AddHours(3); // 다음날 3시로 설정합니다.

            return (targetTime - now).TotalMilliseconds;
        }

        private void Timer_Elapsed(object sender, ElapsedEventArgs e)
        {
            // 타이머 이벤트가 발생할 때 실행되는 메서드입니다.
            // 매일 새벽 3시에 이곳의 코드 블록이 실행됩니다.

            // 원하는 작업을 이곳에 추가합니다.
            // 예: 특정 작업 수행, 이메일 전송, 파일 처리 등
            // 이 메서드는 타이머의 Interval 간격마다 호출됩니다.
        }
    }
}
