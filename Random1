re is a Python script using pymssql and pandas to fetch data from Table_jdbarcode, order it by ipadd2 and rowtime2, and then sample it regularly at every 16th row.

python
Copy code
import pymssql
import pandas as pd

# Database connection details
server = "your_server"
database = "your_database"
username = "your_username"
password = "your_password"

# Connect to the database
conn = pymssql.connect(server=server, user=username, password=password, database=database)
cursor = conn.cursor(as_dict=True)

# SQL query to get ordered data
query = """
SELECT modelname2 AS model, jdbarcode2 AS barcode
FROM Table_jdbarcode
ORDER BY ipadd2, rowtime2 ASC
"""

# Execute query and fetch data into a DataFrame
df = pd.read_sql(query, conn)

# Regularly sample every 16th row
df_sampled = df.iloc[::16].reset_index(drop=True)

# Close the connection
conn.close()

# Display the DataFrame
import ace_tools as tools
tools.display_dataframe_to_user(name="Sampled Data", dataframe=df_sampled)
Explanation:
Connects to the MSSQL 2014 database using pymssql.
Executes the SQL query to fetch modelname2 as model and jdbarcode2 as barcode, sorted by ipadd2 and rowtime2.
Loads the data into a pandas DataFrame.
Samples every 16th row using df.iloc[::16].
Closes the database connection.