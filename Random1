using System;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace PrinterSettingsExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void buttonLoadSettings_Click(object sender, EventArgs e)
        {
            try
            {
                // 프린터 설정 불러오기
                PrinterSettings printerSettings = new PrinterSettings();
                printerSettings.PrinterName = "YourPrinterName"; // 프린터 이름 지정 (예시: "HP LaserJet P1006")

                // 저장된 설정 파일 경로를 지정합니다.
                string settingsFilePath = "C:\\path\\to\\your\\printer.settings";

                // 프린터 설정 파일 로드
                printerSettings.Load(settingsFilePath);

                // 프린터 설정을 현재 프린터에 적용합니다.
                // (옵션) 만약, 프린터 설정 대화상자를 띄우지 않으려면 다음 코드를 사용합니다.
                // PrintDocument printDocument = new PrintDocument();
                // printDocument.PrinterSettings = printerSettings;

                // 여기에서 불러온 프린터 설정으로 필요한 작업을 수행합니다.
                // 예를 들면, 프린터 설정 정보 출력:
                Console.WriteLine("Printer Name: " + printerSettings.PrinterName);
                Console.WriteLine("Paper Size: " + printerSettings.DefaultPageSettings.PaperSize);
                // ...

                // 이후, 필요한 작업을 수행합니다.
            }
            catch (Exception ex)
            {
                // 오류 처리
                MessageBox.Show("프린터 설정을 불러오는 중 오류가 발생했습니다:\n" + ex.Message);
            }
        }
    }
}
