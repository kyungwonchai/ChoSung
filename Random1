다음은 UploadFile_Click 함수만 제공하는 예제입니다. StreamReader를 사용하여 파일을 읽고 데이터베이스에 저장하는 방법을 설명합니다.

UploadFile_Click 함수
csharp
코드 복사
private void UploadFile_Click(object sender, RoutedEventArgs e)
{
    Button button = sender as Button;
    DataRowView rowView = button.Tag as DataRowView;

    OpenFileDialog openFileDialog = new OpenFileDialog();
    if (openFileDialog.ShowDialog() == true)
    {
        string filePath = openFileDialog.FileName;
        string fileName = openFileDialog.SafeFileName;
        
        using (SqlConnection conn = new SqlConnection(connectionString))
        {
            conn.Open();
            string query = "UPDATE 테이블A SET FileName = @FileName, FileData = @FileData WHERE ID = @ID";
            SqlCommand cmd = new SqlCommand(query, conn);
            cmd.Parameters.AddWithValue("@FileName", fileName);

            // StreamReader를 사용하여 파일을 읽어서 바이트 배열로 변환합니다.
            using (StreamReader reader = new StreamReader(filePath))
            {
                byte[] fileData = System.Text.Encoding.UTF8.GetBytes(reader.ReadToEnd());
                cmd.Parameters.AddWithValue("@FileData", fileData);
            }

            cmd.Parameters.AddWithValue("@ID", rowView["ID"]);
            cmd.ExecuteNonQuery();
        }

        LoadData();
    }
}
설명
OpenFileDialog를 통해 사용자가 업로드할 파일을 선택합니다.
선택된 파일의 경로(filePath)와 파일 이름(fileName)을 가져옵니다.
SqlConnection을 사용하여 데이터베이스에 연결합니다.
SQL 쿼리를 준비하고, 파일 이름과 파일 데이터를 매개 변수로 추가합니다.
StreamReader를 사용하여 파일을 읽고, UTF-8 인코딩을 사용하여 바이트 배열로 변환합니다.
SQL 명령을 실행하여 파일 데이터를 데이터베이스에 저장합니다.
데이터베이스에서 데이터를 다시 로드하여 GridControl을 업데이트합니다.
이 함수는 파일을 StreamReader를 사용하여 읽고, UTF-8 인코딩으로 바이트 배열로 변환한 후 데이터베이스에 저장합니다. 필요에 따라 인코딩 방식을 조정할 수 있습니다.






