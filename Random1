른 워크북의 시트를 찾고 싶으셨군요! 이 경우, 다른 워크북을 열고 그 안의 시트를 검색하는 과정이 필요합니다. 아래는 특정 파일 경로의 엑셀 파일에서 '사태', '외주일별', '계획'이라는 키워드가 모두 포함된 시트를 찾아 선택하는 VBA 코드입니다.

엑셀에서 Alt + F11을 눌러 VBA 편집기를 엽니다.
새로운 모듈을 추가한 후 아래 코드를 붙여넣으시면 됩니다.
vba
코드 복사
Sub SelectSheetFromAnotherWorkbook()
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim filePath As String
    Dim keyword1 As String, keyword2 As String, keyword3 As String
    
    ' 파일 경로 설정
    filePath = "C:\path\to\your\excel.xlsx" ' <-- 여기 파일 경로를 수정하세요.

    ' 엑셀 워크북 열기
    On Error Resume Next
    Set wb = Workbooks.Open(filePath)
    
    If wb Is Nothing Then
        MsgBox "워크북을 열 수 없습니다. 파일 경로를 확인하세요.", vbCritical
        Exit Sub
    End If
    On Error GoTo 0

    ' 키워드 설정
    keyword1 = "사태"
    keyword2 = "외주일별"
    keyword3 = "계획"

    ' 모든 시트를 순회하여 조건에 맞는 시트를 찾기
    For Each ws In wb.Worksheets
        If InStr(1, ws.Name, keyword1, vbTextCompare) > 0 And _
           InStr(1, ws.Name, keyword2, vbTextCompare) > 0 And _
           InStr(1, ws.Name, keyword3, vbTextCompare) > 0 Then
            ws.Select
            MsgBox "시트 '" & ws.Name & "'를 선택했습니다.", vbInformation
            Exit Sub
        End If
    Next ws

    ' 조건에 맞는 시트를 찾지 못한 경우
    MsgBox "조건에 맞는 시트를 찾지 못했습니다.", vbExclamation
End Sub
코드 설명
파일 경로 설정:

filePath 변수에 원하는 엑셀 파일 경로를 지정합니다. "C:\path\to\your\excel.xlsx" 부분을 실제 파일 경로로 수정하세요.
워크북 열기:

Set wb = Workbooks.Open(filePath)를 사용하여 지정된 파일을 엽니다.
만약 파일을 열 수 없는 경우 wb가 Nothing이 되므로, 이에 대한 에러 메시지를 표시합니다.
시트 찾기:

열린 워크북의 모든 시트를 순회하며, 이름에 '사태', '외주일별', '계획' 키워드가 모두 포함된 시트를 찾습니다.
조건에 맞는 시트를 찾으면 ws.Select로 해당 시트를 선택하고, 메시지 박스를 표시합니다.
시트를 찾지 못한 경우:
