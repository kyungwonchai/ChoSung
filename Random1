 포트를 이용한 프로그램 간 통신 및 스캐너 데이터 분배 방법
1. 가상 포트 설정
가상 포트(Virtual COM Port)는 두 프로그램 간에 시리얼 통신을 흉내내어 데이터를 주고받게 하는 역할을 합니다. Windows에서는 com0com 같은 가상 포트 드라이버를 사용할 수 있습니다. 다음은 com0com을 사용한 설정 방법입니다.

com0com 설치

com0com을 다운로드하고 설치합니다.
설치 후, setupc.exe를 실행하여 가상 포트 페어를 생성합니다. 예를 들어, COM2-COM3 페어를 생성합니다.
가상 포트 페어 설정

setupc 명령어로 COM2와 COM3 페어를 생성합니다.
bash
코드 복사
setupc install PortName=COM2 PortName=COM3
프로그램 설정

PGM A는 COM2를 사용하여 데이터를 보냅니다.
PGM C는 COM3를 사용하여 데이터를 수신합니다.
이와 같은 방법으로 다른 프로그램 간에도 가상 포트를 설정하여 통신할 수 있습니다.

2. PLC와의 시리얼 통신
PLC와의 통신은 물리적인 COM 포트를 사용하여 연결합니다. 예를 들어, COM1 포트를 사용하여 PGM C가 PLC와 통신하는 설정입니다.

3. 스캐너 데이터 분배
스캐너 데이터를 3개의 프로그램(PGM A, PGM B, PGM D)에 동시에 전달하는 방법은 다음과 같습니다.

스캐너 데이터 수신 프로그램 작성 (중앙 서버)

스캐너 데이터를 수신하는 중앙 프로그램을 작성합니다. 이 프로그램은 스캐너로부터 데이터를 수신한 후, 각 프로그램으로 데이터를 전달합니다.
예시 코드 (Python):

python
코드 복사
import serial
import threading

def read_scanner_data(port, baudrate):
    ser = serial.Serial(port, baudrate)
    while True:
        data = ser.readline().decode('utf-8')
        distribute_data(data)

def distribute_data(data):
    # 각 프로그램에 데이터를 전송
    for program_port in ["COM4", "COM5", "COM6"]:
        send_data_to_program(program_port, data)

def send_data_to_program(port, data):
    ser = serial.Serial(port, 9600)
    ser.write(data.encode('utf-8'))
    ser.close()

if __name__ == "__main__":
    scanner_thread = threading.Thread(target=read_scanner_data, args=("COM7", 9600))
    scanner_thread.start()
각 프로그램의 수신 설정

PGM A, PGM B, PGM D는 각각 COM4, COM5, COM6 포트를 사용하여 데이터를 수신합니다.
결론
이렇게 가상 포트와 물리적인 시리얼 포트를 함께 사용하여 프로그램 간 통신과 외부 장치(PCL, 스캐너)와의 통신을 효율적으로 처리할 수 있습니다. 각 프로그램이 데이터를 주고받는 방식과 포트 설정을 잘 구성하면, 안정적인 통신 환경을 구축할 수 있습니