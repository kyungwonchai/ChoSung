Sub 필터링정렬및시트생성()

    Dim cols As Variant
    Dim i As Integer
    Dim sheetName As String
    Dim ws As Worksheet

    cols = Array("B", "E", "H", "K", "N", "Q", "T") ' 작업할 열

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    For i = LBound(cols) To UBound(cols)
        sheetName = cols(i)

        ' 새 워크시트 생성 및 이름 설정
        Set ws = Sheets.Add(After:=Sheets(Sheets.Count))
        ws.Name = sheetName

        ' 기존 시트에 대한 작업
        With ThisWorkbook.Sheets("원본") ' 원본 시트 이름을 적절히 설정하세요.
            ' 지정된 열과 그 뒤의 두 개 열을 복사
            .Range(.Columns(sheetName), .Columns(sheetName).Offset(0, 2)).Copy Destination:=ws.Range("A1")
            ws.Rows("1:2").Delete
            ws.Range("A1:A" & ws.Cells(ws.Rows.Count, "A").End(xlUp).Row).AutoFilter Field:=1, Criteria1:="S*"
            ws.Range("A1:C" & ws.Cells(ws.Rows.Count, "C").End(xlUp).Row).AutoFilter Field:=3, Criteria1:=">=0"
        End With
    Next i

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True

End Sub
