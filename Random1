, 화면의 아래부분은 제외하고 캡쳐하기 위한 수정 부분을 설명드리겠습니다.

캡처할 때 버튼 영역을 제외하고 캡처하는 부분
캡처할 영역 설정하기: PixelCopy.request 호출 시 캡처할 영역을 지정합니다. 여기서 화면의 아래부분은 제외하고 캡처하도록 설정합니다.
캡처 영역의 높이 설정하기: 이미지가 표시되는 영역의 높이를 설정합니다. 예를 들어, 이미지 영역의 높이가 전체 화면의 3/4이라면, 버튼 영역을 제외할 수 있습니다.
수정된 캡처 함수
kotlin
코드 복사
fun captureAndUploadBitmapWithoutButtons(window: android.view.Window, view: View, scope: CoroutineScope) {
    val location = IntArray(2)
    view.getLocationInWindow(location)

    val imageViewHeight = view.height * 3 / 4 // 전체 높이의 3/4만 캡처

    val bitmap = Bitmap.createBitmap(view.width, imageViewHeight, Bitmap.Config.ARGB_8888)

    try {
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
            PixelCopy.request(
                window, android.graphics.Rect(
                    location[0], location[1],
                    location[0] + view.width, location[1] + imageViewHeight
                ), bitmap, { copyResult ->
                    if (copyResult == PixelCopy.SUCCESS) {
                        scope.launch {
                            uploadBitmap(bitmap)
                        }
                    }
                }, view.handler
            )
        } else {
            val canvas = Canvas(bitmap)
            view.draw(canvas)
            scope.launch {
                uploadBitmap(bitmap)
            }
        }
    } catch (e: Exception) {
        e.printStackTrace()
    }
}
캡처할 영역 설정 부분
위의 코드에서, 캡처할 영역을 설정하는 부분을 설명드리겠습니다.

kotlin
코드 복사
val imageViewHeight = view.height * 3 / 4 // 전체 높이의 3/4만 캡처

val bitmap = Bitmap.createBitmap(view.width, imageViewHeight, Bitmap.Config.ARGB_8888)

PixelCopy.request(
    window, android.graphics.Rect(
        location[0], location[1],
        location[0] + view.width, location[1] + imageViewHeight
    ), bitmap, { copyResult ->
        if (copyResult == PixelCopy.SUCCESS) {
            scope.launch {
                uploadBitmap(bitmap)
            }
        }
    }, view.handler
)
이 부분에서 imageViewHeight를 전체 높이의 3/4로 설정하여 버튼 영역을 제외하고 캡처하도록 했습니다. PixelCopy.request의 두 번째 인자로 전달되는 Rect 객체에서 캡처할 영역을 지정하고 있습니다.

요약
imageViewHeight를 설정하여 캡처할 영역의 높이를 결정합니다.
PixelCopy.request 호출 시 Rect 객체를 사용하여 캡처할 영역을 지정합니다.
이제 이 부분만 수정하여 버튼 영역을 제외하고 캡처할 수 있습니다. 추가적인 도움이 필요하시면 언제든지 말씀해 주세요.






