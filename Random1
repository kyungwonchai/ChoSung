WITH RankedData AS (
    SELECT
        tbname,
        line1,
        machine1,
        lane1,
        datatime1,
        LEAD(datatime1) OVER (PARTITION BY tbname, line1, machine1, lane1 ORDER BY datatime1) AS time2
    FROM
        YourTableName
)
SELECT
    tbname,
    line1,
    machine1,
    lane1,
    datatime1,
    time2,
    DATEDIFF(SECOND, datatime1, time2) AS sec2
FROM
    RankedData;
