@echo off

REM 이벤트 로그 삭제할 로그 이름 목록
set "logs=Application,Security,System"

REM 최근 1개월 이전 날짜 계산
for /f "usebackq tokens=1-3 delims=/ " %%a in (`echo %date%`) do set "currentDate=%%c-%%a-%%b"
set "oneMonthAgoDate="
powershell -Command "(Get-Date -Date '%currentDate%').AddMonths(-1).ToString('yyyy-MM-dd')" > temp.txt
set /p oneMonthAgoDate=<temp.txt
del temp.txt

REM 이벤트 로그 삭제
for %%A in (%logs%) do (
    wevtutil.exe cl "%%A" /q:"*[System[TimeCreated[@SystemTime<'%oneMonthAgoDate%']]]"
)

REM 이벤트 로그 설정 변경
for %%A in (%logs%) do (
    reg add "HKLM\SYSTEM\CurrentControlSet\Services\EventLog\%%A" /v MaxSize /t REG_DWORD /d %maxSize% /f
)

echo 최근 1개월 이전의 이벤트 로그가 삭제되었고, 이벤트 로그 설정이 변경되었습니다.

pause
