의 이름, 컬럼명, 및 컬럼 순서를 테이블 구조 테이블(T_컬럼구조)에 삽입하는 함수를 만드는 예시입니다.

sql

CREATE FUNCTION dbo.InsertTableStructure(@TableName NVARCHAR(100))
RETURNS INT
AS
BEGIN
    DECLARE @ColumnIndex INT = 10;
    
    INSERT INTO T_컬럼구조 (엑셀명, 컬럼명, 컬럼순서)
    SELECT @TableName, COLUMN_NAME, @ColumnIndex
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = @TableName;
    
    RETURN @@ROWCOUNT;
END;

위의 함수를 사용하려면 T_컬럼구조 테이블이 미리 생성되어 있어야 합니다. 만약 T_컬럼구조 테이블이 아직 없다면, 아래와 같은 코드로 해당 테이블을 생성해주세요.

sql

CREATE TABLE T_컬럼구조 (
    엑셀명 NVARCHAR(100),
    컬럼명 NVARCHAR(100),
    컬럼순서 INT
);

함수를 사용하여 특정 테이블의 구조를 T_컬럼구조 테이블에 삽입하려면 다음과 같이 호출하면 됩니다.

sql

DECLARE @Result INT;
SET @Result = dbo.InsertTableStructure('테이블A');
SELECT @Result AS 'InsertedRows';

위 코드를 실행하면 테이블A의 구조가 T_컬럼구조 테이블에 삽입되며, 'InsertedRows'라는 열에 삽입된 행 수가 반환됩니다. 이를 통해 몇 개의 행이 삽입되었는지 확인할 수 있습니다.