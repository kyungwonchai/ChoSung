기 메뉴의 그룹과 버튼을 완전히 초기화하려면, 즐겨찾기 페이지에 포함된 모든 그룹을 제거하고, 해당 그룹 내 버튼 및 링크도 삭제해야 합니다. 아래는 즐겨찾기 페이지를 초기화하는 함수를 제공합니다.

ClearFavoritesPage 함수
csharp
코드 복사
private void ClearFavoritesPage()
{
    try
    {
        // 즐겨찾기 페이지에 있는 모든 그룹 삭제
        foreach (var group in favoritesPage.Groups.ToList())
        {
            group.ItemLinks.Clear(); // 그룹 내 링크 제거
            favoritesPage.Groups.Remove(group); // 그룹 자체 제거
        }

        Console.WriteLine("[Info] Favorites page cleared.");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] ClearFavoritesPage: {ex.Message}");
    }
}
주요 변경 사항
그룹 삭제:

favoritesPage.Groups.ToList()를 사용하여 그룹 컬렉션을 복사.
컬렉션 변경 중에도 안전하게 반복문 실행 가능.
링크 제거:

각 그룹의 ItemLinks.Clear()로 그룹 내 모든 버튼 링크를 제거.
그룹 제거:

favoritesPage.Groups.Remove(group)로 해당 그룹을 삭제.
예외 처리:

오류 발생 시 로그를 출력하여 디버깅 가능.
함수 사용 방법
로그인하기 전에 즐겨찾기 페이지를 초기화하려면, SetCurrentUser 함수에 아래 코드를 추가합니다:

수정된 SetCurrentUser
csharp
코드 복사
public void SetCurrentUser(string userId)
{
    try
    {
        // 즐겨찾기 페이지 초기화
        ClearFavoritesPage();

        // 사용자 ID 설정 및 즐겨찾기 로드
        currentUserId = userId;

        if (!string.IsNullOrWhiteSpace(currentUserId))
        {
            Console.WriteLine($"[Info] Logged in as User ID: {currentUserId}");
            LoadFavoritesFromDatabase(); // DB 데이터 로드
        }
        else
        {
            Console.WriteLine("[Info] Logged out. Using local favorites.");
            LoadFavoritesFromFile(); // 로컬 파일 데이터 로드
        }

        InitializeButtons(); // 버튼 UI 갱신
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetCurrentUser: {ex.Message}");
    }
}
테스트 흐름
로그아웃 상태에서 실행:

ClearFavoritesPage 호출로 즐겨찾기 페이지 초기화.
로컬 파일(favorites.txt) 데이터 로드.
로그인 상태에서 실행:

ClearFavoritesPage 호출로 즐겨찾기 페이지 초기화.
데이터베이스에서 사용자별 즐겨찾기 로드.
즐겨찾기 UI 갱신:

InitializeButtons 호출로 즐겨찾기 데이터에 따라 버튼 및 그룹 생성.
예상 결과
로그인 전에 즐겨찾기 페이지가 완전히 초기화됩니다.
새로운 데이터 로드 시 중복이 발생하지 않습니다.