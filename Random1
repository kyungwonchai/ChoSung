-- Example table and column names: YourTable(FileName)
SELECT
  FileName,
  -- Extract the first part of the filename before the underscore
  LEFT(FileName, CHARINDEX('_', FileName) - 1) AS ExtractedDatePart,
  -- Convert the extracted part to datetime format (assuming YYYYMMDD format)
  CONVERT(datetime, 
          LEFT(FileName, 4) + '-' + -- Year
          SUBSTRING(FileName, 5, 2) + '-' + -- Month
          SUBSTRING(FileName, 7, 2) -- Day
          , 120) AS ConvertedToDate -- The format 120 corresponds to 'yyyy-MM-dd HH:mi:ss' (ISO)
FROM YourTable;
