CREATE PROCEDURE dbo.InsertTableStructure
    @TableName NVARCHAR(100)
AS
BEGIN
    DECLARE @ColumnIndex INT = 10;
    DECLARE @Increment INT = 10;
    DECLARE @RowNumber INT = 0;
    DECLARE @ColumnsTable TABLE (ID INT IDENTITY(1,1), 엑셀명 NVARCHAR(100), 컬럼명 NVARCHAR(100), 컬럼순서 INT);

    INSERT INTO @ColumnsTable (엑셀명, 컬럼명, 컬럼순서)
    SELECT @TableName, COLUMN_NAME, 
           @ColumnIndex + (@Increment * @RowNumber) AS 컬럼순서
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = @TableName;

    INSERT INTO T_컬럼구조 (엑셀명, 컬럼명, 컬럼순서)
    SELECT 엑셀명, 컬럼명, 컬럼순서 FROM @ColumnsTable;
END;
