Sort 순서대로 정렬하고, 라인 선택 및 체크박스 기능을 구현한 코드입니다. 이를 통해 XAML과 C#을 수정하여 요구 사항에 맞게 동작하도록 구현했습니다.

XAML 코드
xml
코드 복사
<Window x:Class="LineDataViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts"
        xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
        Title="Line Data Viewer" Height="600" Width="900">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <!-- 좌측 컨트롤 -->
        <StackPanel Grid.Column="0" Margin="10">
            <TextBlock Text="라인 목록" FontWeight="Bold" Margin="0,0,0,10" />
            <TreeView x:Name="LineTreeView" Margin="0,0,0,10">
                <!-- 그룹 템플릿 -->
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type local:LineGroup}" ItemsSource="{Binding Lines}">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Content="{Binding GroupName}" IsChecked="{Binding IsChecked, Mode=TwoWay}" />
                        </StackPanel>
                    </HierarchicalDataTemplate>

                    <!-- 라인 템플릿 -->
                    <DataTemplate DataType="{x:Type local:LineInfo}">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Content="{Binding LineName}" IsChecked="{Binding IsChecked, Mode=TwoWay}" />
                        </StackPanel>
                    </DataTemplate>
                </TreeView.Resources>
            </TreeView>

            <TextBlock Text="날짜 검색" FontWeight="Bold" Margin="0,20,0,10" />
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <TextBlock Text="시작:" VerticalAlignment="Center" Margin="0,0,5,0" />
                <DatePicker x:Name="StartDatePicker" SelectedDateChanged="OnStartDateChanged" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <TextBlock Text="종료:" VerticalAlignment="Center" Margin="0,0,5,0" />
                <DatePicker x:Name="EndDatePicker" SelectedDateChanged="OnEndDateChanged" />
            </StackPanel>

            <CheckBox x:Name="AutoRefreshCheckBox" Content="자동 갱신" Margin="0,20,0,10" />
            <Button x:Name="SearchButton" Content="조회" Click="SearchButton_Click" Width="200" />
        </StackPanel>

        <!-- 차트 영역 -->
        <dxc:ChartControl x:Name="LineChart" Grid.Column="1" Margin="10">
            <dxc:ChartControl.Diagram>
                <dxc:XYDiagram2D>
                    <dxc:XYDiagram2D.AxisY>
                        <dxc:AxisY2D>
                            <dxc:AxisY2D.WholeRange>
                                <dxc:Range MinValue="-1" MaxValue="1" />
                            </dxc:AxisY2D.WholeRange>
                            <dxc:AxisY2D.ConstantLines>
                                <dxc:ConstantLine Value="0.6" Brush="Green">
                                    <dxc:ConstantLine.Title>
                                        <dxc:ConstantLineTitle Content="Upper Limit" Visibility="Visible" />
                                    </dxc:ConstantLine.Title>
                                    <dxc:ConstantLine.LineStyle>
                                        <dxc:LineStyle Thickness="1" DashStyle="Dash" />
                                    </dxc:ConstantLine.LineStyle>
                                </dxc:ConstantLine>
                                <dxc:ConstantLine Value="-0.6" Brush="Red">
                                    <dxc:ConstantLine.Title>
                                        <dxc:ConstantLineTitle Content="Lower Limit" Visibility="Visible" />
                                    </dxc:ConstantLine.Title>
                                    <dxc:ConstantLine.LineStyle>
                                        <dxc:LineStyle Thickness="1" DashStyle="Dash" />
                                    </dxc:ConstantLine.LineStyle>
                                </dxc:ConstantLine>
                            </dxc:AxisY2D.ConstantLines>
                        </dxc:AxisY2D>
                    </dxc:XYDiagram2D>
                </dxc:ChartControl.Diagram>
            </dxc:ChartControl>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)
데이터 로드 및 TreeView에 바인딩
라인 그룹과 라인 데이터를 그룹화하고, TreeView에 바인딩합니다.

csharp
코드 복사
using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Windows;

namespace LineDataViewer
{
    public partial class MainWindow : Window
    {
        private DateTime startDate;
        private DateTime endDate;
        private List<LineGroup> lineGroups;

        public MainWindow()
        {
            InitializeComponent();
            LoadLineData();
            InitializeDates();
        }

        private void LoadLineData()
        {
            lineGroups = new List<LineGroup>();
            var connectionString = "YourConnectionStringHere";

            using (var connection = new SqlConnection(connectionString))
            {
                connection.Open();
                var query = "SELECT LineGroup, LineName, Sort FROM LineTable ORDER BY Sort";

                using (var command = new SqlCommand(query, connection))
                using (var reader = command.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        var groupName = reader.GetString(0);
                        var lineName = reader.GetString(1);

                        // 그룹 찾거나 추가
                        var group = lineGroups.FirstOrDefault(g => g.GroupName == groupName);
                        if (group == null)
                        {
                            group = new LineGroup { GroupName = groupName, Lines = new List<LineInfo>() };
                            lineGroups.Add(group);
                        }

                        group.Lines.Add(new LineInfo
                        {
                            LineName = lineName,
                            IsChecked = true
                        });
                    }
                }
            }

            LineTreeView.ItemsSource = lineGroups;
        }

        private void InitializeDates()
        {
            startDate = DateTime.Now.Date.AddDays(-7);
            endDate = DateTime.Now.Date;
            StartDatePicker.SelectedDate = startDate;
            EndDatePicker.SelectedDate = endDate;
        }

        private void OnStartDateChanged(object sender, RoutedEventArgs e)
        {
            if (StartDatePicker.SelectedDate != null)
            {
                startDate = StartDatePicker.SelectedDate.Value;
            }
        }

        private void OnEndDateChanged(object sender, RoutedEventArgs e)
        {
            if (EndDatePicker.SelectedDate != null)
            {
                endDate = EndDatePicker.SelectedDate.Value;
            }
        }

        private void SearchButton_Click(object sender, RoutedEventArgs e)
        {
            var selectedLines = lineGroups
                .SelectMany(g => g.Lines)
                .Where(line => line.IsChecked)
                .Select(line => line.LineName)
                .ToList();

            if (!selectedLines.Any())
            {
                MessageBox.Show("라인을 선택해주세요.", "오류", MessageBoxButton.OK, MessageBoxImage.Warning);
                return;
            }

            LoadChartData(selectedLines, startDate, endDate);
        }

        private void LoadChartData(List<string> selectedLines, DateTime startDate, DateTime endDate)
        {
            // DB 데이터 로드 및 차트 업데이트 (미완성)
            Console.WriteLine($"조회: 라인={string.Join(",", selectedLines)}, 날짜={startDate} ~ {endDate}");
        }
    }

    public class LineGroup
    {
        public string GroupName { get; set; }
        public List<LineInfo> Lines { get; set; }
        public bool IsChecked
        {
            get => Lines.All(line => line.IsChecked);
            set
            {
                foreach (var line in Lines)
                {
                    line.IsChecked = value;
                }
            }
        }
    }

    public class LineInfo
    {
        public string LineName { get; set; }
        public bool IsChecked { get; set; }
    }
}
주요 변경 사항
라인 그룹화:

LineGroup 클래스와 LineInfo 클래스를 사용해 그룹별 라인 데이터를 관리.
LineGroup의 IsChecked 속성을 설정하면 하위 라인(LineInfo)의 IsChecked 속성도 함께 변경.
TreeView 템플릿:

HierarchicalDataTemplate과 DataTemplate을 사용해 그룹과 라인을 각각 표시.
그룹과 라인에 개별 체크박스를 추가.
데이터 정렬:

Sort 필드를 기준으로 정렬하여 라인을 출력.
날짜 및 라인 조회:

선택된 라인(IsChecked=true)과 날짜 범위를 기준으로 데이터를 필터링.
결과
TreeView에 LineGroup별로 라인이 정렬되어 표시됩니다.
그룹 체크박스를 클릭하면 하위 라인이 모두 선택/해제됩니다.