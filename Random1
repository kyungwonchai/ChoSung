에서 특정 문구를 찾아 DataTable을 만들고 해당 DataTable을 MS SQL 2014의 테이블에 벌크 인서트하는 작업을 진행하겠습니다. 아래는 주어진 요구사항에 따른 C# 코드 예시입니다:

    Excel 파일을 열어서 데이터를 읽습니다.
    2행에서 "Basic 모델" 및 "설계변경단계" 문구를 찾습니다.
    해당 데이터를 DataTable "ttt"에 저장합니다.
    DataTable의 값을 yyyyMMdd와 두 개의 컬럼 값을 _로 묶어서 컬럼C를 만듭니다.
    만들어진 DataTable을 MS SQL 2014의 "table C"에 벌크 인서트합니다.

csharp

using System;
using System.Data;
using System.Data.SqlClient;
using Excel = Microsoft.Office.Interop.Excel;

public void ProcessExcelAndInsertToDatabase()
{
    // 1. Excel 파일 열기
    Excel.Application xlApp = new Excel.Application();
    Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(@"your_file_path_here.xlsx");
    Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
    Excel.Range xlRange = xlWorksheet.UsedRange;

    // 2. 데이터 찾기
    DataTable ttt = new DataTable();
    ttt.Columns.Add("yyyyMMdd");
    ttt.Columns.Add("ColumnA");
    ttt.Columns.Add("ColumnB");
    ttt.Columns.Add("ColumnC");

    for (int i = 2; i <= xlRange.Rows.Count; i++)
    {
        if (xlRange.Cells[i, 1].Value2 != null && xlRange.Cells[i, 1].Value2.ToString() == "Basic 모델")
        {
            DataRow dr = ttt.NewRow();
            dr["yyyyMMdd"] = DateTime.Now.ToString("yyyyMMdd");
            dr["ColumnA"] = xlRange.Cells[i, 1].Value2.ToString();
            dr["ColumnB"] = xlRange.Cells[i, 2].Value2.ToString();
            dr["ColumnC"] = dr["yyyyMMdd"] + "_" + dr["ColumnA"] + "_" + dr["ColumnB"];
            ttt.Rows.Add(dr);
        }
    }

    // 3. MS SQL 2014에 벌크 인서트
    using (SqlConnection connection = new SqlConnection("your_connection_string_here"))
    {
        connection.Open();
        using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))
        {
            bulkCopy.DestinationTableName = "table C";
            bulkCopy.WriteToServer(ttt);
        }
    }

    // 메모리 해제
    xlWorkbook.Close();
    xlApp.Quit();
}

위 코드는 Microsoft Office Interop Excel 라이브러리를 사용하여 Excel 파일을 열고, 데이터를 읽어옵니다. 그런 다음, 해당 데이터를 DataTable에 저장하고, MS SQL 2014에 벌크 인서트하는 과정을 거칩니다.

이 코드를 실행하기 전에, 필요한 라이브러리를 설치하고, 파일 경로 및 데이터베이스 연결 문자열을 적절히 설정해야 합니다.

※ 주의: 위 코드는 예시이므로, 실제