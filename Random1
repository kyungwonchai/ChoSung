using System;
using System.Diagnostics;

class Program
{
    static void Main(string[] args)
    {
        // 명령어와 인수를 정의합니다.
        string command = "w32tm";
        string arguments = "/resync";

        // 관리자 권한으로 명령어를 실행할 ProcessStartInfo를 생성합니다.
        ProcessStartInfo psi = new ProcessStartInfo();
        psi.FileName = "cmd.exe";
        psi.Arguments = $"/c {command} {arguments}";
        psi.Verb = "runas"; // 관리자 권한으로 실행하기 위한 설정
        psi.CreateNoWindow = true;
        psi.UseShellExecute = true;

        try
        {
            // 프로세스를 시작합니다.
            Process process = Process.Start(psi);
            process.WaitForExit();
            int exitCode = process.ExitCode;

            // 결과를 출력합니다.
            Console.WriteLine($"Command executed with exit code: {exitCode}");
        }
        catch (Exception ex)
        {
            // 오류를 처리합니다.
            Console.WriteLine($"An error occurred: {ex.Message}");
        }
    }
}
