 있는 VBA 매크로입니다. 이 매크로는 날짜, 요일, 조, 명칭 정보를 포함하여 10년 간의 데이터를 생성합니다.

vba
코드 복사
Sub GenerateShiftData()
    Dim ws As Worksheet
    Dim startDate As Date
    Dim endDate As Date
    Dim currentDate As Date
    Dim row As Long
    Dim weekPattern As String
    Dim shiftPattern() As String
    Dim currentShift As String
    Dim i As Integer
    
    ' 초기화
    Set ws = ThisWorkbook.Sheets(1) ' 첫 번째 시트에 데이터 생성
    ws.Cells.Clear ' 기존 데이터 지우기
    ws.Range("A1:D1").Value = Array("날짜", "요일", "조", "명칭") ' 헤더 추가
    
    ' 날짜 설정
    startDate = DateValue("2024-11-01")
    endDate = DateAdd("yyyy", 10, startDate)
    
    ' 초기 값 설정
    weekPattern = "CAACCA" ' 주 단위 패턴
    shiftPattern = Split("A,C,CA,AC,CA", ",") ' 명칭 패턴
    currentShift = "CA" ' 2024-11-03 시작 패턴
    
    row = 2 ' 데이터 시작 행
    
    ' 데이터 생성
    For currentDate = startDate To endDate
        Dim dayOfWeek As Integer
        Dim shiftName As String
        
        ' 요일 계산 (일요일: 1, 월요일: 2, ...)
        dayOfWeek = Weekday(currentDate, vbSunday)
        
        ' 주 패턴 갱신 (매주 일요일에 갱신)
        If dayOfWeek = 1 Then
            currentShift = Mid(weekPattern, ((row - 2) \ 14) Mod 3 + 1, 2)
        End If
        
        ' 1조와 2조 데이터 생성
        For i = 1 To 2
            ws.Cells(row, 1).Value = currentDate ' 날짜
            ws.Cells(row, 2).Value = dayOfWeek ' 요일
            ws.Cells(row, 3).Value = i ' 조
            If i = 1 Then
                shiftName = Left(currentShift, 1) ' 첫 번째 문자가 1조의 명칭
            Else
                shiftName = Right(currentShift, 1) ' 두 번째 문자가 2조의 명칭
            End If
            ws.Cells(row, 4).Value = shiftName ' 명칭
            row = row + 1
        Next i
    Next currentDate
    
    ' 결과 메시지
    MsgBox "10년 간의 데이터 생성이 완료되었습니다!", vbInformation
End Sub
실행 방법
엑셀을 열고 Alt + F11을 눌러 VBA 편집기를 엽니다.
상단 메뉴에서 삽입 > 모듈을 선택합니다.
위 코드를 복사하여 붙여넣습니다.
VBA 편집기를 닫고 엑셀로 돌아옵니다.
Alt + F8을 눌러 매크로 실행 창을 엽니다.
GenerateShiftData를 선택한 후 실행을 클릭합니다.
결과
A 열: 날짜 (yyyy-MM-dd 형식)
B 열: 요일 (일요일: 1, 월요일: 2, ...)
C 열: 조 (1, 2)