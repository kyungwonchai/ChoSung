WITH RankedTable AS (
    SELECT *, 
           LEAD(gg) OVER (PARTITION BY bb, nn ORDER BY time_column ASC) AS NextGG,
           LAG(gg) OVER (PARTITION BY bb, nn ORDER BY time_column ASC) AS PrevGG
    FROM TableA
)
SELECT *
FROM RankedTable
WHERE gg != NextGG OR gg != PrevGG;
