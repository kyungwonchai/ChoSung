using System;
using System.Diagnostics;
using System.Windows.Forms;

namespace SSMSLauncher
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void btnLaunchSSMS_Click(object sender, EventArgs e)
        {
            string serverAddress = txtServerAddress.Text;
            string port = txtPort.Text;
            string username = txtUsername.Text;
            string password = txtPassword.Text;

            LaunchSSMS(serverAddress, port, username, password);
        }

        private void LaunchSSMS(string serverAddress, string port, string username, string password)
        {
            string ssmsPath = "C:\\Program Files (x86)\\Microsoft SQL Server\\{version}\\Tools\\Binn\\ManagementStudio\\Ssms.exe";
            string ssmsArguments = $"/S {serverAddress},{port} /U {username} /P {password}";

            Process.Start(ssmsPath, ssmsArguments);
        }
    }
}
