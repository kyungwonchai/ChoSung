System;

class Program
{
    static void Main(string[] args)
    {
        string appName = "MyApp"; // 프로그램 이름
        string appPath = @"C:\Path\To\YourApp.exe"; // 프로그램 경로

        AddToStartup(appName, appPath);
    }

    static void AddToStartup(string appName, string appPath)
    {
        // 레지스트리 키 경로
        string registryKey = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Run";

        // 레지스트리 키 열기
        using (RegistryKey key = Registry.CurrentUser.OpenSubKey(registryKey, true))
        {
            if (key == null)
            {
                Console.WriteLine("레지스트리 키를 열 수 없습니다.");
                return;
            }

            // 이미 등록된 항목 확인
            object value = key.GetValue(appName);
            if (value != null && value.ToString() == appPath)
            {
                Console.WriteLine("프로그램이 이미 시작 프로그램에 등록되어 있습니다.");
            }
            else
            {
                // 시작 프로그램에 등록
                key.SetValue(appName, appPath);
                Console.WriteLine("프로그램을 시작 프로그램에 등록했습니다.");
            }
        }
    }
}
이 코드의 주요 부분을 설명하겠습니다:

Registry Key 경로: @"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"은 시작 프로그램에 등록하는 위치입니다.
Registry 접근: Registry.CurrentUser.OpenSubKey를 사용하여 현재 사용자의 레지스트리 키를 엽니다. 두 번째 인자로 true를 주어 쓰기 가능하도록 설정합니다.
등록 여부 확인: key.GetValue를 사용하여 이미 등록된 프로그램인지 확인합니다.
등록: key.SetValue를 사용하여 프로그램을 시작 프로그램에 등록합니다.
이 코드를 실행하면, 프로그램이 시작 프로그램에 등록됩니다. 이미 등록되어 있