 조건에 따라 SQL 쿼리를 작성하겠습니다. msswl2014 데이터베이스의 table1에서, date1 컬럼은 날짜 (yyyy-MM-dd 형식)를, pro2 컬럼은 데이터를 가지고 있습니다. 요청하신 것은 최근 6개월 동안 각 월별로 pro2 값이 'hull'이 아닌 행의 개수를 조회하는 것입니다. 이를 위해, 다음과 같은 SQL 쿼리를 사용할 수 있습니다:

sql
Copy code
SELECT 
    DATE_FORMAT(date1, '%y-%m') AS Month, 
    COUNT(*) AS NonHullCount
FROM 
    table1
WHERE 
    pro2 != 'hull' AND 
    date1 >= DATE_SUB(CURDATE(), INTERVAL 6 MONTH) AND 
    date1 < LAST_DAY(DATE_SUB(CURDATE(), INTERVAL 1 MONTH)) + INTERVAL 1 DAY
GROUP BY 
    DATE_FORMAT(date1, '%y-%m');
이 쿼리는 다음과 같이 작동합니다:

DATE_FORMAT(date1, '%y-%m')를 사용하여 date1을 yy-MM 형식으로 변환합니다.
WHERE 절에서는 pro2가 'hull'이 아닌 행과 최근 6개월 동안의 날짜를 필터링합니다.
GROUP BY를 사용하여 각 월별로 그룹화하고, COUNT(*)로 각 그룹의 행 수를 계산합니다.
이 쿼리는 각 월이 1일부터 말일까지 전부 있는 데이터에 대해서만 작동합니다. 데이터에 누락된 날짜가 있다면, 그 월은 결과에 포함되지 않을 수 있습니다.





