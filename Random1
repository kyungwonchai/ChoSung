셀 VBA 코드로 요청하신 내용을 처리하는 매크로입니다. 이 코드는 D, F, G, H, I, J, K 컬럼에 대해 4행부터 해당 범위의 배경색이 하얗거나 투명한 셀의 값을 지웁니다.

VBA 코드:
엑셀에서 Alt + F11을 눌러 VBA 편집기를 열고,
삽입 > 모듈을 선택한 후 아래 코드를 붙여넣으세요.
이후 엑셀로 돌아와 매크로를 실행하면 됩니다.
vba
코드 복사
Sub ClearValuesIfBackgroundIsWhite()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    Dim colsToCheck As Variant
    Dim startRow As Long
    Dim lastRow As Long
    Dim i As Long

    ' 작업할 시트 지정 (필요시 변경)
    Set ws = ThisWorkbook.Sheets(1)
    
    ' 확인할 컬럼들
    colsToCheck = Array("D", "F", "G", "H", "I", "J", "K")
    
    ' 시작 행 설정
    startRow = 4
    
    ' 데이터가 있는 마지막 행 확인
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' 컬럼별로 반복
    For i = LBound(colsToCheck) To UBound(colsToCheck)
        ' 현재 컬럼 범위 지정
        Set rng = ws.Range(colsToCheck(i) & startRow & ":" & colsToCheck(i) & lastRow)
        
        ' 각 셀을 확인하여 조건에 따라 값 제거
        For Each cell In rng
            ' 배경색이 투명 또는 흰색이면 값 클리어
            If cell.Interior.Color = xlNone Or cell.Interior.Color = RGB(255, 255, 255) Then
                cell.ClearContents
            End If
        Next cell
    Next i
    
    MsgBox "완료되었습니다.", vbInformation
End Sub
코드 설명:
colsToCheck 배열:
확인할 컬럼을 배열로 정의합니다. 필요에 따라 컬럼을 추가하거나 제거하세요.
startRow와 lastRow:
startRow는 시작 행(4행)을 지정하고, lastRow는 데이터의 마지막 행을 자동으로 계산합니다.
cell.Interior.Color:
셀의 배경색을 확인합니다.
xlNone은 투명한 배경색이고, RGB(255, 255, 255)는 흰색 배경입니다.