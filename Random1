data 옵션을 사용할 때, 와일드카드 *는 현재 디렉토리의 파일들만을 포함합니다. 하위 디렉토리는 포함하지 않습니다. 그렇기 때문에 openpyxl 폴더 내의 하위 디렉토리와 파일들을 모두 포함하려면 각 하위 디렉토리에 대해 --add-data 옵션을 별도로 지정해야 합니다.

다음은 모든 하위 디렉토리를 포함하기 위한 방법의 예시입니다:

bash

pyinstaller --add-data "C:\path\to\site-packages\openpyxl;openpyxl" --add-data "C:\path\to\site-packages\openpyxl\subpackage1;openpyxl\subpackage1" --add-data "C:\path\to\site-packages\openpyxl\subpackage2;openpyxl\subpackage2" your_script.py

위의 명령어에서 C:\path\to\site-packages\openpyxl은 실제 openpyxl 라이브러리가 있는 경로로 대체해야 하며, subpackage1, subpackage2 등은 실제 openpyxl 내부의 하위 폴더 이름으로 대체해야 합니다.

이 방법은 번거롭고 실수할 가능성이 높으므로, 대신 PyInstaller를 사용할 때 hook 파일을 만들어 자동으로 모든 필요한 파일들을 포함시키도록 설정하는 것이 더 효율적일 수 있습니다.

그러나 가장 간단하고 확실한 방법은 직접 모든 하위 폴더를 명시하는 것입니다. PyInstaller의 공식 문서와 커뮤니티 포럼에서는 종종 이런 문제를 해결하기 위한 스크립트나 도구들이 