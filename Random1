using System;

namespace StringManipulationExample
{
    class Program
    {
        static void Main(string[] args)
        {
            string C = "This is a sample text with BSM-123_456_789 and more text.";
            string prefix = "BSM-";
            int startIndex = C.IndexOf(prefix);

            if (startIndex != -1)
            {
                int endIndex = C.IndexOf(' ', startIndex);
                if (endIndex == -1)
                {
                    endIndex = C.Length;
                }

                string targetString = C.Substring(startIndex, endIndex - startIndex);

                string[] parts = targetString.Split('_');

                if (parts.Length >= 3)
                {
                    int number = int.Parse(parts[2]) + 1;
                    parts[2] = number.ToString();
                }
                else if (parts.Length <= 2)
                {
                    targetString += "_001";
                }

                string newString = string.Join('_', parts);

                C = C.Replace(targetString, newString);
            }

            Console.WriteLine("Modified string: " + C);
        }
    }
}
