이해했습니다. 즉, 바코드 스캐너가 연결된 COM 포트(예: COM18)에서 데이터를 읽어, 프로그램 A(COM20)와 프로그램 B(COM21)에 데이터를 전달하고 싶다는 거군요. 이를 해결하기 위해 가상 COM 포트 페어를 사용하여 데이터를 전달하는 방법을 구현해 보겠습니다.

전체 솔루션 개요
가상 COM 포트 페어 설정: com0com을 사용하여 가상 COM 포트 페어를 생성합니다.
C# 프로그램 작성: COM18에서 데이터를 읽어 가상 COM 포트 페어로 전달하는 프로그램을 작성합니다.
프로그램 A와 B 설정: 프로그램 A는 가상 COM 포트의 한 쪽(COM20)을 열고, 프로그램 B는 다른 쪽(COM21)을 열어 데이터를 수신합니다.
1. 가상 COM 포트 페어 설정
com0com 다운로드 및 설치
com0com 다운로드:

com0com 프로젝트 페이지에서 설치 파일을 다운로드합니다.
설치 파일 실행:

다운로드한 설치 파일 (com0com-3.0.0.0-i386-and-x64-signed.exe)을 실행합니다.
설치 도중에 Windows 보안 경고가 나타나면 "이 드라이버 소프트웨어를 설치합니다"를 선택합니다.
드라이버 서명 비활성화 (필요한 경우)
고급 시작 옵션:

설정 > 업데이트 및 보안 > 복구로 이동합니다.
고급 시작 옵션에서 "지금 다시 시작"을 클릭합니다.
드라이버 서명 비활성화:

재부팅 후 나타나는 옵션 화면에서 "문제 해결"을 선택합니다.
고급 옵션 > 시작 설정 > 다시 시작을 선택합니다.
다시 시작 후 나타나는 메뉴에서 7번 "드라이버 서명 적용 안 함"을 선택합니다.
가상 포트 페어 생성
com0com Setup Command Prompt 실행:

시작 메뉴에서 com0com 폴더를 찾아 Setup Command Prompt를 관리자 권한으로 실행합니다.
가상 포트 페어 생성:

다음 명령어를 입력하여 가상 포트를 생성합니다:
sh
코드 복사
install PortName=COM20 PortName=COM22
install PortName=COM21 PortName=COM23
이렇게 하면 두 개의 가상 포트 페어가 생성됩니다. COM20-COM22, COM21-COM23.
가상 포트 페어 확인:

생성된 가상 포트 페어를 확인하려면 다음 명령어를 입력합니다:
sh
코드 복사
list
2. C# 프로그램 작성
C# 프로그램을 작성하여 COM18에서 데이터를 읽고, 이를 가상 포트 페어(COM22와 COM23)로 전달합니다.

프로그램 코드
csharp
코드 복사
using System;
using System.IO.Ports;

namespace COMPortProxy
{
    class Program
    {
        static SerialPort _inputPort;
        static SerialPort _outputPort1;
        static SerialPort _outputPort2;

        static void Main(string[] args)
        {
            // 입력 포트 설정 (실제 바코드 스캐너가 연결된 포트)
            _inputPort = new SerialPort("COM18", 9600);
            _inputPort.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);
            _inputPort.Open();

            // 출력 포트 설정 (가상 COM 포트)
            _outputPort1 = new SerialPort("COM22", 9600);
            _outputPort2 = new SerialPort("COM23", 9600);
            _outputPort1.Open();
            _outputPort2.Open();

            Console.WriteLine("Press any key to exit...");
            Console.ReadKey();

            _inputPort.Close();
            _outputPort1.Close();
            _outputPort2.Close();
        }

        private static void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e)
        {
            SerialPort sp = (SerialPort)sender;
            string inputData = sp.ReadExisting();
            Console.WriteLine("Received: " + inputData);

            // 입력받은 데이터를 가상 포트 페어로 전송
            if (_outputPort1.IsOpen)
            {
                _outputPort1.Write(inputData);
            }
            if (_outputPort2.IsOpen)
            {
                _outputPort2.Write(inputData);
            }
        }
    }
}
3. 프로그램 A와 B 설정
프로그램 A: COM20을 열어 데이터를 수신하도록 설정합니다.
프로그램 B: COM21을 열어 데이터를 수신하도록 설정합니다.
이제 바코드 스캐너로부터 COM18으로 데이터를 읽어, COM20과 COM21로 전달할 수 있습니다. 프로그램 A와 B는 각각 COM20과 COM21에서 데이터를 수신하게 됩니다.

요약
com0com을 사용하여 가상 COM 포트 페어를 생성합니다.
C# 프로그램을 작성하여 실제 COM 포트(바코드 스캐너 연결)에서 데이터를 읽어 가상 COM 포트 페어로 전달합니다.
프로그램 A와 B는 각각 가상 COM 포트 페어의 한 쪽을 열어 데이터를 수신합니다.
이렇게 하면 실제 COM 포트를 열 수 없더라도, 가상 COM 포트를 통해 데이터를 전달할 수 있습니다