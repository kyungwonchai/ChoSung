래는 WPF를 사용하여 MSSQL과 Oracle 간의 데이터 동기화 및 매칭되지 않은 사용자 정보를 관리할 수 있는 애플리케이션의 코드입니다. XAML UI와 함께 C# 코드를 제공합니다.

데이터 동기화 클래스 (비동기 작업 및 지속 실행):
csharp
코드 복사
using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;
using Oracle.ManagedDataAccess.Client;

public class DataSync
{
    private string sourceConnectionString = "Data Source=SourceServer;Initial Catalog=SourceDB;User ID=YourUsername;Password=YourPassword";
    private string targetConnectionString = "Data Source=TargetServer;Initial Catalog=TargetDB;User ID=YourUsername;Password=YourPassword";
    private string oracleConnectionString = "Data Source=OracleServer;User ID=YourUsername;Password=YourPassword";

    public async Task SyncDataAsync()
    {
        while (true)
        {
            DataTable sourceData = await GetSourceDataAsync();
            DataTable targetData = await GetTargetDataAsync();

            foreach (DataRow sourceRow in sourceData.Rows)
            {
                DataRow[] targetRows = targetData.Select($"E_NUM = '{sourceRow["E_NUM"]}'");

                if (targetRows.Length == 0)
                {
                    await InsertRowAsync(sourceRow);
                }
                else
                {
                    await UpdateRowAsync(sourceRow, targetRows[0]);
                }
            }

            // Delay for a certain interval before next sync
            await Task.Delay(TimeSpan.FromMinutes(10));
        }
    }

    private async Task<DataTable> GetSourceDataAsync()
    {
        using (SqlConnection conn = new SqlConnection(sourceConnectionString))
        {
            await conn.OpenAsync();
            string query = "SELECT PROCESS, GROUP_NAME, USER_NAME, E_NUM FROM ESD_USER_INFO WHERE PROCESS LIKE '%REPAIR%'";
            SqlDataAdapter adapter = new SqlDataAdapter(query, conn);
            DataTable dataTable = new DataTable();
            adapter.Fill(dataTable);
            return dataTable;
        }
    }

    private async Task<DataTable> GetTargetDataAsync()
    {
        using (SqlConnection conn = new SqlConnection(targetConnectionString))
        {
            await conn.OpenAsync();
            string query = "SELECT PROCESS, GROUP_NAME, USER_NAME, E_NUM FROM 테이블B";
            SqlDataAdapter adapter = new SqlDataAdapter(query, conn);
            DataTable dataTable = new DataTable();
            adapter.Fill(dataTable);
            return dataTable;
        }
    }

    private async Task InsertRowAsync(DataRow sourceRow)
    {
        using (SqlConnection conn = new SqlConnection(targetConnectionString))
        {
            await conn.OpenAsync();
            string query = "INSERT INTO 테이블B (PROCESS, GROUP_NAME, USER_NAME, E_NUM) VALUES (@PROCESS, @GROUP_NAME, @USER_NAME, @E_NUM)";
            SqlCommand cmd = new SqlCommand(query, conn);
            cmd.Parameters.AddWithValue("@PROCESS", sourceRow["PROCESS"]);
            cmd.Parameters.AddWithValue("@GROUP_NAME", sourceRow["GROUP_NAME"]);
            cmd.Parameters.AddWithValue("@USER_NAME", sourceRow["USER_NAME"]);
            cmd.Parameters.AddWithValue("@E_NUM", sourceRow["E_NUM"]);
            await cmd.ExecuteNonQueryAsync();
        }
    }

    private async Task UpdateRowAsync(DataRow sourceRow, DataRow targetRow)
    {
        bool isDifferent = !sourceRow["PROCESS"].Equals(targetRow["PROCESS"]) ||
                           !sourceRow["GROUP_NAME"].Equals(targetRow["GROUP_NAME"]) ||
                           !sourceRow["USER_NAME"].Equals(targetRow["USER_NAME"]);

        if (isDifferent)
        {
            using (SqlConnection conn = new SqlConnection(targetConnectionString))
            {
                await conn.OpenAsync();
                string query = "UPDATE 테이블B SET PROCESS = @PROCESS, GROUP_NAME = @GROUP_NAME, USER_NAME = @USER_NAME WHERE E_NUM = @E_NUM";
                SqlCommand cmd = new SqlCommand(query, conn);
                cmd.Parameters.AddWithValue("@PROCESS", sourceRow["PROCESS"]);
                cmd.Parameters.AddWithValue("@GROUP_NAME", sourceRow["GROUP_NAME"]);
                cmd.Parameters.AddWithValue("@USER_NAME", sourceRow["USER_NAME"]);
                cmd.Parameters.AddWithValue("@E_NUM", sourceRow["E_NUM"]);
                await cmd.ExecuteNonQueryAsync();
            }
        }
    }

    public async Task<DataTable> GetOracleUserDataAsync()
    {
        using (OracleConnection conn = new OracleConnection(oracleConnectionString))
        {
            await conn.OpenAsync();
            string query = "SELECT USER_NAME, USER_CARD_ID FROM OracleUserTable";
            OracleDataAdapter adapter = new OracleDataAdapter(query, conn);
            DataTable dataTable = new DataTable();
            adapter.Fill(dataTable);
            return dataTable;
        }
    }
}
WPF XAML UI:
xaml
코드 복사
<Window x:Class="DataSyncApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Data Sync Application" Height="450" Width="800">
    <Grid>
        <DataGrid x:Name="dataGrid" AutoGenerateColumns="False" Margin="10" CellEditEnding="DataGrid_CellEditEnding">
            <DataGrid.Columns>
                <DataGridTextColumn Header="USER_NAME" Binding="{Binding USER_NAME}" IsReadOnly="True"/>
                <DataGridTextColumn Header="USER_CARD_ID" Binding="{Binding USER_CARD_ID}"/>
                <DataGridTextColumn Header="E_NUM" Binding="{Binding E_NUM}" IsReadOnly="True"/>
                <DataGridTextColumn Header="PROCESS" Binding="{Binding PROCESS}" IsReadOnly="True"/>
                <DataGridTextColumn Header="GROUP_NAME" Binding="{Binding GROUP_NAME}" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>
        <Button Content="Load Data" HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="10" Click="LoadDataButton_Click"/>
    </Grid>
</Window>
MainWindow.xaml.cs:
csharp
코드 복사
using System;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;

namespace DataSyncApp
{
    public partial class MainWindow : Window
    {
        private DataSync dataSync;

        public MainWindow()
        {
            InitializeComponent();
            dataSync = new DataSync();
            Task.Run(() => dataSync.SyncDataAsync());
        }

        private async void LoadDataButton_Click(object sender, RoutedEventArgs e)
        {
            await LoadGridControlAsync();
        }

        private async Task LoadGridControlAsync()
        {
            DataTable sourceData = await dataSync.GetSourceDataAsync();
            DataTable oracleData = await dataSync.GetOracleUserDataAsync();

            var unmatchedRows = from source in sourceData.AsEnumerable()
                                join oracle in oracleData.AsEnumerable()
                                on source.Field<string>("USER_NAME") equals oracle.Field<string>("USER_NAME") into tempJoin
                                from subOracle in tempJoin.DefaultIfEmpty()
                                select new
                                {
                                    USER_NAME = source.Field<string>("USER_NAME"),
                                    USER_CARD_ID = subOracle == null ? "Not Matched" : subOracle.Field<string>("USER_CARD_ID"),
                                    E_NUM = source.Field<string>("E_NUM"),
                                    PROCESS = source.Field<string>("PROCESS"),
                                    GROUP_NAME = source.Field<string>("GROUP_NAME")
                                };

            dataGrid.ItemsSource = unmatchedRows.ToList();

            foreach (var item in dataGrid.Items)
            {
                DataGridRow row = (DataGridRow)dataGrid.ItemContainerGenerator.ContainerFromItem(item);
                if (row != null && ((dynamic)row.Item).USER_CARD_ID == "Not Matched")
                {
                    row.Background = new SolidColorBrush(Colors.Red);
                }
            }
        }

        private void DataGrid_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
        {
            if (e.Column.Header.ToString() == "USER_CARD_ID")
            {
                string userName = ((TextBox)e.EditingElement).Text;
                string userCardId = ((TextBox)e.EditingElement).Text;

                // Handle manual input for USER_CARD_ID
                // For example, you might update a local list or another table in the database.
            }
        }
    }
}
이 코드는 WPF UI를 사용하여 데이터를 표시하고 관리합니다. DataSync 클래스는 비동기로 데이터를 동기화하며, MainWindow에서는 데이터를 로드하고 UI에 표시하는 로직을 포함합니다. GridControl에서 매칭되지 않은 항목은 빨간색으로 강조 표시됩니다. 사용자는 USER_CARD_ID를 수동으로 수정할