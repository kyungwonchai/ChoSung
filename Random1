using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class ClickOnPixelColorForm : Form
{
    [DllImport("user32.dll")]
    public static extern bool GetCursorPos(out Point lpPoint);

    [DllImport("gdi32.dll")]
    public static extern int GetPixel(IntPtr hdc, int x, int y);

    public ClickOnPixelColorForm()
    {
        // 폼 초기화
        this.Text = "Click On Pixel Color";
        this.Size = new Size(300, 200);
        this.MouseDown += new MouseEventHandler(ClickOnPixelColorForm_MouseDown);
    }

    private void ClickOnPixelColorForm_MouseDown(object sender, MouseEventArgs e)
    {
        Point cursorPos;
        GetCursorPos(out cursorPos);

        IntPtr hdc = GetDC(IntPtr.Zero);
        int pixelColor = GetPixel(hdc, cursorPos.X, cursorPos.Y);
        ReleaseDC(IntPtr.Zero, hdc);

        Color color = Color.FromArgb(pixelColor);
        if (color.R < 75 && color.G < 75 && color.B < 75)
        {
            MessageBox.Show("클릭!");
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        Graphics g = e.Graphics;
        g.DrawString("클릭하여 픽셀 색상 확인", this.Font, Brushes.Black, 10, 10);
    }

    [DllImport("user32.dll")]
    public static extern IntPtr GetDC(IntPtr hwnd);

    [DllImport("user32.dll")]
    public static extern int ReleaseDC(IntPtr hwnd, IntPtr hdc);
}

public class Program
{
    public static void Main()
    {
        Application.Run(new ClickOnPixelColorForm());
    }
}
