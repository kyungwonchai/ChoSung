using System;
using System.Collections.Generic;
using System.Drawing;
using System.IO;
using System.Runtime.Serialization.Formatters.Binary;
using System.Windows.Forms;

public partial class MainForm : Form
{
    private string folderPath = @"C:\agent1";
    private PrintDocument printDocument = new PrintDocument();
    private PrintDialog printDialog = new PrintDialog();

    public MainForm()
    {
        InitializeComponent();

        // 이벤트 핸들러 등록
        printDocument.PrintPage += PrintDocument_PrintPage;

        // 폴더가 없으면 폴더를 생성
        if (!Directory.Exists(folderPath))
        {
            Directory.CreateDirectory(folderPath);
        }

        // 저장된 파일들을 ListBox에 최근 파일 우선으로 표시
        RefreshListBox();
    }

    private void RefreshListBox()
    {
        // 폴더에 있는 .dat 파일들을 가져와서 ListBox에 표시
        listBox1.Items.Clear();
        string[] files = Directory.GetFiles(folderPath, "*.dat");

        // 파일들을 최근 수정일자를 기준으로 내림차순으로 정렬
        List<string> sortedFiles = new List<string>(files);
        sortedFiles.Sort((a, b) => -File.GetLastWriteTime(a).CompareTo(File.GetLastWriteTime(b)));

        listBox1.Items.AddRange(sortedFiles.ToArray());
    }

    // 이하 생략...
}
