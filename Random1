using DevExpress.XtraTreeList.Nodes;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;
using DevExpress.XtraTreeList;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        treeList1.OptionsBehavior.Editable = false; // 트리 리스트를 읽기 전용으로 만듭니다.
        treeList1.OptionsView.ShowColumns = false; // 열 헤더를 숨깁니다.

        // 특정 폴더 설정
        string rootFolder = @"C:\YourFolder";

        // Root 노드 추가
        TreeListNode rootNode = treeList1.AppendNode(new object[] { Path.GetFileName(rootFolder) }, null);
        rootNode.Tag = rootFolder;

        // 하위 디렉토리 추가
        AddDirectories(rootNode);
        treeList1.ExpandAll();

        // 더블 클릭 이벤트 핸들러 추가
        treeList1.DoubleClick += TreeList1_DoubleClick;
    }

    private void AddDirectories(TreeListNode parentNode)
    {
        string path = (string)parentNode.Tag;
        try
        {
            foreach (var dir in Directory.GetDirectories(path))
            {
                TreeListNode node = treeList1.AppendNode(new object[] { Path.GetFileName(dir) }, parentNode);
                node.Tag = dir;
                AddDirectories(node);
            }
        }
        catch (Exception)
        {
            // 접근 권한이 없는 경우 무시
        }
    }

    private void TreeList1_DoubleClick(object sender, EventArgs e)
    {
        TreeList tree = sender as TreeList;
        string path = (string)tree.FocusedNode.Tag;
        if (Directory.Exists(path) || File.Exists(path))
        {
            Process.Start("explorer.exe", path);
        }
    }
}
