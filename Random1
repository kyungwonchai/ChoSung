using System;
using System.Runtime.InteropServices;
using System.Text;

public class Program
{
    [DllImport("user32.dll")]
    public static extern bool EnumWindows(EnumWindowsProc enumProc, ref IntPtr lParam);

    [DllImport("user32.dll")]
    public static extern int GetClassName(IntPtr hWnd, StringBuilder lpClassName, int nMaxCount);

    [DllImport("user32.dll")]
    public static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int nMaxCount);

    public delegate bool EnumWindowsProc(IntPtr hWnd, ref IntPtr lParam);

    public static bool MyEnumWindowsProc(IntPtr hWnd, ref IntPtr lParam)
    {
        StringBuilder className = new StringBuilder(256);
        StringBuilder windowText = new StringBuilder(256);

        GetClassName(hWnd, className, className.Capacity);
        GetWindowText(hWnd, windowText, windowText.Capacity);

        string targetClassName = "YourClassNameHere";
        string targetWindowText = "YourWindowTextHere";

        if (className.ToString() == targetClassName && windowText.ToString() == targetWindowText)
        {
            lParam = hWnd;
            return false; // Stop enumeration
        }

        return true; // Continue enumeration
    }

    public static IntPtr FindWindowByClassAndCaption(string className, string caption)
    {
        IntPtr foundHandle = IntPtr.Zero;
        EnumWindows(new EnumWindowsProc(MyEnumWindowsProc), ref foundHandle);
        return foundHandle;
    }

    public static void Main()
    {
        IntPtr hWnd = FindWindowByClassAndCaption("YourClassNameHere", "YourWindowTextHere");

        if (hWnd != IntPtr.Zero)
        {
            Console.WriteLine("Window handle found: " + hWnd);
        }
        else
        {
            Console.WriteLine("Window not found.");
        }
    }
}
