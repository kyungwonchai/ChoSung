ì¢‹ë‹¤. ì…ë ¥ ì¹¸ì— ê°’ì´ ì…ë ¥ë˜ê±°ë‚˜ ìˆ˜ì •ë˜ë©´ ì¦‰ì‹œ MSSQL ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜ë˜ë„ë¡ ìˆ˜ì •í•˜ê² ë‹¤.
ë‘ ê°€ì§€ ë°©ì‹ìœ¼ë¡œ ì œê³µí•˜ê² ë‹¤:

âœ… 1. ìë™ ì €ì¥ (ì»¤ì„œ ì´íƒˆ ì‹œ ë°”ë¡œ ì €ì¥)
ì‚¬ìš©ìê°€ TextBoxì— ê°’ì„ ì…ë ¥í•˜ê³  ì»¤ì„œê°€ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì´ë™í•˜ë©´ ìë™ìœ¼ë¡œ ì €ì¥ëœë‹¤.

ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ MSSQL ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë¨.

âœ… 2. ìˆ˜ë™ ì €ì¥ (ë²„íŠ¼ í´ë¦­ ì‹œ ì €ì¥)
ì‚¬ìš©ìê°€ ê°’ì„ ë³€ê²½í•˜ê³  ì €ì¥ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ì €ì¥ëœë‹¤.

ë°ì´í„°ê°€ ì¦‰ì‹œ MSSQL ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜ë¨.

1. MainWindow.xaml (ìë™ ì €ì¥ ë°©ì‹ ì¶”ê°€)
xml
ì½”ë“œ ë³µì‚¬
<StackPanel Grid.Column="1" Margin="5">
    <TextBlock Text="User Details" FontWeight="Bold" Margin="0,0,0,10"/>

    <!-- ì´ë¦„ ì…ë ¥ -->
    <TextBox Text="{Binding SelectedUser.Name, UpdateSourceTrigger=PropertyChanged}" 
             LostFocus="OnUserDetailChanged" Margin="0,0,0,10"/>

    <!-- Knox ID ì…ë ¥ -->
    <TextBox Text="{Binding SelectedUser.KnoxId, UpdateSourceTrigger=PropertyChanged}" 
             LostFocus="OnUserDetailChanged" Margin="0,0,0,10"/>

    <!-- ì €ì¥ ë²„íŠ¼ ì¶”ê°€ (ìˆ˜ë™ ì €ì¥ ê¸°ëŠ¥) -->
    <Button Content="Save Changes" Click="SaveButton_Click" Margin="0,10,0,10"/>

    <!-- ê´€ë¦¬ í•­ëª© GridControl -->
    <dxg:GridControl x:Name="ManagementItemsGrid" AutoGenerateColumns="False"
                    ItemsSource="{Binding SelectedUser.ManagementItems}"
                    SelectionMode="Row">
        <dxg:GridControl.Columns>
            <dxg:GridColumn FieldName="Name" Header="Name" Width="*"/>
            <dxg:GridColumn FieldName="Floor" Header="Floor" Width="*"/>
            <dxg:GridColumn FieldName="Zone" Header="Zone" Width="*"/>
            <dxg:GridColumn FieldName="SubPart" Header="SubPart" Width="*"/>
            <dxg:GridColumn FieldName="Manager" Header="Manager" Width="*"/>
        </dxg:GridControl.Columns>
    </dxg:GridControl>
</StackPanel>
2. MainWindow.xaml.cs (ìë™ ì €ì¥ ë° ìˆ˜ë™ ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Windows;
using WPF_DevExpress_Locker_Management.ViewModels;

namespace WPF_DevExpress_Locker_Management
{
    public partial class MainWindow : Window
    {
        private readonly MainViewModel _viewModel;

        public MainWindow()
        {
            InitializeComponent();
            _viewModel = new MainViewModel();
            DataContext = _viewModel;
        }

        // ìë™ ì €ì¥ ê¸°ëŠ¥: TextBoxê°€ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ í¬ì»¤ìŠ¤ë¥¼ ìƒì—ˆì„ ë•Œ í˜¸ì¶œë¨
        private void OnUserDetailChanged(object sender, RoutedEventArgs e)
        {
            _viewModel.SaveUserDetails();
        }

        // ìˆ˜ë™ ì €ì¥ ê¸°ëŠ¥: ë²„íŠ¼ í´ë¦­ ì‹œ í˜¸ì¶œë¨
        private void SaveButton_Click(object sender, RoutedEventArgs e)
        {
            _viewModel.SaveUserDetails();
            MessageBox.Show("Changes saved successfully!");
        }
    }
}
3. MainViewModel.cs (ì €ì¥ ê¸°ëŠ¥ ì¶”ê°€)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using WPF_DevExpress_Locker_Management.Models;
using WPF_DevExpress_Locker_Management.Services;
using System.Windows.Input;

namespace WPF_DevExpress_Locker_Management.ViewModels
{
    public class MainViewModel : INotifyPropertyChanged
    {
        private readonly DataRepository _dataRepository;
        public ObservableCollection<User> Users { get; set; }
        public User SelectedUser { get; set; }

        public ICommand AddUserCommand { get; }
        public ICommand DeleteUserCommand { get; }

        public MainViewModel()
        {
            _dataRepository = new DataRepository();
            Users = new ObservableCollection<User>(_dataRepository.GetUsers());
        }

        // ì‚¬ìš©ìê°€ ë³€ê²½í•œ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
        public void SaveUserDetails()
        {
            if (SelectedUser != null)
            {
                _dataRepository.UpdateUser(SelectedUser);
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string name) => PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(name));
    }
}
4. DataRepository.cs (ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ ì¶”ê°€)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Data.SqlClient;
using WPF_DevExpress_Locker_Management.Models;

namespace WPF_DevExpress_Locker_Management.Services
{
    public class DataRepository
    {
        private readonly string _connectionString = "Server=localhost;Database=LockerDB;User Id=your_user;Password=your_password;";

        public void UpdateUser(User user)
        {
            using (SqlConnection conn = new SqlConnection(_connectionString))
            {
                conn.Open();
                var cmd = new SqlCommand("UPDATE Users SET Name = @Name, KnoxId = @KnoxId WHERE UserId = @UserId", conn);
                cmd.Parameters.AddWithValue("@UserId", user.UserId);
                cmd.Parameters.AddWithValue("@Name", user.Name);
                cmd.Parameters.AddWithValue("@KnoxId", user.KnoxId);

                cmd.ExecuteNonQuery();
            }
        }
    }
}
âœ… ìˆ˜ì • ì‚¬í•­ ìš”ì•½
ì»¤ì„œ ì´íƒˆ ì‹œ ìë™ ì €ì¥ (LostFocus ì´ë²¤íŠ¸ í™œìš©)

ë²„íŠ¼ í´ë¦­ ì‹œ ìˆ˜ë™ ì €ì¥ (Save Changes ë²„íŠ¼ ì¶”ê°€)

DataRepositoryì— UpdateUser() í•¨ìˆ˜ ì¶”ê°€

TextBoxì— UpdateSourceTrigger=PropertyChanged ì‚¬ìš©í•˜ì—¬ ì¦‰ì‹œ ê°’ ë°˜ì˜

ğŸ“Œ ì‘ë™ ë°©ì‹
ì»¤ì„œê°€ TextBoxë¥¼ ë²—ì–´ë‚˜ë©´(LostFocus) ìë™ìœ¼ë¡œ DBì— ì €ì¥ëœë‹¤.

ë˜ëŠ” ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì €ì¥ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ì €ì¥í•  ìˆ˜ ìˆë‹¤.

ì €ì¥ ì‹œì—ëŠ” MainViewModelì˜ SaveUserDetails() í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì–´, ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ê°€ ì§„í–‰ëœë‹¤.
