 ì°½ì— í…Œë‘ë¦¬ë¥¼ ê·¸ë ¤ PictureBoxì— í‘œì‹œí•˜ê¸°
í˜„ì¬ ê°ì§€í•œ ì°½ì„ PictureBoxì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë„ë¡ ì°½ì˜ í…Œë‘ë¦¬ë¥¼ ê·¸ë ¤ì„œ í‘œì‹œí•˜ê² ìŠµë‹ˆë‹¤. ğŸš€

1. ì¶”ê°€ ê¸°ëŠ¥
ê°ì§€ëœ ì°½ì— í…Œë‘ë¦¬(ë¹¨ê°„ìƒ‰) ê·¸ë¦¬ê¸°
ê°ì§€ëœ ì°½ì˜ ì¢Œí‘œë¥¼ ì½˜ì†”ì— ì¶œë ¥
í…Œë‘ë¦¬ê°€ ê·¸ë ¤ì§„ ì´ë¯¸ì§€ë¥¼ PictureBoxì— í‘œì‹œ
2. ìˆ˜ì •ëœ ì½”ë“œ (Form1.cs)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Drawing;
using System.IO;
using System.Windows.Forms;
using OpenCvSharp;
using OpenCvSharp.Extensions;

namespace WinFormsOpenCv
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            pictureBox1.SizeMode = PictureBoxSizeMode.StretchImage; // ì´ë¯¸ì§€ ë§ì¶”ê¸°
        }

        // ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
        private void btnProcess_Click(object sender, EventArgs e)
        {
            // í™”ë©´ ìº¡ì²˜
            Bitmap screenshot = CaptureScreen();

            // OpenCV Mat ë³€í™˜ ë° ì´ì§„í™” ì ìš©
            Mat matImage = BitmapConverter.ToMat(screenshot);
            Mat gray = new Mat();
            Cv2.CvtColor(matImage, gray, ColorConversionCodes.BGR2GRAY);
            Mat binary = new Mat();
            Cv2.Threshold(gray, binary, 200, 255, ThresholdTypes.Binary);

            // ì°½ ê°ì§€
            Rect detectedWindow = DetectWindow(binary, matImage);

            if (detectedWindow != Rect.Empty)
            {
                // ìš°ì¸¡ ìƒë‹¨ ê¸°ì¤€ ì¢Œí‘œì—ì„œ x -10, y -10 ì§€ì  í´ë¦­
                int clickX = detectedWindow.Right - 10;
                int clickY = detectedWindow.Top - 10;
                Cursor.Position = new System.Drawing.Point(clickX, clickY);
                mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, clickX, clickY, 0, IntPtr.Zero);

                Console.WriteLine($"ë‹«ê¸° ë²„íŠ¼ í´ë¦­: ({clickX}, {clickY})");
            }
            else
            {
                Console.WriteLine("í•´ë‹¹ ì¡°ê±´ì˜ ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }

            // PictureBoxì— ê°ì§€ëœ ì°½ í‘œì‹œ
            pictureBox1.Image = ConvertMatToBitmap(matImage);
            pictureBox1.Refresh();
        }

        // í™”ë©´ ìº¡ì²˜ í•¨ìˆ˜ (ì „ì²´ í™”ë©´ ìº¡ì²˜)
        private Bitmap CaptureScreen()
        {
            Rectangle bounds = Screen.PrimaryScreen.Bounds;
            Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height);
            using (Graphics g = Graphics.FromImage(bitmap))
            {
                g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
            }
            return bitmap;
        }

        // Mat â†’ Bitmap ë³€í™˜ í•¨ìˆ˜
        private Bitmap ConvertMatToBitmap(Mat mat)
        {
            return BitmapConverter.ToBitmap(mat);
        }

        // ì°½ ê°ì§€ ë° í…Œë‘ë¦¬ ê·¸ë¦¬ê¸° í•¨ìˆ˜
        private Rect DetectWindow(Mat binary, Mat originalImage)
        {
            // ì»¨íˆ¬ì–´ ì°¾ê¸°
            Cv2.FindContours(binary, out OpenCvSharp.Point[][] contours, out _, RetrievalModes.External, ContourApproximationModes.ApproxSimple);

            Rect detectedWindow = Rect.Empty;
            int screenWidth = Screen.PrimaryScreen.Bounds.Width;
            int screenCenterX = screenWidth / 2;
            double maxArea = 0;

            foreach (var contour in contours)
            {
                Rect rect = Cv2.BoundingRect(contour);
                double area = rect.Width * rect.Height;

                // ì°½ ê°ì§€ ì¡°ê±´ (ë„ˆë¬´ ì‘ì€ ê²ƒ ì œì™¸, í™”ë©´ ì¤‘ì•™, y > 150)
                if (rect.Width > 100 && rect.Height > 50 && rect.Y > 150 && 
                    Math.Abs(rect.X + rect.Width / 2 - screenCenterX) < 200 && area > maxArea)
                {
                    maxArea = area;
                    detectedWindow = rect;

                    // ì°½ í…Œë‘ë¦¬ ê·¸ë¦¬ê¸° (ë¹¨ê°„ìƒ‰)
                    Cv2.Rectangle(originalImage, rect, new Scalar(0, 0, 255), 3);
                    Console.WriteLine($"ì°½ ê°ì§€: ìœ„ì¹˜ ({rect.X}, {rect.Y}), í¬ê¸° ({rect.Width}x{rect.Height})");
                }
            }

            return detectedWindow;
        }

        // ë§ˆìš°ìŠ¤ í´ë¦­ì„ ìœ„í•œ WinAPI
        [DllImport("user32.dll", SetLastError = true)]
        static extern void mouse_event(uint dwFlags, int dx, int dy, uint dwData, IntPtr dwExtraInfo);

        const uint MOUSEEVENTF_LEFTDOWN = 0x02;
        const uint MOUSEEVENTF_LEFTUP = 0x04;
    }
}
3. ì£¼ìš” ë³€ê²½ì 
âœ… 1) ì°½ í…Œë‘ë¦¬ ê·¸ë¦¬ê¸°
ê°ì§€ëœ ì°½ì„ Cv2.Rectangle()ì„ ì‚¬ìš©í•´ ë¹¨ê°„ìƒ‰ í…Œë‘ë¦¬ë¡œ í‘œì‹œ
csharp
ì½”ë“œ ë³µì‚¬
Cv2.Rectangle(originalImage, rect, new Scalar(0, 0, 255), 3);
ê²°ê³¼ ì´ë¯¸ì§€ê°€ PictureBoxì— í‘œì‹œë¨ â†’ ì œëŒ€ë¡œ ê°ì§€ë˜ëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥!
âœ… 2) ê°ì§€ëœ ì°½ì˜ ì¢Œí‘œ ì¶œë ¥
ì°½ì„ ê°ì§€í•˜ë©´ ì¢Œí‘œì™€ í¬ê¸°ë¥¼ Consoleì— ì¶œë ¥í•˜ì—¬ ë””ë²„ê¹… ê°€ëŠ¥
csharp
ì½”ë“œ ë³µì‚¬
Console.WriteLine($"ì°½ ê°ì§€: ìœ„ì¹˜ ({rect.X}, {rect.Y}), í¬ê¸° ({rect.Width}x{rect.Height})");
âœ… 3) PictureBoxì— ê²°ê³¼ ì´ë¯¸ì§€ í‘œì‹œ
ê°ì§€ëœ ì°½ì˜ í…Œë‘ë¦¬ê°€ í¬í•¨ëœ ì´ë¯¸ì§€ë¥¼ PictureBoxì— í‘œì‹œ
csharp
ì½”ë“œ ë³µì‚¬
pictureBox1.Image = ConvertMatToBitmap(matImage);
pictureBox1.Refresh();
4. ì‹¤í–‰ ê²°ê³¼
WinForms ì‹¤í–‰ í›„ "ì´ì§„í™” ì ìš©" ë²„íŠ¼ í´ë¦­
í˜„ì¬ í™”ë©´ì„ ìº¡ì²˜í•˜ì—¬ Y â‰¥ 150 & ì¤‘ì•™ì— ìˆëŠ” ì°½ì„ ê°ì§€
ì°½ì˜ í…Œë‘ë¦¬ë¥¼ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ê·¸ë¦¼
ê°ì§€ëœ ì°½ì´ ìˆìœ¼ë©´ ìš°ì¸¡ ìƒë‹¨ ë‹«ê¸° ë²„íŠ¼ í´ë¦­