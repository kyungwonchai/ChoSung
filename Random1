IF EXISTS(SELECT * FROM INFORMATION_SCHEMA.COLUMNS 
          WHERE TABLE_NAME = 'YourTableName' AND COLUMN_NAME = 'szModelName')
BEGIN
    SELECT 
        CASE 
            WHEN CHARINDEX('_', szModelName) > 0 AND CHARINDEX('_', szModelName, CHARINDEX('_', szModelName) + 1) > 0 
            THEN SUBSTRING(szModelName, 1, CHARINDEX('_', szModelName, CHARINDEX('_', szModelName) + 1) - 1)
            ELSE szModelName
        END AS ExtractedString
    FROM 
        YourTableName
END
