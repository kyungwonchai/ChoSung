년도로 설정하고, 나머지 시트는 본래 날짜를 유지하면서 나머지 작업을 수행하는 VBA 매크로 코드입니다.

이 매크로는 첫 번째와 두 번째 시트의 2행의 날짜를 2023년도로 고정하고, 그 외 모든 시트에서는 날짜를 수정하지 않습니다. 또한, 각 시트에서 빈 셀을 왼쪽 또는 위쪽의 값으로 채우는 기능도 포함되어 있습니다.

엑셀에서 ALT + F11을 눌러 VBA 편집기를 엽니다.
Insert > Module을 선택하여 새 모듈을 추가합니다.
아래 코드를 붙여넣고 실행합니다.
vba
코드 복사
Sub FillCellsForAllSheets()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim lastCol As Long
    Dim i As Long
    Dim j As Long
    Dim col As Integer
    Dim sheetIndex As Integer

    ' 모든 시트를 순회
    sheetIndex = 1 ' 시트 번호를 추적하기 위해 사용
    For Each ws In ThisWorkbook.Worksheets
        ' 첫째와 둘째 시트는 2행 날짜를 강제로 2023년도로 설정
        If sheetIndex = 1 Or sheetIndex = 2 Then
            ws.Cells(2, 1).Value = "2023-01-01" ' 2023년도로 설정
        End If
        
        ' Step 1: 2행에서 빈 셀이 있으면 왼쪽 값으로 채우기
        ' 2행에서 마지막 열을 찾기
        lastCol = ws.Cells(2, ws.Columns.Count).End(xlToLeft).Column
        
        ' 2열부터 마지막 열까지 반복
        For j = 2 To lastCol
            ' 셀이 비어 있는지 확인
            If IsEmpty(ws.Cells(2, j).Value) Then
                ' 비어 있으면 왼쪽 셀의 값을 복사
                ws.Cells(2, j).Value = ws.Cells(2, j - 1).Value
            End If
        Next j

        ' Step 2: A, B, C 열에서 빈 셀이 있으면 위쪽 값으로 채우기
        For col = 1 To 3 ' 1은 A열, 2는 B열, 3은 C열
            ' 마지막 행 찾기 (각 열을 기준으로)
            lastRow = ws.Cells(ws.Rows.Count, col).End(xlUp).Row
            
            ' 2행부터 마지막 행까지 반복
            For i = 2 To lastRow
                ' 셀이 비어 있는지 확인
                If IsEmpty(ws.Cells(i, col).Value) Then
                    ' 비어 있으면 위쪽 셀의 값을 복사
                    ws.Cells(i, col).Value = ws.Cells(i - 1, col).Value
                End If
            Next i
        Next col

        ' 다음 시트로 넘어가면서 시트 인덱스를 증가
        sheetIndex = sheetIndex + 1
    Next ws
    
    MsgBox "모든 시트의 2행 날짜 설정 및 빈 셀을 채웠습니다.", vbInformation
End Sub
코드 설명