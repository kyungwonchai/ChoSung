이해했습니다. App.xaml.cs에서 MainWindow를 인식하도록 만드는 것이 핵심입니다. 이를 위해 싱글톤 패턴을 사용하여 MainWindow의 인스턴스를 접근할 수 있도록 하겠습니다. 또한, Clipboard의 내용을 받아 새로운 창을 열고 도킹하도록 하는 방법을 수정하겠습니다.

1. MainWindow.xaml.cs
먼저 MainWindow에서 싱글톤 패턴을 설정합니다.

csharp
코드 복사
using System;
using System.Runtime.InteropServices;
using System.Windows;
using DevExpress.Xpf.Core;
using DevExpress.Xpf.Layout.Core;

namespace ClipboardApp
{
    public partial class MainWindow : DXWindow
    {
        private static MainWindow _instance;
        public static MainWindow Instance
        {
            get { return _instance; }
        }

        // 외부 DLL 호출
        [DllImport("user32.dll")]
        private static extern bool SetForegroundWindow(IntPtr hWnd);
        [DllImport("user32.dll")]
        private static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

        public MainWindow()
        {
            InitializeComponent();
            LoadClipboardContent();
            _instance = this; // 현재 인스턴스를 저장합니다.
        }

        private void LoadClipboardContent()
        {
            if (Clipboard.ContainsText())
            {
                string clipboardText = Clipboard.GetText();
                myTextBox.Text = clipboardText;
            }
        }

        public void DockNewWindow(string content)
        {
            NewWindow newWindow = new NewWindow
            {
                Owner = this
            };
            newWindow.newTextBox.Text = content;

            var newPanel = new LayoutPanel
            {
                Content = newWindow.Content,
                Caption = "New Tab"
            };

            dockLayoutManager.DockController.Dock(newPanel, dockLayoutManager.LayoutRoot, DockType.Fill);
        }

        public static void ActivateExistingInstance(string content)
        {
            if (_instance != null)
            {
                _instance.Dispatcher.Invoke(() =>
                {
                    IntPtr hWnd = FindWindow(null, "Clipboard App");
                    if (hWnd != IntPtr.Zero)
                    {
                        SetForegroundWindow(hWnd);
                        _instance.DockNewWindow(content);
                    }
                });
            }
        }
    }
}
2. App.xaml.cs
App.xaml.cs에서 프로그램 실행 시 MainWindow를 활성화하고 새 탭을 추가하는 로직을 구현합니다.

csharp
코드 복사
using System;
using System.Threading;
using System.Windows;

namespace ClipboardApp
{
    public partial class App : Application
    {
        private static Mutex mutex = null;

        protected override void OnStartup(StartupEventArgs e)
        {
            const string appName = "ClipboardApp";
            bool createdNew;

            mutex = new Mutex(true, appName, out createdNew);

            if (!createdNew)
            {
                // 이미 실행 중인 경우 기존 인스턴스 활성화 및 새 탭 추가
                string clipboardContent = Clipboard.GetText();
                MainWindow.ActivateExistingInstance(clipboardContent);
                Application.Current.Shutdown();
                return;
            }

            base.OnStartup(e);
            MainWindow mainWindow = new MainWindow();
            mainWindow.Show();
        }
    }
}
3. NewWindow.xaml.cs
이 부분은 그대로 두어도 됩니다.

csharp
코드 복사
using System.Windows;

namespace ClipboardApp
{
    public partial class NewWindow : Window
    {
        public NewWindow()
        {
            InitializeComponent();
        }
    }
}
위의 코드로, App.xaml.cs에서 MainWindow 인스턴스를 관리하고, 중복 실행 시 기존 인스턴스를 활성화하여 새 탭을 추가하도록 구현했습니다. 이 방법으로 요구 사항을 충족할 수 있을 것입