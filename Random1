래는 MSSQL에서 LineName을 전달받아 해당 라인의 IpName을 반환하는 Stored Procedure와 이를 호출하는 C# 코드입니다.

MSSQL: Stored Procedure
sql
코드 복사
CREATE PROCEDURE GetIpByLineName
    @LineName NVARCHAR(100) -- 입력 라인 이름
AS
BEGIN
    SET NOCOUNT ON;

    -- IpName을 반환
    SELECT IpName
    FROM LineTable
    WHERE LineName = @LineName
END
LineTable 예제
LineName	IpName
Line 1.1	192.168.0.101
Line 1.2	192.168.0.102
Line 2.1	192.168.0.103
Line 2.2	192.168.0.104
C# 코드
csharp
코드 복사
using System;
using System.Data;
using System.Data.SqlClient;

namespace LineIpLookup
{
    public class LineIpService
    {
        private readonly string _connectionString;

        public LineIpService(string connectionString)
        {
            _connectionString = connectionString;
        }

        /// <summary>
        /// LineName을 사용하여 IpName을 가져오는 메서드
        /// </summary>
        /// <param name="lineName">라인 이름</param>
        /// <returns>IpName (없으면 null)</returns>
        public string GetIpByLineName(string lineName)
        {
            string ipName = null;

            using (var connection = new SqlConnection(_connectionString))
            {
                connection.Open();

                using (var command = new SqlCommand("GetIpByLineName", connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    // LineName 매개변수 추가
                    command.Parameters.Add(new SqlParameter("@LineName", SqlDbType.NVarChar)
                    {
                        Value = lineName
                    });

                    // 결과 읽기
                    using (var reader = command.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            ipName = reader["IpName"].ToString();
                        }
                    }
                }
            }

            return ipName;
        }
    }
}
사용 예시
csharp
코드 복사
class Program
{
    static void Main(string[] args)
    {
        string connectionString = "YourConnectionStringHere"; // DB 연결 문자열
        var service = new LineIpService(connectionString);

        // 테스트: 라인 이름으로 IP 가져오기
        string lineName = "Line 1.1";
        string ipName = service.GetIpByLineName(lineName);

        if (!string.IsNullOrEmpty(ipName))
        {
            Console.WriteLine($"Line: {lineName}, IP: {ipName}");
        }
        else
        {
            Console.WriteLine($"Line: {lineName}의 IP를 찾을 수 없습니다.");
        }
    }
}
코드 설명
Stored Procedure (GetIpByLineName):

LineName을 입력받아 해당 라인의 IpName을 반환.
LineTable에서 LineName 조건으로 조회.
C# 메서드 (GetIpByLineName):

SqlConnection과 SqlCommand를 사용하여 프로시저 호출.
프로시저의 결과를 읽어 IpName을 반환.
사용 예제:

Line 1.1을 입력하면 192.168.0.101을 반환.
라인 이름이 없으면 null 반환.
결과 예시
입력:
LineName: Line 1.1
출력:
mathematica
코드 복사