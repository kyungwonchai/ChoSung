네, 허용할 IP 주소가 많을 경우 하나씩 추가하는 것은 번거롭습니다. 다행히 IIS의 "IP 주소 및 도메인 제한" 기능에는 IP 대역(범위)을 추가하는 기능이 있으며, 여러 개의 특정 IP를 일괄 추가하려면 GUI 외의 방법(스크립트 등)을 사용해야 합니다.

1. IP 대역(범위) 추가 방법 (GUI에서 가능)

연속된 IP 주소 블록 전체를 허용해야 할 때 사용합니다. 예를 들어, 특정 사무실의 모든 PC(192.168.1.1 부터 192.168.1.254 까지)를 허용하는 경우입니다.

IIS 관리자 > 해당 웹 사이트 선택 > 'IP 주소 및 도메인 제한' 더블 클릭.
오른쪽 '작업' 창에서 '허용 항목 추가...(Add Allow Entry...)' 클릭.
허용 규칙 추가 창에서 'IP 주소 범위(IP address range)' 옵션을 선택합니다.
방법 1: 네트워크 ID 및 서브넷 마스크 사용
IP 주소 범위(IP address range): 허용할 네트워크의 시작 주소(네트워크 ID)를 입력합니다. (예: 192.168.1.0)
마스크(Mask) 또는 서브넷 마스크(Subnet mask): 해당 네트워크의 서브넷 마스크를 입력합니다. (예: 255.255.255.0)
'확인' 클릭.
방법 2: CIDR 표기법 사용
IP 주소 범위(IP address range): 허용할 네트워크 주소와 서브넷 비트 수를 CIDR 형식으로 입력합니다. (예: 192.168.1.0/24) /24는 255.255.255.0 서브넷 마스크와 동일한 범위를 의미합니다.
'확인' 클릭.
이 방법을 사용하면 지정된 범위 내의 모든 IP 주소가 한 번에 허용 목록에 추가됩니다.

2. 여러 개의 '특정' IP 주소 일괄 추가 방법 (GUI 외)

GUI에서는 여러 개의 개별 IP 주소를 한 번에 입력하거나 목록으로 붙여넣는 기능은 없습니다. 따라서 스크립트나 구성 파일 편집 방법을 사용해야 합니다.

방법 A: PowerShell 스크립트 사용 (권장)

Windows Server 2012에는 IIS 관리를 위한 WebAdministration PowerShell 모듈이 포함되어 있습니다. 이를 사용하여 스크립트로 여러 IP를 추가할 수 있습니다.
PowerShell을 관리자 권한으로 실행합니다.
아래는 예시 스크립트입니다. 실제 웹 사이트 이름과 IP 목록을 수정하여 사용하세요.
PowerShell

# IIS 관리 모듈 가져오기
Import-Module WebAdministration

# 대상 웹 사이트 이름 설정
$siteName = "MyRepairApi" # 여기에 실제 웹 사이트 이름을 입력하세요

# 허용할 IP 주소 목록 (파일에서 읽어오거나 직접 정의)
$allowedIPs = @(
    "192.168.0.15",
    "192.168.0.16",
    "10.1.2.3",
    "172.16.5.100"
    # 필요한 만큼 IP 주소 추가
)

# 각 IP 주소에 대해 허용 규칙 추가
foreach ($ip in $allowedIPs) {
    try {
        # IIS 경로 지정 및 필터 설정
        $iisPath = "IIS:\Sites\$siteName"
        $filter = "system.webServer/security/ipSecurity"

        # 설정 추가 (이미 존재하면 오류 발생 가능하므로 주의)
        Add-WebConfigurationProperty -pspath $iisPath -filter $filter -name "." -value @{ipAddress=$ip;allowed='True'}

        Write-Host "Successfully allowed IP: $ip for site '$siteName'"
    } catch {
        Write-Error "Failed to allow IP: $ip for site '$siteName'. Error: $($_.Exception.Message)"
        # 이미 규칙이 존재하면 오류가 발생할 수 있습니다.
    }
}

Write-Host "IP address processing complete."
이 스크립트를 .ps1 파일로 저장하고 실행하거나, PowerShell 창에 직접 붙여넣어 실행할 수 있습니다. (실행 정책 Set-ExecutionPolicy 변경이 필요할 수 있음)
방법 B: appcmd.exe 명령어 사용 (명령 프롬프트)

IIS 설정을 위한 명령줄 도구인 appcmd.exe를 사용할 수 있습니다.
명령 프롬프트(cmd)를 관리자 권한으로 실행합니다.
각 IP에 대해 아래와 유사한 명령어를 실행해야 합니다. (보통 배치 파일(.bat) 스크립트로 만듭니다.)
DOS

@echo off
set SITE_NAME="MyRepairApi" REM 실제 웹 사이트 이름으로 변경

REM 허용할 IP 목록 (배치 파일에서 배열 처리 복잡, 보통 파일에서 읽거나 인자로 받음)
set ALLOWED_IPS=192.168.0.15 192.168.0.16 10.1.2.3 172.16.5.100

echo Processing IPs for site %SITE_NAME%...

for %%i in (%ALLOWED_IPS%) do (
    echo Allowing IP: %%i ...
    %systemroot%\system32\inetsrv\appcmd.exe set config %SITE_NAME% /section:system.webServer/security/ipSecurity /+"[ipAddress='%%i',allowed='True']" /commit:apphost
    REM 오류 처리는 기본 제공되지 않음
)

echo IP address processing complete.
pause
이 방식은 PowerShell보다 오류 처리 등이 번거로울 수 있습니다.
방법 C: 구성 파일 직접 편집 (고급 사용자용, 위험 감수)

IIS 설정은 XML 파일(%windir%\System32\inetsrv\config\applicationHost.config 또는 웹 사이트 폴더의 web.config)에 저장됩니다. 이 파일을 직접 편집하여 <ipSecurity> 섹션에 <add ipAddress="..." allowed="true" /> 항목을 여러 개 추가할 수 있습니다.
주의: 이 방법은 XML 구조를 정확히 이해해야 하며, 작은 실수로도 IIS 전체가 오작동할 수 있습니다. 반드시 백업 후 신중하게 작업해야 하며, 권장하는 방법은 아닙니다.
XML

<system.webServer>
    <security>
        <ipSecurity allowUnlisted="false"> <clear/> <add ipAddress="192.168.0.15" allowed="true" />
            <add ipAddress="192.168.0.16" allowed="true" />
            <add ipAddress="10.1.2.3" allowed="true" />
            <add ipAddress="172.16.5.100" allowed="true" />
            </ipSecurity>
    </security>
</system.webServer>
요약:

IP 대역(범위) 추가: IIS 관리자 GUI의 '허용 항목 추가'에서 'IP 주소 범위' 옵션을 사용하면 쉽게 추가 가능합니다.
여러 특정 IP 일괄 추가:
PowerShell 스크립트: 가장 권장하는 자동화 방법입니다.
appcmd.exe (배치 스크립트): 명령줄 기반으로 가능합니다.
구성 파일 직접 편집: 가능하지만 위험 부담이 크고 권장하지 않습니다.