래는 찾은 파란 버튼 영역의 가운데 좌표를 계산하여 클릭하는 코드입니다. 기존 코드에서 ClickOnBlueButton 함수를 수정하여, 파란색 버튼의 중심 좌표를 클릭하도록 합니다.

csharp
코드 복사
private void DetectAndDisplay(object sender, EventArgs e)
{
    // 스크린샷 캡처
    Bitmap screenshot = CaptureScreen();

    // 검정색 영역 확인 및 PictureBox에 표시
    Rectangle blackRegion = FindBlackRegion(screenshot);
    if (blackRegion != Rectangle.Empty)
    {
        Bitmap blackRegionImage = screenshot.Clone(blackRegion, screenshot.PixelFormat);
        pictureBox1.Image?.Dispose();
        pictureBox1.Image = blackRegionImage;

        // 검정 영역의 평균 색상 계산 및 출력
        Color avgColor = GetAverageColor(blackRegionImage);
        Console.WriteLine($"검정 영역 평균 색상 - R:{avgColor.R}, G:{avgColor.G}, B:{avgColor.B}");

        // 검정 영역 안에 파란색 버튼을 찾기
        Rectangle blueButton = FindBlueButton(screenshot, blackRegion);
        if (blueButton != Rectangle.Empty)
        {
            Console.WriteLine("파란 버튼이 검출되었습니다.");

            // 파란 버튼의 평균 색상 계산 및 출력
            Color blueAvgColor = GetAverageColor(screenshot.Clone(blueButton, screenshot.PixelFormat));
            Console.WriteLine($"파란 버튼 평균 색상 - R:{blueAvgColor.R}, G:{blueAvgColor.G}, B:{blueAvgColor.B}");

            // 파란 버튼 위치 클릭
            ClickOnBlueButton(blueButton);
        }
        else
        {
            Console.WriteLine("파란 버튼이 검출되지 않았습니다.");
        }
    }
    else
    {
        Console.WriteLine("검정 영역이 조건에 맞지 않습니다.");
    }

    screenshot.Dispose();
}

private void ClickOnBlueButton(Rectangle blueButton)
{
    // 파란 버튼의 가운데 좌표 계산
    int centerX = blueButton.Left + (blueButton.Width / 2);
    int centerY = blueButton.Top + (blueButton.Height / 2);
    Point clickPoint = new Point(centerX, centerY);
    
    // 가운데 좌표 클릭
    ClickOnScreen(clickPoint);
}

// 마우스 클릭을 위한 외부 함수 호출
[DllImport("user32.dll")]
static extern bool SetCursorPos(int X, int Y);

[DllImport("user32.dll")]
static extern void mouse_event(uint dwFlags, uint dx, uint dy, uint dwData, int dwExtraInfo);

private const int MOUSEEVENTF_LEFTDOWN = 0x02;
private const int MOUSEEVENTF_LEFTUP = 0x04;

private void ClickOnScreen(Point location)
{
    SetCursorPos(location.X, location.Y);
    mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, (uint)location.X, (uint)location.Y, 0, 0);
}
변경사항 요약
ClickOnBlueButton 함수 수정: blueButton의 중앙 좌표를 계산하여, clickPoint로 설정합니다.
centerX = blueButton.Left + (blueButton.Width / 2)
centerY = blueButton.Top + (blueButton.Height / 2)