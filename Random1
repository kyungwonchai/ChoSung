ì œëŠ” Streamlitì—ì„œ í‘œë¥¼ í•œ ì„¸íŠ¸ë‹¹ 3í–‰ìœ¼ë¡œ êµ¬ì„±í•˜ê³ , **ì´ 3ì„¸íŠ¸(BCT/TCT/ACT ì‹œë¦¬ì¦ˆ)**ë¥¼ ì¶œë ¥í•´ì•¼ í•©ë‹ˆë‹¤.

âœ… ìš”êµ¬ì‚¬í•­ ì •ë¦¬
ì‚¬ìš©ìê°€ ë¼ì¸(line1) ì„ íƒ ì‹œ,
ê° ì„¸íŠ¸ë¥¼ ë‹¤ìŒ ìˆœì„œë¡œ í‘œì‹œ (3í–‰ êµ¬ì„±):
BCT â†’ TCT â†’ ACT
BCT2 â†’ TCT2 â†’ ACT2
BCT2BEST â†’ TCT2BEST â†’ ACT2BEST
ê° ì„¸íŠ¸ë§ˆë‹¤ í‘œ í•˜ë‚˜ì”© (ì´ 3ê°œ í‘œ)
í‘œ ì œëª©: CT1, CT2, CT2Best
ì—´ í—¤ë”: MC1 ~ MC8
âœ… êµ¬í˜„ í™”ë©´ ì˜ˆì‹œ
csharp
ì½”ë“œ ë³µì‚¬
[CT1]
êµ¬ë¶„     MC1 ~ MC8  
---------------------
BCT1     ...
TCT1     ...
ACT1     ...

[CT2]
BCT2     ...
TCT2     ...
ACT2     ...

[CT2Best]
BCT2BEST ...
TCT2BEST ...
ACT2BEST ...
âœ… Streamlit ì „ì²´ ì½”ë“œ (í•œê¸€ ì„¤ëª… + ì˜ì–´ ì£¼ì„)
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql
import pandas as pd

# ğŸ“Œ MSSQL ì—°ê²° ì •ë³´
DB_CONFIG = {
    "server": "your_server",
    "user": "your_user",
    "password": "your_password",
    "database": "your_database"
}

# ğŸ“Œ ë¼ì¸ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” í•¨ìˆ˜
def get_lines():
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor()
    cursor.execute("SELECT DISTINCT line1 FROM ExcelData ORDER BY line1")
    lines = [row[0] for row in cursor.fetchall()]
    conn.close()
    return lines

# ğŸ“Œ ì„ íƒí•œ ë¼ì¸ì˜ ìµœì‹  ëª¨ë¸ 1ê°œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
def get_latest_data_by_line(line1):
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor(as_dict=True)
    
    cursor.execute("""
        SELECT TOP 1 * FROM ExcelData
        WHERE line1 = %s
        ORDER BY time1 DESC
    """, (line1,))
    data = cursor.fetchone()
    
    conn.close()
    return data

# ğŸ“Œ Streamlit UI ì‹œì‘
st.title("ë¼ì¸ë³„ CT ë°ì´í„° ì¡°íšŒ")

# ğŸ“Œ ì¢Œì¸¡ ë¼ì¸ ì„ íƒ
lines = get_lines()
selected_line = st.sidebar.selectbox("ë¼ì¸ ì„ íƒ", lines)

if selected_line:
    row = get_latest_data_by_line(selected_line)

    if row:
        # ğŸ“Œ ê³µí†µ í—¤ë” ì •ì˜
        headers = ["MC1", "MC2", "MC3", "MC4", "MC5", "MC6", "MC7", "MC8"]

        # ğŸ“Œ ì„¸íŠ¸ ìƒì„± í•¨ìˆ˜
        def make_ct_table(title, prefix_b, prefix_t, prefix_a):
            # Create data as list of rows: [BCT, TCT, ACT]
            data = [
                [row[f"{prefix_b}_{i}"] for i in range(1, 9)],
                [row[f"{prefix_t}_{i}"] for i in range(1, 9)],
                [row[f"{prefix_a}_{i}"] for i in range(1, 9)]
            ]
            df = pd.DataFrame(data, columns=headers)
            df.insert(0, "Category", [prefix_b, prefix_t, prefix_a])  # Add row labels
            st.subheader(title)
            st.table(df)

        # ğŸ“Œ CT1: BCT1, TCT1, ACT1
        make_ct_table("CT1", "BCT1", "TCT1", "ACT1")

        # ğŸ“Œ CT2: BCT2, TCT2, ACT2
        make_ct_table("CT2", "BCT2", "TCT2", "ACT2")

        # ğŸ“Œ CT2Best: BCT2BEST, TCT2BEST, ACT2BEST
        make_ct_table("CT2Best", "BCT2BEST", "TCT2BEST", "ACT2BEST")

    else:
        st.warning("ì„ íƒí•œ ë¼ì¸ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
âœ… ì‚¬ìš©ë²•
ìœ„ ì½”ë“œ ë³µì‚¬ í›„ app.py íŒŒì¼ì— ì €ì¥
ì•„ë˜ ëª…ë ¹ìœ¼ë¡œ ì‹¤í–‰
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql pandas
streamlit run app.py
ì›¹ì—ì„œ http://localhost:8501 ì ‘ì†
âœ… ê²°ê³¼
ë¼ì¸ ì„ íƒ ì‹œ â†’ ìµœì‹  1ê°œ ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ
3ê°œì˜ í‘œ (CT1, CT2, CT2Best)ê°€ 3í–‰(B/T/A)ìœ¼ë¡œ ê°ê° ì¶œë ¥ë¨