는 설명하신 대로 요일이 1(일요일)일 때 주간 패턴이 시작되며, 이전 패턴의 반대 패턴을 적용하여 10년 간 데이터를 생성하는 매크로입니다.

VBA 코드
vba
코드 복사
Sub GenerateShiftData()
    Dim ws As Worksheet
    Dim startDate As Date
    Dim endDate As Date
    Dim currentDate As Date
    Dim row As Long
    Dim currentPattern As String
    Dim isCAPattern As Boolean ' True이면 CA, False이면 AC
    Dim dayOfWeek As Integer
    Dim shiftName As String
    Dim i As Integer
    
    ' 초기화
    Set ws = ThisWorkbook.Sheets(1) ' 첫 번째 시트 사용
    ws.Cells.Clear ' 기존 데이터 삭제
    ws.Range("A1:D1").Value = Array("날짜", "요일", "조", "명칭") ' 헤더 설정
    
    ' 날짜 설정
    startDate = DateValue("2024-11-01")
    endDate = DateAdd("yyyy", 10, startDate)
    
    ' 초기 패턴 설정 (2024-11-03은 일요일, 첫 패턴은 CA로 시작)
    isCAPattern = True ' 첫 주는 CA 패턴 시작
    currentPattern = "CA"
    row = 2 ' 데이터 시작 행
    
    ' 데이터 생성
    For currentDate = startDate To endDate
        dayOfWeek = Weekday(currentDate, vbSunday) ' 요일 계산 (일요일: 1, 월요일: 2, ...)
        
        ' 매주 일요일에 패턴 변경
        If dayOfWeek = 1 Then
            If isCAPattern Then
                currentPattern = "AC" ' 이전 주가 CA면 이번 주는 AC
            Else
                currentPattern = "CA" ' 이전 주가 AC면 이번 주는 CA
            End If
            isCAPattern = Not isCAPattern ' 패턴 토글
        End If
        
        ' 현재 날짜의 조 데이터 생성
        For i = 1 To 2
            ws.Cells(row, 1).Value = Format(currentDate, "yyyy-MM-dd") ' 날짜
            ws.Cells(row, 2).Value = dayOfWeek ' 요일
            ws.Cells(row, 3).Value = i ' 조
            
            ' 명칭 설정
            If i = 1 Then
                shiftName = Left(currentPattern, 1) ' 첫 번째 문자 (1조)
            Else
                shiftName = Right(currentPattern, 1) ' 두 번째 문자 (2조)
            End If
            ws.Cells(row, 4).Value = shiftName ' 명칭
            row = row + 1
        Next i
    Next currentDate
    
    ' 완료 메시지
    MsgBox "10년 간의 데이터를 생성했습니다!", vbInformation
End Sub