 각 시트를 순회하면서 모든 행의 A, B, C 열의 구분 값과 D 열의 실제 측정값을 추출하여, 2행의 날짜와 3행의 시간을 조합하여 하나의 포맷으로 "전체data" 시트에 기록하는 VBA 매크로 코드입니다.

이 코드에서는 각 시트의 모든 데이터를 순회하면서 구역, 구분, 측정값 구분에 대한 정보를 가져와 "전체data" 시트에 누적 기록하는 방식입니다.

엑셀에서 ALT + F11을 눌러 VBA 편집기를 엽니다.
Insert > Module을 선택하여 새 모듈을 추가합니다.
아래 코드를 붙여넣고 실행합니다.
vba
코드 복사
Sub CollectDataToMasterSheet()
    Dim ws As Worksheet
    Dim masterSheet As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim dateValue As String
    Dim timeValue As String
    Dim regionValue As String
    Dim categoryValue As String
    Dim measureTypeValue As String
    Dim actualValue As Variant
    Dim formattedString As String

    ' "전체data" 시트를 찾거나 없으면 새로 만듦
    On Error Resume Next
    Set masterSheet = ThisWorkbook.Worksheets("전체data")
    On Error GoTo 0
    If masterSheet Is Nothing Then
        Set masterSheet = ThisWorkbook.Worksheets.Add
        masterSheet.Name = "전체data"
    End If
    
    ' "전체data" 시트 초기화
    masterSheet.Cells.Clear
    masterSheet.Cells(1, 1).Value = "날짜"
    masterSheet.Cells(1, 2).Value = "시간"
    masterSheet.Cells(1, 3).Value = "구역"
    masterSheet.Cells(1, 4).Value = "구분"
    masterSheet.Cells(1, 5).Value = "측정값구분"
    masterSheet.Cells(1, 6).Value = "실제값"
    masterSheet.Cells(1, 7).Value = "포맷결과"

    ' 모든 시트를 순회
    For Each ws In ThisWorkbook.Worksheets
        ' "전체data" 시트는 건너뜀
        If ws.Name <> "전체data" Then
            ' 2행의 날짜와 3행의 시간을 가져옴
            dateValue = ws.Cells(2, 1).Value ' 날짜 (2행)
            timeValue = ws.Cells(3, 1).Value ' 시간 (3행)

            ' 데이터가 있는 마지막 행 찾기
            lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row

            ' 4행부터 마지막 행까지 반복하여 A, B, C 열 값과 실제값(D열)을 가져옴
            For i = 4 To lastRow
                regionValue = ws.Cells(i, 1).Value ' 구역 (A 열)
                categoryValue = ws.Cells(i, 2).Value ' 구분 (B 열)
                measureTypeValue = ws.Cells(i, 3).Value ' 측정값구분 (C 열)
                actualValue = ws.Cells(i, 4).Value ' 실제값 (D 열)

                ' 각 정보를 포맷 형식으로 조합
                formattedString = dateValue & " " & timeValue & " - " & regionValue & " - " & categoryValue & " - " & measureTypeValue & " - " & actualValue
                
                ' "전체data" 시트의 마지막 행을 찾고 데이터를 추가
                Dim lastMasterRow As Long
                lastMasterRow = masterSheet.Cells(masterSheet.Rows.Count, 1).End(xlUp).Row + 1
                masterSheet.Cells(lastMasterRow, 1).Value = dateValue
                masterSheet.Cells(lastMasterRow, 2).Value = timeValue
                masterSheet.Cells(lastMasterRow, 3).Value = regionValue
                masterSheet.Cells(lastMasterRow, 4).Value = categoryValue
                masterSheet.Cells(lastMasterRow, 5).Value = measureTypeValue
                masterSheet.Cells(lastMasterRow, 6).Value = actualValue
                masterSheet.Cells(lastMasterRow, 7).Value = formattedString
            Next i
        End If
    Next ws
    
    MsgBox "모든 시트의 데이터를 '전체data' 시트에 추가했습니다.", vbInformation
End Sub