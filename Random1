WITH MaxDates AS (
    SELECT Line, MAX([N-Date]) AS MaxDate
    FROM YourTableName
    GROUP BY Line
)
SELECT 
    YourTableName.*,
    CASE 
        WHEN YourTableName.[N-Date] = MaxDates.MaxDate THEN 1
        ELSE 0
    END AS ddd
FROM 
    YourTableName
JOIN 
    MaxDates
ON 
    YourTableName.Line = MaxDates.Line;
