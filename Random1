using DevExpress.XtraEditors;
using System;
using System.Windows.Forms;

namespace DevExpressPermissionsExample
{
    public partial class MainForm : XtraForm
    {
        private string currentUser; // 현재 사용자 계정을 저장할 변수입니다.

        public MainForm(string username)
        {
            InitializeComponent();
            currentUser = username;
            CheckUserPermissions(); // 권한을 확인하고 해당 권한에 맞게 컨트롤을 설정합니다.
        }

        private void CheckUserPermissions()
        {
            // 권한 확인 로직을 구현합니다.
            bool hasButtonPermission = CheckButtonPermission();
            bool hasGridControlPermission = CheckGridControlPermission();

            // 버튼 권한 설정
            if (!hasButtonPermission)
            {
                // 권한이 없는 경우 버튼을 비활성화합니다.
                btnAction.Enabled = false;
            }

            // GridControl 권한 설정
            if (!hasGridControlPermission)
            {
                // 권한이 없는 경우 GridControl을 숨깁니다.
                gridControl1.Visible = false;
            }
        }

        private bool CheckButtonPermission()
        {
            // 버튼 권한을 확인하는 로직을 구현합니다.
            // 예시로 현재 사용자 계정이 "admin"인 경우에만 권한이 있는 것으로 가정합니다.
            return currentUser == "admin";
        }

        private bool CheckGridControlPermission()
        {
            // GridControl 권한을 확인하는 로직을 구현합니다.
            // 예시로 현재 사용자 계정이 "user"인 경우에만 권한이 있는 것으로 가정합니다.
            return currentUser == "user";
        }

        private void btnAction_Click(object sender, EventArgs e)
        {
            try
            {
                // 권한 확인
                if (!CheckButtonPermission())
                {
                    throw new Exception("권한이 없습니다.");
                }

                // 버튼 동작 코드
                // 권한이 있는 경우에만 실행됩니다.
                MessageBox.Show("버튼 동작 코드를 실행합니다.");
            }
            catch (Exception ex)
            {
                // 권한 오류 처리
                MessageBox.Show(ex.Message);
            }
        }
    }
}
