화 시나리오 전부 다, 주석은 프로시저 안에만, 밖에 설명 없이, 실제로 쓸 수 있는 전문가 코드로 정리해서 싹 다 준다. 설명은 없다. 코드만.

[PART 9] 텍스트 파일 입출력 (File I/O)
vba
코드 복사
Sub WriteToTextFile()
    Dim fso As Object, txt As Object
    Dim path As String
    path = ThisWorkbook.Path & "\log.txt"
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txt = fso.CreateTextFile(path, True)
    
    txt.WriteLine "로그 작성 시간: " & Now
    txt.WriteLine "처리 상태: 완료"
    txt.Close
End Sub
vba
코드 복사
Sub ReadFromTextFile()
    Dim fso As Object, txt As Object
    Dim path As String, lineData As String
    path = ThisWorkbook.Path & "\log.txt"
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txt = fso.OpenTextFile(path, 1)  ' 1 = ForReading
    
    Do Until txt.AtEndOfStream
        lineData = txt.ReadLine
        Debug.Print lineData
    Loop
    txt.Close
End Sub
vba
코드 복사
Sub AppendToTextFile()
    Dim fso As Object, txt As Object
    Dim path As String
    path = ThisWorkbook.Path & "\log.txt"
    
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txt = fso.OpenTextFile(path, 8, True)  ' 8 = ForAppending
    
    txt.WriteLine "추가 로그: " & Now
    txt.Close
End Sub
[PART 10] 실무 자동화 시나리오 (보고서 자동화)
vba
코드 복사
Sub GenerateDailyReport()
    Dim ws As Worksheet, lastRow As Long
    Set ws = Sheets("데이터")
    
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    Sheets.Add(After:=Sheets(Sheets.Count)).Name = "보고서_" & Format(Date, "yyyymmdd")
    With ActiveSheet
        .Cells(1, 1).Value = "일자"
        .Cells(1, 2).Value = "항목"
        .Cells(1, 3).Value = "값"
        
        Dim i As Long, r As Long
        r = 2
        For i = 2 To lastRow
            If ws.Cells(i, 1).Value = Date Then
                .Cells(r, 1).Value = ws.Cells(i, 1).Value
                .Cells(r, 2).Value = ws.Cells(i, 2).Value
                .Cells(r, 3).Value = ws.Cells(i, 3).Value
                r = r + 1
            End If
        Next i
    End With
End Sub
vba
코드 복사
Sub ExportReportToTextFile()
    Dim path As String, fso As Object, txt As Object
    Dim r As Long, line As String
    
    path = ThisWorkbook.Path & "\DailyReport_" & Format(Date, "yyyymmdd") & ".txt"
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set txt = fso.CreateTextFile(path, True)
    
    With Sheets("보고서_" & Format(Date, "yyyymmdd"))
        r = 2
        Do While .Cells(r, 1).Value <> ""
            line = .Cells(r, 1).Text & vbTab & .Cells(r, 2).Text & vbTab & .Cells(r, 3).Text
            txt.WriteLine line
            r = r + 1
        Loop
    End With
    txt.Close
End Sub
vba
코드 복사
Sub SendMailWithReport()
    Dim olApp As Object, olMail As Object
    Dim path As String
    path = ThisWorkbook.Path & "\DailyReport_" & Format(Date, "yyyymmdd") & ".txt"
    
    Set olApp = CreateObject("Outlook.Application")
    Set olMail = olApp.CreateItem(0)
    
    With olMail
        .To = "someone@example.com"
        .Subject = "일일 보고서 - " & Format(Date, "yyyy-mm-dd")
        .Body = "첨부된 보고서를 확인해주세요."
        .Attachments.Add path
        .Send
    End With
End Sub
끝이다.
이제 너한테 필요한 건 다 들어있다:

파일 생성

파일 읽기

로그 추가

보고서 생성

보고서 텍스트 출력

이메일 발송
