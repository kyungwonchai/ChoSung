VBA 코드 예제입니다. 이 코드는 임시1시트의 2, 3행을 복사하여 새로운 임시2시트를 만들고, 3열부터 U열까지 3칸씩 이동하며 조건을 검사하여 임시2시트로 누적 복사합니다. B열의 값이 있는 행까지만 순환합니다.

vba
Copy code
Sub CopyDataToTempSheet()
    Dim wsTemp1 As Worksheet
    Dim wsTemp2 As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim j As Integer
    
    ' 임시1시트와 임시2시트 지정
    Set wsTemp1 = ThisWorkbook.Sheets("임시1시트")
    On Error Resume Next
    Set wsTemp2 = ThisWorkbook.Sheets("임시2시트")
    On Error GoTo 0
    
    ' 임시2시트가 이미 존재하면 삭제
    If Not wsTemp2 Is Nothing Then
        Application.DisplayAlerts = False
        wsTemp2.Delete
        Application.DisplayAlerts = True
    End If
    
    ' 새로운 임시2시트 생성
    Set wsTemp2 = ThisWorkbook.Sheets.Add
    wsTemp2.Name = "임시2시트"
    
    ' 임시1시트의 마지막 행 확인 (B열 기준)
    lastRow = wsTemp1.Cells(wsTemp1.Rows.Count, "B").End(xlUp).Row
    
    ' B열이 있는 행까지 순환
    For i = 2 To lastRow ' 2행부터 시작 (1행은 헤더)
        ' 현재 컬럼이 "S"로 시작하고 다음 컬럼의 값이 0보다 큰지 확인
        For j = 3 To 19 Step 3 ' 3열부터 U열까지 3칸씩 이동
            If Left(wsTemp1.Cells(i, j).Value, 1) = "S" And wsTemp1.Cells(i, j + 1).Value > 0 Then
                ' 조건을 만족하는 경우 해당 셀 2개를 임시2시트로 복사
                wsTemp1.Range(wsTemp1.Cells(i, j), wsTemp1.Cells(i, j + 1)).Copy Destination:=wsTemp2.Cells(wsTemp2.Cells(wsTemp2.Rows.Count, "A").End(xlUp).Row + 1, 1)
            End If
        Next j
    Next i
End Sub
이 코드는 엑셀 VBA를 사용하여 요구사항대로 작업을 수행합니다. 코드를 실행하면 임시1시트에서 데이터를 복사하여 임시2시트로 옮기고, 조건을 만족하는 데이터만 누적해서 복사합니다. 코드를 실행하려면 엑셀에서 VBA 편집기를 열고 모듈에 코드를 붙여넣고 실행하면 됩니다.





