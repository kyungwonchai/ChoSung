using System;
using System.IO;
using System.Windows.Forms;
using DevExpress.Export;
using DevExpress.XtraGrid;
using DevExpress.XtraPrinting;

namespace WinFormApp
{
    public partial class MainForm : Form
    {
        private GridControl gridControl;
        private RichTextBox richTextBox;

        public MainForm()
        {
            InitializeComponent();
        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            // GridControl 초기화 및 데이터 바인딩
            gridControl = new GridControl();
            // 데이터를 GridControl에 바인딩하는 코드 작성

            // RichTextBox 초기화
            richTextBox = new RichTextBox();

            // 폼에 컨트롤 추가
            Controls.Add(gridControl);
            Controls.Add(richTextBox);
        }

        private void ExportGridDataToExcel()
        {
            // ExportOptions 초기화
            var exportOptions = new XlsxExportOptionsEx();

            // 엑셀로 내보내기
            using (var stream = new MemoryStream())
            {
                gridControl.ExportToXlsx(stream, exportOptions);
                stream.Seek(0, SeekOrigin.Begin);

                // 엑셀 파일을 RichTextBox에 붙여넣기
                richTextBox.Clear();
                richTextBox.LoadFile(stream, RichTextBoxStreamType.RichText);
            }
        }

        private void ExportButton_Click(object sender, EventArgs e)
        {
            ExportGridDataToExcel();
        }
    }
}
