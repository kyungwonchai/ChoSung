using DevExpress.XtraBars;
using DevExpress.XtraBars.Ribbon;
using DevExpress.XtraEditors;
using DevExpress.XtraGrid.Columns;
using DevExpress.XtraGrid.Views.Grid;
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;

private GridControl gridControl1; // 그리드 컨트롤
private GridView gridView1; // 그리드 뷰

private void SearchControl1_TextChanged(object sender, EventArgs e)
{
    string searchText = SearchControl1.Text.ToLower();

    if (isSearchBarFocused)
    {
        // 필터링된 아이템을 수집합니다.
        List<BarItem> filteredItems = new List<BarItem>();

        foreach (RibbonPage page in ribbonControl1.Pages)
        {
            foreach (RibbonPageGroup group in page.Groups)
            {
                foreach (BarItemLink itemLink in group.ItemLinks)
                {
                    BarItem item = itemLink.Item;
                    if (item != null && item.Caption.ToLower().Contains(searchText))
                    {
                        filteredItems.Add(item);
                    }
                }
            }
        }

        // 그리드 컨트롤이 존재하는 경우 기존 컨트롤 제거
        if (gridControl1 != null)
        {
            this.Controls.Remove(gridControl1);
            gridControl1.Dispose();
        }

        // 필터링된 아이템이 있는 경우에만 그리드 컨트롤을 생성하여 아이템 목록을 표시합니다.
        if (filteredItems.Count > 0)
        {
            // 그리드 컨트롤 생성
            gridControl1 = new GridControl();
            gridControl1.Width = SearchControl1.Width;
            gridControl1.Location = new Point(SearchControl1.Left, SearchControl1.Bottom + 5);

            // 그리드 뷰 생성
            gridView1 = new GridView(gridControl1);
            gridControl1.MainView = gridView1;
            gridControl1.ViewCollection.Add(gridView1);

            // 아이템 목록을 그리드에 바인딩합니다.
            gridControl1.DataSource = filteredItems;
            gridView1.Columns.Clear();

            // 아이콘 컬럼 추가
            GridColumn iconColumn = new GridColumn();
            iconColumn.Caption = "아이콘";
            iconColumn.FieldName = "LargeGlyph";
            iconColumn.ImageOptions.ImageLayout = DevExpress.Utils.Drawing.ImageLayoutMode.Zoom;
            iconColumn.Visible = true;
            gridView1.Columns.Add(iconColumn);

            // 제목 컬럼 추가
            GridColumn captionColumn = new GridColumn();
            captionColumn.Caption = "제목";
            captionColumn.FieldName = "Caption";
            captionColumn.Visible = true;
            gridView1.Columns.Add(captionColumn);

            // 그리드 컨트롤을 Form에 추가합니다.
            this.Controls.Add(gridControl1);
        }
    }
}
