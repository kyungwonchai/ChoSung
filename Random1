using Excel = Microsoft.Office.Interop.Excel;
using System.Data;

// 엑셀 파일 경로
string filePath = "경로\\파일이름.xlsx";

// Excel Application 인스턴스 생성
Excel.Application excelApp = new Excel.Application();

// Workbook 열기
Excel.Workbook workbook = excelApp.Workbooks.Open(filePath);

// 마스터 시트 읽기
Excel.Worksheet masterSheet = workbook.Sheets["마스터 시트명"];
Excel.Range masterRange = masterSheet.Cells[1, 1].CurrentRegion;
DataTable masterTB = new DataTable();

// 마스터 시트의 데이터를 데이터 테이블로 변환
for (int row = 1; row <= masterRange.Rows.Count; row++)
{
    if (masterRange.Cells[row, 2].Value2 != null && masterRange.Cells[row, 2].Value2.ToString().Length >= 2)
    {
        DataRow dataRow = masterTB.NewRow();
        for (int col = 1; col <= masterRange.Columns.Count; col++)
        {
            object value = masterRange.Cells[row, col].Value2;
            dataRow[col] = value != null ? value.ToString() : string.Empty;
        }
        masterTB.Rows.Add(dataRow);
    }
}

// 불출 시트 읽기
Excel.Worksheet bulSheet = workbook.Sheets["불출 시트명"];
Excel.Range bulRange = bulSheet.Cells[1, 1].CurrentRegion;
DataTable bulTB = new DataTable();

// 불출 시트의 데이터를 데이터 테이블로 변환
for (int row = 1; row <= bulRange.Rows.Count; row++)
{
    if (bulRange.Cells[row, 2].Value2 != null && bulRange.Cells[row, 2].Value2.ToString().Length >= 2)
    {
        DataRow dataRow = bulTB.NewRow();
        for (int col = 1; col <= bulRange.Columns.Count; col++)
        {
            object value = bulRange.Cells[row, col].Value2;
            dataRow[col] = value != null ? value.ToString() : string.Empty;
        }
        bulTB.Rows.Add(dataRow);
    }
}

// Excel 파일과 관련된 리소스 해제
workbook.Close();
excelApp.Quit();
System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);
System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);

// 사용이 완료된 COM 개체를 제거
GC.Collect();
