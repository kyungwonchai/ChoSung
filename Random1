public void OpenSerialPort(string portName)
{
    // 기존 시리얼 포트가 열려 있는지 확인하고 닫음
    if (_serialPort != null && _serialPort.IsOpen)
    {
        try
        {
            _serialPort.Close();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"기존 시리얼 포트를 닫는 중 오류 발생: {ex.Message}");
        }
    }

    // 새 시리얼 포트를 설정하고 열기
    _serialPort = new SerialPort(portName, 9600);

    try
    {
        _serialPort.Open();
        Console.WriteLine("시리얼 포트가 열렸습니다.");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"시리얼 포트를 여는 중 오류 발생: {ex.Message}");
    }
}
