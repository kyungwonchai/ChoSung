nForms 애플리케이션에서 트레이 아이콘을 사용하여 창을 닫거나 최소화할 때 시스템 트레이로 숨기고, 트레이 아이콘을 더블 클릭하면 다시 창을 표시하며, 종료는 트레이 아이콘의 우클릭 메뉴에서 처리하는 방법을 단계별로 설명하겠습니다.

1. NotifyIcon 추가
먼저 NotifyIcon을 추가하여 시스템 트레이에 아이콘을 표시합니다.

Visual Studio 디자이너에서 폼을 선택한 후, Toolbox에서 NotifyIcon을 찾아 폼에 드래그하여 추가합니다.
NotifyIcon의 속성에서 아이콘(Icon)을 지정해야 합니다. 예를 들어, 트레이에 표시될 아이콘을 설정하세요.
2. ContextMenuStrip 추가
트레이 아이콘을 우클릭했을 때 메뉴를 표시할 수 있도록 ContextMenuStrip을 추가합니다.

ContextMenuStrip을 추가하고, 종료 메뉴 항목을 만듭니다.
종료 메뉴 항목에 대한 이벤트 핸들러를 작성하여 프로그램 종료 기능을 구현합니다.
csharp
코드 복사
// 종료 버튼 클릭 이벤트 처리
private void 종료ToolStripMenuItem_Click(object sender, EventArgs e)
{
    Application.Exit(); // 애플리케이션 종료
}
3. 폼 이벤트 처리 (최소화 및 창 닫기 시 동작)
폼이 최소화되거나 닫힐 때, 시스템 트레이로 숨기고 트레이 아이콘 더블 클릭 시 폼을 다시 표시하도록 이벤트를 처리합니다.

3.1. 폼이 최소화될 때 트레이로 이동
csharp
코드 복사
// 폼이 최소화될 때 트레이로 이동
private void Form1_Resize(object sender, EventArgs e)
{
    if (this.WindowState == FormWindowState.Minimized)
    {
        this.Hide(); // 폼 숨기기
        notifyIcon1.Visible = true; // 트레이 아이콘 보이기
    }
}
3.2. 폼 닫기 시 트레이로 이동
csharp
코드 복사
// 폼 닫기 시 트레이로 이동
private void Form1_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = true; // 닫기 취소
    this.Hide(); // 폼 숨기기
    notifyIcon1.Visible = true; // 트레이 아이콘 보이기
}
4. 트레이 아이콘 더블 클릭 시 폼 표시
NotifyIcon을 더블 클릭하면 폼을 다시 화면에 표시하도록 설정합니다.

csharp
코드 복사
// 트레이 아이콘 더블 클릭 시 폼 표시
private void notifyIcon1_DoubleClick(object sender, EventArgs e)
{
    this.Show(); // 폼 다시 표시
    this.WindowState = FormWindowState.Normal; // 최소화 상태 해제
    notifyIcon1.Visible = false; // 트레이 아이콘 숨기기
}
5. 종합 코드 예시
csharp
코드 복사
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        // 폼 이벤트 핸들러 설정
        this.Resize += Form1_Resize;
        this.FormClosing += Form1_FormClosing;

        // 트레이 아이콘 더블 클릭 이벤트 설정
        notifyIcon1.DoubleClick += notifyIcon1_DoubleClick;

        // 트레이 아이콘의 컨텍스트 메뉴 설정
        ContextMenuStrip contextMenu = new ContextMenuStrip();
        ToolStripMenuItem exitMenuItem = new ToolStripMenuItem("종료", null, 종료ToolStripMenuItem_Click);
        contextMenu.Items.Add(exitMenuItem);
        notifyIcon1.ContextMenuStrip = contextMenu;
    }

    // 종료 버튼 클릭 이벤트 처리
    private void 종료ToolStripMenuItem_Click(object sender, EventArgs e)
    {
        Application.Exit(); // 애플리케이션 종료
    }

    // 폼이 최소화될 때 트레이로 이동
    private void Form1_Resize(object sender, EventArgs e)
    {
        if (this.WindowState == FormWindowState.Minimized)
        {
            this.Hide(); // 폼 숨기기
            notifyIcon1.Visible = true; // 트레이 아이콘 보이기
        }
    }

    // 폼 닫기 시 트레이로 이동
    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        e.Cancel = true; // 닫기 취소
        this.Hide(); // 폼 숨기기
        notifyIcon1.Visible = true; // 트레이 아이콘 보이기
    }

    // 트레이 아이콘 더블 클릭 시 폼 표시
    private void notifyIcon1_DoubleClick(object sender, EventArgs e)
    {
        this.Show(); // 폼 다시 표시
        this.WindowState = FormWindowState.Normal; // 최소화 상태 해제
        notifyIcon1.Visible = false; // 트레이 아이콘 숨기기
    }
}
주요 사항 요약:
NotifyIcon: 시스템 트레이 아이콘을 추가하여 보이게 함.
ContextMenuStrip: 트레이 아이콘 우클릭 메뉴를 설정하여 종료 기능 추가.
폼 최소화 시 숨기기: 폼이 최소화될 때 시스템 트레이로 이동.
폼 닫기 시 숨기기: 폼이 닫힐 때 시스템 트레이로 이동.