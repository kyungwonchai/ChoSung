treamlit Code (MSSQL2014 데이터 조회 및 최대값 강조)
아래 코드는 rankeddata 테이블에서 Get_min_bestdifferent 프로시저를 호출하여 데이터를 가져오고, 각 행의 act2_1 ~ act2_8 값 중 가장 큰 값을 노란색으로 강조하여 표시하는 코드입니다.

python
코드 복사
import streamlit as st
import pandas as pd
import pymssql

# MSSQL 서버 연결 설정 함수
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent 프로시저 호출 함수
def fetch_main_data():
    conn = get_connection()
    query = "EXEC Get_min_bestdifferent"
    df = pd.read_sql(query, conn)
    conn.close()
    return df

# 테이블에서 최대값을 노란색으로 강조하는 함수
def highlight_max(row):
    max_value = row.max()
    return ['background-color: yellow' if v == max_value else '' for v in row]

# Streamlit 앱 구성
def main():
    st.set_page_config(layout="wide")
    st.title("Ranked Data Table - act2_1 ~ act2_8 Highlighting")

    # 데이터 가져오기
    main_data = fetch_main_data()
    
    # 필요한 컬럼 필터링
    act2_columns = [f'act2_{i}' for i in range(1, 9)]
    display_data = main_data[['group1', 'line1', 'model1', 'type1', 'ecn1', 'edition1'] + act2_columns]
    
    st.subheader("act2_1 ~ act2_8 데이터 테이블")
    
    # act2 부분을 색상 강조 (각 행마다 최대값을 노란색으로 표시)
    styled_data = display_data.style.apply(highlight_max, subset=act2_columns, axis=1)
    
    # HTML로 변환하여 표시
    st.write(styled_data.to_html(), unsafe_allow_html=True)

if __name__ == "__main__":
    main()
📌 코드 설명
MSSQL 연결 설정 (get_connection())

pymssql 라이브러리를 사용하여 MSSQL 서버에 연결합니다.

서버 정보 (YOUR_SERVER, YOUR_USER, YOUR_PASSWORD, YOUR_DATABASE)는 사용자가 사용하는 값으로 변경하세요.

데이터 조회 (fetch_main_data())

Get_min_bestdifferent 프로시저를 호출하여 데이터를 가져옵니다.

pandas.read_sql()을 사용하여 DataFrame 형식으로 변환합니다.

최대값 강조 (highlight_max())

행별로 act2_1 ~ act2_8 값 중 최대값을 찾아 해당 셀에 노란색 배경을 지정합니다.

Streamlit 앱 구성 (main())

Streamlit을 사용하여 웹 UI를 구성합니다.

st.write()로 스타일링된 DataFrame을 HTML로 출력합니다.

📌 설치 필요 라이브러리
bash
코드 복사
pip install streamlit pandas pymssql
📌 Streamlit 실행 방법
bash
코드 복사
streamlit run your_script_name.py
💡 결과 화면 설명
각 행마다 act2_1 ~ act2_8 값 중 최대값이 노란색으로 강조됩니다.

표시되는 컬럼: group1, line1, model1, type1, ecn1, edition1, act2_1 ~ act2_8