값이 컬럼 헤더로 나오는 이유는 fetch_main_data() 함수에서 데이터를 반환할 때, 테이블 구조를 제대로 잡아주지 않았기 때문입니다. 데이터베이스로부터 가져온 데이터와 컬럼 이름을 분리하여 올바르게 출력하도록 수정하겠습니다.

✅ 수정된 코드 (Cursor 방식)
python
코드 복사
import streamlit as st
import pymssql

# MSSQL 서버 연결 설정 함수
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent 프로시저 호출 함수 (cursor.fetchall() 방식)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    
    # 컬럼 이름을 먼저 가져오기
    columns = [desc[0] for desc in cursor.description]  
    
    # 데이터 가져오기
    rows = cursor.fetchall()
    conn.close()
    
    return rows, columns

# 테이블에서 최대값을 노란색으로 강조하는 HTML 스타일 함수
def generate_html_table(data, columns):
    html = "<table border='1' style='width:100%; border-collapse: collapse;'>"
    html += "<thead><tr>"
    for col in columns:
        html += f"<th>{col}</th>"
    html += "</tr></thead><tbody>"

    act2_columns = [f'act2_{i}' for i in range(1, 9)]

    # 데이터 렌더링
    for row in data:
        html += "<tr>"
        # act2_1 ~ act2_8 값 중 최대값 찾기
        act2_values = {col: row[idx] for idx, col in enumerate(columns) if col in act2_columns}
        max_value = max(act2_values.values())
        
        for idx, value in enumerate(row):
            column_name = columns[idx]
            if column_name in act2_columns and value == max_value:
                html += f"<td style='background-color: yellow;'>{value}</td>"
            else:
                html += f"<td>{value}</td>"
        html += "</tr>"

    html += "</tbody></table>"
    return html

# Streamlit 앱 구성
def main():
    st.set_page_config(layout="wide")
    st.title("Ranked Data Table - act2_1 ~ act2_8 Highlighting (Cursor 방식)")

    # 데이터 가져오기
    data, columns = fetch_main_data()
    
    st.subheader("act2_1 ~ act2_8 데이터 테이블")
    
    # HTML 테이블 생성 및 표시
    html_table = generate_html_table(data, columns)
    st.markdown(html_table, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
📌 코드 수정 내용
fetch_main_data() 함수 수정

cursor.fetchall()로 데이터 가져오기.

cursor.description을 사용하여 컬럼 이름 목록을 가져오기.

데이터를 rows로 반환하고, 컬럼 이름을 columns로 반환.

generate_html_table() 함수 수정

데이터 (data)는 이제 리스트의 리스트 형태로 반환됩니다.

컬럼 이름을 기준으로 테이블을 생성하고 HTML로 표시합니다.

act2_1 ~ act2_8 값 중 최대값을 노란색으로 강조합니다.

📌 설치 필요 라이브러리
bash
코드 복사
pip install streamlit pymssql
📌 Streamlit 실행 방법
bash
코드 복사
streamlit run your_script_name.py
💡 결과 화면 설명
데이터는 rows로 가져오며, 열 이름은 columns로 처리합니다.

각 행마다 act2_1 ~ act2_8 값 중 최대값을 노란색으로 강조합니다.

데이터가 HTML 표로 올바르게 표시됩니다.