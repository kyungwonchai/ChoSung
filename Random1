래는 엑셀 VBA 코드입니다.
5행부터 전체 사용되는 영역에서 S열 값이 존재하면서 J열 값이 "TOTAL"이 아닌 행들을 삭제하는 매크로입니다.

VBA 코드
vba
코드 복사
Sub DeleteRowsBasedOnSAndJ()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long

    ' 현재 활성화된 워크시트 설정
    Set ws = ActiveSheet
    
    ' 마지막 행 찾기 (S열 기준으로 찾음)
    lastRow = ws.Cells(ws.Rows.Count, "S").End(xlUp).Row

    ' 아래에서 위로 반복하면서 조건에 맞는 행 삭제
    For i = lastRow To 5 Step -1
        If ws.Cells(i, "S").Value <> "" And ws.Cells(i, "J").Value <> "TOTAL" Then
            ws.Rows(i).Delete
        End If
    Next i

    MsgBox "필터링된 행이 삭제되었습니다.", vbInformation
End Sub
설명
lastRow 찾기:

S열에서 마지막 데이터가 있는 행을 찾아서 lastRow에 저장.
행 삭제 로직:

For i = lastRow To 5 Step -1:
마지막 행부터 5행까지 역순으로 검사하여 조건에 맞으면 삭제.
If ws.Cells(i, "S").Value <> "" And ws.Cells(i, "J").Value <> "TOTAL" Then:
S열 값이 있고, J열 값이 "TOTAL"이 아닌 경우 해당 행 삭제.
삭제 후 메시지 출력:

실행 완료 후 "필터링된 행이 삭제되었습니다." 메시지 표시.
사용 방법
ALT + F11을 눌러 VBA 편집기를 엽니다.
삽입 > 모듈을 선택하여 새 모듈을 추가합니다.
위 코드를 복사하여 붙여넣습니다.