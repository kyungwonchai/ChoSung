using System;
using System.IO;
using System.Windows;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Presentation;
using System.Linq;
using System.Xml.Linq;
using MessageBox = System.Windows.MessageBox;

namespace PowerPointToImage
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void ConvertToSVG_Click(object sender, RoutedEventArgs e)
        {
            string pptxFilePath = "your_pptx_file_path.pptx";

            try
            {
                using (PresentationDocument presentationDocument = PresentationDocument.Open(pptxFilePath, false))
                {
                    PresentationPart presentationPart = presentationDocument.PresentationPart;
                    Presentation presentation = presentationPart.Presentation;
                    SlideIdList slideIdList = presentation.SlideIdList;

                    int slideIndex = 1;
                    foreach (SlideId slideId in slideIdList.ChildElements.OfType<SlideId>())
                    {
                        SlidePart slidePart = (SlidePart)presentationPart.GetPartById(slideId.RelationshipId);

                        string svgFilePath = $"Slide{slideIndex}.svg";
                        using (FileStream svgFileStream = new FileStream(svgFilePath, FileMode.Create))
                        {
                            slidePart.Slide.Export(svgFileStream, new SvgOptions());
                        }

                        // TODO: SVG 파일을 원하는 방식으로 처리

                        File.Delete(svgFilePath);
                        slideIndex++;
                    }

                    MessageBox.Show("Conversion completed. SVG files are processed.");
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("An error occurred during conversion: " + ex.Message);
            }
        }
    }
}
