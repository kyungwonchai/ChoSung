C#에서 특정 작업이 실행될 때 화면 보호기가 동작하지 않도록 마우스를 주기적으로 이동시키는 방법입니다.

✅ 핵심 기능
SetCursorPos(x, y)를 사용하여 마우스를 주기적으로 이동.
System.Windows.Forms.Cursor.Position으로 현재 위치를 가져와 조금씩 움직이게 설정.
비동기 작업을 실행하는 동안 마우스 이동을 반복.
✅ C# 비동기 타이머 + 마우스 이동 예제
csharp
코드 복사
using System;
using System.Runtime.InteropServices;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms; // WinForms 사용 필요 (콘솔에서 사용 가능)

class Program
{
    private static Timer? _timer;
    private static bool _isRunning = false;
    private static readonly object _lock = new object();
    private static CancellationTokenSource? _cts;

    [DllImport("user32.dll")]
    static extern bool SetCursorPos(int X, int Y);

    static async Task Main()
    {
        Console.WriteLine("Timer 시작...");
        StartTimer();

        // 프로그램 유지 (Ctrl + C로 종료)
        await Task.Delay(Timeout.Infinite);
    }

    private static void StartTimer()
    {
        _timer = new Timer(async _ => await CheckAndRunTask(), null, 0, 600000); // 10분마다 실행
    }

    private static async Task CheckAndRunTask()
    {
        lock (_lock)
        {
            if (_isRunning)
            {
                Console.WriteLine($"{DateTime.Now:HH:mm:ss} - 이전 실행이 끝나지 않음, 대기...");
                return;
            }
            _isRunning = true;
        }

        _cts = new CancellationTokenSource();
        var token = _cts.Token;

        Task mouseMoveTask = PreventScreensaver(token); // 마우스 이동 실행
        Task workTask = RunTaskAsync(); // 실제 작업 실행

        await workTask; // 작업이 끝날 때까지 대기
        _cts.Cancel(); // 마우스 이동 작업 중단
        await mouseMoveTask; // 마우스 이동 작업 종료

        Console.WriteLine($"{DateTime.Now:HH:mm:ss} - 작업 완료");
        _isRunning = false;
    }

    private static async Task RunTaskAsync()
    {
        Console.WriteLine($"{DateTime.Now:HH:mm:ss} - 작업 시작");
        await Task.Delay(20000); // 20초 동안 실행되는 작업 (예제)
    }

    private static async Task PreventScreensaver(CancellationToken token)
    {
        Console.WriteLine("화면 보호기 방지를 위한 마우스 이동 시작...");
        int step = 5; // 마우스를 움직이는 거리

        while (!token.IsCancellationRequested)
        {
            var pos = Cursor.Position;
            SetCursorPos(pos.X + step, pos.Y); // 오른쪽으로 이동
            await Task.Delay(5000, token); // 5초마다 이동

            SetCursorPos(pos.X, pos.Y); // 원래 위치로 복귀
            await Task.Delay(5000, token); // 5초마다 복귀
        }

        Console.WriteLine("화면 보호기 방지 중지.");
    }
}
✅ 설명
10분마다 RunTaskAsync() 실행.
이전 실행이 끝나지 않으면 건너뜀.
작업 실행 중 PreventScreensaver() 실행 → 5초마다 마우스 살짝 이동.
작업이 끝나면 마우스 이동 작업 중단 (_cts.Cancel()).
✅ 마우스 이동 예제
마우스를 5픽셀 오른쪽으로 이동 → 5초 후 원위치 복귀.
10분마다 실행되는 작업이 끝날 때까지 반복.
✅ 실행 결과
makefile
코드 복사
Timer 시작...
10:00:00 - 작업 시작
화면 보호기 방지를 위한 마우스 이동 시작...
10:00:20 - 작업 완료
화면 보호기 방지 중지.
10:10:00 - 작업 시작
화면 보호기 방지를 위한 마우스 이동 시작...
10:10:20 - 작업 완료
화면 보호기 방지 중지.
✅ 특징