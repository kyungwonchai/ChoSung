알겠습니다. 상황을 다시 정리해 보겠습니다. 많이 답답하셨을 텐데, 이번에는 kwkw 계정으로 처음부터 끝까지 확실하게 설정할 수 있도록 차근차근 안내해 드리겠습니다.

핵심 목표:

kwkw 계정으로 주피터 노트북을 설치하고 실행합니다.

외부에서 접속할 수 있도록 비밀번호와 IP 설정을 합니다.

서버를 껐다 켜도 항상 실행되도록 서비스로 등록합니다.

--allow-root 같은 위험한 옵션 없이, 가장 안전하고 표준적인 방법으로 설정합니다.

1단계: kwkw 계정으로 모든 작업 준비하기
가장 중요합니다. 지금부터 모든 명령어는 kwkw 계정으로 로그인한 터미널에서 실행해야 합니다. sudo가 필요한 명령어는 제가 따로 표시해 드리겠습니다.

kwkw 계정으로 로그인

Bash

su - kwkw
# 또는 ssh kwkw@서버주소 로 접속
필수 패키지 설치 (이미 설치했다면 넘어가도 됩니다)
이 명령어는 sudo가 필요합니다.

Bash

sudo apt update
sudo apt install python3-pip python3-venv -y
2단계: kwkw 계정 전용 파이썬 가상 환경 만들기
kwkw 계정의 홈 디렉토리에 주피터 노트북만을 위한 독립된 파이썬 환경을 만듭니다. 이렇게 해야 다른 파이썬 프로그램과 충돌이 없습니다.

가상 환경 생성

Bash

# /home/kwkw/ 디렉토리 안에 jupyter_env 라는 가상 환경 생성
python3 -m venv /home/kwkw/jupyter_env
가상 환경 활성화

Bash

source /home/kwkw/jupyter_env/bin/activate
이제 터미널 맨 앞에 (jupyter_env) 라고 표시되어야 합니다. 앞으로 모든 설치와 실행은 이 활성화된 환경 안에서 진행됩니다.

3단계: 주피터 노트북 설치 및 설정
주피터 노트북 설치
(jupyter_env)가 활성화된 상태에서 아래 명령어를 실행합니다.

Bash

pip install --upgrade pip
pip install notebook
설정 파일 생성

Bash

jupyter notebook --generate-config
실행하면 /home/kwkw/.jupyter/jupyter_notebook_config.py 파일이 생성됩니다.

비밀번호 설정
외부에서 접속할 비밀번호를 설정합니다. 명령어를 실행하고 비밀번호를 두 번 입력하세요.

Bash

jupyter notebook password
작업 폴더 생성
kwkw 사용자의 홈에 노트북 파일들을 저장할 폴더를 만듭니다.

Bash

mkdir /home/kwkw/notebooks
설정 파일 수정 (가장 중요한 부분!)
nano 편집기로 설정 파일을 엽니다.

Bash

nano /home/kwkw/.jupyter/jupyter_notebook_config.py
파일의 맨 위에 아래 내용을 그대로 복사해서 붙여넣으세요. 기존 내용을 찾아서 수정할 필요 없이, 그냥 맨 위에 추가하면 됩니다.

Python

# --- Jupyter Notebook Server 설정 (파일 맨 위에 추가) ---
c.ServerApp.ip = '0.0.0.0'
c.ServerApp.open_browser = False
c.ServerApp.port = 8888
c.ServerApp.root_dir = '/home/kwkw/notebooks'
# ---------------------------------------------------------
수정이 끝났으면 Ctrl+X -> Y -> Enter 키를 눌러 저장하고 나옵니다.

4단계: Systemd 서비스로 등록하기
이제 kwkw 계정의 주피터 노트북을 시스템 서비스로 등록하여, 서버가 재부팅되어도 자동으로 실행되게 만듭니다.

서비스 파일 생성 (sudo 필요)
jupyter-kwkw.service 라는 이름으로 서비스 파일을 만듭니다.

Bash

sudo nano /etc/systemd/system/jupyter-kwkw.service
서비스 내용 작성
열린 파일에 아래 내용을 정확하게 복사해서 붙여넣습니다. ExecStart의 경로는 kwkw 계정의 홈 디렉토리와 가상 환경 이름에 맞게 이미 수정되어 있습니다.

Ini, TOML

[Unit]
Description=Jupyter Notebook for kwkw
After=network.target

[Service]
Type=simple
User=kwkw
Group=kwkw
ExecStart=/home/kwkw/jupyter_env/bin/jupyter notebook
WorkingDirectory=/home/kwkw/notebooks
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
Ctrl+X -> Y -> Enter 키를 눌러 저장하고 나옵니다.

5단계: 서비스 실행 및 최종 확인
서비스 활성화 및 시작 (sudo 필요)

Bash

sudo systemctl daemon-reload
sudo systemctl enable jupyter-kwkw.service
sudo systemctl start jupyter-kwkw.service
서비스 상태 확인 (sudo 필요)

Bash

sudo systemctl status jupyter-kwkw.service
active (running) 이라는 녹색 글자가 보이면 성공입니다. (q를 눌러 빠져나올 수 있습니다.)

방화벽 설정 (sudo 필요)
방화벽이 켜져 있다면 8888번 포트를 열어줍니다.

Bash

sudo ufw allow 8888/tcp
외부에서 접속
이제 다른 PC의 웹 브라우저에서 http://<서버_IP주소>:8888 로 접속하세요. 3단계에서 설정한 비밀번호를 입력하면 kwkw 계정의 /home/kwkw/notebooks 폴더를 보실 수 있습니다.

이제 --allow-root 같은 위험한 옵션 없이, kwkw 사용자 권한으로 안전하게 주피터 노트북 서비스가 항상 실행될 것입니다.

