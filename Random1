using Ghostscript.NET.Rasterizer;
using Ghostscript.NET;
using System.Drawing.Imaging;
using System.IO;

namespace PDFToImageConverter
{
    class Program
    {
        static void Main(string[] args)
        {
            string pdfFilePath = "your_pdf_file_path.pdf";
            string outputFolder = "output_folder_path";
            int desired_dpi = 96;

            using (var rasterizer = new GhostscriptRasterizer())
            {
                rasterizer.Open(pdfFilePath, GhostscriptVersionInfo.GetLastInstalledVersion(), false);
                for (int pageNumber = 1; pageNumber <= rasterizer.PageCount; pageNumber++)
                {
                    string outputFilePath = Path.Combine(outputFolder, $"Page{pageNumber}.jpg");

                    using (var img = rasterizer.GetPage(desired_dpi, pageNumber))
                    {
                        img.Save(outputFilePath, ImageFormat.Jpeg);
                    }
                }
                rasterizer.Close();
            }
        }
    }
}
