-- 감사 로그 테이블 생성
PRINT 'AuditLogs 테이블 생성 시작...';
CREATE TABLE AuditLogs (
    Id INT PRIMARY KEY IDENTITY(1,1),            -- 로그 고유 ID
    Timestamp DATETIME2 NOT NULL DEFAULT GETDATE(), -- 로그 기록 시간
    UserName NVARCHAR(100) NOT NULL,            -- 변경 수행 사용자 (관리자)
    Action NVARCHAR(50) NOT NULL,               -- 작업 종류 (예: Added, Modified, Deleted)
    TableName NVARCHAR(100) NOT NULL,           -- 변경된 테이블 이름
    RecordId NVARCHAR(100) NULL,               -- 변경된 레코드의 주 식별자 (Id 등, 문자열로 저장)
    AffectedColumns NVARCHAR(MAX) NULL,        -- 변경된 컬럼 목록 (Update 시, 콤마 구분 등)
    OldValues NVARCHAR(MAX) NULL,              -- 변경 전 값 (JSON, XML 등 형식으로 저장 권장)
    NewValues NVARCHAR(MAX) NULL               -- 변경 후 값 (JSON, XML 등 형식으로 저장 권장)
);
PRINT 'AuditLogs 테이블 생성 완료.';
GO
-- 인덱스 생성 (성능 향상 목적)
CREATE INDEX IX_AuditLogs_Timestamp ON dbo.AuditLogs (Timestamp DESC);
PRINT 'AuditLogs 테이블 인덱스 생성 완료.';