터를 기준으로 업데이트하는 것이 목표입니다. 팝업 창이 뜨는 문제를 해결하고, 일치하는 데이터를 찾아 abc 시트에 값을 업데이트하는 방법을 개선해보겠습니다.

다음 코드는 zzz 시트의 데이터를 기준으로 abc 시트의 데이터를 업데이트하는 매크로입니다:

vba
코드 복사
Sub UpdateABCFromZZZ()
    Dim wsABC As Worksheet
    Dim wsZZZ As Worksheet
    Dim lastRowABC As Long
    Dim lastRowZZZ As Long
    Dim dict As Object
    Dim i As Long, j As Long
    Dim key As String
    
    ' 시트 설정
    Set wsABC = ThisWorkbook.Sheets("abc")
    Set wsZZZ = ThisWorkbook.Sheets("zzz")
    
    ' 마지막 행 찾기
    lastRowABC = wsABC.Cells(wsABC.Rows.Count, "A").End(xlUp).Row
    lastRowZZZ = wsZZZ.Cells(wsZZZ.Rows.Count, "C").End(xlUp).Row
    
    ' Dictionary 생성
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' zzz 시트의 데이터를 Dictionary에 저장
    For i = 2 To lastRowZZZ
        key = wsZZZ.Cells(i, 3).Value & "|" & wsZZZ.Cells(i, 6).Value & "|" & wsZZZ.Cells(i, 8).Value
        If Not dict.exists(key) Then
            dict.Add key, wsZZZ.Cells(i, 12).Resize(1, 8).Value
        End If
    Next i
    
    ' abc 시트와 비교하여 일치하는 경우 값 업데이트
    For j = 2 To lastRowABC
        key = wsABC.Cells(j, 1).Value & "|" & wsABC.Cells(j, 2).Value & "|" & wsABC.Cells(j, 3).Value
        If dict.exists(key) Then
            wsABC.Cells(j, 4).Resize(1, 8).Value = dict(key)
        End If
    Next j
    
    ' Dictionary 해제
    Set dict = Nothing
End Sub
이 코드는 다음과 같이 동작합니다:

wsABC와 wsZZZ로 abc 시트와 zzz 시트를 설정합니다.
각 시트의 마지막 행을 찾습니다.
zzz 시트의 데이터를 Dictionary에 저장합니다. 키는 C, F, H 열의 조합이며, 값은 L부터 S 열까지의 데이터입니다.
abc 시트의 각 행과 Dictionary를 비교하여 일치하는 경우 해당 데이터를 abc 시트에 업데이트합니다.
이렇게 하면 일치하는 데이터를 abc 시트에 올바르게 업데이트할 수 있습니다.






