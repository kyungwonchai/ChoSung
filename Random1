DB ì¡°íšŒëŠ” GetInfo ê³„ì—´ í•¨ìˆ˜ì—ì„œ ì§ì ‘ ì²˜ë¦¬
âœ… DatabaseReaderì—ì„œ ì§ì ‘ ë¹„ë™ê¸°ë¡œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ DataRow ë°˜í™˜
âœ… ì±…ì„ ë¶„ë¦¬: ë°ì´í„° ì¡°íšŒì™€ ë§¤í¬ë¡œ ì‹¤í–‰ì„ ë…ë¦½ì ìœ¼ë¡œ ìœ ì§€
âœ… ì˜ˆì œ: GetInfo_QR() í•¨ìˆ˜ê°€ QR ê´€ë ¨ ì •ë³´ë¥¼ ë¹„ë™ê¸°ë¡œ ì¡°íšŒí•˜ì—¬ ë°˜í™˜
âœ… ì¡°íšŒëœ ì •ë³´ë¥¼ ë§¤í¬ë¡œ ì‹¤í–‰ì— í™œìš©

ğŸ“‚ 1. í”„ë¡œì íŠ¸ êµ¬ì¡°
pgsql
ì½”ë“œ ë³µì‚¬
ğŸ“¦ AutoHandleSolution
 â”£ ğŸ“‚ AAutoHandle
 â”ƒ â”£ ğŸ“‚ Commands
 â”ƒ â”£ ğŸ“‚ Core
 â”ƒ â”£ ğŸ“‚ Database
 â”ƒ â”ƒ â”£ ğŸ“œ MySqlHelper.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MsSqlHelper.cs
 â”ƒ â”ƒ â”£ ğŸ“œ DatabaseReader.cs
 â”ƒ â”ƒ â”— ğŸ“œ GetInfoManager.cs  â˜… ë°ì´í„° ì¡°íšŒ ì „ë‹´
 â”ƒ â”£ ğŸ“‚ MacroActions
 â”ƒ â”ƒ â”£ ğŸ“œ MacroActionA.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroActionB.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroActionC.cs
 â”ƒ â”£ ğŸ“‚ Forms
 â”ƒ â”ƒ â”— ğŸ“œ MainForm.cs
 â”ƒ â”£ ğŸ“œ Program.cs
 â”ƒ â”— ğŸ“œ AAutoHandle.csproj
 â”— ğŸ“œ AutoHandleSolution.sln
âœ… ì¡°íšŒ ë¡œì§ì„ GetInfoManager.csì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬
âœ… MacroActionAì—ì„œ í•„ìš”í•  ë•Œ GetInfoManagerë¥¼ í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ì¡°íšŒ

ğŸ“œ 2. GetInfoManager.cs (DB ì¡°íšŒ ë‹´ë‹¹)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using MySql.Data.MySqlClient;
    using System.Data.SqlClient;

    public class GetInfoManager
    {
        private readonly string _mysqlConnString;
        private readonly string _mssqlConnString;

        public GetInfoManager(string mysqlConn, string mssqlConn)
        {
            _mysqlConnString = mysqlConn;
            _mssqlConnString = mssqlConn;
        }

        public async Task<DataRow> GetInfo_QR(string qrCode)
        {
            using (var connection = new MySqlConnection(_mysqlConnString))
            {
                await connection.OpenAsync();
                using (var command = new MySqlCommand("sp_GetInfo_QR", connection))
                {
                    command.CommandType = CommandType.StoredProcedure;
                    command.Parameters.AddWithValue("@qr_code", qrCode);

                    using (var adapter = new MySqlDataAdapter(command))
                    {
                        var table = new DataTable();
                        adapter.Fill(table);

                        if (table.Rows.Count > 0)
                            return table.Rows[0]; // ì²« ë²ˆì§¸ ê²°ê³¼ ë°˜í™˜
                        else
                            return null; // ê²°ê³¼ ì—†ìŒ
                    }
                }
            }
        }
    }
}
âœ… QR ê´€ë ¨ ì •ë³´ë¥¼ sp_GetInfo_QR í”„ë¡œì‹œì €ë¡œ ì¡°íšŒ
âœ… ì¡°íšŒ ê²°ê³¼ê°€ ìˆìœ¼ë©´ DataRow ë°˜í™˜, ì—†ìœ¼ë©´ null ë°˜í™˜

ğŸ“œ 3. MacroActionA.cs (QR ì •ë³´ë¥¼ ë°›ì•„ ë§¤í¬ë¡œ ì‹¤í–‰)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.MacroActions
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using AAutoHandle.Core;
    using AAutoHandle.Commands;
    using AAutoHandle.Database;

    public class MacroActionA
    {
        private readonly GetInfoManager _infoManager;

        public MacroActionA(string mysqlConn, string mssqlConn)
        {
            _infoManager = new GetInfoManager(mysqlConn, mssqlConn);
        }

        public async Task ExecuteAsync(string qrCode)
        {
            var macroManager = MacroManager.Instance;

            // **QR ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ì •ë³´ ì¡°íšŒ**
            DataRow qrInfo = await _infoManager.GetInfo_QR(qrCode);

            if (qrInfo != null)
            {
                int x = Convert.ToInt32(qrInfo["x"]);
                int y = Convert.ToInt32(qrInfo["y"]);
                string capturePath = qrInfo["capturePath"].ToString();

                macroManager.AddCommand(new MouseClickCommand(x, y));
                macroManager.AddCommand(new DelayCommand(500));
                macroManager.AddCommand(new ScreenCaptureCommand(capturePath));

                await macroManager.StartExecutionAsync();
            }
            else
            {
                MacroLogger.Instance.AddLog($"QR ì½”ë“œ '{qrCode}'ì— ëŒ€í•œ ì •ë³´ ì—†ìŒ.");
            }
        }
    }
}
âœ… QR ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ GetInfo_QRì„ í†µí•´ ì •ë³´ ì¡°íšŒ
âœ… ì¡°íšŒëœ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§¤í¬ë¡œ ì‹¤í–‰ (MouseClickCommand, ScreenCaptureCommand)

ğŸ“œ 4. MainForm.cs (UIì—ì„œ ì‹¤í–‰)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Windows.Forms;
using AAutoHandle.MacroActions;

namespace AAutoHandle
{
    public partial class MainForm : Form
    {
        private MacroActionA _macroActionA;

        public MainForm()
        {
            InitializeComponent();

            string mysqlConn = "Server=localhost;Database=mydb;User=root;Password=1234;";
            string mssqlConn = "Server=myserver;Database=mydb;User Id=myuser;Password=mypassword;";

            _macroActionA = new MacroActionA(mysqlConn, mssqlConn);
        }

        private async void btnStartMacro_Click(object sender, EventArgs e)
        {
            string qrCode = "QRCODE123"; // í…ŒìŠ¤íŠ¸ QR ì½”ë“œ
            await _macroActionA.ExecuteAsync(qrCode);
        }
    }
}
âœ… ë²„íŠ¼ í´ë¦­ ì‹œ íŠ¹ì • QR ì½”ë“œ ì •ë³´ ì¡°íšŒ & ë§¤í¬ë¡œ ì‹¤í–‰
âœ… QR ì½”ë“œ ë³€ê²½ ì‹œ í•´ë‹¹ ì •ë³´ ê¸°ë°˜ìœ¼ë¡œ ìë™ ì‹¤í–‰ ê°€ëŠ¥

ğŸ“œ 5. MySQL í”„ë¡œì‹œì € ì˜ˆì‹œ (sp_GetInfo_QR)
sql
ì½”ë“œ ë³µì‚¬
DELIMITER //
CREATE PROCEDURE sp_GetInfo_QR(IN qr_code VARCHAR(255))
BEGIN
    SELECT x, y, capturePath FROM qr_table WHERE qr_value = qr_code;
END //
DELIMITER ;
âœ… QR ì½”ë“œ ê°’ìœ¼ë¡œ ìœ„ì¹˜ ì •ë³´ (x, y), ìº¡ì²˜ ê²½ë¡œ ì¡°íšŒ
âœ… ì¡°íšŒëœ ë°ì´í„°ê°€ ë§¤í¬ë¡œ ì‹¤í–‰ì— ì‚¬ìš©ë¨

ğŸ“œ 6. ì‹¤í–‰ íë¦„
âœ… btnStartMacro_Click() ì‹¤í–‰
MacroActionA.ExecuteAsync(qrCode) ì‹¤í–‰
QR ì½”ë“œ ì •ë³´ (qrCode = "QRCODE123")ë¥¼ GetInfo_QRì—ì„œ ì¡°íšŒ
ì¡°íšŒëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§¤í¬ë¡œ ì‹¤í–‰
ë§ˆìš°ìŠ¤ í´ë¦­ (MouseClickCommand)
0.5ì´ˆ ëŒ€ê¸° (DelayCommand)
í™”ë©´ ìº¡ì²˜ (ScreenCaptureCommand)
ListBoxì— ì‹¤í–‰ ê²°ê³¼ ì¶”ê°€
ğŸ“œ 7. í™•ì¥ ê°€ëŠ¥ì„±
âœ… GetInfo_XXX() ë°©ì‹ìœ¼ë¡œ ë‹¤ì–‘í•œ ì •ë³´ ì¡°íšŒ ê°€ëŠ¥
âœ… DB ì¡°íšŒ í›„ íŠ¹ì • ë™ì‘ ì‹¤í–‰ (í‚¤ ì…ë ¥, ë§ˆìš°ìŠ¤ í´ë¦­ ë“±) ê°€ëŠ¥
âœ… QR ì½”ë“œ ì™¸ì—ë„ ë°”ì½”ë“œ, RFID ë“±ì˜ ë°ì´í„° ê¸°ë°˜ ë§¤í¬ë¡œ ì‹¤í–‰ í™•ì¥ ê°€ëŠ¥

ğŸ“Œ ê²°ë¡ 
ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒì™€ ë§¤í¬ë¡œ ì‹¤í–‰ì„ ë…ë¦½ì ìœ¼ë¡œ ë¶„ë¦¬ (GetInfoManager)
ğŸ”¹ QR ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ í•„ìš”í•œ ì •ë³´ë¥¼ ê°€ì ¸ì™€ ë§¤í¬ë¡œ ì‹¤í–‰ (MacroActionA)
ğŸ”¹ ìƒˆë¡œìš´ ë°ì´í„° ìœ í˜• ì¶”ê°€ ì‹œ GetInfo_XXX()ë§Œ ì¶”ê°€í•˜ë©´ í™•ì¥ ê°€ëŠ¥
ğŸ”¹ ë‹·ë„· 4.8 ì™„ë²½ ì§€ì›, MySQL & MSSQL ì—°ë™, ë¹„ë™ê¸° ë§¤í¬ë¡œ ì‹¤í–‰ ê°€ëŠ¥