P5DATA와 MP5RESULT 컬럼을 추가하려면 다음을 수정해야 합니다:

GetNewRows 함수 수정:
추가 컬럼 데이터를 읽어 처리.
SQL 쿼리 수정:
INSERT 문에 새로운 컬럼 추가.
수정된 GetNewRows 함수
csharp
코드 복사
public List<Dictionary<string, object>> GetNewRows(string rootPath)
{
    var newRows = new List<Dictionary<string, object>>();
    var csvFiles = Directory.GetFiles(rootPath, "*.csv", SearchOption.AllDirectories);

    foreach (var file in csvFiles)
    {
        using (var reader = new StreamReader(new FileStream(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)))
        {
            reader.ReadLine(); // 첫 번째 행(헤더) 무시
            while (!reader.EndOfStream)
            {
                var values = reader.ReadLine()?.Split(',');
                if (values == null || values.Length < 12) // MP5DATA와 MP5RESULT 포함 최소 12개 컬럼 확인
                {
                    Debug.WriteLine("Skipped Row: Insufficient columns.");
                    continue;
                }

                // 디버그 출력: 현재 처리 중인 행의 값을 출력
                Debug.WriteLine($"Processing Row: {string.Join(", ", values)}");

                // InspectionTime 문자열을 지정된 형식으로 파싱
                if (!DateTime.TryParseExact(values[0], "yyyyMMdd HH:mm:ss", CultureInfo.InvariantCulture, DateTimeStyles.None, out var inspectionTime))
                {
                    Debug.WriteLine("Skipped Row: InspectionTime is not in the valid format (yyyyMMdd HH:mm:ss).");
                    continue;
                }

                // 4열이 숫자(정수 또는 실수)가 아니면 제외
                if (!decimal.TryParse(values[3], out _))
                {
                    Debug.WriteLine("Skipped Row: 4th column is not a valid number.");
                    continue;
                }

                var row = new Dictionary<string, object>
                {
                    ["InspectionTime"] = inspectionTime, // 파싱된 DateTime 값 사용
                    ["ModelName"] = values[1],
                    ["AlignResult"] = values[2],
                    ["MP1DATA"] = float.Parse(values[3]),
                    ["MP1RESULT"] = values[4],
                    ["MP2DATA"] = float.Parse(values[5]),
                    ["MP2RESULT"] = values[6],
                    ["MP3DATA"] = float.Parse(values[7]),
                    ["MP3RESULT"] = values[8],
                    ["MP4DATA"] = float.Parse(values[9]),
                    ["MP4RESULT"] = values[10],
                    ["MP5DATA"] = float.Parse(values[11]),
                    ["MP5RESULT"] = values[12],
                    ["ipname"] = _ipAddress // 현재 IP 추가
                };

                // InspectionTime 조건 검사
                if (inspectionTime > _lastUploadedTime)
                {
                    Debug.WriteLine("Added Row: Passed all checks.");
                    newRows.Add(row);
                }
                else
                {
                    Debug.WriteLine("Skipped Row: InspectionTime is not newer than the last uploaded time.");
                }
            }
        }
    }

    return newRows;
}
SQL 쿼리 수정
테이블 수정
YourTable에 새로운 컬럼 MP5DATA와 MP5RESULT 추가:

sql
코드 복사
ALTER TABLE YourTable
ADD MP5DATA FLOAT,
    MP5RESULT NVARCHAR(100);
INSERT 문 수정
데이터베이스 업로드 시 새 컬럼 처리:

csharp
코드 복사
using (var command = new SqlCommand(
    @"IF NOT EXISTS (SELECT 1 FROM YourTable WHERE InspectionTime = @InspectionTime AND ModelName = @ModelName)
      INSERT INTO YourTable (InspectionTime, ModelName, AlignResult, MP1DATA, MP1RESULT, MP2DATA, MP2RESULT, MP3DATA, MP3RESULT, MP4DATA, MP4RESULT, MP5DATA, MP5RESULT, ipname)
      VALUES (@InspectionTime, @ModelName, @AlignResult, @MP1DATA, @MP1RESULT, @MP2DATA, @MP2RESULT, @MP3DATA, @MP3RESULT, @MP4DATA, @MP4RESULT, @MP5DATA, @MP5RESULT, @ipname)", connection))
{
    command.Parameters.AddWithValue("@InspectionTime", row["InspectionTime"]);
    command.Parameters.AddWithValue("@ModelName", row["ModelName"]);
    command.Parameters.AddWithValue("@AlignResult", row["AlignResult"]);
    command.Parameters.AddWithValue("@MP1DATA", row["MP1DATA"]);
    command.Parameters.AddWithValue("@MP1RESULT", row["MP1RESULT"]);
    command.Parameters.AddWithValue("@MP2DATA", row["MP2DATA"]);
    command.Parameters.AddWithValue("@MP2RESULT", row["MP2RESULT"]);
    command.Parameters.AddWithValue("@MP3DATA", row["MP3DATA"]);
    command.Parameters.AddWithValue("@MP3RESULT", row["MP3RESULT"]);
    command.Parameters.AddWithValue("@MP4DATA", row["MP4DATA"]);
    command.Parameters.AddWithValue("@MP4RESULT", row["MP4RESULT"]);
    command.Parameters.AddWithValue("@MP5DATA", row["MP5DATA"]);
    command.Parameters.AddWithValue("@MP5RESULT", row["MP5RESULT"]);
    command.Parameters.AddWithValue("@ipname", row["ipname"]);

    await command.ExecuteNonQueryAsync();
}
수정된 로직 요약
GetNewRows 함수:

새로운 MP5DATA와 MP5RESULT 컬럼을 포함하여 12개의 컬럼 데이터를 처리.
추가 컬럼 값을 파싱하여 데이터베이스 업로드 시 사용.
SQL 테이블:

YourTable에 MP5DATA(FLOAT)와 MP5RESULT(NVARCHAR(100)) 컬럼 추가.
SQL INSERT 문:

새로운 컬럼(MP5DATA, MP5RESULT) 값을 포함하여 데이터 삽입.
디버깅 로그:
