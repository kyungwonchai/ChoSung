MP5 값이 데이터베이스에 올라가지 않는 문제는 몇 가지 원인 중 하나일 가능성이 큽니다. 아래에서 원인을 확인하고 수정할 수 있는 부분을 정리합니다.

원인 및 확인해야 할 사항
CSV 데이터 확인:

MP5DATA와 MP5RESULT에 값이 정확히 들어 있는지 확인.
값이 공백(""), null, 또는 다른 형식일 가능성이 있습니다.
GetNewRows에서 MP5 데이터 처리 확인:

AddDefaultColumn 함수에서 MP5DATA와 MP5RESULT를 제대로 처리하지 못하고 있을 가능성.
SQL 쿼리에서 @MP5DATA와 @MP5RESULT 추가 여부 확인:

SQL INSERT 문에서 MP5DATA와 MP5RESULT 값이 누락되었을 가능성.
디버그 로그 확인:

디버그 메시지를 통해 MP5 데이터가 제대로 생성되고 있는지 확인.
수정된 GetNewRows 함수 및 SQL 쿼리
다음은 MP5 데이터를 제대로 처리하고 데이터베이스로 업로드하기 위해 필요한 수정 사항입니다.

수정된 AddDefaultColumn 함수
csharp
코드 복사
private void AddDefaultColumn(Dictionary<string, object> row, string columnName, string[] values, int index)
{
    if (index < values.Length && !string.IsNullOrWhiteSpace(values[index]))
    {
        if (columnName.Contains("DATA"))
        {
            // DATA 컬럼은 숫자가 아니면 99로 처리
            if (float.TryParse(values[index], out var numericValue))
            {
                row[columnName] = numericValue; // 숫자로 변환 가능하면 숫자 값 추가
            }
            else
            {
                row[columnName] = 99; // 숫자가 아니면 99로 처리
            }
        }
        else if (columnName.Contains("RESULT"))
        {
            // RESULT 컬럼은 항상 문자 그대로 추가
            row[columnName] = values[index];
        }
    }
    else
    {
        // 값이 없으면 기본값 추가
        if (columnName.Contains("DATA"))
        {
            row[columnName] = 0; // DATA 컬럼 기본값 0
        }
        else if (columnName.Contains("RESULT"))
        {
            row[columnName] = "NA"; // RESULT 컬럼 기본값 "NA"
        }
    }
}
수정된 SQL INSERT 문
csharp
코드 복사
using (var command = new SqlCommand(
    @"INSERT INTO YourTable (ipname, InspectionTime, ModelName, AlignResult, MP1DATA, MP1RESULT, MP2DATA, MP2RESULT, MP3DATA, MP3RESULT, MP4DATA, MP4RESULT, MP5DATA, MP5RESULT)
      VALUES (@ipname, @InspectionTime, @ModelName, @AlignResult, @MP1DATA, @MP1RESULT, @MP2DATA, @MP2RESULT, @MP3DATA, @MP3RESULT, @MP4DATA, @MP4RESULT, @MP5DATA, @MP5RESULT)", connection))
{
    command.Parameters.AddWithValue("@ipname", row["ipname"]);
    command.Parameters.AddWithValue("@InspectionTime", row["InspectionTime"]);
    command.Parameters.AddWithValue("@ModelName", row["ModelName"]);
    command.Parameters.AddWithValue("@AlignResult", row["AlignResult"]);
    command.Parameters.AddWithValue("@MP1DATA", row["MP1DATA"]);
    command.Parameters.AddWithValue("@MP1RESULT", row["MP1RESULT"]);
    command.Parameters.AddWithValue("@MP2DATA", row["MP2DATA"]);
    command.Parameters.AddWithValue("@MP2RESULT", row["MP2RESULT"]);
    command.Parameters.AddWithValue("@MP3DATA", row["MP3DATA"]);
    command.Parameters.AddWithValue("@MP3RESULT", row["MP3RESULT"]);
    command.Parameters.AddWithValue("@MP4DATA", row["MP4DATA"]);
    command.Parameters.AddWithValue("@MP4RESULT", row["MP4RESULT"]);
    command.Parameters.AddWithValue("@MP5DATA", row["MP5DATA"]); // MP5 데이터 추가
    command.Parameters.AddWithValue("@MP5RESULT", row["MP5RESULT"]); // MP5 결과 추가

    await command.ExecuteNonQueryAsync();
}
디버그 확인 추가
GetNewRows 함수에서 MP5DATA와 MP5RESULT 값을 디버깅 로그로 출력하여 처리 여부를 확인합니다.

csharp
코드 복사
Debug.WriteLine($"MP5DATA: {row["MP5DATA"]}, MP5RESULT: {row["MP5RESULT"]}");
진단 순서
CSV 데이터 확인:
MP5DATA와 MP5RESULT 값이 제대로 있는지 확인.
디버그 로그 출력:
MP5DATA와 MP5RESULT가 row에 올바르게 추가되었는지 확인.
SQL 쿼리 검증:
@MP5DATA와 @MP5RESULT 값이 누락되지 않았는지 확인.
결론
AddDefaultColumn 함수가 제대로 작동하지 않을 경우, MP5DATA가 0 또는 비어 있는 값으로 처리될 가능성이 있습니다.