using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public partial class Form1 : Form
{
    [DllImport("user32.dll")]
    private static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

    [DllImport("user32.dll")]
    private static extern IntPtr GetForegroundWindow();

    private const int SW_RESTORE = 9;

    public Form1()
    {
        InitializeComponent();
    }

    protected override void OnLoad(EventArgs e)
    {
        base.OnLoad(e);

        // 폼이 로드될 때 윈도 상태를 복원합니다.
        RestoreWindow();
    }

    private void RestoreWindow()
    {
        // 현재 활성화된 윈도우의 핸들을 가져옵니다.
        IntPtr foregroundWindowHandle = GetForegroundWindow();

        // 윈도 상태를 복원합니다.
        ShowWindow(foregroundWindowHandle, SW_RESTORE);
    }
}
