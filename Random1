셀 파일의 시트를 복사하여 새로운 파일을 만들었음에도 불구하고 열기 속도가 느린 경우, 복사 과정에서 숨겨진 요소나 기타 문제들이 함께 복사되었을 가능성이 있습니다. 여기 몇 가지 원인과 해결 방법을 제시하겠습니다.

1. 숨겨진 이름 범위
엑셀 파일에는 종종 사용되지 않는 숨겨진 이름 범위가 포함될 수 있습니다. 이를 확인하고 제거하는 매크로를 사용해 볼 수 있습니다.

vba
코드 복사
Sub RemoveHiddenNames()
    Dim n As Name
    On Error Resume Next
    For Each n In ThisWorkbook.Names
        If n.Visible = False Then
            n.Delete
        End If
    Next n
    On Error GoTo 0
    MsgBox "Hidden names removed.", vbInformation
End Sub
2. 파일 메타데이터 및 링크 정리
복사 과정에서 파일 메타데이터나 외부 링크가 함께 복사될 수 있습니다. 이를 정리해봅니다.

메타데이터 제거
vba
코드 복사
Sub RemoveDocumentProperties()
    Dim dp As DocumentProperty
    For Each dp In ThisWorkbook.BuiltinDocumentProperties
        dp.Value = ""
    Next dp
    MsgBox "Document properties cleared.", vbInformation
End Sub
외부 링크 제거
vba
코드 복사
Sub RemoveExternalLinks()
    Dim i As Integer
    Dim links As Variant
    
    links = ThisWorkbook.LinkSources(xlExcelLinks)
    If Not IsEmpty(links) Then
        For i = 1 To UBound(links)
            ThisWorkbook.BreakLink Name:=links(i), Type:=xlLinkTypeExcelLinks
        Next i
        MsgBox "External links removed.", vbInformation
    Else
        MsgBox "No external links found.", vbInformation
    End If
End Sub
3. 사용되지 않는 스타일 제거
엑셀 파일에는 사용되지 않는 스타일이 쌓여서 성능 저하를 일으킬 수 있습니다. 이를 정리해봅니다.

vba
코드 복사
Sub RemoveUnusedStyles()
    Dim style As Style
    On Error Resume Next
    For Each style In ThisWorkbook.Styles
        If style.BuiltIn = False Then
            style.Delete
        End If
    Next style
    On Error GoTo 0
    MsgBox "Unused styles removed.", vbInformation
End Sub
4. 피벗 테이블 캐시 정리
피벗 테이블이 있는 경우 캐시를 정리하여 성능을 향상시킬 수 있습니다.

vba
코드 복사
Sub ClearPivotCache()
    Dim pc As PivotCache
    For Each pc In ThisWorkbook.PivotCaches
        pc.Refresh
    Next pc
    MsgBox "Pivot caches refreshed.", vbInformation
End Sub
5. 매크로 실행 방법
Excel 파일을 엽니다.
Alt + F11을 눌러 VBA 편집기를 엽니다.
Insert > Module을 선택하여 새 모듈을 추가합니다.
위의 매크로 코드를 복사하여 모듈에 붙여넣습니다.
F5 키를 눌러 매크로를 실행합니다.
위의 방법들을 시도하여 파일의 숨겨진 요소를 제거하고 성능을 최적화할 수 있습니다. 이러한 정리 작업 후에도 파일이 여전히 느리다면, 파일 구조에 더 깊은 문제가 있을 수 있으므로 추가적인 검토가 필요할 수 있습니다.