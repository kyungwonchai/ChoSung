using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        private SqlConnection connection;
        private SqlCommand command;

        public YourForm()
        {
            InitializeComponent();
            connection = new SqlConnection("YourConnectionString");
            command = new SqlCommand("Return_MaskFilterGroup2", connection);
            command.CommandType = CommandType.StoredProcedure;
        }

        private void RefreshPanel1()
        {
            // 버튼 클릭 시 panel1 초기화
            panel1.Controls.Clear();

            try
            {
                connection.Open();
                SqlDataReader reader = command.ExecuteReader();

                if (reader.HasRows)
                {
                    while (reader.Read())
                    {
                        string email = reader["Email"].ToString();
                        string area = reader["Area"].ToString();
                        string quantity = reader["Quantity"].ToString();
                        string remainingDays = reader["RemainingDays"].ToString();
                        string adminInfo = reader["AdminInfo"].ToString();
                        string dateSetting = reader["DateSetting"].ToString();

                        // 동적으로 데이터 표시할 컨트롤 생성
                        Label emailLabel = new Label();
                        emailLabel.Text = "Email: " + email;

                        Label areaLabel = new Label();
                        areaLabel.Text = "Area: " + area;

                        Label quantityLabel = new Label();
                        quantityLabel.Text = "Quantity: " + quantity;

                        Label remainingDaysLabel = new Label();
                        remainingDaysLabel.Text = "Remaining Days: " + remainingDays;

                        Label adminInfoLabel = new Label();
                        adminInfoLabel.Text = "Admin Info: " + adminInfo;

                        Label dateSettingLabel = new Label();
                        dateSettingLabel.Text = "Date Setting: " + dateSetting;

                        // 생성한 컨트롤을 panel1에 추가
                        panel1.Controls.Add(emailLabel);
                        panel1.Controls.Add(areaLabel);
                        panel1.Controls.Add(quantityLabel);
                        panel1.Controls.Add(remainingDaysLabel);
                        panel1.Controls.Add(adminInfoLabel);
                        panel1.Controls.Add(dateSettingLabel);
                    }
                }
                else
                {
                    // 행이 없는 경우 처리
                    Label noDataLabel = new Label();
                    noDataLabel.Text = "행이 없습니다.";
                    panel1.Controls.Add(noDataLabel);
                }

                reader.Close();
            }
            catch (Exception ex)
            {
                // 예외 처리
                MessageBox.Show("오류 발생: " + ex.Message);
            }
            finally
            {
                connection.Close();
            }
        }

        private void YourButton_Click(object sender, EventArgs e)
        {
            RefreshPanel1();
        }
    }
}
