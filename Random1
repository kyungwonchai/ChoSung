using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows;

namespace WpfAppWithProcedure
{
    public partial class MainWindow : Window
    {
        private DataTable dataTable;

        public MainWindow()
        {
            InitializeComponent();
            LoadDataFromProcedure();
        }

        private void LoadDataFromProcedure()
        {
            string connectionString = "Data Source=YourServer;Initial Catalog=YourDatabase;User ID=YourUser;Password=YourPassword";
            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();
                using (SqlCommand command = new SqlCommand("YourStoredProcedureName", connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    SqlDataAdapter adapter = new SqlDataAdapter(command);
                    dataTable = new DataTable();
                    adapter.Fill(dataTable);
                }
            }
        }

        private void UpdateSpecificColumnInDatabase()
        {
            string connectionString = "Data Source=YourServer;Initial Catalog=YourDatabase;User ID=YourUser;Password=YourPassword";
            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();
                using (SqlCommand command = new SqlCommand("YourStoredProcedureName", connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    SqlDataAdapter adapter = new SqlDataAdapter(command);
                    SqlCommandBuilder builder = new SqlCommandBuilder(adapter);

                    // 커스텀 UpdateCommand 작성
                    command.CommandText = "UPDATE YourTable SET YourColumnName = @YourValue WHERE YourIDColumn = @YourID";
                    command.Parameters.Add(new SqlParameter("@YourValue", SqlDbType.YourColumnType)).SourceColumn = "YourColumnName";
                    command.Parameters.Add(new SqlParameter("@YourID", SqlDbType.YourIDColumnType)).SourceColumn = "YourIDColumn";

                    adapter.UpdateCommand = command;
                    adapter.Update(dataTable);
                }
            }
        }

        private void UpdateButton_Click(object sender, RoutedEventArgs e)
        {
            UpdateSpecificColumnInDatabase();
            MessageBox.Show("특정 컬럼 업데이트 완료");
        }
    }
}
