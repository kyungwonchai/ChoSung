L 태그 코드로 변환하여 새로운 시트 태그HTML에 작성하는 매크로 코드입니다. 기존 태그HTML 시트가 있다면 삭제 후 새로 생성되며, 각 데이터는 HTML에서 보이는 코드로 변환됩니다.

VBA 코드
vba
코드 복사
Sub GenerateHTMLCode()
    Dim wsSource As Worksheet
    Dim wsResult As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim cellValue As String
    Dim resultRow As Long
    
    ' 데이터가 있는 소스 시트 확인
    On Error Resume Next
    Set wsSource = ThisWorkbook.ActiveSheet ' 현재 활성화된 시트를 소스 시트로 사용
    On Error GoTo 0
    If wsSource Is Nothing Then
        MsgBox "데이터 소스 시트를 찾을 수 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 태그HTML 시트 삭제
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsResult = ThisWorkbook.Worksheets("태그HTML")
    If Not wsResult Is Nothing Then wsResult.Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' 태그HTML 시트 생성
    Set wsResult = ThisWorkbook.Sheets.Add
    wsResult.Name = "태그HTML"
    
    ' 소스 시트의 마지막 행 가져오기
    lastRow = wsSource.Cells(wsSource.Rows.Count, 1).End(xlUp).Row
    If lastRow < 2 Then
        MsgBox "데이터가 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' HTML 코드 변환 및 태그HTML 시트에 작성
    resultRow = 1
    wsResult.Cells(resultRow, 1).Value = "<HTML>"
    resultRow = resultRow + 1
    wsResult.Cells(resultRow, 1).Value = "<BODY>"
    resultRow = resultRow + 1
    
    For i = 2 To lastRow
        cellValue = wsSource.Cells(i, 1).Value ' 1열 데이터 읽기
        
        ' 데이터가 비어있지 않은 경우만 처리
        If cellValue <> "" Then
            wsResult.Cells(resultRow, 1).Value = "&lt;p&gt;" & cellValue & "&lt;/p&gt;"
            resultRow = resultRow + 1
        End If
    Next i
    
    ' HTML 닫는 태그 추가
    wsResult.Cells(resultRow, 1).Value = "</BODY>"
    resultRow = resultRow + 1
    wsResult.Cells(resultRow, 1).Value = "</HTML>"
    
    ' 결과 시트 컬럼 폭 자동 조정
    wsResult.Cells.EntireColumn.AutoFit
    
    MsgBox "HTML 코드 생성이 완료되었습니다.", vbInformation
End Sub
코드 설명
소스 데이터 읽기:

활성화된 시트를 소스 시트로 사용하며, 1열 2행부터 마지막 데이터 행까지 읽습니다.
HTML 코드 변환:

각 셀의 값을 <p> 태그로 감싸고, HTML에서 보이는 코드 형태로 변환합니다.
예: 값 → &lt;p&gt;값&lt;/p&gt;.
결과 시트 작성:

새로운 태그HTML 시트를 생성합니다.
기존 시트가 있다면 삭제 후 새로 생성합니다.
HTML 태그 구조:

최종 출력물은 HTML 구조를 따릅니다:
html
코드 복사
<HTML>
<BODY>
<p>값1</p>
<p>값2</p>
</BODY>
</HTML>
성능 최적화 및 오류 처리:

데이터가 없거나 시트를 찾지 못할 경우 경고 메시지를 표시하고 종료합니다.
사용 방법
VBA 편집기에서 코드를 추가합니다.
Alt + F8을 눌러 매크로 목록에서 GenerateHTMLCode를 실행합니다.
실행 결과
예를 들어, 소스 시트에 다음 데이터가 있다면:

1열
값1
값2
값3
결과는 새로운 태그HTML 시트에 다음과 같이 작성됩니다:

1열
<HTML>
<BODY>
&lt;p&gt;값1&lt;/p&gt;
&lt;p&gt;값2&lt;/p&gt;
&lt;p&gt;값3&lt;/p&gt;
</BODY>
</HTML>
모든 HTML 코드는 <p> 태그로 감싸져 출력됩니다.




