 닫힐 때 발생하므로, 데이터 변경 작업을 데이터베이스에 반영할 수 있습니다.

다음은 수정된 코드입니다:

csharp

private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
{
    // 변경된 데이터를 데이터베이스에 반영
    SqlCommandBuilder tasksCommandBuilder = new SqlCommandBuilder(taskManager.TasksDataAdapter);
    taskManager.TasksDataAdapter.Update(taskManager.DataSet, "Tasks");

    SqlCommandBuilder taskDetailsCommandBuilder = new SqlCommandBuilder(taskManager.TaskDetailsDataAdapter);
    taskManager.TaskDetailsDataAdapter.Update(taskManager.DataSet, "TaskDetails");

    SqlCommandBuilder recipientsCommandBuilder = new SqlCommandBuilder(taskManager.RecipientsDataAdapter);
    taskManager.RecipientsDataAdapter.Update(taskManager.DataSet, "Recipients");
}

위의 코드에서 taskManager는 TaskManagerManager 클래스의 인스턴스입니다. 해당 클래스에는 TasksDataAdapter, TaskDetailsDataAdapter, RecipientsDataAdapter와 DataSet 멤버가 포함되어 있어야 합니다.

MainForm 클래스의 생성자에서 taskManager를 초기화하고 필요한 데이터 어댑터와 데이터셋을 설정해야 합니다.

예시:

csharp

public MainForm()
{
    InitializeComponent();

    // SQL 연결 문자열 설정
    string connectionString = "Data Source=(local);Initial Catalog=TaskManagerDB;Integrated Security=True";

    // TaskManagerManager 초기화
    taskManager = new TaskManagerManager(connectionString);

    // GridControl에 데이터 바인딩
    gridControl1.DataSource = taskManager.GetTasks();
}

또한 taskManager 클래스의 TasksDataAdapter, TaskDetailsDataAdapter, RecipientsDataAdapter와 DataSet 멤버에는 public 접근자가 있어야 합니다. 그렇지 않으면 MainForm_FormClosing 이벤트 핸들러에서 접근할 수 없습니다.

위의 수정된 코드를 참고하여 해당 부분을 수정하고 MainForm_FormClosing 이벤트 핸들러에 적절한 위치에 코드를 넣어주시면 됩