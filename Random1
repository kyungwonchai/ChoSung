는 요청하신 작업을 수행하는 엑셀 VBA 매크로 코드입니다. 이 코드는 버튼과 그룹페이지라는 이름의 시트를 생성한 뒤, 지정된 경로에서 CSV 파일을 읽어와 시트에 데이터를 로드하고 컬럼 폭을 자동 조정합니다. 기존 시트가 있다면 삭제하고, 실행 속도를 높이기 위해 ScreenUpdating을 적절히 설정합니다.

VBA 코드 작성 방법
Excel에서 VBA 편집기 열기:
Alt + F11을 눌러 VBA 편집기를 엽니다.
모듈 추가:
VBA 편집기에서 삽입 > 모듈을 클릭하여 새 모듈을 추가합니다.
코드 붙여넣기:
아래 코드를 복사하여 추가한 모듈에 붙여넣습니다.
매크로 실행:
Alt + F8을 눌러 매크로 목록에서 ImportCSVFiles를 선택하고 실행합니다.
VBA 코드
vba
코드 복사
Sub ImportCSVFiles()
    Dim ws As Worksheet
    Dim filePaths As Variant
    Dim fileName As String
    Dim i As Integer
    
    ' CSV 파일 경로 설정
    filePaths = Array("C:\agent\_sheet1.csv", "C:\agent\_sheet2.csv", "C:\agent\_sheet3.csv")
    
    ' 화면 업데이트 및 계산 중지로 실행 속도 개선
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    
    ' 기존 시트 삭제
    On Error Resume Next
    For Each ws In ThisWorkbook.Worksheets
        If ws.Name = "버튼" Or ws.Name = "그룹페이지" Then
            Application.DisplayAlerts = False
            ws.Delete
            Application.DisplayAlerts = True
        End If
    Next ws
    On Error GoTo 0
    
    ' 새로운 시트 생성
    Dim buttonSheet As Worksheet, groupPageSheet As Worksheet
    Set buttonSheet = ThisWorkbook.Sheets.Add
    buttonSheet.Name = "버튼"
    Set groupPageSheet = ThisWorkbook.Sheets.Add
    groupPageSheet.Name = "그룹페이지"
    
    ' CSV 파일 읽어오기
    For i = LBound(filePaths) To UBound(filePaths)
        fileName = filePaths(i)
        If Dir(fileName) <> "" Then ' 파일이 존재하는 경우만 실행
            Dim tempSheet As Worksheet
            Set tempSheet = ThisWorkbook.Sheets.Add
            tempSheet.Name = "Temp" & i ' 임시 시트 이름 지정
            
            ' CSV 파일 로드
            With tempSheet.QueryTables.Add(Connection:="TEXT;" & fileName, Destination:=tempSheet.Range("A1"))
                .TextFileParseType = xlDelimited
                .TextFileCommaDelimiter = True
                .Refresh BackgroundQuery:=False
            End With
            
            ' 컬럼 폭 자동 조정
            tempSheet.Cells.EntireColumn.AutoFit
            
            ' 데이터를 그룹페이지 시트로 복사
            tempSheet.UsedRange.Copy Destination:=groupPageSheet.Cells(1 + groupPageSheet.UsedRange.Rows.Count, 1)
            
            ' 임시 시트 삭제
            Application.DisplayAlerts = False
            tempSheet.Delete
            Application.DisplayAlerts = True
        Else
            MsgBox "파일이 존재하지 않습니다: " & fileName, vbExclamation
        End If
    Next i
    
    ' 화면 업데이트 및 계산 복원
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    
    MsgBox "CSV 파일 로드 완료!", vbInformation
End Sub
코드 설명
CSV 파일 경로 지정:
filePaths 배열에 처리할 CSV 파일 경로를 추가합니다.
기존 시트 삭제:
버튼과 그룹페이지라는 이름의 시트를 찾고, 있다면 삭제합니다.
새로운 시트 생성:
버튼과 그룹페이지라는 이름의 새 시트를 만듭니다.
CSV 파일 읽기 및 복사:
각 CSV 파일을 임시 시트에 로드한 후, 데이터를 그룹페이지 시트에 추가로 복사합니다.
임시 시트는 작업 완료 후 삭제됩니다.
컬럼 폭 자동 조정:
AutoFit 메서드를 사용해 데이터를 보기 좋게 정렬합니다.
성능 최적화:
Application.ScreenUpdating과 Application.Calculation 설정을 통해 실행 속도를 개선합니다.
주의사항
파일 경로를 정확히 지정하세요.