using System.ServiceProcess;
using System.Diagnostics;
using System.Timers;

public class MyService : ServiceBase
{
    private Timer timer;

    public MyService()
    {
        this.ServiceName = "RPA_BlackScreenRebootChecker";
    }

    protected override void OnStart(string[] args)
    {
        timer = new Timer();
        timer.Interval = 30000; // 30ì´ˆ
        timer.Elapsed += new ElapsedEventHandler(this.OnTimer);
        timer.Start();
    }

    protected override void OnStop()
    {
        timer.Stop();
        timer = null;
    }

    private void OnTimer(object sender, ElapsedEventArgs args)
    {
        Process[] pname = Process.GetProcessesByName("RPA_BlackScreenReboot");
        if (pname.Length == 0)
        {
            Process.Start(@"C:\Path\To\RPA_BlackScreenReboot.exe");
        }
    }
}
