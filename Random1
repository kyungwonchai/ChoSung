using System.Drawing;
using System.IO;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;
using PdfSharp.Drawing;

namespace PDFToImageConverter
{
    class Program
    {
        static void Main(string[] args)
        {
            string pdfFilePath = "your_pdf_file_path.pdf";
            string outputFolder = "output_folder_path";

            PdfDocument document = PdfReader.Open(pdfFilePath, PdfDocumentOpenMode.ReadOnly);

            for (int i = 0; i < document.PageCount; i++)
            {
                XGraphics gfx = XGraphics.FromPdfPage(document.Pages[i]);
                XImage img = XImage.FromGdiPlusImage(new Bitmap(gfx.PageSize.Width, gfx.PageSize.Height));

                string outputFilePath = Path.Combine(outputFolder, $"Page{i+1}.jpg");
                img.Save(outputFilePath, ImageFormat.Jpeg);
            }
        }
    }
}
