용자로부터 입력을 받아 프로그램의 동작을 동적으로 제어하는 것은 VBA 프로그래밍에서 중요한 요소입니다. 이를 위해 VBA에서는 InputBox 함수와 **사용자 정의 폼(UserForm)**을 제공합니다.​

1. InputBox 함수
InputBox 함수는 간단한 대화 상자를 통해 사용자로부터 입력을 받을 수 있는 기능을 제공합니다. 이 함수는 사용자가 값을 입력하고 확인 버튼을 누를 때까지 기다린 후, 입력된 값을 반환합니다.​

1.1 InputBox 함수의 기본 사용법
다음은 InputBox 함수를 사용하여 사용자의 이름을 입력받고, 해당 이름을 메시지 박스로 출력하는 예제입니다.​

vba
코드 복사
'===============================================
' [프로시저명] GetUserName
' [설명] InputBox를 사용하여 사용자의 이름을 입력받고 출력하는 예제
'===============================================
Sub GetUserName()

    ' 사용자로부터 이름을 입력받기 위한 변수 선언
    Dim userName As String

    ' InputBox를 통해 사용자에게 이름 입력 요청
    userName = InputBox("이름을 입력하세요:", "이름 입력", "홍길동")

    ' 입력된 이름을 메시지 박스로 출력
    MsgBox "입력하신 이름은 " & userName & "입니다.", vbInformation, "이름 확인"

End Sub
주석 설명:

Dim userName As String: 사용자 이름을 저장할 문자열 변수를 선언합니다.​

InputBox("이름을 입력하세요:", "이름 입력", "홍길동"): InputBox 함수를 호출하여 사용자에게 "이름을 입력하세요:"라는 메시지를 표시하고, 기본값으로 "홍길동"을 제공합니다.​

MsgBox "입력하신 이름은 " & userName & "입니다.", vbInformation, "이름 확인": 입력된 이름을 메시지 박스로 출력합니다.​

1.2 InputBox 함수의 다양한 활용 예제
예제 1: 두 수를 입력받아 합계를 계산하기

사용자로부터 두 개의 숫자를 입력받아 그 합계를 계산하고 출력하는 예제입니다.​

vba
코드 복사
'===============================================
' [프로시저명] SumTwoNumbers
' [설명] 두 개의 숫자를 입력받아 합계를 계산하는 예제
'===============================================
Sub SumTwoNumbers()

    ' 변수 선언
    Dim num1 As Double
    Dim num2 As Double
    Dim sum As Double
    Dim input1 As String
    Dim input2 As String

    ' 첫 번째 숫자 입력받기
    input1 = InputBox("첫 번째 숫자를 입력하세요:", "숫자 입력")
    ' 입력된 값을 숫자로 변환 (에러 방지를 위해 Val 함수 사용)
    num1 = Val(input1)

    ' 두 번째 숫자 입력받기
    input2 = InputBox("두 번째 숫자를 입력하세요:", "숫자 입력")
    ' 입력된 값을 숫자로 변환
    num2 = Val(input2)

    ' 합계 계산
    sum = num1 + num2

    ' 결과 출력
    MsgBox "두 숫자의 합은 " & sum & "입니다.", vbInformation, "합계 계산"

End Sub
주석 설명:

Dim num1 As Double, num2 As Double, sum As Double: 두 개의 숫자와 그 합계를 저장할 변수를 선언합니다.​

Dim input1 As String, input2 As String: InputBox에서 입력받은 값을 임시로 저장할 문자열 변수를 선언합니다.​

input1 = InputBox("첫 번째 숫자를 입력하세요:", "숫자 입력"): 첫 번째 숫자를 입력받습니다.​

num1 = Val(input1): 입력된 문자열을 숫자로 변환합니다. Val 함수는 문자열에서 숫자 부분만 추출하여 변환합니다.​

sum = num1 + num2: 두 숫자의 합계를 계산합니다.​

MsgBox "두 숫자의 합은 " & sum & "입니다.", vbInformation, "합계 계산": 계산된 합계를 메시지 박스로 출력합니다.​

예제 2: 입력받은 숫자의 제곱 계산하기

사용자로부터 숫자를 입력받아 그 제곱을 계산하고 출력하는 예제입니다.​

vba
코드 복사
'===============================================
' [프로시저명] SquareNumber
' [설명] 입력받은 숫자의 제곱을 계산하는 예제
'===============================================
Sub SquareNumber()

    ' 변수 선언
    Dim num As Double
    Dim square As Double
    Dim inputNum As String

    ' 숫자 입력받기
    inputNum = InputBox("숫자를 입력하세요:", "숫자 입력")
    ' 입력된 값을 숫자로 변환
    num = Val(inputNum)

    ' 제곱 계산
    square = num ^ 2

    ' 결과 출력
    MsgBox "입력한 숫자의 제곱은 " & square & "입니다.", vbInformation, "제곱 계산"

End Sub
주석 설명:

Dim num As Double, square As Double: 입력된 숫자와 그 제곱 값을 저장할 변수를 선언합니다.​

Dim inputNum As String: InputBox에서 입력받은 값을 임시로 저장할 문자열 변수를 선언합니다.​

inputNum = InputBox("숫자를 입력하세요:", "숫자 입력"): 숫자를 입력받습니다.​

num = Val(inputNum): 입력된 문자열을 숫자로 변환합니다.​