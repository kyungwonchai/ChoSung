가 발생하는 상대 PC가 Windows 7 Professional SP1 영문 버전이라면, Windows 7이 기본적으로 SMB2 프로토콜을 지원하지만 특정 설정이나 보안 제한으로 인해 연결에 실패할 수 있습니다. 해당 문제를 해결하기 위해 Windows 7의 공유 설정 및 보안 정책을 수정해 보겠습니다.

Windows 7 공유 폴더 문제 해결 방법
1. SMB 프로토콜 확인 및 설정
Windows Embedded Standard 2010은 SMB1을 기본 사용하며, SMB2를 제대로 지원하지 않을 수 있습니다. Windows 7의 SMB 설정을 조정해야 합니다.

SMB1 활성화 확인:
Windows 7에서 regedit 실행.

아래 경로로 이동:

plaintext
코드 복사
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
SMB1 값을 확인:

DWORD (32-bit) 값 이름: SMB1
값이 **1**인지 확인.
값이 없으면 새로 추가:
이름: SMB1
값: 1
SMB2를 비활성화하려면 아래 값을 추가하거나 수정:

plaintext
코드 복사
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
DWORD (32-bit) 값 이름: SMB2
값: 0
아래 명령어를 실행하여 적용:

cmd
코드 복사
net stop lanmanserver
net start lanmanserver
2. 네트워크 및 공유 센터 설정
Windows 7에서 기본 네트워크 설정을 확인 및 조정합니다.

암호 보호 공유 끄기:
제어판 → 네트워크 및 공유 센터 → 고급 공유 설정으로 이동.
모든 네트워크 → 암호 보호 공유 끄기를 선택.
파일 및 프린터 공유 켜기를 선택.
3. 폴더 권한 확인
공유 폴더에 대한 권한 설정을 확인합니다.

Everyone 권한 부여:
공유 폴더를 마우스 오른쪽 클릭 → 속성 선택.
보안 탭에서 편집을 클릭하고, Everyone 그룹을 추가:
추가 → Everyone 입력 → 확인.
읽기 및 쓰기 권한을 허용.
공유 탭 → 고급 공유 → 권한에서 Everyone에게 전체 제어 권한을 부여.
4. 레지스트리에서 LAN 인증 설정
Windows Embedded와 Windows 7 간 인증 충돌을 방지하기 위해 LAN 관리자 인증 수준을 조정합니다.

LAN 관리자 인증 수준 변경:
regedit 실행.

아래 경로로 이동:

plaintext
코드 복사
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa
DWORD 값 확인 또는 추가:

이름: LmCompatibilityLevel
값: 1
값 설명:
0: LM 및 NTLM 사용.
1: LM 및 NTLM 사용. NTLMv2 세션 보안이 협상 가능할 경우 사용.
적용 후 서비스 재시작:

cmd
코드 복사
net stop lanmanworkstation
net start lanmanworkstation
5. Windows 방화벽 및 포트 확인
Windows 방화벽이 SMB 관련 트래픽을 차단하지 않도록 설정해야 합니다.

SMB 포트 허용:
제어판 → Windows 방화벽 → 고급 설정으로 이동.

인바운드 규칙 → 새 규칙 추가:

포트 선택: TCP 포트 445, 139.
허용 규칙 생성.
동일한 방식으로 UDP 포트 137, 138도 허용.

6. SMB 클라이언트 인증 활성화
Windows Embedded에서 비보안 인증을 활성화해야 할 수 있습니다.

regedit 실행.
아래 경로로 이동:
plaintext
코드 복사
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters
DWORD 값 추가 또는 수정:
이름: AllowInsecureGuestAuth
값: 1.
7. Windows Embedded에서 연결 테스트
Windows Embedded에서 명령어로 공유 폴더 연결을 테스트합니다:

cmd
코드 복사
net use \\[Windows 7 IP 주소]\[공유 폴더 이름]
에러 메시지가 표시되면, 에러 코드와 함께 알려주세요. 추가 해결 방법을 안내해 드리겠습니다.

위 단계를 적용한 후에도 문제가 해결되지 않으면, 아래 추가 정보를 알려주세요:

공유 폴더 접근 시 정확한 에러 메시지.