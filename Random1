evExpress 22.2의 WinForms Ribbon 컨트롤에서 각 RibbonPage의 ButtonItem 우상단에 별표를 클릭하면 즐겨찾기 페이지에 추가되도록 구현할 수 있습니다. 이를 구현하는 방법을 단계별로 상세하게 설명하겠습니다.

구현 단계
Ribbon 컨트롤 설정:

폼에 RibbonControl을 추가하고, 기본적인 RibbonPage를 생성하여 ButtonItem 요소들을 추가합니다.
즐겨찾기를 표시할 전용 RibbonPage를 추가합니다. 이 페이지는 사용자가 선택한 즐겨찾기에 따라 동적으로 업데이트됩니다.
별표 아이콘 추가:

기본 RibbonPage의 각 ButtonItem 옆에 작은 CheckButton 또는 커스텀 Button을 추가하여 별표 아이콘을 표시합니다.
이 버튼에 클릭 이벤트 핸들러를 연결합니다.
별표 버튼 클릭 이벤트 처리:

클릭 이벤트 핸들러에서 해당 ButtonItem이 이미 즐겨찾기인지 확인합니다.
즐겨찾기가 아니라면 즐겨찾기 RibbonPage에 추가합니다.
이미 즐겨찾기라면 해당 RibbonPage에서 삭제합니다.
즐겨찾기 항목은 원본과 동일한 기능을 유지하도록 미러링됩니다.
즐겨찾기 상태 저장 및 복원:

즐겨찾기 항목으로 등록된 ButtonItem의 ID를 저장할 수 있는 설정 파일 또는 설정을 사용하여 즐겨찾기 상태를 저장합니다.
프로그램이 시작될 때 이 설정 파일을 읽어 즐겨찾기 페이지를 복원합니다.
코드 예시 개요
아래는 코드 구조를 간단하게 예시한 것입니다:

csharp
코드 복사
private void InitializeFavorites()
{
    foreach (var item in mainRibbonPage.Groups.SelectMany(g => g.ItemLinks))
    {
        var buttonItem = item.Item as BarButtonItem;
        if (buttonItem != null)
        {
            // 각 ButtonItem 옆에 작은 별표 아이콘 (CheckButton)을 추가
            var starButton = new BarButtonItem();
            starButton.Caption = "★"; // 또는 아이콘 사용
            starButton.Tag = buttonItem;
            starButton.ItemClick += StarButton_ItemClick;

            // starButton을 리본 그룹에 추가하거나 buttonItem 옆에 추가
            item.ItemLink.Add(starButton);
        }
    }

    LoadFavorites(); // 저장된 즐겨찾기 목록을 로드
}

private void StarButton_ItemClick(object sender, ItemClickEventArgs e)
{
    var starButton = (BarButtonItem)e.Item;
    var originalButton = (BarButtonItem)starButton.Tag;

    if (IsFavorite(originalButton))
    {
        RemoveFromFavorites(originalButton);
    }
    else
    {
        AddToFavorites(originalButton);
    }

    SaveFavorites(); // 즐겨찾기 상태 저장
}

private bool IsFavorite(BarButtonItem item)
{
    // 해당 항목이 즐겨찾기에 있는지 확인
    return favoritesRibbonPage.Groups.SelectMany(g => g.ItemLinks).Any(link => link.Item == item);
}

private void AddToFavorites(BarButtonItem item)
{
    // 즐겨찾기 RibbonPage에 항목 추가
    var favoriteGroup = new RibbonPageGroup("Favorites");
    var newFavoriteItem = new BarButtonItem { Caption = item.Caption, Tag = item.Tag };
    favoriteGroup.ItemLinks.Add(newFavoriteItem);
    favoritesRibbonPage.Groups.Add(favoriteGroup);
}

private void RemoveFromFavorites(BarButtonItem item)
{
    // 즐겨찾기 RibbonPage에서 항목 제거
    var favoriteGroup = favoritesRibbonPage.Groups.FirstOrDefault(g => g.ItemLinks.Any(link => link.Item == item));
    if (favoriteGroup != null)
    {
        var link = favoriteGroup.ItemLinks.FirstOrDefault(l => l.Item == item);
        favoriteGroup.ItemLinks.Remove(link);
        if (favoriteGroup.ItemLinks.Count == 0)
        {
            favoritesRibbonPage.Groups.Remove(favoriteGroup);
        }
    }
}

private void SaveFavorites()
{
    // 즐겨찾기 상태를 설정 파일이나 애플리케이션 설정에 저장
}

private void LoadFavorites()
{
    // 설정 파일에서 즐겨찾기를 로드하고 즐겨찾기 RibbonPage에 항목을 추가
}
설명:
별표 아이콘 표시 및 위치: 별표 아이콘은 ButtonItem 옆에 배치되며, 사용자가 클릭할 때 즐겨찾기로 등록되거나 해제됩니다. 별표의 위치와 모양은 필요에 따라 커스텀할 수 있습니다.
즐겨찾기 저장 방법: 즐겨찾기 상태는 애플리케이션 설정이나 JSON, XML 같은 외부 파일에 저장하여 프로그램을 다시 시작해도 유지되도록 합니다.