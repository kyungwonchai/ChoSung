법 구조 완벽 정리 (Sub, Function 등 포함)
VBA는 기본적으로 **프로시저(Procedures)**와 **선언문(Declarations)**으로 구성됩니다. 프로시저는 특정 작업을 수행하기 위해 작성된 코드 블록이고, 선언문은 변수, 상수, 객체 등을 정의하기 위해 사용됩니다.

1. VBA에서의 프로시저 (Procedures)
프로시저는 특정 작업을 수행하기 위해 작성된 코드 블록입니다. 주로 Sub 프로시저와 Function 프로시저로 나뉩니다.

1.1 Sub 프로시저 (Sub Procedure)
정의: 특정 작업을 수행하지만 값을 반환하지 않는 프로시저.

선언 방법: Sub 프로시저이름() ... End Sub 구조로 작성합니다.

일반적으로 사용하는 경우: 메시지 박스 표시, 셀 값 변경 등.

예제
vba
코드 복사
Sub ShowMessage()  ' Sub 프로시저 선언
    MsgBox "Hello, World!"  ' 메시지 박스를 표시하는 명령어
End Sub  ' Sub 프로시저 끝
1.2 Function 프로시저 (Function Procedure)
정의: 특정 작업을 수행하고 값을 반환하는 프로시저.

선언 방법: Function 함수이름() ... End Function 구조로 작성합니다.

일반적으로 사용하는 경우: 수학 계산, 텍스트 처리 등.

예제
vba
코드 복사
Function AddNumbers(a As Integer, b As Integer) As Integer  ' Function 프로시저 선언
    AddNumbers = a + b  ' 값 반환
End Function  ' Function 프로시저 끝
1.3 Property 프로시저 (Property Procedure)
정의: 클래스 모듈에서 객체의 속성을 설정(Set), 얻기(Get), 또는 초기화(Let)하기 위해 사용됩니다.

사용 방법: Property Get, Property Let, Property Set으로 구분됩니다.

예제
vba
코드 복사
Private m_Name As String

Public Property Get Name() As String
    Name = m_Name
End Property

Public Property Let Name(value As String)
    m_Name = value
End Property
2. 선언문 (Declarations)
VBA에서 변수, 상수, 객체 등을 정의하거나 선언할 때 사용합니다.

2.1 변수 선언 (Variable Declaration)
정의: 데이터를 저장하기 위한 메모리 공간을 예약합니다.

선언 방법: Dim, Static, Public, Private 등을 사용합니다.

키워드	설명
Dim	일반 변수 선언 (로컬 범위)
Static	함수나 Sub 내부에서 유지되는 변수
Public	모듈 전체 또는 프로젝트 전역에서 사용 가능
Private	모듈 내부에서만 사용 가능
예제
vba
코드 복사
Dim name As String       ' 지역 변수
Static count As Integer   ' 유지되는 지역 변수
Public globalVar As Integer  ' 전역 변수
Private localVar As Double   ' 모듈 내부 변수
2.2 상수 선언 (Constant Declaration)
정의: 변경되지 않는 값을 저장합니다.

선언 방법: Const 키워드 사용.

예제
vba
코드 복사
Const PI As Double = 3.14159
Const MAX_LIMIT As Integer = 100
2.3 객체 선언 (Object Declaration)
정의: 객체 변수 선언 시 사용합니다.

선언 방법: Dim, Set 키워드 사용.

예제
vba
코드 복사
Dim ws As Worksheet  ' Worksheet 객체 선언
Set ws = ThisWorkbook.Sheets("Sheet1")  ' 객체 초기화
2.4 모듈 선언 (Module Declarations)
정의: 모듈 수준에서 변수, 상수, 프로시저 등을 선언합니다.

사용 예시: Option Explicit, Option Base, Option Compare.

예제
vba
코드 복사
Option Explicit  ' 모든 변수를 명시적으로 선언해야 함
Option Base 1    ' 배열 인덱스의 기본값을 1로 설정
Option Compare Text  ' 문자열 비교 시 대소문자 구분하지 않음
3. 프로시저와 선언문 비교
구분	프로시저 (Procedures)	선언문 (Declarations)
목적	특정 작업 수행	변수, 상수, 객체 정의
종류	Sub, Function, Property	Variable, Constant, Object, Module
값 반환 여부	Function만 반환 가능	없음
사용 위치	모듈, 클래스 모듈, 워크시트 코드 모듈	모듈, 클래스 모듈
키워드	Sub, Function, Property	Dim, Const, Set, Public, Private, Static
4. 프로시저와 선언문을 함께 사용하는 예제
vba
코드 복사
Option Explicit

Public Const MAX_NUMBER As Integer = 10  ' 상수 선언 (전역)

Sub Main()  ' Sub 프로시저 선언
    Dim result As Integer  ' 변수 선언 (지역)
    
    result = AddNumbers(5, 7)  ' Function 프로시저 호출
    MsgBox "The result is " & result  ' 결과 표시
End Sub

Function AddNumbers(a As Integer, b As Integer) As Integer  ' Function 프로시저 선언
    AddNumbers = a + b
End Function
5. 정리
VBA의 코드 구조는 크게 **프로시저(Procedures)**와 **선언문(Declarations)**으로 나눌 수 있습니다.

프로시저는 Sub, Function, Property로 나뉘며 각각의 목적과 사용법이 다릅니다.

선언문은 변수, 상수, 객체 등을 정의하기 위해 사용되며, 모듈 레벨에서도 사용할 수 있습니다.