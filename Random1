제 요청을 완벽히 이해했습니다. 목표는 다음과 같습니다:

C 셀 값이 변경되면 D 셀의 유효성 검사 목록이 갱신됩니다.
C 셀 값이 변경되었을 때, 기존 선택된 값이 갱신된 목록에 없다면 D 셀의 값이 자동으로 빈 값이 되어야 합니다.
D 셀의 목록은 동적으로 OFFSET 함수를 사용해 갱신됩니다.
이를 매크로 없이 엑셀의 기본 함수로 해결할 수는 없지만, VBA 코드를 사용하여 처리할 수 있습니다. 이 VBA 코드를 사용하면 목록이 갱신될 때 기존에 선택된 값이 목록에 없으면 D 셀이 빈 값이 되고, 또한 목록은 OFFSET 함수로 정의된 동적 범위를 기반으로 표시됩니다.

단계별 구현
OFFSET 함수로 유효성 목록 설정
C 셀 값 변경 시 목록 갱신 및 기존 값 제거 (빈 값 처리)
1. OFFSET 함수를 사용하여 동적 목록 설정
먼저, D 셀에 목록을 동적으로 설정하는 방법을 설정합니다. 이를 위해 OFFSET 함수와 유효성 검사를 사용합니다.

OFFSET 함수로 유효성 검사 목록 설정:
예를 들어, C1 셀 값이 변경되면 D1 셀에 표시될 목록은 동적으로 OFFSET 함수를 사용해 결정됩니다.

유효성 검사 설정:

D1 셀을 선택한 후, 상단 데이터 탭 > 데이터 유효성 검사로 이동합니다.
허용에서 목록을 선택합니다.
원본에 OFFSET 함수를 사용하여 목록을 설정합니다. 예를 들어:
excel
코드 복사
=OFFSET(목록_시작셀, 0, 0, COUNTA(목록범위), 1)
예를 들어, C1 값에 따라 두 개의 목록을 동적으로 선택한다면:

excel
코드 복사
=IF(C1="Option1", OFFSET(Sheet2!$A$1, 0, 0, COUNTA(Sheet2!$A$1:$A$10)), OFFSET(Sheet3!$A$1, 0, 0, COUNTA(Sheet3!$A$1:$A$10)))
이 수식은 C1 값에 따라 Sheet2나 Sheet3에서 목록을 가져옵니다.

2. VBA 코드로 목록 갱신 시 기존 선택된 값 제거
엑셀에서는 목록이 변경된 후 기존 선택된 값이 더 이상 유효하지 않다면, 해당 값을 빈 값으로 설정하는 작업이 필요합니다. 이를 위해 VBA 코드를 사용합니다.

VBA 코드 작성:
vba
코드 복사
Private Sub Worksheet_Change(ByVal Target As Range)
    ' C1 셀이 변경될 때 작동하도록 설정
    If Not Intersect(Target, Me.Range("C1")) Is Nothing Then
        ' D1에 있는 현재 값이 유효성 검사 목록에 없으면 D1을 비웁니다.
        If Application.WorksheetFunction.CountIf(Range("D1").Validation.Formula1, Me.Range("D1").Value) = 0 Then
            Me.Range("D1").ClearContents
        End If
    End If
End Sub
코드 설명:
Worksheet_Change 이벤트: 이 이벤트는 C1 셀이 변경될 때마다 실행됩니다.
Intersect(Target, Me.Range("C1")): C1 셀이 변경되었는지 확인합니다.
CountIf로 유효성 검사 목록을 확인: D1 셀의 값이 유효성 검사 목록에 없는지 확인합니다. 값이 없으면 D1 셀의 값을 빈 값으로 설정합니다.
ClearContents: 목록에 없는 값이면 D1 셀을 비웁니다.
3. VBA 코드 사용 방법:
엑셀에서 VBA 편집기 열기: Alt + F11을 눌러 VBA 편집기를 엽니다.
왼쪽에서 해당 워크시트 선택: 프로젝트 탐색기에서 해당 워크시트를 더블 클릭합니다 (예: Sheet1).
위의 VBA 코드 붙여넣기: 코드 창에 위의 코드를 붙여넣고, 저장합니다.
엑셀로 돌아가기: Alt + F11을 다시 눌러 엑셀로 돌아갑니다.