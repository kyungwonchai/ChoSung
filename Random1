먼저, MSSQL 테이블을 만들기 위한 스크립트입니다:

sql

CREATE TABLE [YourTableName]
(
    [ID] INT IDENTITY(1,1) PRIMARY KEY,
    [Content] NVARCHAR(MAX)
)

위 스크립트에서 [YourTableName]은 테이블 이름으로 원하시는 이름으로 대체해 주세요.

다음은 수정된 C# 코드 예시입니다:

csharp

using DevExpress.XtraRichEdit;
using System.Data;
using System.Data.SqlClient;
using System.IO;

// RichEditControl 생성
RichEditControl richEditControl1 = new RichEditControl();

// 데이터베이스 연결 문자열 설정
string connectionString = "YourConnectionString"; // 실제 연결 문자열로 대체해야 합니다.

// RichEditControl의 내용을 데이터베이스에 저장
SaveContentToDatabase(richEditControl1, connectionString);

// 데이터베이스에서 내용을 불러와서 RichEditControl에 표시
LoadContentFromDatabase(richEditControl1, connectionString);

// RichEditControl의 내용을 데이터베이스에 저장하는 함수
private void SaveContentToDatabase(RichEditControl richEditControl, string connectionString)
{
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();

        SqlCommand command = new SqlCommand("INSERT INTO YourTableName (Content) VALUES (@Content)", connection);
        command.Parameters.AddWithValue("@Content", richEditControl.Document.RtfText);
        command.ExecuteNonQuery();
    }
}

// 데이터베이스에서 내용을 불러와서 RichEditControl에 표시하는 함수
private void LoadContentFromDatabase(RichEditControl richEditControl, string connectionString)
{
    using (SqlConnection connection = new SqlConnection(connectionString))
    {
        connection.Open();

        SqlCommand command = new SqlCommand("SELECT Content FROM YourTableName ORDER BY ID DESC", connection);
        SqlDataReader reader = command.ExecuteReader();
        if (reader.Read())
        {
            string content = reader["Content"].ToString();
            richEditControl.Document.LoadText(content, DocumentFormat.Rtf);
        }

        reader.Close();
    }
}

위의 코드에서 SaveContentToDatabase 함수는 RichEditControl의 내용을 RTF 형식으로 변환하여 데이터베이스에 저장합니다. LoadContentFromDatabase 함수는 데이터베이스에서 내용을 가져와서 RTF 형식으로 변환하여 RichEditControl에 표시합니다.

실제 코드에서는 데이터베이스 연결 문자열을 적절하게 설정해야 합니다. 또한, [YourTableName]을 테이블 이름으로 대체해야 합니다.

이제 RichEditControl의 내용을 MSSQL 데이터베이스에 저장하고 불러올 수 있는 코드가 준비되었습니다. 필요에 따라 코드를 수정