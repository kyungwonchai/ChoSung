using System;
using System.Data;
using System.Data.SqlClient;

public void InsertNonDuplicateDataToDatabase(DataTable ttt)
{
    DataTable existingData = new DataTable();

    // 1. T_설계변경요약 테이블의 데이터 가져오기
    using (SqlConnection connection = new SqlConnection("your_connection_string_here"))
    {
        connection.Open();
        SqlDataAdapter adapter = new SqlDataAdapter("SELECT * FROM T_설계변경요약", connection);
        adapter.Fill(existingData);
    }

    // 2. 중복되지 않는 데이터만 새 DataTable에 저장
    DataTable nonDuplicateData = ttt.Clone();
    foreach (DataRow row in ttt.Rows)
    {
        bool isDuplicate = false;
        foreach (DataRow existingRow in existingData.Rows)
        {
            if (row["ColumnC"].ToString() == existingRow["ColumnC"].ToString()) // ColumnC를 기준으로 중복 확인
            {
                isDuplicate = true;
                break;
            }
        }
        if (!isDuplicate)
        {
            nonDuplicateData.ImportRow(row);
        }
    }

    // 3. 중복되지 않은 데이터를 T_설계변경요약 테이블에 벌크 인서트
    using (SqlConnection connection = new SqlConnection("your_connection_string_here"))
    {
        connection.Open();
        using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))
        {
            bulkCopy.DestinationTableName = "T_설계변경요약";
            bulkCopy.WriteToServer(nonDuplicateData);
        }
    }
}
