using System;
using System.Data;
using System.Data.SqlClient;

namespace UpdateDatabaseExample
{
    class Program
    {
        static void Main(string[] args)
        {
            string connectionString = "your_connection_string_here";
            string[] updateValues = new string[] { "value1", "value2", "value3", "value4" };
            int maxRows = 3;

            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();

                for (int i = 0; i < updateValues.Length; i++)
                {
                    if (i >= maxRows)
                    {
                        // 입력 행이 최대 행 수를 초과하면 무시
                        break;
                    }

                    string query = "UPDATE TableA SET B = @Value WHERE Line = @Line AND (SELECT COUNT(*) FROM TableA WHERE Line = @Line) = 1";

                    using (SqlCommand command = new SqlCommand(query, connection))
                    {
                        command.Parameters.Add(new SqlParameter("@Value", updateValues[i]));
                        command.Parameters.Add(new SqlParameter("@Line", i + 1));

                        int rowsAffected = command.ExecuteNonQuery();
                        if (rowsAffected == 0)
                        {
                            // 첫 번째 행이 업데이트되지 않으면 다음 행을 업데이트
                            query = "UPDATE TableA SET B = @Value WHERE Line = @Line AND (SELECT COUNT(*) FROM TableA WHERE Line = @Line) = 0";
                            command.CommandText = query;
                            command.ExecuteNonQuery();
                        }
                    }
                }

                connection.Close();
            }
        }
    }
}
