public MainWindow()
{
    InitializeComponent();
    
    // 이벤트 핸들러를 추가합니다.
    EventManager.RegisterClassHandler(typeof(DevExpress.Xpf.Grid.GridControl), UIElement.MouseRightButtonDownEvent, new MouseButtonEventHandler(OnGridControlRightClick));
}

private void OnGridControlRightClick(object sender, MouseButtonEventArgs e)
{
    if (sender is DevExpress.Xpf.Grid.GridControl gridControl)
    {
        if (gridControl.ContextMenu == null)
        {
            ContextMenu contextMenu = new ContextMenu();
            MenuItem exportMenuItem = new MenuItem { Header = "엑셀 내보내기" };
            exportMenuItem.Click += ExportToExcel_Click;
            contextMenu.Items.Add(exportMenuItem);
            gridControl.ContextMenu = contextMenu;
        }
    }
}

private void ExportToExcel_Click(object sender, RoutedEventArgs e)
{
    if (e.Source is MenuItem menuItem && menuItem.Parent is ContextMenu contextMenu && contextMenu.PlacementTarget is DevExpress.Xpf.Grid.GridControl gridControl)
    {
        SaveFileDialog saveFileDialog = new SaveFileDialog
        {
            Filter = "Excel Files (*.xlsx)|*.xlsx"
        };

        if (saveFileDialog.ShowDialog() == true)
        {
            gridControl.View.ExportToXlsx(saveFileDialog.FileName);
        }
    }
}
