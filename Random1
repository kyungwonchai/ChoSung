제는 Streamlit에서 표를 한 세트당 3행으로 구성하고, **총 3세트(BCT/TCT/ACT 시리즈)**를 출력해야 합니다.

✅ 요구사항 정리
사용자가 라인(line1) 선택 시,
각 세트를 다음 순서로 표시 (3행 구성):
BCT → TCT → ACT
BCT2 → TCT2 → ACT2
BCT2BEST → TCT2BEST → ACT2BEST
각 세트마다 표 하나씩 (총 3개 표)
표 제목: CT1, CT2, CT2Best
열 헤더: MC1 ~ MC8
✅ 구현 화면 예시
csharp
코드 복사
[CT1]
구분     MC1 ~ MC8  
---------------------
BCT1     ...
TCT1     ...
ACT1     ...

[CT2]
BCT2     ...
TCT2     ...
ACT2     ...

[CT2Best]
BCT2BEST ...
TCT2BEST ...
ACT2BEST ...
✅ Streamlit 전체 코드 (한글 설명 + 영어 주석)
python
코드 복사
import streamlit as st
import pymssql
import pandas as pd

# 📌 MSSQL 연결 정보
DB_CONFIG = {
    "server": "your_server",
    "user": "your_user",
    "password": "your_password",
    "database": "your_database"
}

# 📌 라인 목록을 조회하는 함수
def get_lines():
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor()
    cursor.execute("SELECT DISTINCT line1 FROM ExcelData ORDER BY line1")
    lines = [row[0] for row in cursor.fetchall()]
    conn.close()
    return lines

# 📌 선택한 라인의 최신 모델 1개 데이터를 가져오는 함수
def get_latest_data_by_line(line1):
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor(as_dict=True)
    
    cursor.execute("""
        SELECT TOP 1 * FROM ExcelData
        WHERE line1 = %s
        ORDER BY time1 DESC
    """, (line1,))
    data = cursor.fetchone()
    
    conn.close()
    return data

# 📌 Streamlit UI 시작
st.title("라인별 CT 데이터 조회")

# 📌 좌측 라인 선택
lines = get_lines()
selected_line = st.sidebar.selectbox("라인 선택", lines)

if selected_line:
    row = get_latest_data_by_line(selected_line)

    if row:
        # 📌 공통 헤더 정의
        headers = ["MC1", "MC2", "MC3", "MC4", "MC5", "MC6", "MC7", "MC8"]

        # 📌 세트 생성 함수
        def make_ct_table(title, prefix_b, prefix_t, prefix_a):
            # Create data as list of rows: [BCT, TCT, ACT]
            data = [
                [row[f"{prefix_b}_{i}"] for i in range(1, 9)],
                [row[f"{prefix_t}_{i}"] for i in range(1, 9)],
                [row[f"{prefix_a}_{i}"] for i in range(1, 9)]
            ]
            df = pd.DataFrame(data, columns=headers)
            df.insert(0, "Category", [prefix_b, prefix_t, prefix_a])  # Add row labels
            st.subheader(title)
            st.table(df)

        # 📌 CT1: BCT1, TCT1, ACT1
        make_ct_table("CT1", "BCT1", "TCT1", "ACT1")

        # 📌 CT2: BCT2, TCT2, ACT2
        make_ct_table("CT2", "BCT2", "TCT2", "ACT2")

        # 📌 CT2Best: BCT2BEST, TCT2BEST, ACT2BEST
        make_ct_table("CT2Best", "BCT2BEST", "TCT2BEST", "ACT2BEST")

    else:
        st.warning("선택한 라인의 데이터가 없습니다.")
✅ 사용법
위 코드 복사 후 app.py 파일에 저장
아래 명령으로 실행
bash
코드 복사
pip install streamlit pymssql pandas
streamlit run app.py
웹에서 http://localhost:8501 접속
✅ 결과
라인 선택 시 → 최신 1개 데이터 기반으로
3개의 표 (CT1, CT2, CT2Best)가 3행(B/T/A)으로 각각 출력됨