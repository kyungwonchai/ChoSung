리보기와 프린터 설정 상태를 보여주는 두 가지 기능으로 나누어서 구현하겠습니다.

    인쇄미리보기 버튼을 누르면 현재 인쇄 전 미리보기를 Panel2에 보여주는 기능:

csharp

using System.Drawing;
using System.Drawing.Printing;
using System.Windows.Forms;

// ...

private void btnPrintPreview_Click(object sender, EventArgs e)
{
    // PrintDocument 생성
    PrintDocument printDocument = new PrintDocument();
    printDocument.PrintPage += PrintDocument_PrintPage;

    // 미리보기를 위한 PrintPreviewDialog 생성
    using (PrintPreviewDialog previewDialog = new PrintPreviewDialog())
    {
        // PrintDocument를 PrintPreviewDialog에 설정
        previewDialog.Document = printDocument;
        // 미리보기를 Panel2에 표시하기 위해 대화상자의 Owner를 설정
        previewDialog.Owner = this;

        // 미리보기 화면 표시
        previewDialog.ShowDialog();
    }
}

private void PrintDocument_PrintPage(object sender, PrintPageEventArgs e)
{
    // 인쇄할 내용을 Panel1에서 이미지로 생성
    Bitmap previewImage = SavePanelAsImage(panel1);

    // 미리보기 이미지를 인쇄할 위치로 그리기
    e.Graphics.DrawImage(previewImage, e.MarginBounds);
}

private Bitmap SavePanelAsImage(Panel panel)
{
    // Panel 컨트롤의 크기만큼의 비트맵 생성
    Bitmap bitmap = new Bitmap(panel.Width, panel.Height);

    // Panel의 내용을 비트맵에 그리기
    panel.DrawToBitmap(bitmap, new Rectangle(0, 0, panel.Width, panel.Height));

    return bitmap;
}

    현재 상태 버튼을 누르면 현재 프린터 설정 상태를 보여주는 기능:

csharp

private void btnPrinterStatus_Click(object sender, EventArgs e)
{
    // 프린터 설정 상태를 보여줄 PrintDialog 생성
    using (PrintDialog printDialog = new PrintDialog())
    {
        // 현재 선택된 프린터 설정을 가져옴
        PrinterSettings printerSettings = printDialog.PrinterSettings;

        // 프린터 설정 상태를 Panel2에 보여주기 위한 TextBox 생성
        TextBox textBox = new TextBox();
        textBox.Multiline = true;
        textBox.ReadOnly = true;
        textBox.ScrollBars = ScrollBars.Both;
        textBox.Width = panel2.ClientSize.Width;
        textBox.Height = panel2.ClientSize.Height;
        textBox.Text = GetPrinterStatusAsString(printerSettings); // 프린터 설정 정보를 문자열로 변환하여 TextBox에 표시

        // TextBox를 Panel2에 추가
        panel2.Controls.Clear();
        panel2.Controls.Add(textBox);
    }
}

private string GetPrinterStatusAsString(PrinterSettings printerSettings)
{
    // 프린터 설정 정보를 문자열로 변환하여 반환하는 메서드 (여기에서는 간단히 프린터 이름만 반환)
    return "Printer Name: " + printerSettings.PrinterName;
}

위의 코드를 사용하여 미리보기 버튼을 누르면 Panel2에 현재 인쇄 전 미리보기가 표시되며, 현재 상태 버튼을 누르면 Panel2