라는 시트에 기록하는 VBA 매크로 코드입니다.

이 코드에서는 각 시트에서 정보를 가져와 전체data 시트에 순차적으로 누적 기록합니다.

엑셀에서 ALT + F11을 눌러 VBA 편집기를 엽니다.
Insert > Module을 선택하여 새 모듈을 추가합니다.
아래 코드를 붙여넣고 실행합니다.
vba
코드 복사
Sub CollectDataToMasterSheet()
    Dim ws As Worksheet
    Dim masterSheet As Worksheet
    Dim lastRow As Long
    Dim dateValue As String
    Dim regionValue As String
    Dim categoryValue As String
    Dim measureTypeValue As String
    Dim formattedString As String

    ' "전체data" 시트를 찾거나 없으면 새로 만듦
    On Error Resume Next
    Set masterSheet = ThisWorkbook.Worksheets("전체data")
    On Error GoTo 0
    If masterSheet Is Nothing Then
        Set masterSheet = ThisWorkbook.Worksheets.Add
        masterSheet.Name = "전체data"
    End If
    
    ' "전체data" 시트 초기화
    masterSheet.Cells.Clear
    masterSheet.Cells(1, 1).Value = "날짜"
    masterSheet.Cells(1, 2).Value = "구역"
    masterSheet.Cells(1, 3).Value = "구분"
    masterSheet.Cells(1, 4).Value = "측정값구분"
    masterSheet.Cells(1, 5).Value = "포맷결과"

    ' 모든 시트를 순회
    For Each ws In ThisWorkbook.Worksheets
        ' "전체data" 시트는 건너뜀
        If ws.Name <> "전체data" Then
            ' 2행에 있는 값을 가져옴
            dateValue = ws.Cells(2, 1).Value ' 날짜
            regionValue = ws.Cells(2, 2).Value ' 구역
            categoryValue = ws.Cells(2, 3).Value ' 구분
            measureTypeValue = ws.Cells(2, 4).Value ' 측정값구분

            ' 각 정보를 하나의 포맷으로 조합
            formattedString = dateValue & " - " & regionValue & " - " & categoryValue & " - " & measureTypeValue
            
            ' "전체data" 시트의 마지막 행을 찾고 데이터를 추가
            lastRow = masterSheet.Cells(masterSheet.Rows.Count, 1).End(xlUp).Row + 1
            masterSheet.Cells(lastRow, 1).Value = dateValue
            masterSheet.Cells(lastRow, 2).Value = regionValue
            masterSheet.Cells(lastRow, 3).Value = categoryValue
            masterSheet.Cells(lastRow, 4).Value = measureTypeValue
            masterSheet.Cells(lastRow, 5).Value = formattedString
        End If
    Next ws
    
    MsgBox "모든 시트의 데이터를 '전체data' 시트에 추가했습니다.", vbInformation
End Sub
코드 설명
"전체data" 시트를 찾아서 설정하거나, 시트가 없으면 새로 생성합니다.
"전체data" 시트의 기존 내용을 지우고 헤더(날짜, 구역, 구분, 측정값구분, 포맷결과)를 추가합니다.
각 시트를 순회하며 "전체data" 시트는 건너뜁니다.
2행에서 A, B, C, D 열의 값을 각각 dateValue, regionValue, categoryValue, measureTypeValue 변수에 가져옵니다.
이 네 가지 정보를 조합하여 formattedString 변수를 만듭니다.