ê°’ì´ ì»¬ëŸ¼ í—¤ë”ë¡œ ë‚˜ì˜¤ëŠ” ì´ìœ ëŠ” fetch_main_data() í•¨ìˆ˜ì—ì„œ ë°ì´í„°ë¥¼ ë°˜í™˜í•  ë•Œ, í…Œì´ë¸” êµ¬ì¡°ë¥¼ ì œëŒ€ë¡œ ì¡ì•„ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ë¡œë¶€í„° ê°€ì ¸ì˜¨ ë°ì´í„°ì™€ ì»¬ëŸ¼ ì´ë¦„ì„ ë¶„ë¦¬í•˜ì—¬ ì˜¬ë°”ë¥´ê²Œ ì¶œë ¥í•˜ë„ë¡ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.

âœ… ìˆ˜ì •ëœ ì½”ë“œ (Cursor ë°©ì‹)
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    
    # ì»¬ëŸ¼ ì´ë¦„ì„ ë¨¼ì € ê°€ì ¸ì˜¤ê¸°
    columns = [desc[0] for desc in cursor.description]  
    
    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    rows = cursor.fetchall()
    conn.close()
    
    return rows, columns

# í…Œì´ë¸”ì—ì„œ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ëŠ” HTML ìŠ¤íƒ€ì¼ í•¨ìˆ˜
def generate_html_table(data, columns):
    html = "<table border='1' style='width:100%; border-collapse: collapse;'>"
    html += "<thead><tr>"
    for col in columns:
        html += f"<th>{col}</th>"
    html += "</tr></thead><tbody>"

    act2_columns = [f'act2_{i}' for i in range(1, 9)]

    # ë°ì´í„° ë Œë”ë§
    for row in data:
        html += "<tr>"
        # act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸°
        act2_values = {col: row[idx] for idx, col in enumerate(columns) if col in act2_columns}
        max_value = max(act2_values.values())
        
        for idx, value in enumerate(row):
            column_name = columns[idx]
            if column_name in act2_columns and value == max_value:
                html += f"<td style='background-color: yellow;'>{value}</td>"
            else:
                html += f"<td>{value}</td>"
        html += "</tr>"

    html += "</tbody></table>"
    return html

# Streamlit ì•± êµ¬ì„±
def main():
    st.set_page_config(layout="wide")
    st.title("Ranked Data Table - act2_1 ~ act2_8 Highlighting (Cursor ë°©ì‹)")

    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    data, columns = fetch_main_data()
    
    st.subheader("act2_1 ~ act2_8 ë°ì´í„° í…Œì´ë¸”")
    
    # HTML í…Œì´ë¸” ìƒì„± ë° í‘œì‹œ
    html_table = generate_html_table(data, columns)
    st.markdown(html_table, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
ğŸ“Œ ì½”ë“œ ìˆ˜ì • ë‚´ìš©
fetch_main_data() í•¨ìˆ˜ ìˆ˜ì •

cursor.fetchall()ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°.

cursor.descriptionì„ ì‚¬ìš©í•˜ì—¬ ì»¬ëŸ¼ ì´ë¦„ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê¸°.

ë°ì´í„°ë¥¼ rowsë¡œ ë°˜í™˜í•˜ê³ , ì»¬ëŸ¼ ì´ë¦„ì„ columnsë¡œ ë°˜í™˜.

generate_html_table() í•¨ìˆ˜ ìˆ˜ì •

ë°ì´í„° (data)ëŠ” ì´ì œ ë¦¬ìŠ¤íŠ¸ì˜ ë¦¬ìŠ¤íŠ¸ í˜•íƒœë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.

ì»¬ëŸ¼ ì´ë¦„ì„ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±í•˜ê³  HTMLë¡œ í‘œì‹œí•©ë‹ˆë‹¤.

act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•©ë‹ˆë‹¤.

ğŸ“Œ ì„¤ì¹˜ í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql
ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬
streamlit run your_script_name.py
ğŸ’¡ ê²°ê³¼ í™”ë©´ ì„¤ëª…
ë°ì´í„°ëŠ” rowsë¡œ ê°€ì ¸ì˜¤ë©°, ì—´ ì´ë¦„ì€ columnsë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

ê° í–‰ë§ˆë‹¤ act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•©ë‹ˆë‹¤.

ë°ì´í„°ê°€ HTML í‘œë¡œ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë©ë‹ˆë‹¤.