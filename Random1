이렇게 하면 DataGrid와 텍스트 박스가 같은 탭 안에 배치되며, 더 빠르고 효율적으로 메모를 조회할 수 있습니다.

MainWindow.xaml
MainWindow.xaml을 아래와 같이 수정하여 레이아웃을 조정하겠습니다.

xml
코드 복사
<Window x:Class="AutoMemo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="AutoMemo" Height="450" Width="800">
    <Grid>
        <TabControl>
            <TabItem Header="Clipboard">
                <Grid>
                    <TextBox Name="clipboardTextBox" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" />
                </Grid>
            </TabItem>
            <TabItem Header="Saved Memos">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Width="200">
                        <Button Name="btnLast5Days" Content="Last 5 Days" Click="btnLast5Days_Click" Margin="5"/>
                        <Button Name="btnAll" Content="All" Click="btnAll_Click" Margin="5"/>
                        <DataGrid Name="memoDataGrid" AutoGenerateColumns="False" SelectionChanged="memoDataGrid_SelectionChanged" Margin="5">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Record Time" Binding="{Binding RecordTime}" Width="*" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                    <TextBox Name="memoDetailsTextBox" Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="5"/>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
MainWindow.xaml.cs
MainWindow.xaml.cs 코드는 이전과 동일하게 유지하되, 레이아웃을 변경한 부분에 맞게 설명을 추가합니다.

csharp
코드 복사
using System;
using System.Data.SqlClient;
using System.Windows;

namespace AutoMemo
{
    public partial class MainWindow : Window
    {
        private string connectionString = "Server=your_server;Database=AutoMemoDB;User Id=your_username;Password=your_password;";

        public MainWindow()
        {
            InitializeComponent();
            ProcessClipboardContent();
        }

        private void ProcessClipboardContent()
        {
            if (Clipboard.ContainsText())
            {
                string clipboardText = Clipboard.GetText();
                clipboardTextBox.Text = clipboardText;
                SaveMemoToDatabase(clipboardText);
            }
        }

        private void SaveMemoToDatabase(string memoText)
        {
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                string query = "INSERT INTO T_AutoMemo (MemoText, RecordTime) VALUES (@MemoText, @RecordTime)";
                SqlCommand cmd = new SqlCommand(query, conn);
                cmd.Parameters.AddWithValue("@MemoText", memoText);
                cmd.Parameters.AddWithValue("@RecordTime", DateTime.Now);

                conn.Open();
                cmd.ExecuteNonQuery();
            }
        }

        private void btnLast5Days_Click(object sender, RoutedEventArgs e)
        {
            LoadMemos(DateTime.Now.AddDays(-5));
        }

        private void btnAll_Click(object sender, RoutedEventArgs e)
        {
            LoadMemos(null);
        }

        private void LoadMemos(DateTime? fromDate)
        {
            memoDataGrid.Items.Clear();
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                string query = "SELECT Id, MemoText, RecordTime FROM T_AutoMemo";
                if (fromDate.HasValue)
                {
                    query += " WHERE RecordTime >= @FromDate";
                }

                SqlCommand cmd = new SqlCommand(query, conn);
                if (fromDate.HasValue)
                {
                    cmd.Parameters.AddWithValue("@FromDate", fromDate.Value);
                }

                conn.Open();
                SqlDataReader reader = cmd.ExecuteReader();
                while (reader.Read())
                {
                    memoDataGrid.Items.Add(new MemoItem
                    {
                        Id = reader.GetInt32(0),
                        MemoText = reader.GetString(1),
                        RecordTime = reader.GetDateTime(2)
                    });
                }
            }
        }

        private void memoDataGrid_SelectionChanged(object sender, System.Windows.Controls.SelectionChangedEventArgs e)
        {
            if (memoDataGrid.SelectedItem != null)
            {
                MemoItem selectedMemo = memoDataGrid.SelectedItem as MemoItem;
                memoDetailsTextBox.Text = selectedMemo.MemoText;
            }
        }

        public class MemoItem
        {
            public int Id { get; set; }
            public string MemoText { get; set; }
            public DateTime RecordTime { get; set; }

            public override string ToString()
            {
                return $"{RecordTime}: {MemoText}";
            }
        }
    }
}
주요 기능
프로그램 실행 시 클립보드 내용 로드 및 저장: 프로그램이 시작되면 클립보드 내용을 가져와서 텍스트 박스에 표시하고 데이터베이스에 저장합니다.
메모 목록 로드: 버튼 클릭 이벤트를 통해 최근 5일간의 메모와 모든 메모를 로드합니다. DataGrid에 시간값만 표시합니다