완전히 이해했습니다! 원하는 방식은 RAW 시트의 A열에서 데이터가 끊어진 부분을 찾아, 그 이후의 데이터 블록에서 B열 값을 가져오되, 끊어진 부분의 다음 행부터 시작하는 것입니다. 즉, 첫 번째로 데이터가 끊어진 다음 행부터 데이터를 추출하고, 중복된 값을 제거해야 합니다.

이를 해결하려면, MATCH 함수로 찾은 위치에서 +1을 추가하여, 끊어진 부분의 다음 행부터 데이터를 가져오게 해야 합니다.

최종 수식:
excel
코드 복사
=UNIQUE(FILTER(RAW!B:B, (ROW(RAW!A:A) > (MATCH(TRUE, INDEX((RAW!A:A=""), 0), 0) + 1)) * (RAW!A:A <> "") * (RAW!B:B <> 0)))
수식 설명:
MATCH(TRUE, INDEX((RAW!A:A=""), 0), 0):
A열에서 첫 번째로 빈 셀이 나타나는 위치를 찾습니다. 즉, 데이터가 끊어진 부분을 찾습니다.
(MATCH(...) + 1):
MATCH로 찾은 빈 셀의 다음 행부터 값을 가져오기 위해 +1을 사용하여 그다음 행부터 데이터를 추출합니다.
ROW(RAW!A:A) > (MATCH(...) + 1):
A열에서 찾은 위치의 다음 행부터 B열 데이터를 추출할 수 있도록 합니다.
RAW!A:A <> "":
A열에서 빈 셀이 아닌 행만 선택합니다.
RAW!B:B <> 0:
B열에서 0이 아닌 값들만 필터링합니다.
FILTER(..., ...):
조건에 맞는 값들을 필터링합니다.
UNIQUE(...):
필터링된 값들 중 중복된 값을 제거하여 고유한 값만 반환합니다.
수식의 동작:
RAW 시트 A열에서 첫 번째로 데이터가 끊어진 빈 셀을 찾은 다음, 그 다음 행부터 B열 값을 추출합니다.
0이 아닌 값들만 가져오고, 중복된 값은 제거합니다.
예시:
RAW 시트 데이터 예시:
A열 데이터:

A1: 데이터1
A2: 데이터2
A3: (빈 셀)
A4: 데이터3
A5: 데이터4
A6: (빈 셀)
B열 데이터 (이에 해당하는 값들):

B1: 1
B2: 2
B4: 3
B5: 4