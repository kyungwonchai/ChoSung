using System;
using System.Drawing;
using System.Windows.Forms;
using DevExpress.XtraGrid.Views.Grid;

namespace DevExpressProgressBarExample
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            // Sample 데이터를 GridControl에 바인딩
            gridControl1.DataSource = GetSampleData();
        }

        private void gridView1_CustomDrawCell(object sender, DevExpress.XtraGrid.Views.Base.RowCellCustomDrawEventArgs e)
        {
            // Rate 컬럼의 인덱스를 가져옴
            int rateColumnIndex = gridView1.Columns["Rate"].VisibleIndex;

            // Rate 컬럼이 아닌 경우 무시
            if (e.Column.VisibleIndex != rateColumnIndex)
                return;

            // ProgressBar의 값과 색상 설정
            int rate = Convert.ToInt32(e.CellValue);
            ProgressBarStyle progressBarStyle = ProgressBarStyle.Continuous;
            Color progressBarColor = Color.FromArgb(128, 255, 182, 193); // Carnation (반투명한 핑크색)

            // ProgressBar 그리기
            e.DefaultDraw();
            DrawProgressBar(e.Cache, e.Bounds, rate, progressBarStyle, progressBarColor);
            e.Handled = true;
        }

        private void DrawProgressBar(Graphics graphics, Rectangle bounds, int value, ProgressBarStyle style, Color color)
        {
            // ProgressBar 그리기
            DevExpress.XtraEditors.ViewInfo.ProgressBarViewInfo progressBarInfo = new DevExpress.XtraEditors.ViewInfo.ProgressBarViewInfo();
            progressBarInfo.Bounds = bounds;
            progressBarInfo.ProgressBarStyle = style;
            progressBarInfo.Progress = value;
            progressBarInfo.Appearance.ForeColor = color;

            DevExpress.XtraEditors.Drawing.ProgressBarPainter progressBarPainter = new DevExpress.XtraEditors.Drawing.ProgressBarPainter();
            progressBarPainter.DrawObject(progressBarInfo);

            // ProgressBar 표시
            graphics.DrawImage(progressBarInfo.Image, bounds.X, bounds.Y);
        }

        private System.Data.DataTable GetSampleData()
        {
            // Sample 데이터를 반환하는 메서드 (임의의 데이터로 예제를 구성합니다.)
            System.Data.DataTable table = new System.Data.DataTable();
            table.Columns.Add("ID", typeof(int));
            table.Columns.Add("Name", typeof(string));
            table.Columns.Add("Rate", typeof(int));

            table.Rows.Add(1, "Item 1", 75);
            table.Rows.Add(2, "Item 2", 50);
            table.Rows.Add(3, "Item 3", 90);
            //...

            return table;
        }
    }
}
