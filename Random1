히 맞게 자동으로 조정되도록 설정하겠습니다. DevExpress에서 이 기능을 구현하려면 BestFitColumns 메서드를 호출하여 각 컬럼이 내용에 정확히 맞는 폭을 갖도록 설정할 수 있습니다.

BestFitColumns는 코드 비하인드에서 호출해야 하므로, 데이터를 로드한 후 BestFitColumns을 적용하겠습니다.

수정된 C# 코드 (MainWindow.xaml.cs)
아래 코드에서는 Analyze_Click 이벤트 핸들러에서 데이터를 로드한 후 Sheet2Grid.BestFitColumns() 메서드를 호출하여 컬럼 폭을 글자 너비에 맞추어 조정합니다.

csharp
코드 복사
using DevExpress.Xpf.Grid;
using System;
using System.Collections.ObjectModel;
using System.IO;
using System.Text.RegularExpressions;
using System.Windows;
using System.Windows.Forms;
using System.Linq;
using System.Collections.Generic;

namespace FileAnalysisApp
{
    public partial class MainWindow : Window
    {
        private string selectedFolderPath = @"c:\prod_file_logs";
        public ObservableCollection<LogEntry> Sheet2Entries { get; set; } = new ObservableCollection<LogEntry>();

        public MainWindow()
        {
            InitializeComponent();
            Sheet2Grid.ItemsSource = Sheet2Entries;
        }

        private void SelectFolder_Click(object sender, RoutedEventArgs e)
        {
            using (var dialog = new FolderBrowserDialog())
            {
                dialog.SelectedPath = selectedFolderPath;
                if (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)
                {
                    selectedFolderPath = dialog.SelectedPath;
                    SelectedFolderText.Text = selectedFolderPath;
                }
            }
        }

        private void Analyze_Click(object sender, RoutedEventArgs e)
        {
            if (string.IsNullOrEmpty(selectedFolderPath))
            {
                System.Windows.MessageBox.Show("Please select a folder first.");
                return;
            }

            Sheet2Entries.Clear();
            AnalyzeFiles(selectedFolderPath);

            // 컬럼 폭을 데이터에 맞게 자동 조정
            Sheet2Grid.BestFitColumns();
        }

        private void AnalyzeFiles(string folderPath)
        {
            var threeDaysAgo = DateTime.Now.AddDays(-3);
            var responseTracker = new Dictionary<string, string>();
            var sheet2Data = new List<LogEntry>();

            var timePattern = new Regex(@"\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d{3}");
            var keyPattern = new Regex(@"고유키:[^\s]+");
            var sendPattern = new Regex(@"보낸값:[^\s]+");
            var recvPattern = new Regex(@"받은값:[^\s]+");

            foreach (var filePath in Directory.GetFiles(folderPath, "*", SearchOption.AllDirectories))
            {
                var fileCreationTime = File.GetCreationTime(filePath);
                if (fileCreationTime < threeDaysAgo) continue;

                string fileName = Path.GetFileName(filePath);
                var lines = File.ReadAllLines(filePath);
                if (fileName.Contains("DetailCMD"))
                {
                    for (int i = 0; i < lines.Length - 1; i++)
                    {
                        var sendMatch = sendPattern.Match(lines[i]);
                        var recvMatch = recvPattern.Match(lines[i + 1]);

                        if (sendMatch.Success && recvMatch.Success)
                        {
                            var timeMatch = timePattern.Match(lines[i]);
                            var keyMatch = keyPattern.Match(lines[i]);
                            if (timeMatch.Success && keyMatch.Success)
                            {
                                string timeStr = timeMatch.Value;
                                string uniqueKey = keyMatch.Value.Split(':')[1];
                                string sendValue = sendMatch.Value.Split(':')[1];
                                string recvValue = recvMatch.Value.Split(':')[1];
                                string combinedKey = $"{sendValue}_{recvValue}";

                                DateTime time = DateTime.ParseExact(timeStr, "yyyy-MM-dd HH:mm:ss.fff", null);
                                string formattedTime = time.ToString("yyMMdd HHmmss");

                                // CCC 컬럼 값 설정
                                string cccValue = string.Empty;
                                if (sendValue.Contains("RC")) cccValue = "RC";
                                else if (sendValue.Contains("WDD")) cccValue = "WDD";
                                else if (sendValue.Contains("WDD2300")) cccValue = "WD2300";

                                if (sendValue.Contains("WD") || combinedKey.Length <= 50)
                                {
                                    if (sendValue.Contains("WD") || !responseTracker.ContainsKey(sendValue) || responseTracker[sendValue] != recvValue)
                                    {
                                        responseTracker[sendValue] = recvValue;
                                        sheet2Data.Add(new LogEntry
                                        {
                                            Filename = fileName,
                                            Time = formattedTime,
                                            UniqueKey = uniqueKey,
                                            SentValue = sendValue,
                                            ReceivedValue = recvValue,
                                            LengthOrRemainingData = combinedKey.Length <= 50 ? recvValue.Length.ToString() : "WD",
                                            CCC = cccValue
                                        });
                                    }
                                }
                            }
                            i++;
                        }
                    }
                }
                else
                {
                    foreach (var line in lines)
                    {
                        var timeMatch = timePattern.Match(line);
                        if (timeMatch.Success)
                        {
                            string timeStr = timeMatch.Value;
                            DateTime time = DateTime.ParseExact(timeStr, "yyyy-MM-dd HH:mm:ss.fff", null);
                            string formattedTime = time.ToString("yyMMdd HHmmss");
                            string remainingData = line.Substring(timeMatch.Length).Trim();

                            sheet2Data.Add(new LogEntry
                            {
                                Filename = fileName,
                                Time = formattedTime,
                                LengthOrRemainingData = remainingData
                            });
                        }
                    }
                }
            }

            foreach (var entry in sheet2Data.OrderBy(e => e.Time))
                Sheet2Entries.Add(entry);
        }
    }

    public class LogEntry
    {
        public string Filename { get; set; }
        public string Time { get; set; }
        public string UniqueKey { get; set; }
        public string SentValue { get; set; }
        public string ReceivedValue { get; set; }
        public string LengthOrRemainingData { get; set; }
        public string CCC { get; set; }
    }
}
코드 설명