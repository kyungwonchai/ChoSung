from docx2pdf import convert
from PIL import Image

# 워드 문서 파일 경로
docx_file_path = 'path/to/word_document.docx'

# 이미지 저장 디렉토리
output_dir = 'path/to/output_directory/'

# 워드 문서를 PDF로 변환
pdf_file_path = output_dir + 'converted_document.pdf'
convert(docx_file_path, pdf_file_path)

# PDF를 이미지로 변환
pdf_image = Image.open(pdf_file_path)
total_pages = pdf_image.n_frames

for page in range(total_pages):
    pdf_image.seek(page)
    page_image = pdf_image.convert('RGB')

    # 이미지 저장
    image_file_path = output_dir + f'page_{page + 1}.png'
    page_image.save(image_file_path)

# PDF 파일 삭제 (선택 사항)
# import os
# os.remove(pdf_file_path)
