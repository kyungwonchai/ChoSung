private async Task AttemptReconnect()
{
    for (int attempt = 1; attempt <= MaxReconnectAttempts; attempt++)
    {
        System.Diagnostics.Debug.WriteLine($"Reconnect attempt {attempt}/{MaxReconnectAttempts}");
        LogHelper.Instance.All_writeFile(LogHelper.Ltype.PLCComport, $"Reconnect attempt {attempt}/{MaxReconnectAttempts}");

        // 응답 받기
        var readTask = TryOpenComPortAsync(_currentPort);
        var readTimeoutTask = Task.Delay(TimeSpan.FromSeconds(1));

        // 두 작업 중 먼저 끝나는 것을 확인
        var readCompletedTask = await Task.WhenAny(readTask, readTimeoutTask);

        if (readCompletedTask == readTask)
        {
            // 응답을 정상적으로 받은 경우
            bool response = await readTask;
            if (response)
            {
                LogHelper.Instance.All_writeFile(LogHelper.Ltype.PLCComport, "Reconnect OK");
                _isConnected = true;
                return;
            }
        }
        else
        {
            // 타임아웃 발생 시
            System.Diagnostics.Debug.WriteLine("Timeout 발생 - 다음 시도 진행");
        }

        // 다음 시도로 넘어가기 전 대기 시간
        await Task.Delay(TimeSpan.FromSeconds(ReconnectInterval));
    }

    // 최대 시도 횟수를 모두 소진한 경우
    LogHelper.Instance.All_writeFile(LogHelper.Ltype.PLCComport, "Failed to reconnect to any COM port");
    _isConnected = false;