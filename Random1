문이에요!
MSSQL에서 최소값뿐만 아니라, 그 최소값이 나온 컬럼 이름까지 함께 출력하고 싶을 때는 VALUES에 컬럼 이름과 값을 같이 넣고, ORDER BY로 최소값을 찾아내는 방식으로 처리하면 됩니다.

예제: a~e에서 최소값과 그 컬럼 이름,
t~z에서 최소값과 그 컬럼 이름을 같이 출력

sql
코드 복사
SELECT 
    a, b, c, d, e,
    t, u, v, w, x, y, z,
    v1.MinValue AS min1,
    v1.ColName AS min1_col,
    v2.MinValue AS min2,
    v2.ColName AS min2_col
FROM 
    YourTable
CROSS APPLY (
    SELECT TOP 1 val AS MinValue, col AS ColName
    FROM (VALUES 
        (a, 'a'), 
        (b, 'b'), 
        (c, 'c'), 
        (d, 'd'), 
        (e, 'e')
    ) AS valueList(val, col)
    ORDER BY val ASC
) AS v1
CROSS APPLY (
    SELECT TOP 1 val AS MinValue, col AS ColName
    FROM (VALUES 
        (t, 't'), 
        (u, 'u'), 
        (v, 'v'), 
        (w, 'w'), 
        (x, 'x'), 
        (y, 'y'), 
        (z, 'z')
    ) AS valueList(val, col)
    ORDER BY val ASC
) AS v2;
결과 컬럼 예시:
a	b	c	d	e	...	min1	min1_col	min2	min2_col
5	2	9	3	6	...	2	b	1	t
필요하면 AS min1_b, AS min2_t 이런 식으로 컬럼명에 동적으로 붙이길 원할 수 있는데,
SQL에서는 컬럼명 동적 생성은 안 되고,
그건 프론트단이나 프로시저로 문자열 처리해야 해요.
그래도 min1, min1_col로 나누어 가져오면 이후 가공은 쉬워요.

원하면 나중에 동적으로 조립하는 방식도 도와줄게요!






나의 말:
아 그리고 최소구할때 0인값은 제외하고 구해야되 다시


ChatGPT의 말:
좋아요! 0인 값을 제외하고 최소값과 그 컬럼 이름을 같이 구하는 방법도 가능합니다.
VALUES 안에서 WHERE val <> 0처럼 필터링은 안 되기 때문에, CROSS APPLY 내부에서 WHERE을 추가하는 방식으로 처리해야 합니다.

최종 버전:
a~e 중 0을 제외한 최소값과 컬럼명 → min1, min1_col
t~z 중 0을 제외한 최소값과 컬럼명 → min2, min2_col

sql
코드 복사
SELECT 
    a, b, c, d, e,
    t, u, v, w, x, y, z,
    v1.MinValue AS min1,
    v1.ColName AS min1_col,
    v2.MinValue AS min2,
    v2.ColName AS min2_col
FROM 
    YourTable
CROSS APPLY (
    SELECT TOP 1 val AS MinValue, col AS ColName
    FROM (VALUES 
        (a, 'a'), 
        (b, 'b'), 
        (c, 'c'), 
        (d, 'd'), 
        (e, 'e')
    ) AS valueList(val, col)
    WHERE val <> 0
    ORDER BY val ASC
) AS v1
CROSS APPLY (
    SELECT TOP 1 val AS MinValue, col AS ColName
    FROM (VALUES 
        (t, 't'), 
        (u, 'u'), 
        (v, 'v'), 
        (w, 'w'), 
        (x, 'x'), 
        (y, 'y'), 
        (z, 'z')
    ) AS valueList(val, col)
    WHERE val <> 0
    ORDER BY val ASC
) AS v2;
결과 예시
a	b	c	d	e	...	min1	min1_col	min2	min2_col
0	3	0	5	2	...	2	e	1	t
a와 c는 0이므로 무시됨

min1은 2, 해당 컬럼은 e
