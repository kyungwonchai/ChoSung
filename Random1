WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER (PARTITION BY Pname ORDER BY Date1 DESC) AS RN
    FROM T2_ProjectDetail
)
DELETE FROM CTE WHERE RN > 3;
