SELECT A1.ipadd, 
       A1.모델 AS CurrentModel, 
       A2.모델 AS PreviousModel, 
       A1.기변로그_행시간값,
       A1.TB구분,
       A1.MS구분,
       A1.기변10장시간기록,
       A1.mysql전달시간
FROM (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY ipadd ORDER BY 기변로그_행시간값) AS rn
    FROM View_기변시간체크
) A1
LEFT JOIN (
    SELECT *, ROW_NUMBER() OVER (PARTITION BY ipadd ORDER BY 기변로그_행시간값) AS rn
    FROM View_기변시간체크
) A2 ON A1.ipadd = A2.ipadd AND A1.rn = A2.rn + 1
WHERE A1.모델 != A2.모델 AND A2.모델 IS NOT NULL;
