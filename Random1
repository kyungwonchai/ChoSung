ChatGPT
죄송합니다. 저의 이전 답변에서 실수가 있었습니다. Chrome 브라우저를 초기화한 후 모든 Chrome 인스턴스를 닫는 방법을 알려드리겠습니다.

csharp
Copy code
using System;
using System.Diagnostics;
using System.IO;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace ChromeOptimizationExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private async void btnOptimizeChrome_Click(object sender, EventArgs e)
        {
            btnOptimizeChrome.Enabled = false; // 버튼 비활성화

            try
            {
                await Task.Run(() =>
                {
                    // 캐시 삭제
                    Process.Start("chrome.exe", "--clear-cache");

                    // 초기화
                    string chromeUserDataDir = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData), @"Google\Chrome\User Data");
                    Process.Start("chrome.exe", $"--user-data-dir=\"{chromeUserDataDir}\" --restore-defaults");

                    // 모든 Chrome 인스턴스 닫기
                    CloseAllChromeProcesses();
                });

                MessageBox.Show("Chrome 브라우저 최적화가 완료되었습니다.");
            }
            catch (Exception ex)
            {
                MessageBox.Show($"Chrome 최적화 중 오류가 발생했습니다.\n\n{ex.Message}");
            }

            btnOptimizeChrome.Enabled = true; // 버튼 다시 활성화
        }

        private void CloseAllChromeProcesses()
        {
            Process[] chromeProcesses = Process.GetProcessesByName("chrome");

            foreach (Process process in chromeProcesses)
            {
                process.Kill();
                process.WaitForExit();
            }
        }
    }
}
위의 예시 코드에서 CloseAllChromeProcesses() 메서드는 현재 실행 중인 모든 Chrome 프로세스를 찾아서 종료합니다. 이렇게 하면 초기화한 Chrome 브라우저를 모두 닫을 수 있습니다.

btnOptimizeChrome_Click 이벤트 핸들러에서 CloseAllChromeProcesses() 메서드를 호출하여 Chrome 초기화 후 모든 Chrome 인스턴스를 닫도록 처리합니다.

초기화 및 Chrome 인스턴스 종료 작업은 비동기적으로 실행되며, 작업이 완료되면 "Chrome 브라우저 최적화가 완료되었습니다."라는 메시지 상자가 표시됩니다. 예외가 발생한 경우에는 오류 메시지가 표시됩니다.




