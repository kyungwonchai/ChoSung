using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

public partial class PythonFileOpener : Form
{
    private string folderPath = @"c:\aaaabbbb"; // 여기에 원하는 경로를 입력하세요.
    private string pyCharmPath = @"C:\Program Files\JetBrains\PyCharm Community Edition 2021.2.3\bin\pycharm64.exe"; // 여기에 실제 PyCharm 경로를 입력하세요.

    public PythonFileOpener()
    {
        InitializeComponent();
        PopulatePythonFiles();
    }

    private void PopulatePythonFiles()
    {
        string[] pythonFiles = Directory.GetFiles(folderPath, "*.py");
        foreach (var file in pythonFiles)
        {
            string fileName = Path.GetFileName(file);
            listBoxControl.Items.Add(fileName);
        }
    }

    private void listBoxControl_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (listBoxControl.SelectedItem != null)
        {
            string selectedFile = listBoxControl.SelectedItem.ToString();
            string filePath = Path.Combine(folderPath, selectedFile);

            // PyCharm으로 선택된 Python 파일을 엽니다.
            Process.Start(pyCharmPath, filePath);
        }
    }
}
