본 버튼 초기화 시, 지정된 스타일이 아닌 버튼은 초기 설정으로 복구되도록 함수를 수정하겠습니다. 이를 위해, InitializeButtons 함수에서 버튼 스타일을 체크하고, 즐겨찾기 상태에 따라 스타일을 적용하거나 초기화하는 로직을 추가합니다.

수정된 InitializeButtons 함수
csharp
코드 복사
private void InitializeButtons()
{
    // 모든 리본 버튼 초기화
    foreach (RibbonPage page in ribbonK.Pages)
    {
        foreach (RibbonPageGroup group in page.Groups)
        {
            foreach (BarItemLink link in group.ItemLinks)
            {
                if (link.Item is BarButtonItem button)
                {
                    // 즐겨찾기 키에 있는 버튼은 스타일 적용
                    if (favoriteKeys.Contains(button.Name))
                    {
                        ApplyFavoriteStyle(button); // 즐겨찾기 스타일 적용
                        AddToFavorites(button, GetButtonGroupName(button)); // 즐겨찾기 그룹에 추가
                    }
                    else
                    {
                        ResetButtonStyle(button); // 초기 스타일로 복구
                    }
                }
            }
        }
    }
}
주요 변경 사항
즐겨찾기 확인:

favoriteKeys.Contains(button.Name)로 버튼이 즐겨찾기 목록에 포함된 경우만 스타일 적용.
초기화 처리:

즐겨찾기 목록에 없는 버튼은 ResetButtonStyle 호출로 초기 스타일로 복구.
스타일 처리 분리:

ApplyFavoriteStyle: 즐겨찾기 스타일 적용.
ResetButtonStyle: 기본 스타일 복구.
ApplyFavoriteStyle 함수
csharp
코드 복사
private void ApplyFavoriteStyle(BarButtonItem button)
{
    // 즐겨찾기 스타일 적용 (예: 배경색, 테두리 색상 등)
    button.ItemAppearance.Normal.BackColor = FavoriteBackColor1;   // 연파랑
    button.ItemAppearance.Normal.BackColor2 = FavoriteBackColor2; // 파랑
    button.ItemAppearance.Normal.Options.UseBackColor = true;

    button.ItemAppearance.Normal.BorderColor = FavoriteBorderColor;
    button.ItemAppearance.Normal.Options.UseBorderColor = true;
}
ResetButtonStyle 함수
csharp
코드 복사
private void ResetButtonStyle(BarButtonItem button)
{
    // 버튼의 스타일 초기화 (기본 상태로 복구)
    button.ItemAppearance.Normal.BackColor = Color.Empty;
    button.ItemAppearance.Normal.BackColor2 = Color.Empty;
    button.ItemAppearance.Normal.Options.UseBackColor = false;

    button.ItemAppearance.Normal.BorderColor = Color.Empty;
    button.ItemAppearance.Normal.Options.UseBorderColor = false;
}
사용 예제
로그인 후 또는 데이터 변경 후 InitializeButtons를 호출하여 모든 버튼의 스타일을 갱신합니다:

csharp
코드 복사
private void Form_Load(object sender, EventArgs e)
{
    try
    {
        // 리본 버튼 초기화
        InitializeRibbonButtons();

        // 사용자 ID 설정 (로그인 상태에 따라 로드)
        SetCurrentUser(null); // 기본 로그아웃 상태

        // 버튼 초기화
        InitializeButtons();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] Form_Load: {ex.Message}");
    }
}
동작 흐름
리본 버튼 전체 확인:

모든 버튼을 순회하며, 즐겨찾기 여부 확인.
즐겨찾기 스타일 적용:

즐겨찾기 목록에 포함된 버튼에만 ApplyFavoriteStyle 호출.
기본 스타일 복구:

포함되지 않은 버튼은 ResetButtonStyle 호출로 초기 상태 복구.
결과
버튼이 즐겨찾기 목록에 있으면 지정된 스타일 적용.
즐겨찾기 목록에 없는 버튼은 기본 스타일로 복구.