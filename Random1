using Excel = Microsoft.Office.Interop.Excel;
using System.Drawing;

// ...

Excel.Application xlApp = new Excel.Application();
Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(@"경로\파일이름.xlsx");
Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
Excel.Range xlRange = xlWorksheet.UsedRange;

int rowCount = xlRange.Rows.Count;
int colCount = xlRange.Columns.Count;

for (int row = 1; row <= rowCount; row++)
{
    for (int col = 1; col <= colCount; col++)
    {
        Excel.Range cell = xlWorksheet.Cells[row, col];
        
        // 배경색상 얻기
        Color color = Color.FromArgb(cell.Interior.Color);
        
        // 16진수 문자열로 변환
        string hexColor = color.R.ToString("X2") + color.G.ToString("X2") + color.B.ToString("X2");
        
        // MSSQL에 저장하는 로직...
    }
}

// Clean up
xlWorkbook.Close(false);
xlApp.Quit();
