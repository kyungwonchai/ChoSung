using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;
using System.Text.RegularExpressions;

namespace ExcelToSQL
{
    class Program
    {
        static void Main(string[] args)
        {
            string filePath = @"C:\allfiles\11.xlsx";
            List<string> columns = new List<string>();
            int numbb = 1;

            Excel.Application xlApp = new Excel.Application();
            Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(filePath);
            Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
            Excel.Range xlRange = xlWorksheet.UsedRange;

            int rowCount = xlRange.Rows.Count;
            int colCount = xlRange.Columns.Count;

            // Getting Column Names
            for (int j = 1; j <= colCount; j++)
            {
                if (xlRange.Cells[2, j] != null && xlRange.Cells[2, j].Value2 != null)
                {
                    string value = xlRange.Cells[2, j].Value2.ToString();
                    string result = Regex.Replace(value, "pattern", "-");
                    string columnName = "C_" + result;

                    if (columnName.StartsWith("C_"))
                    {
                        columns.Add(columnName);
                    }
                }
            }

            // To be continued...
