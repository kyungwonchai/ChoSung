using DevExpress.XtraGrid.Views.Tile;
using System;
using System.Drawing;
using System.IO;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        string folderPath = @"C:\YourFolder";  // 바로가기 파일이 있는 폴더
        string[] shortcutFiles = Directory.GetFiles(folderPath, "*.lnk");

        foreach (var shortcut in shortcutFiles)
        {
            string shortcutTarget = GetShortcutTarget(shortcut);
            Icon icon = Icon.ExtractAssociatedIcon(shortcutTarget);

            TileViewItemElement nameElement = new TileViewItemElement();
            nameElement.Text = Path.GetFileNameWithoutExtension(shortcut);
            nameElement.ImageAlignment = TileItemContentAlignment.MiddleLeft;
            nameElement.TextAlignment = TileItemContentAlignment.MiddleRight;

            TileViewItemElement iconElement = new TileViewItemElement();
            iconElement.Image = icon.ToBitmap();
            iconElement.ImageAlignment = TileItemContentAlignment.MiddleCenter;

            TileViewItem item = tileView1.AddTileViewItem();
            item.Elements.Add(nameElement);
            item.Elements.Add(iconElement);
            item.Tag = shortcutTarget;  // 타일에 타겟 경로 저장
        }

        tileView1.ItemClick += TileView1_ItemClick;
    }

    [DllImport("shfolder.dll", CharSet = CharSet.Auto)]
    private static extern int SHGetShortcutTarget(string pszShortcut, out IntPtr ppszTarget);

    private static string GetShortcutTarget(string shortcutFilename)
    {
        SHGetShortcutTarget(shortcutFilename, out IntPtr pszTarget);
        if (pszTarget != IntPtr.Zero)
        {
            return Marshal.PtrToStringAuto(pszTarget);
        }
        return "";
    }

    private void TileView1_ItemClick(object sender, TileViewItemClickEventArgs e)
    {
        string path = (string)e.Item.Tag;
        System.Diagnostics.Process.Start("explorer.exe", path);
    }
}
