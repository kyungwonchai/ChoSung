import bpy
from math import radians

# 모든 오브젝트 삭제 - 초기화 작업
bpy.ops.object.select_all(action='SELECT')
bpy.ops.object.delete(use_global=False)

# 텍스트 오브젝트 추가
bpy.ops.object.text_add(location=(0, 0, 0))  # 텍스트 위치: 원점(0,0,0)
text_obj = bpy.context.object
text_obj.data.body = "Router ACR Middleware"  # 텍스트 내용 설정
text_obj.data.size = 3.0  # 텍스트 크기 설정 - 화면에 가득 차도록 큰 값으로 설정

# 3D 효과를 위한 두께와 모서리 둥글게 처리
text_obj.data.extrude = 0.3  # 텍스트의 두께를 줌
text_obj.data.bevel_depth = 0.03  # 모서리 부분을 부드럽게 설정

# 텍스트에 황금빛 재질 적용
mat = bpy.data.materials.new(name="TextMaterial")
mat.use_nodes = True  # 노드를 사용한 재질 생성
bsdf = mat.node_tree.nodes["Principled BSDF"]
bsdf.inputs['Base Color'].default_value = (1, 0.84, 0, 1)  # 황금색 계열
bsdf.inputs['Roughness'].default_value = 0.2  # 반사도 조정하여 황금 느낌 강화
text_obj.data.materials.append(mat)

# 카메라 추가 및 위치 조정
bpy.ops.object.camera_add(location=(0, -10, 3))  # 카메라를 텍스트 정면으로 배치
camera = bpy.context.object
camera.rotation_euler = (radians(90), 0, radians(0))  # 카메라를 텍스트 정면을 바라보게 회전

# 카메라 미세 조정
# 카메라 위치를 상하좌우로 조금씩 조정하며 텍스트가 화면에 꽉 차게
camera.location.x = 0      # 좌우로 이동 (양수 = 우측, 음수 = 좌측)
camera.location.y = -10    # 앞뒤로 이동 (음수로 두어 텍스트와 거리 조절)
camera.location.z = 2.5    # 상하 이동 (양수 = 위로, 음수 = 아래로)

# 광원 설정 - 텍스트에 황금 시간대 조명
bpy.ops.object.light_add(type='SUN', location=(5, -5, 10))  # 따뜻한 느낌의 광원 추가
sun_light = bpy.context.object
sun_light.data.energy = 5  # 조명의 세기
sun_light.data.color = (1, 0.75, 0.5)  # 따뜻한 황금빛
sun_light.rotation_euler = (radians(45), radians(-20), 0)  # 조명 각도 조정하여 텍스트에 그림자 생성

# 배경을 투명하게 설정
bpy.context.scene.render.film_transparent = True  # 투명 배경 설정

# 렌더링 설정
bpy.context.scene.render.engine = 'CYCLES'  # Cycles 렌더 엔진 사용
bpy.context.scene.cycles.samples = 500  # 고해상도 샘플 수
bpy.context.scene.render.resolution_x = 1920  # 가로 해상도
bpy.context.scene.render.resolution_y = 1080  # 세로 해상도
bpy.context.scene.render.image_settings.file_format = 'PNG'  # 파일 형식: PNG
bpy.context.scene.render.image_settings.color_mode = 'RGBA'  # 알파 채널 포함

# 파일 저장 경로 설정 (예: 바탕화면에 저장)
bpy.context.scene.render.filepath = "C:/Users/YourUsername/Desktop/router_acr_middleware_render.png"

# 렌더링 실행 - 파일 저장
bpy.ops.render.render(write_still=True)
