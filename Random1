using System;
using System.Windows.Forms;
using Microsoft.Web.WebView2.WinForms;

namespace WinFormsWebView2App
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
            this.KeyPress += new KeyPressEventHandler(Form_KeyPress);
        }

        private void Form_KeyPress(object sender, KeyPressEventArgs e)
        {
            if (ModifierKeys == Keys.Control)
            {
                if (e.KeyChar == 3) // 3은 Ctrl+C를 나타냅니다.
                {
                    webView21.ExecuteScriptAsync("window.getSelection().toString()").ContinueWith(task =>
                    {
                        if (task.Status == System.Threading.Tasks.TaskStatus.RanToCompletion)
                        {
                            string selectedText = task.Result.Replace("\"", ""); // 결과 문자열에서 따옴표 제거
                            Clipboard.SetText(selectedText);
                            MessageBox.Show("텍스트가 클립보드에 복사되었습니다.");
                        }
                    });
                }
            }
        }
    }
}
