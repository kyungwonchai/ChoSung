<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    xmlns:models="clr-namespace:LockerManagementApp.Models"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure"
    Title="ÏÇ¨Î¨ºÌï® Í¥ÄÎ¶¨ ÌîÑÎ°úÍ∑∏Îû® (DevExpress MVVM - .NET Framework 4.8)" Height="750" Width="1300"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"
    FontSize="14"
    >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <infra:HighlightCellConverter x:Key="HighlightCellConverter"/>

        <Style x:Key="LightBlueHeaderStyle" TargetType="dxg:BaseGridHeader"> <Setter Property="Background" Value="LightBlue"/> <Setter Property="HorizontalContentAlignment" Value="Center"/> <Setter Property="FontWeight" Value="Bold"/> <Setter Property="Foreground" Value="Black"/> </Style>
        <Style TargetType="dxg:GridColumnHeader" BasedOn="{StaticResource LightBlueHeaderStyle}"/>
        <Style TargetType="dxg:BandHeaderControl" BasedOn="{StaticResource LightBlueHeaderStyle}"/>

        <Style x:Key="HighlightCellStyle" TargetType="dxg:CellContentPresenter">
            <Setter Property="Background">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource HighlightCellConverter}">
                        <Binding Path="Value"/>
                        <Binding Path="Column.FieldName"/>
                        <Binding Path="View.DataContext.SelectedCellValue"/>
                        <Binding Path="View.DataContext.SelectedCellColumnFieldName"/>
                    </MultiBinding>
                </Setter.Value>
            </Setter>
        </Style>

    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="5">
                 <TextBlock Text="ÏùºÎ∞ò ÌÇ§:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                 <PasswordBox x:Name="NormalPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding NormalPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                 <Button Content="ÌôïÏù∏" Margin="5,0,15,0" Command="{Binding CheckNormalPasswordCommand}"/>

                <TextBlock Text="ÎßàÏä§ÌÑ∞ ÌÇ§:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Content="ÌôïÏù∏" Margin="5,0,0,0" Command="{Binding CheckMasterPasswordCommand}"/>
            </StackPanel>
            <Border Background="LightGray" Padding="5">
                 <StackPanel Orientation="Horizontal">
                    <Button Content="üîÑ ÏÉàÎ°úÍ≥†Ïπ®" Margin="3" Command="{Binding LoadDataCommand}"/>
                    <Button Content="üíæ Î≥ÄÍ≤Ω ÏÇ¨Ìï≠ Ï†ÄÏû•" Margin="3" Command="{Binding SaveChangesCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="‚öôÔ∏è ÎßàÏä§ÌÑ∞ Îç∞Ïù¥ÌÑ∞ Í¥ÄÎ¶¨" Margin="15,3,3,3" Command="{Binding OpenMasterDataWindowCommand}" ToolTip="ÎßàÏä§ÌÑ∞ Îç∞Ïù¥ÌÑ∞(Ï∏µ, Íµ¨Ïó≠ Îì±)Î•º Í¥ÄÎ¶¨ÌïòÎäî ÏÉà Ï∞ΩÏùÑ ÏóΩÎãàÎã§." Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="üîë ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω" Margin="5,3,3,3" Command="{Binding OpenPasswordChangeWindowCommand}" ToolTip="ÎßàÏä§ÌÑ∞ ÌÇ§ ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î≥ÄÍ≤ΩÌï©ÎãàÎã§." Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="üìú Î°úÍ∑∏ Î≥¥Í∏∞" Margin="5,3,3,3" Command="{Binding OpenLogWindowCommand}" ToolTip="Îç∞Ïù¥ÌÑ∞ Î≥ÄÍ≤Ω Ïù¥Î†• Î°úÍ∑∏Î•º ÌôïÏù∏Ìï©ÎãàÎã§."/>
                    <Button Content="üìÑ ÏóëÏÖÄ Ï†ÄÏû•" Margin="15,3,3,3" Click="ExportExcelButton_Click" ToolTip="ÌòÑÏû¨ Ìëú ÎÇ¥Ïö©ÏùÑ ÏóëÏÖÄ ÌååÏùºÎ°ú Ï†ÄÏû•Ìï©ÎãàÎã§."/>
                 </StackPanel>
            </Border>
        </DockPanel>

        <Grid Grid.Row="1" Margin="5">
            <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
            <Border Grid.Row="0" Background="WhiteSmoke" Padding="3">
                <StackPanel Orientation="Horizontal">
                    <Button Content="‚ûï ÏÉà ÏÇ¨Î¨ºÌï® Ï∂îÍ∞Ä" Margin="3" Command="{Binding AddNewCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="‚ùå ÏÑ†ÌÉù Ìï≠Î™© ÏÇ≠Ï†ú" Margin="3" Command="{Binding DeleteCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                </StackPanel>
            </Border>
            <dxg:GridControl Grid.Row="1" ItemsSource="{Binding LockerAssignments}" SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}"
                             CurrentItemChanged="GridControl_CurrentItemChanged"
                             CustomColumnSort="GridControl_CustomColumnSort">
                <dxg:GridControl.View>
                    <dxg:TableView x:Name="mainTableView" AllowPerPixelScrolling="True" ShowGroupPanel="True" AllowEditing="True"
                                   NavigationStyle="Cell" ShowAutoFilterRow="True" NewItemRowPosition="None"
                                   ShowIndicator="True" ShowSearchPanelMode="Always"
                                   FocusedColumnChanged="TableView_FocusedColumnChanged"
                                   UseLightweightTemplates="None">
                        <dxg:TableView.RowCellMenuCustomizations>
                            <dxb:BarItemSeparator/>
                            <dxb:BarButtonItem Content="Ìñâ ÏÇ≠Ï†ú" Command="{Binding View.DataContext.DeleteCommand}" Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/>
                        </dxg:TableView.RowCellMenuCustomizations>
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="LockerType" Header="Ï¢ÖÎ•ò" Width="100" Fixed="Left" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllLockerTypes}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Floor" Header="Ï∏µ" Width="60" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllFloors}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Zone" Header="Íµ¨Ïó≠" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllZones}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SpecificLocation" Header="ÏÑ∏Î∂Ä ÏúÑÏπò" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" SortMode="Custom">
                         <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings>
                    </dxg:GridColumn>
                    <dxg:GridColumn FieldName="UserName" Header="ÏÑ±Î™Ö" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SubPart" Header="ÏÜåÌååÌä∏" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllSubParts}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Administrator" Header="Í¥ÄÎ¶¨ Îã¥ÎãπÏûê" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllAdministrators}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="TransferStatus" Header="Ï†ÑÎ∞∞Î≥µÏßÅ" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Details" Header="ÎÇ¥Ïö©" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Remarks" Header="ÌäπÏù¥ÏÇ¨Ìï≠" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Notes" Header="ÎπÑÍ≥†" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="LastUpdated" Header="ÏµúÏ¢Ö ÏàòÏ†ïÏùºÏãú" Width="150" AllowEditing="False" ReadOnly="True" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
                </dxg:GridControl.Columns>
            </dxg:GridControl>
        </Grid>

        <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem><TextBlock Text="{Binding StatusBarText}" Margin="5,0"/></StatusBarItem> </StatusBar>
    </Grid>

</dx:ThemedWindow>
```

**ÌïµÏã¨ Î≥ÄÍ≤Ω ÏÇ¨Ìï≠:**

* **`<dxg:GridControl>`:** `CustomColumnSort="GridControl_CustomColumnSort"` Ïù¥Î≤§Ìä∏Î•º Ïó∞Í≤∞ÌñàÏäµÎãàÎã§.
* **`<dxg:GridColumn FieldName="SpecificLocation">`:** `SortMode="Custom"` ÏÜçÏÑ±ÏùÑ Ï∂îÍ∞ÄÌñàÏäµÎãàÎã§.