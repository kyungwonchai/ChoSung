using System;
using System.Data;
using System.Data.OleDb;

public DataTable ReadExcelToDataTable(string filePath)
{
    DataTable dt = new DataTable();

    string excelConnectionString = $"Provider=Microsoft.ACE.OLEDB.12.0;Data Source={filePath};Extended Properties=\"Excel 12.0;HDR=YES\";";

    using (OleDbConnection excelConnection = new OleDbConnection(excelConnectionString))
    {
        excelConnection.Open();

        // 원하는 컬럼명을 SELECT 문에서 지정
        OleDbCommand command = new OleDbCommand("SELECT [YourColumnName1], [YourColumnName2] FROM [Sheet1$]", excelConnection); // Sheet1은 워크시트 이름에 따라 변경

        OleDbDataAdapter adapter = new OleDbDataAdapter(command);

        adapter.Fill(dt);
    }

    return dt;
}
