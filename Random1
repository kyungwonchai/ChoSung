using System;
using System.Data;
using System.Data.SqlClient;
using System.Timers;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        private string connectionString = "Data Source=YourServer;Initial Catalog=YourDatabase;User ID=YourUsername;Password=YourPassword";
        private Timer timer;

        public YourForm()
        {
            InitializeComponent();
        }

        private void YourForm_Load(object sender, EventArgs e)
        {
            // 타이머 초기화 및 설정
            timer = new Timer();
            timer.Interval = 1000; // 1초
            timer.Elapsed += Timer_Elapsed;

            // 타이머 시작
            timer.Start();
        }

        private void Timer_Elapsed(object sender, ElapsedEventArgs e)
        {
            // MSSQL에서 값을 가져오는 메서드 호출
            int value = GetValueFromTable();

            // 라벨 값 변경을 위해 인보크 사용
            Invoke((MethodInvoker)delegate {
                label1.Text = value.ToString();
            });
        }

        private int GetValueFromTable()
        {
            try
            {
                int value = 0;

                using (SqlConnection connection = new SqlConnection(connectionString))
                {
                    connection.Open();

                    string query = "SELECT ValueColumn FROM YourTable";
                    using (SqlCommand command = new SqlCommand(query, connection))
                    {
                        using (SqlDataReader reader = command.ExecuteReader())
                        {
                            if (reader.Read())
                            {
                                // 값 가져오기
                                value = reader.GetInt32(0);
                            }
                        }
                    }

                    connection.Close();
                }

                return value;
            }
            catch (Exception ex)
            {
                MessageBox.Show("MSSQL 데이터베이스에서 값 가져오기 중 오류가 발생했습니다:\n" + ex.Message);
                return 0;
            }
        }
    }
}
