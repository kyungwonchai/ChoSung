using System;
using System.IO;
using System.Windows.Forms;
using IWshRuntimeLibrary;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        string folderPath = @"C:\YourFolder";  // 바로가기 파일이 있는 폴더
        string[] shortcutFiles = Directory.GetFiles(folderPath, "*.lnk");

        foreach (var shortcut in shortcutFiles)
        {
            string shortcutTarget = GetShortcutTarget(shortcut);
            if (string.IsNullOrEmpty(shortcutTarget)) continue;

            listBox1.Items.Add(new ListBoxItem 
            {
                Display = Path.GetFileNameWithoutExtension(shortcut),
                Value = shortcutTarget
            });
        }

        listBox1.DoubleClick += ListBox1_DoubleClick;  // 더블 클릭 이벤트 핸들러 추가
    }

    private static string GetShortcutTarget(string shortcutFilename)
    {
        WshShell shell = new WshShell();
        IWshShortcut shortcut = (IWshShortcut)shell.CreateShortcut(shortcutFilename);
        return shortcut.TargetPath;
    }

    private void ListBox1_DoubleClick(object sender, EventArgs e)
    {
        if (listBox1.SelectedItem != null)
        {
            string path = ((ListBoxItem)listBox1.SelectedItem).Value;
            System.Diagnostics.Process.Start("explorer.exe", path);
        }
    }

    public class ListBoxItem
    {
        public string Display { get; set; }
        public string Value { get; set; }

        public override string ToString()
        {
            return Display;
        }
    }
}
