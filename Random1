CREATE PROCEDURE InsertIntoTable_수기입
AS
BEGIN
    -- 삽입 작업을 시작하기 전에 트랜잭션을 시작합니다.
    BEGIN TRANSACTION;
    
    TRY
        -- #t1의 KeyN 값이 Table_수기입의 Key1 컬럼에 없는 레코드만 삽입합니다.
        INSERT INTO Table_수기입 (Key1, [다른_컬럼1], [다른_컬럼2], ...)
        SELECT KeyN, [다른_컬럼1], [다른_컬럼2], ...
        FROM #t1
        WHERE KeyN NOT IN (SELECT Key1 FROM Table_수기입);
        
        -- 작업이 성공적으로 완료되면 트랜잭션을 커밋합니다.
        COMMIT TRANSACTION;
    CATCH
        -- 오류가 발생한 경우 트랜잭션을 롤백합니다.
        ROLLBACK TRANSACTION;
        -- 추가적인 오류 처리를 여기에 작성할 수 있습니다.
    END;
END;
