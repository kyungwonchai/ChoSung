using System;
using System.Collections.Generic;
using System.Linq;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        public YourForm()
        {
            InitializeComponent();
        }

        private void YourButton_Click(object sender, EventArgs e)
        {
            // 예시로 사용할 double형 List
            List<double> doubleList = new List<double> { 1.2, 2.5, 3.1, 4.8, 100.0, 5.9, 6.3, 7.2, 8.4 };

            // double형 List를 배열로 변환
            double[] doubleArray = doubleList.ToArray();

            // 이상치 제거를 위해 percentile 계산
            double lowerPercentile = 10.0; // 하위 백분위수 (0부터 100 사이의 값)
            double upperPercentile = 90.0; // 상위 백분위수 (0부터 100 사이의 값)

            // percentile 값을 기준으로 이상치 제거
            double[] cleanedArray = RemoveOutliers(doubleArray, lowerPercentile, upperPercentile);

            // 이상치가 제거된 배열의 평균 계산 (float 형태로 변환)
            float average = (float)cleanedArray.Average();

            // 결과 출력
            Console.WriteLine("이상치 제거 후 배열: " + string.Join(", ", cleanedArray));
            Console.WriteLine("평균: " + average);
        }

        private double[] RemoveOutliers(double[] array, double lowerPercentile, double upperPercentile)
        {
            // 배열을 정렬하여 percentile에 해당하는 값의 인덱스 계산
            int lowerIndex = (int)Math.Floor(array.Length * (lowerPercentile / 100.0));
            int upperIndex = (int)Math.Ceiling(array.Length * (upperPercentile / 100.0));

            // 이상치가 제거된 배열 생성
            double[] cleanedArray = array.OrderBy(x => x).Skip(lowerIndex).Take(upperIndex - lowerIndex).ToArray();

            return cleanedArray;
        }
    }
}
