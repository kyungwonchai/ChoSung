오류 코드 1292는 데이터 형식이 맞지 않아서 발생하는 문제입니다. SUBSTRING_INDEX와 CAST를 사용할 때 빈 문자열을 정수로 변환하려고 시도하기 때문에 발생할 수 있습니다. 이를 방지하기 위해 SUBSTRING_INDEX 함수가 빈 문자열을 반환하지 않도록 수정해야 합니다.

아래는 이를 수정한 쿼리입니다:

업데이트 쿼리:

sql
코드 복사
UPDATE smd.tbl_history
SET gatherok = 1
WHERE CAST(NULLIF(SUBSTRING_INDEX(flow)mch, ':', 1), '') AS UNSIGNED) >= 5;
이 작업을 10분마다 실행하기 위해 MySQL 이벤트 스케줄러를 사용할 수 있습니다:

먼저 MySQL 이벤트 스케줄러를 활성화합니다:

sql
코드 복사
SET GLOBAL event_scheduler = ON;
그런 다음, 이벤트를 생성합니다:

sql
코드 복사
CREATE EVENT update_gatherok_event
ON SCHEDULE EVERY 10 MINUTE
DO
  UPDATE smd.tbl_history
  SET gatherok = 1
  WHERE CAST(NULLIF(SUBSTRING_INDEX(flow)mch, ':', 1), '') AS UNSIGNED) >= 5;
NULLIF 함수는 첫 번째 인자가 두 번째 인자와 같으면 NULL을 반환합니다. 이 경우 SUBSTRING_INDEX가 빈 문자열을 반환할 때 이를 NULL로 바꾸고, CAST 함수는 NULL을 무시하여 오류가 발생하지 않게 합니다.

이렇게 하면 10분마다 자동으로 해당 조건에 맞는 레코드가 업데이트됩니다. MySQL 서버의 권한과 설정을 확인하여 이벤트 스케줄러가 제대로 작동하도록 해야 합니다.