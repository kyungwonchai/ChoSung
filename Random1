using DevExpress.XtraEditors;
using System;
using System.IO;
using System.Collections.Generic;
using System.Windows.Forms;
using IWshRuntimeLibrary;

public partial class Form1 : XtraForm
{
    private Dictionary<string, ListBoxControl> listBoxControls = new Dictionary<string, ListBoxControl>();

    public Form1()
    {
        InitializeComponent();

        // 각 ListBoxControl에 해당하는 폴더 경로를 추가합니다.
        listBoxControls.Add(@"C:\YourFolder1", listBoxControl1);
        listBoxControls.Add(@"C:\YourFolder2", listBoxControl2);
        // 필요한 만큼 더 추가합니다.

        foreach (var pair in listBoxControls)
        {
            string folderPath = pair.Key;
            ListBoxControl listBoxControl = pair.Value;

            string[] shortcutFiles = Directory.GetFiles(folderPath, "*.lnk");

            foreach (var shortcut in shortcutFiles)
            {
                string shortcutTarget = GetShortcutTarget(shortcut);
                if (string.IsNullOrEmpty(shortcutTarget)) continue;

                listBoxControl.Items.Add(new ListBoxItem
                {
                    Display = Path.GetFileNameWithoutExtension(shortcut),
                    Value = shortcutTarget
                });
            }

            listBoxControl.DoubleClick += ListBoxControl_DoubleClick;  // 더블 클릭 이벤트 핸들러 추가
        }
    }

    private static string GetShortcutTarget(string shortcutFilename)
    {
        WshShell shell = new WshShell();
        IWshShortcut shortcut = (IWshShortcut)shell.CreateShortcut(shortcutFilename);
        return shortcut.TargetPath;
    }

    private void ListBoxControl_DoubleClick(object sender, EventArgs e)
    {
        ListBoxControl listBoxControl = sender as ListBoxControl;

        if (listBoxControl != null && listBoxControl.SelectedItem != null)
        {
            string path = ((ListBoxItem)listBoxControl.SelectedItem).Value;
            System.Diagnostics.Process.Start("explorer.exe", path);
        }
    }

    public class ListBoxItem
    {
        public string Display { get; set; }
        public string Value { get; set; }

        public override string ToString()
        {
            return Display;
        }
    }
}
