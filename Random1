특정 리본 페이지를 특정 IP 주소에서만 표시하려면, IP 주소 확인 후 리본 페이지를 동적으로 숨기거나 표시하는 로직을 구현할 수 있습니다. 아래는 이를 구현하는 방법입니다.

1. IP 확인 및 조건 설정
IP 주소 가져오기
사용자의 IP 주소를 가져오는 코드입니다:

csharp
코드 복사
using System.Net;

private string GetLocalIPAddress()
{
    try
    {
        var host = Dns.GetHostEntry(Dns.GetHostName());
        foreach (var ip in host.AddressList)
        {
            if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork)
            {
                return ip.ToString(); // IPv4 주소 반환
            }
        }
        return "127.0.0.1"; // 로컬호스트 반환
    }
    catch
    {
        return string.Empty;
    }
}
2. 리본 페이지 숨기기/표시
특정 IP에 따라 리본 페이지 처리
리본 페이지를 특정 IP에서만 보이도록 설정합니다.

csharp
코드 복사
private void SetRibbonPageVisibility(RibbonPage ribbonPage, string allowedIp)
{
    try
    {
        string localIp = GetLocalIPAddress(); // 현재 IP 가져오기

        if (localIp == allowedIp)
        {
            ribbonPage.Visible = true; // 허용된 IP라면 페이지 표시
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is visible for IP: {localIp}");
        }
        else
        {
            ribbonPage.Visible = false; // 허용되지 않은 IP라면 숨김
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is hidden for IP: {localIp}");
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetRibbonPageVisibility: {ex.Message}");
    }
}
3. 폼 로드 시 호출
Form_Load에서 특정 리본 페이지를 조건에 따라 처리합니다.

csharp
코드 복사
private void Form_Load(object sender, EventArgs e)
{
    try
    {
        // 특정 리본 페이지
        RibbonPage targetPage = favoritesPage; // 예: 즐겨찾기 페이지
        string allowedIp = "192.168.1.100"; // 허용할 IP 주소

        // 리본 페이지 가시성 설정
        SetRibbonPageVisibility(targetPage, allowedIp);

        // 기타 초기화 작업
        InitializeRibbonButtons();
        SetCurrentUser(null); // 기본 로그아웃 상태
        InitializeButtons();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] Form_Load: {ex.Message}");
    }
}
4. 여러 IP에 대해 조건 처리
여러 IP를 허용하려면, 리스트로 관리하고 조건을 수정합니다:

IP 리스트 정의
csharp
코드 복사
private readonly List<string> AllowedIps = new List<string>
{
    "192.168.1.100",
    "192.168.1.101"
};
조건 수정
csharp
코드 복사
private void SetRibbonPageVisibility(RibbonPage ribbonPage, List<string> allowedIps)
{
    try
    {
        string localIp = GetLocalIPAddress();

        if (allowedIps.Contains(localIp))
        {
            ribbonPage.Visible = true;
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is visible for IP: {localIp}");
        }
        else
        {
            ribbonPage.Visible = false;
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is hidden for IP: {localIp}");
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetRibbonPageVisibility: {ex.Message}");
    }
}
최종 결과
특정 IP에서만 페이지 보임:

IP 주소가 허용된 경우에만 페이지가 표시됩니다.
폼 로드에서 자동 처리:

프로그램 시작 시 IP 조건에 따라 페이지를 숨기거나 표시.
여러 IP 지원:
