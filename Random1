ğŸ“¦ AutoHandleSolution
 â”£ ğŸ“‚ AAutoHandle
 â”ƒ â”£ ğŸ“‚ Commands
 â”ƒ â”ƒ â”£ ğŸ“œ IMacroCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ KeyboardCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MouseClickCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ DelayCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ ScreenCaptureCommand.cs
 â”ƒ â”ƒ â”— ğŸ“œ CVCommand.cs
 â”ƒ â”£ ğŸ“‚ Core
 â”ƒ â”ƒ â”£ ğŸ“œ MacroExecutor.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroManager.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroLogger.cs
 â”ƒ â”£ ğŸ“‚ Database
 â”ƒ â”ƒ â”£ ğŸ“œ MySqlHelper.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MsSqlHelper.cs
 â”ƒ â”ƒ â”— ğŸ“œ DatabaseReader.cs  â˜… MySQL/MSSQL ì¡°íšŒ ë° ìˆœíšŒ
 â”ƒ â”£ ğŸ“‚ Forms
 â”ƒ â”ƒ â”— ğŸ“œ MainForm.cs
 â”ƒ â”£ ğŸ“œ Program.cs
 â”ƒ â”— ğŸ“œ AAutoHandle.csproj
 â”— ğŸ“œ AutoHandleSolution.sln
ğŸ“œ 1ï¸âƒ£ MySQL & MSSQL ë°ì´í„° ì¡°íšŒ ë° ìˆœíšŒ (Database í´ë”)
ğŸ”¹ MySqlHelper.cs (MySQL í”„ë¡œì‹œì € í˜¸ì¶œ)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using MySql.Data.MySqlClient;

    public class MySqlHelper
    {
        private readonly string _connectionString;

        public MySqlHelper(string connectionString)
        {
            _connectionString = connectionString;
        }

        public DataTable ExecuteStoredProcedure(string procedureName, params MySqlParameter[] parameters)
        {
            using (var connection = new MySqlConnection(_connectionString))
            {
                using (var command = new MySqlCommand(procedureName, connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    if (parameters != null)
                        command.Parameters.AddRange(parameters);

                    using (var adapter = new MySqlDataAdapter(command))
                    {
                        var resultTable = new DataTable();
                        adapter.Fill(resultTable);
                        return resultTable;
                    }
                }
            }
        }
    }
}
ğŸ”¹ MsSqlHelper.cs (MSSQL í”„ë¡œì‹œì € í˜¸ì¶œ)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using System.Data.SqlClient;

    public class MsSqlHelper
    {
        private readonly string _connectionString;

        public MsSqlHelper(string connectionString)
        {
            _connectionString = connectionString;
        }

        public DataTable ExecuteStoredProcedure(string procedureName, params SqlParameter[] parameters)
        {
            using (var connection = new SqlConnection(_connectionString))
            {
                using (var command = new SqlCommand(procedureName, connection))
                {
                    command.CommandType = CommandType.StoredProcedure;

                    if (parameters != null)
                        command.Parameters.AddRange(parameters);

                    using (var adapter = new SqlDataAdapter(command))
                    {
                        var resultTable = new DataTable();
                        adapter.Fill(resultTable);
                        return resultTable;
                    }
                }
            }
        }
    }
}
ğŸ”¹ DatabaseReader.cs (MySQL & MSSQL ê²°ê³¼ ìˆœíšŒ)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using System.Collections.Generic;

    public class DatabaseReader
    {
        private readonly MySqlHelper _mySqlHelper;
        private readonly MsSqlHelper _msSqlHelper;

        public DatabaseReader(string mysqlConnString, string mssqlConnString)
        {
            _mySqlHelper = new MySqlHelper(mysqlConnString);
            _msSqlHelper = new MsSqlHelper(mssqlConnString);
        }

        public void ReadMySqlData(string procedureName, Action<DataRow> processRow, params MySql.Data.MySqlClient.MySqlParameter[] parameters)
        {
            var table = _mySqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                processRow(row);
            }
        }

        public void ReadMsSqlData(string procedureName, Action<DataRow> processRow, params System.Data.SqlClient.SqlParameter[] parameters)
        {
            var table = _msSqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                processRow(row);
            }
        }
    }
}
ğŸ“œ 2ï¸âƒ£ UIì—ì„œ ì‹¤í–‰ (MainForm.cs)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Data;
using System.Windows.Forms;
using AAutoHandle.Core;
using AAutoHandle.Commands;
using AAutoHandle.Database;
using MySql.Data.MySqlClient;
using System.Data.SqlClient;

namespace AAutoHandle
{
    public partial class MainForm : Form
    {
        private DatabaseReader _dbReader;

        public MainForm()
        {
            InitializeComponent();

            // MySQL & MSSQL ì—°ê²° ì •ë³´ ì„¤ì •
            string mysqlConn = "Server=localhost;Database=mydb;User=root;Password=1234;";
            string mssqlConn = "Server=myserver;Database=mydb;User Id=myuser;Password=mypassword;";

            _dbReader = new DatabaseReader(mysqlConn, mssqlConn);
        }

        private async void btnStartMacro_Click(object sender, EventArgs e)
        {
            var macroManager = MacroManager.Instance;

            macroManager.AddCommand(new KeyboardCommand(Keys.A));
            macroManager.AddCommand(new MouseClickCommand(500, 300));
            macroManager.AddCommand(new DelayCommand(1000));
            macroManager.AddCommand(new ScreenCaptureCommand("screenshot.png"));
            macroManager.AddCommand(new CVCommand("test.png"));

            await macroManager.StartExecutionAsync();
        }

        private void btnLoadMySqlData_Click(object sender, EventArgs e)
        {
            listBoxLogs.Items.Clear();
            _dbReader.ReadMySqlData("sp_GetData",
                row => listBoxLogs.Items.Add($"{row["id"]}: {row["name"]}"));
        }

        private void btnLoadMsSqlData_Click(object sender, EventArgs e)
        {
            listBoxLogs.Items.Clear();
            _dbReader.ReadMsSqlData("sp_GetData",
                row => listBoxLogs.Items.Add($"{row["id"]}: {row["name"]}"));
        }
    }
}
ğŸ“œ 3ï¸âƒ£ SQL í”„ë¡œì‹œì € ì˜ˆì‹œ
ğŸ”¹ MySQL (sp_GetData í”„ë¡œì‹œì €)
sql
ì½”ë“œ ë³µì‚¬
DELIMITER //
CREATE PROCEDURE sp_GetData()
BEGIN
    SELECT id, name FROM my_table;
END //
DELIMITER ;
ğŸ”¹ MSSQL (sp_GetData í”„ë¡œì‹œì €)
sql
ì½”ë“œ ë³µì‚¬
CREATE PROCEDURE sp_GetData
AS
BEGIN
    SELECT id, name FROM my_table;
END;
ğŸ“œ 4ï¸âƒ£ ì‹¤í–‰ ê²°ê³¼
âœ… btnLoadMySqlData_Click() ì‹¤í–‰ â†’ ListBoxì— MySQL ë°ì´í„° ì¶œë ¥
âœ… btnLoadMsSqlData_Click() ì‹¤í–‰ â†’ ListBoxì— MSSQL ë°ì´í„° ì¶œë ¥

ğŸ“Œ ê²°ë¡ 
MySQL & MSSQL ë°ì´í„° ì¡°íšŒ: DatabaseReader.csì—ì„œ í”„ë¡œì‹œì € í˜¸ì¶œ
í–‰ì„ ìˆœíšŒí•˜ë©° ë°ì´í„° ì½ê¸°: Action<DataRow> ì‚¬ìš©í•´ ë™ì  ì²˜ë¦¬
UIì™€ ì—°ê²°: ë²„íŠ¼ í´ë¦­ ì‹œ ListBoxì— ë°ì´í„° í‘œì‹œ
ë‹·ë„· 4.8 ì§€ì› ì½”ë“œ: ??= ì œê±° í›„ ëª…í™•í•œ null ì²´í¬ ë¡œì§ ì ìš©