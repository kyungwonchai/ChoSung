안녕하세요! 요청하신 엑셀 수식을 만들어 드리겠습니다.

상황 요약:

실적시트 (Performance Sheet):

J열: 최종 점수가 표시될 열입니다.
B열: 구역
C열: 조
I열: 라인
T3:W9 (아마도 "ㅉ9"는 W9를 의미하시는 것 같습니다): 점수 참조표
U열 (U3:U9): 하한값 (Lower bound)
V열 (V3:V9): 상한값 (Upper bound)
W열 (W3:W9): 점수 (Score)
전체데이타시트 (Overall Data Sheet):

H열: 구역
C열: 조
B열: 라인
E열: 평균을 계산할 값
작업 흐름:

실적시트의 현재 행(예: 2행)에서 B열(구역), C열(조), I열(라인) 값을 가져옵니다.
이 값들을 기준으로 전체데이타시트에서 일치하는 데이터를 찾습니다 (H열=구역, C열=조, B열=라인).
일치하는 데이터들의 E열 값들의 평균을 계산합니다.
계산된 평균값을 실적시트의 점수 참조표(U열:하한값, V열:상한값)와 비교하여 해당하는 W열의 점수를 가져옵니다.
수식:

실적시트의 J2 셀에 다음 수식을 입력하고 아래로 복사하여 적용하세요. (최신 버전의 Excel을 사용하시는 경우 LET 함수를 사용하면 더 깔끔하게 작성할 수 있습니다.)

1. LET 함수 사용 가능 시 (Excel 2021, Microsoft 365):
이 방법이 더 읽기 쉽고 효율적입니다.

Excel

=LET(
    평균값, AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2),
    점수, SUMPRODUCT(--(평균값 >= U$3:U$9), --(평균값 <= V$3:V$9), W$3:W$9),
    IFERROR(점수, "평균값 없음 또는 점수 범위 해당 없음")
)
설명:

LET(이름1, 값1, [이름2, 값2, ...], 계산): 중간 계산 결과를 이름으로 저장하여 사용할 수 있게 합니다.
평균값, AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2):
전체데이타시트!E:E: 평균을 구할 범위입니다.
전체데이타시트!H:H, B2: 전체데이타시트 H열(구역)이 실적시트 B2셀(구역)과 같은 조건입니다.
전체데이타시트!C:C, C2: 전체데이타시트 C열(조)이 실적시트 C2셀(조)과 같은 조건입니다.
전체데이타시트!B:B, I2: 전체데이타시트 B열(라인)이 실적시트 I2셀(라인)과 같은 조건입니다.
위 세 가지 조건을 모두 만족하는 E열 값들의 평균을 계산하여 평균값이라는 이름으로 저장합니다.
점수, SUMPRODUCT(--(평균값 >= U$3:U$9), --(평균값 <= V$3:V$9), W$3:W$9):
평균값 >= U$3:U$9: 계산된 평균값이 점수표의 하한값(U3:U9)보다 크거나 같은지 비교합니다 (결과는 TRUE/FALSE 배열).
평균값 <= V$3:V$9: 계산된 평균값이 점수표의 상한값(V3:V9)보다 작거나 같은지 비교합니다 (결과는 TRUE/FALSE 배열).
--(...): TRUE/FALSE를 숫자 1/0으로 변환합니다.
SUMPRODUCT는 이 세 배열을 곱한 후 합산합니다. 즉, 평균값이 하한과 상한 사이에 해당하는 행의 점수(W열)를 가져옵니다. (점수표의 범위가 서로 겹치지 않는다고 가정합니다.)
IFERROR(점수, "평균값 없음 또는 점수 범위 해당 없음"):
만약 AVERAGEIFS에서 조건에 맞는 데이터가 없어 #DIV/0! 오류가 발생하거나, SUMPRODUCT에서 적절한 점수 범위를 찾지 못해 결과가 0 또는 예상치 못한 값이 나올 경우 (보통 0으로 나옴) 지정된 메시지를 표시합니다. 만약 오류 시 0점을 부여하고 싶다면 "평균값 없음 또는 점수 범위 해당 없음" 대신 0을 쓰면 됩니다.
2. LET 함수 사용 불가능 시 (구버전 Excel):

Excel

=IFERROR(SUMPRODUCT(--(AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2) >= U$3:U$9), --(AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2) <= V$3:V$9), W$3:W$9), "평균값 없음 또는 점수 범위 해당 없음")
이 수식은 AVERAGEIFS 부분이 반복되지만 동일한 로직으로 작동합니다.

참고 사항:

실적시트와 전체데이타시트의 시트 이름이 정확한지 확인해주세요.
점수표의 범위(U$3:U$9, V$3:V$9, W$3:W$9)는 절대 참조($)를 사용하여 수식을 아래로 복사해도 고정되도록 했습니다.
AVERAGEIFS의 조건에 해당하는 데이터가 전체데이타시트에 없을 경우 #DIV/0! 오류가 발생할 수 있으며, IFERROR 함수로 처리했습니다.