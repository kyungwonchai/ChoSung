찾은 경로의 끝 경로명이 특정 타겟 이름과 동일한 경우에만 .sln 파일을 찾고 실행하도록 코드를 수정할 수 있습니다. 아래는 수정된 코드입니다.

코드: 끝 경로명이 타겟 이름과 같은 경우만 .sln 찾기
csharp
코드 복사
using System;
using System.Diagnostics;
using System.IO;

class Program
{
    static void Main(string[] args)
    {
        // 루트 폴더와 타겟 폴더 이름을 설정합니다.
        string rootFolder = @"C:\TargetFolder"; // 검색 시작 폴더
        string targetFolderName = "SpecificFolder"; // 찾고자 하는 타겟 폴더 이름
        string solutionExtension = "*.sln"; // 찾고자 하는 파일 확장자

        try
        {
            // 루트 폴더의 모든 하위 폴더 검색
            string[] directories = Directory.GetDirectories(rootFolder, "*", SearchOption.AllDirectories);

            foreach (string folder in directories)
            {
                // 끝 경로명 추출 (마지막 폴더명)
                string folderName = Path.GetFileName(folder);

                // 끝 경로명이 타겟 이름과 동일한지 확인
                if (folderName.Equals(targetFolderName, StringComparison.OrdinalIgnoreCase))
                {
                    Console.WriteLine($"'{folder}' 폴더에서 '{targetFolderName}' 발견. .sln 파일을 검색합니다...");
                    
                    // 해당 폴더에서 .sln 파일 검색
                    string[] slnFiles = Directory.GetFiles(folder, solutionExtension, SearchOption.TopDirectoryOnly);

                    if (slnFiles.Length > 0)
                    {
                        foreach (string slnFile in slnFiles)
                        {
                            Console.WriteLine($"솔루션 파일 발견: {slnFile}");
                            OpenSolution(slnFile); // 솔루션 실행
                        }
                    }
                    else
                    {
                        Console.WriteLine($"'{folder}' 폴더에 .sln 파일이 없습니다.");
                    }
                }
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"오류 발생: {ex.Message}");
        }
    }

    /// <summary>
    /// 지정된 .sln 파일을 실행합니다.
    /// </summary>
    /// <param name="solutionPath">.sln 파일 경로</param>
    static void OpenSolution(string solutionPath)
    {
        try
        {
            Process.Start(new ProcessStartInfo
            {
                FileName = solutionPath,
                UseShellExecute = true
            });
            Console.WriteLine($"솔루션 실행: {solutionPath}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"솔루션 실행 중 오류 발생: {ex.Message}");
        }
    }
}
주요 변경점
끝 경로명 확인:

csharp
코드 복사
string folderName = Path.GetFileName(folder);
if (folderName.Equals(targetFolderName, StringComparison.OrdinalIgnoreCase))
Path.GetFileName를 사용하여 현재 경로의 끝 부분(폴더 이름)을 가져옵니다.