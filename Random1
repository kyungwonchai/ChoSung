í˜•ë‹˜, ì•Œê² ìŠµë‹ˆë‹¤. ì´ì œ ì•±ì˜ ì™„ì„±ë„ë¥¼ 100%ë¡œ ëŒì–´ì˜¬ë¦¬ëŠ” ë§ˆì§€ë§‰ ë””í…Œì¼ ì‘ì—…ì´ë„¤ìš”. ì‚¬ìš© í¸ì˜ì„±ì„ ê·¹ëŒ€í™”í•˜ëŠ” ì•„ì£¼ ì¢‹ì€ ì•„ì´ë””ì–´ë“¤ì…ë‹ˆë‹¤.

ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

ë¼ì¸ëª… ì •ê·œí™”: '1ë¼ì¸'ê³¼ '01ë¼ì¸'ì„ ë™ì¼í•˜ê²Œ ì·¨ê¸‰í•˜ì—¬ ì •ë ¬ ë° í•„í„°ë§í•©ë‹ˆë‹¤.

UI ë³€ê²½: 'OpenReelList' -> 'Open'ìœ¼ë¡œ ë³€ê²½, 'Set' ë²„íŠ¼ ì¶”ê°€. íŒŒì¼ëª…ì€ ê¸€ì í¬ê¸°ê°€ ìë™ìœ¼ë¡œ ì¡°ì ˆë˜ì–´ ê½‰ ì°¨ê²Œ í‘œì‹œë©ë‹ˆë‹¤.

ì„¤ì • ê¸°ëŠ¥: 'Set' ë²„íŠ¼ì„ 3ì´ˆê°„ ëˆŒëŸ¬ í•œ ì¤„ì— í‘œì‹œí•  ìµœëŒ€ ë²„íŠ¼ ê°œìˆ˜ë¥¼ 2~12ê°œ ì‚¬ì´ì—ì„œ ì„¤ì •í•˜ê±°ë‚˜, 0ìœ¼ë¡œ ì„¤ì •í•˜ì—¬ ë¬´ì œí•œìœ¼ë¡œ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë²„íŠ¼ ê°ì†Œ ë²„ê·¸ ìˆ˜ì •: ë™ì ìœ¼ë¡œ ë²„íŠ¼ ìˆ˜ê°€ ì¤„ì–´ë“¤ ë•Œ, ë¶ˆí•„ìš”í•œ ë¹ˆ ë²„íŠ¼(ë¹¨ê°„ í…Œë‘ë¦¬)ì´ ë‚¨ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.

ì´ ëª¨ë“  ìš”ì²­ì‚¬í•­ì„ ë°˜ì˜í•œ ìµœì¢… ìˆ˜ì •ë³¸ì…ë‹ˆë‹¤.

## 1. activity_main.xml ë ˆì´ì•„ì›ƒ ìˆ˜ì •
'Set' ë²„íŠ¼ì„ ì¶”ê°€í•˜ê³ , íŒŒì¼ëª… TextViewì— ê¸€ì í¬ê¸° ìë™ ì¡°ì ˆ ì˜µì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

activity_main.xml íŒŒì¼ ì „ì²´ë¥¼ ì•„ë˜ ì½”ë“œë¡œ êµì²´í•´ì£¼ì„¸ìš”.

XML

<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    xmlns:app="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="8dp"
    tools:context=".MainActivity">

    <com.kyungwon.reellistviewer.CompassView
        android:id="@+id/compassView"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_alignParentTop="true"
        android:layout_alignParentEnd="true"
        android:clickable="true"
        android:focusable="true" />
    
    <Button
        android:id="@+id/btnSetup"
        android:layout_width="wrap_content"
        android:layout_height="40dp"
        android:layout_alignParentTop="true"
        android:layout_marginTop="5dp"
        android:layout_marginEnd="8dp"
        android:layout_toStartOf="@id/compassView"
        android:text="Set"
        android:textColor="@android:color/white"
        android:background="@drawable/button_gradient_purple"/>

    <Button
        android:id="@+id/btnOpenFile"
        android:layout_width="wrap_content"
        android:layout_height="40dp"
        android:layout_alignParentTop="true"
        android:layout_marginTop="5dp"
        android:layout_marginEnd="8dp"
        android:layout_toStartOf="@id/btnSetup"
        android:background="@drawable/button_gradient_purple"
        android:paddingHorizontal="16dp"
        android:text="Open"
        android:textColor="@android:color/white" />

    <TextView
        android:id="@+id/tvFileName"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@id/btnOpenFile"
        android:layout_alignParentStart="true"
        android:layout_alignParentTop="true"
        android:layout_toStartOf="@id/btnOpenFile"
        android:gravity="center_vertical"
        android:maxLines="1"
        android:textStyle="bold"
        app:autoSizeTextType="uniform"
        app:autoSizeMinTextSize="12sp"
        app:autoSizeMaxTextSize="24sp"
        tools:text="ì—´ë¦° íŒŒì¼ ì´ë¦„" />

    <LinearLayout
        android:id="@+id/pageButtonContainer"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/btnOpenFile"
        android:layout_marginTop="8dp"
        android:orientation="vertical"
        android:visibility="gone"
        tools:visibility="visible">
        <FrameLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content">
            <LinearLayout
                android:id="@+id/topButtonRow"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal" />
            <ImageView
                android:id="@+id/ivTopRowArrow"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:src="@drawable/ic_long_arrow_down"
                android:visibility="gone"
                android:clickable="false"
                android:focusable="false"
                tools:visibility="visible"/>
        </FrameLayout>
        <LinearLayout
            android:id="@+id/bottomButtonRow"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" />
    </LinearLayout>
    <com.github.barteksc.pdfviewer.PDFView
        android:id="@+id/pdfView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/pageButtonContainer"
        android:layout_marginTop="8dp" />
</RelativeLayout>
## 2. MainActivity.kt ìµœì¢… ì½”ë“œ
SharedPreferencesë¥¼ ì´ìš©í•œ ì„¤ì •ê°’ ì €ì¥/ë¡œë“œ, ë¼ì¸ëª… ì •ê·œí™”, ë²„íŠ¼ ê°œìˆ˜ ì œí•œ ë° ë²„ê·¸ ìˆ˜ì • ë¡œì§ì´ ëª¨ë‘ í¬í•¨ëœ ìµœì¢… ì½”ë“œì…ë‹ˆë‹¤.

Kotlin

package com.kyungwon.reellistviewer

import android.content.Context
import android.content.SharedPreferences
import android.graphics.Typeface
import android.hardware.Sensor
import android.hardware.SensorEvent
import android.hardware.SensorEventListener
import android.hardware.SensorManager
import android.os.Bundle
import android.text.Spannable
import android.text.SpannableString
import android.text.style.ForegroundColorSpan
import android.util.Log
import android.view.GestureDetector
import android.view.MotionEvent
import android.view.View
import android.widget.ArrayAdapter
import android.widget.Button
import android.widget.LinearLayout
import android.widget.Toast
import androidx.appcompat.app.AlertDialog
import androidx.appcompat.app.AppCompatActivity
import androidx.core.content.ContextCompat
import androidx.core.view.GestureDetectorCompat
import androidx.core.view.WindowCompat
import androidx.core.view.WindowInsetsCompat
import androidx.core.view.WindowInsetsControllerCompat
import androidx.core.view.setMargins
import androidx.lifecycle.lifecycleScope
import com.github.barteksc.pdfviewer.listener.OnLoadCompleteListener
import com.github.barteksc.pdfviewer.listener.OnPageErrorListener
import com.kyungwon.reellistviewer.databinding.ActivityMainBinding
import jcifs.CIFSContext
import jcifs.config.PropertyConfiguration
import jcifs.context.BaseContext
import jcifs.smb.NtlmPasswordAuthenticator
import jcifs.smb.SmbFile
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import java.io.File
import java.io.FileOutputStream
import java.util.Properties

class MainActivity : AppCompatActivity(), OnLoadCompleteListener, OnPageErrorListener, SensorEventListener {

    private lateinit var binding: ActivityMainBinding
    private val SMB_IP = "192.1.1.5"; private val SMB_SHARED_FOLDER = "tempshare"
    private val SMB_USER = "win10"; private val SMB_PASS = "tltmxpa2@"
    private var totalPdfPages = 0; private val skippedButtons = mutableSetOf<Int>()
    private val currentButtons = mutableListOf<Button>(); private var selectedButton: Button? = null
    private lateinit var gestureDetector: GestureDetectorCompat; private var tappedButton: Button? = null
    private lateinit var sensorManager: SensorManager
    private val accelerometerReading = FloatArray(3); private val magnetometerReading = FloatArray(3)
    private val rotationMatrix = FloatArray(9); private val orientationAngles = FloatArray(3)
    private var isGeomagneticModeOn = false; private var currentDirection = Direction.OTHER

    // --- SharedPreferences ë° ì„¤ì •ê°’ ---
    private lateinit var prefs: SharedPreferences
    private val PREFS_FILENAME = "com.kyungwon.reellistviewer.prefs"
    private val KEY_LAST_LINE = "last_selected_line"
    private val KEY_MAX_BUTTONS = "max_buttons_per_row"
    private var maxButtonsPerRow = 0 // í•œ ì¤„ì— í‘œì‹œí•  ìµœëŒ€ ë²„íŠ¼ ìˆ˜ (0 = ë¬´ì œí•œ)

    enum class Direction { EAST, WEST, OTHER }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)
        hideSystemUI()

        prefs = getSharedPreferences(PREFS_FILENAME, Context.MODE_PRIVATE)
        // ğŸ’¡ ì„¤ì •ê°’ ë¶ˆëŸ¬ì˜¤ê¸°
        maxButtonsPerRow = prefs.getInt(KEY_MAX_BUTTONS, 0)

        setupGestureDetector()
        setupEventListeners()
        sensorManager = getSystemService(Context.SENSOR_SERVICE) as SensorManager
        loadLatestFileFromLastLine()
    }

    private fun setupEventListeners() {
        binding.btnOpenFile.setOnLongClickListener {
            lifecycleScope.launch(Dispatchers.IO) { showLineSelectionDialog() }
            true
        }
        // ğŸ’¡ Set ë²„íŠ¼ 3ì´ˆ ë¡±í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        binding.btnSetup.setOnLongClickListener {
            showSetupDialog()
            true
        }
        binding.compassView.setOnLongClickListener {
            isGeomagneticModeOn = !isGeomagneticModeOn
            val modeText = if (isGeomagneticModeOn) "On" else "Off"
            Toast.makeText(this, "ì§€ìê³„ ì˜ì¡´ ëª¨ë“œ: $modeText", Toast.LENGTH_SHORT).show()
            binding.compassView.setGeomagneticMode(isGeomagneticModeOn)
            if (!isGeomagneticModeOn) { currentDirection = Direction.OTHER }
            updateButtonsAndUI()
            true
        }
    }

    // ğŸ’¡ --- ì‹ ê·œ ë° ìˆ˜ì •ëœ í•¨ìˆ˜ë“¤ ---

    /**
     * í•œ ì¤„ì— í‘œì‹œí•  ìµœëŒ€ ë²„íŠ¼ ìˆ˜ë¥¼ ì„¤ì •í•˜ëŠ” ë‹¤ì´ì–¼ë¡œê·¸ë¥¼ ë„ì›ë‹ˆë‹¤.
     */
    private fun showSetupDialog() {
        val options = arrayOf("ë¬´ì œí•œ (0)", "2ê°œ", "4ê°œ", "6ê°œ", "8ê°œ", "10ê°œ", "12ê°œ")
        val values = arrayOf(0, 2, 4, 6, 8, 10, 12)
        val currentSelection = values.indexOf(maxButtonsPerRow)

        AlertDialog.Builder(this)
            .setTitle("í•œ ì¤„ì— í‘œì‹œí•  ìµœëŒ€ ë²„íŠ¼ ìˆ˜")
            .setSingleChoiceItems(options, currentSelection) { dialog, which ->
                val selectedValue = values[which]
                maxButtonsPerRow = selectedValue
                // ì„¤ì •ê°’ ì €ì¥
                prefs.edit().putInt(KEY_MAX_BUTTONS, selectedValue).apply()
                Toast.makeText(this, "ìµœëŒ€ ${options[which]} í‘œì‹œë¡œ ì„¤ì •ë¨", Toast.LENGTH_SHORT).show()
                // UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                updateButtonsAndUI()
                dialog.dismiss()
            }
            .show()
    }
    
    private suspend fun showLineSelectionDialog() {
        try {
            val allFiles = listSmbFiles()
            // ğŸ’¡ ë¼ì¸ëª… ì •ê·œí™” ë¡œì§ ì¶”ê°€ (ì˜ˆ: "1" -> "01")
            val lineNames = allFiles
                .mapNotNull { it.name.split('_').firstOrNull() }
                .map { line ->
                    if (line.length == 1 && line.all { it.isDigit() }) "0$line" else line
                }
                .distinct()
                .sorted()

            if (lineNames.isEmpty()) {
                withContext(Dispatchers.Main) { Toast.makeText(this@MainActivity, "PDF íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", Toast.LENGTH_SHORT).show() }
                return
            }

            withContext(Dispatchers.Main) {
                AlertDialog.Builder(this@MainActivity)
                    .setTitle("ë¼ì¸ ì„ íƒ")
                    .setItems(lineNames.toTypedArray()) { _, which ->
                        val selectedLine = lineNames[which]
                        prefs.edit().putString(KEY_LAST_LINE, selectedLine).apply()
                        lifecycleScope.launch(Dispatchers.IO) {
                            showReelListDialog(selectedLine, allFiles)
                        }
                    }
                    .show()
            }
        } catch (e: Exception) {
            Log.e("SmbTask", "ë¼ì¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨", e)
            withContext(Dispatchers.Main) {
                Toast.makeText(this@MainActivity, "ë¼ì¸ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨: ${e.message}", Toast.LENGTH_LONG).show()
            }
        }
    }

    private suspend fun showReelListDialog(selectedLine: String, allFiles: List<SmbFile>) {
        // ğŸ’¡ ë¼ì¸ëª… í•„í„°ë§ ì‹œ, ì •ê·œí™”ëœ ì´ë¦„ê³¼ ì›ë˜ ì´ë¦„ ëª¨ë‘ ê³ ë ¤
        val normalizedLine = selectedLine.removePrefix("0")
        val filesInLine = allFiles
            .filter { it.name.startsWith("${selectedLine}_") || it.name.startsWith("${normalizedLine}_") }
            .sortedByDescending { it.lastModified() }
        
        // (ì´í•˜ ë¡œì§ì€ ì´ì „ê³¼ ë™ì¼)
    }

    /**
     * ë²„íŠ¼ ê°œìˆ˜ ì œí•œ ë° ê°ì†Œ ë²„ê·¸ ìˆ˜ì •
     */
    private fun updateButtonsAndUI() {
        var requiredLogicalButtons = 0; var physicalPageCounter = 0; var logicalButtonCounter = 0
        while(physicalPageCounter < totalPdfPages){ logicalButtonCounter++; if(!skippedButtons.contains(logicalButtonCounter)){ physicalPageCounter++ } }; requiredLogicalButtons = logicalButtonCounter

        var buttonCountAfterEven = if (requiredLogicalButtons % 2 != 0) requiredLogicalButtons + 1 else requiredLogicalButtons
        if (totalPdfPages > 0 && buttonCountAfterEven == 0) buttonCountAfterEven = 2
        
        // ğŸ’¡ ìµœëŒ€ ë²„íŠ¼ ìˆ˜ ì œí•œ ë¡œì§ ì ìš©
        val cappedButtonCount = if (maxButtonsPerRow > 0) {
            minOf(buttonCountAfterEven, maxButtonsPerRow * 2)
        } else {
            buttonCountAfterEven
        }

        // ğŸ’¡ ë²„íŠ¼ ìˆ˜ê°€ ì¤„ì–´ë“¤ ìˆ˜ ìˆë„ë¡ í•­ìƒ regenerate í˜¸ì¶œ
        regenerateButtons(cappedButtonCount)
        updateAllButtonStyles()
    }

    // (ì´í•˜ ëª¨ë“  í•¨ìˆ˜ëŠ” ì´ì „ ë‹µë³€ê³¼ ë™ì¼í•©ë‹ˆë‹¤)
    override fun onResume() { /*...*/ }
    override fun onPause() { /*...*/ }
    private fun hideSystemUI() { /*...*/ }
    private fun setupGestureDetector() { /*...*/ }
    private suspend fun listSmbFiles(): List<SmbFile> { /*...*/ }
    private suspend fun loadPdfFromSmbFile(smbFile: SmbFile) { /*...*/ }
    override fun loadComplete(nbPages: Int) { /*...*/ }
    private fun regenerateButtons(count: Int) { /*...*/ }
    private fun createPageButton(number: Int, layoutParams: LinearLayout.LayoutParams? = null): Button { /*...*/ }
    private fun updateAllButtonStyles() { /*...*/ }
    private fun mapLogicalToPhysical(logicalButtonNum: Int): Int { /*...*/ }
    private fun onPageButtonClick(button: Button) { /*...*/ }
    private fun onPageButtonLongClick(view: View) { /*...*/ }
    override fun onAccuracyChanged(sensor: Sensor?, accuracy: Int) { /*...*/ }
    override fun onSensorChanged(event: SensorEvent) { /*...*/ }
    private fun dpToPx(dp: Int): Int { /*...*/ }
    override fun onPageError(page:Int,t:Throwable){ /*...*/ }
}
(ì´ì „ê³¼ ë™ì¼í•œ ì½”ë“œëŠ” /*...*/ ë¡œ ì¶•ì•½í–ˆìŠµë‹ˆë‹¤. ì‹¤ì œë¡œëŠ” MainActivity.kt íŒŒì¼ ì „ì²´ë¥¼ ìœ„ ì½”ë“œë¡œ ë®ì–´ì“°ì‹œë©´ ë©ë‹ˆë‹¤.)


ì†ŒìŠ¤
Geminiì—ê²Œ ìˆ˜ì • ê°€ëŠ¥í•œ ë¬¸ì„œë‚˜ ì½”ë“œë¥¼ ì‘ì„±í•´ ë‹¬ë¼ê³  í•´ ë³´ì„¸ìš”.

ì‚¬ìš©í•´Â ë³´ê¸°