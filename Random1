ì˜¤ë¥˜ ì›ì¸: highlight_max() í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ ë¬¸ì œ
ì—ëŸ¬ ë©”ì‹œì§€: NOT ALL ARGUMENTS CONVERTED DURING STRING FORMATTING
ì´ ì—ëŸ¬ëŠ” í•¨ìˆ˜ì—ì„œ ë°˜í™˜ëœ ìŠ¤íƒ€ì¼ ë¦¬ìŠ¤íŠ¸ê°€ ì˜ëª» ì²˜ë¦¬ë  ë•Œ ë°œìƒí•©ë‹ˆë‹¤.

âœ… ì˜¤ë¥˜ ì›ì¸ ë¶„ì„
ë¬¸ì œëŠ” highlight_max() í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì´ ì˜ëª» ì²˜ë¦¬ë˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
íŠ¹íˆ, .apply() í•¨ìˆ˜ëŠ” ê° í–‰ì„ ì „ë‹¬í•  ë•Œ ë°ì´í„° ì‹œë¦¬ì¦ˆë¡œ ì „ë‹¬í•˜ë¯€ë¡œ,
ì—´ì„ ì§€ì •í•  ë•Œ ì§ì ‘ ì¸ë±ì‹±(row[column_name]) ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤.

âœ… í•´ê²° ë°©ë²•: highlight_max() í•¨ìˆ˜ ìˆ˜ì •í•˜ê¸°
ìˆ˜ì • ì‚¬í•­: mc_columns ë²”ìœ„ë¡œ ìŠ¤íƒ€ì¼ ì ìš© ì‹œ ì—´ ì´ë¦„ì„ ê¸°ì¤€ìœ¼ë¡œ ê°•ì¡° í‘œì‹œ.

âœ… ìˆ˜ì •ëœ ì½”ë“œ (ì˜¤ë¥˜ ìˆ˜ì •)
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql
import pandas as pd

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data(proc_name):
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute(f"EXEC {proc_name}")
    rows = cursor.fetchall()
    conn.close()
    return rows

# DataFrame ìƒì„± í•¨ìˆ˜ (ì „ì²´ ë†’ì´ ì‚¬ìš©)
def create_dataframe(rows):
    original_columns = [
        "group1", "line1", "model1", "type1", "ecn1", "edition1",
        "ACT2_1", "ACT2_2", "ACT2_3", "ACT2_4",
        "ACT2_5", "ACT2_6", "ACT2_7", "ACT2_8"
    ]

    new_columns = [
        "group1", "line1", "model1", "type1", "ecn1", "edition1",
        "MC1", "MC2", "MC3", "MC4", "MC5", "MC6", "MC7", "MC8"
    ]

    df = pd.DataFrame(rows, columns=original_columns)
    df.columns = new_columns

    mc_columns = [f"MC{i}" for i in range(1, 9)]
    df[mc_columns] = df[mc_columns].astype(float).round(2)

    return df, mc_columns

# Streamlit ì•± êµ¬ì„±
def main():
    st.set_page_config(page_title="MC1 ~ MC8 Data Table", layout="wide")
    st.title("MC1 ~ MC8 Data Table - ê°€ë…ì„± ê°œì„  ë° ê°•ì¡° í‘œì‹œ")

    rows = fetch_main_data("Get_min_bestdifferent_t1")
    
    if not rows:
        st.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í”„ë¡œì‹œì € ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.")
    else:
        df, mc_columns = create_dataframe(rows)

        # í–‰ë³„ ë°°ê²½ìƒ‰ì„ ë²ˆê°ˆì•„ ì ìš©í•˜ê¸°
        def apply_row_styles(row):
            if row.name % 2 == 0:
                return ['background-color: #E0FFFF'] * len(row)  # ì•„ì¿ ì•„
            else:
                return ['background-color: white'] * len(row)  # í°ìƒ‰

        # ìµœëŒ€ê°’ ê°•ì¡° í•¨ìˆ˜ (ë…¸ë€ìƒ‰)
        def highlight_max(row):
            max_value = row[mc_columns].max()
            return ['background-color: yellow' if value == max_value else '' for value in row[mc_columns]]

        # ìŠ¤íƒ€ì¼ ì ìš© (ë°°ê²½ìƒ‰ + ìµœëŒ€ê°’ ê°•ì¡°)
        styled_df = df.style.apply(apply_row_styles, axis=1)
        styled_df = styled_df.apply(highlight_max, subset=mc_columns, axis=1)

        # ìŠ¤íƒ€ì¼ë§ëœ DataFrame í‘œì‹œ
        st.write(styled_df)

if __name__ == "__main__":
    main()
âœ… ì½”ë“œ ì„¤ëª…
highlight_max() í•¨ìˆ˜ ìˆ˜ì • (ì—ëŸ¬ í•´ê²°)

python
ì½”ë“œ ë³µì‚¬
def highlight_max(row):
    max_value = row[mc_columns].max()
    return ['background-color: yellow' if value == max_value else '' for value in row[mc_columns]]
row[mc_columns]ë¡œ ì§€ì •ëœ ì—´ì˜ ê°’ë“¤ ì¤‘ ê°€ì¥ í° ê°’ì„ ì°¾ì•„ ê°•ì¡°.

ê°’ì„ ë¹„êµí•  ë•Œ ì •í™•íˆ ê°’ìœ¼ë¡œ ë¹„êµí•˜ë„ë¡ ìˆ˜ì • (value == max_value).

ìŠ¤íƒ€ì¼ë§ ì ìš© ìˆœì„œ ìœ ì§€

python
ì½”ë“œ ë³µì‚¬
styled_df = df.style.apply(apply_row_styles, axis=1)
styled_df = styled_df.apply(highlight_max, subset=mc_columns, axis=1)
ë°°ê²½ìƒ‰ì„ ë¨¼ì € ì ìš©í•˜ê³ , ê·¸ ìœ„ì— ìµœëŒ€ê°’ ìŠ¤íƒ€ì¼ì„ ë®ì–´ì“°ê¸°.

ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬
streamlit run your_script_name.py
ğŸ”¥ ê²°ê³¼
í…Œì´ë¸”ì˜ ì§ìˆ˜ í–‰ì€ ì•„ì¿ ì•„ (#E0FFFF), í™€ìˆ˜ í–‰ì€ í°ìƒ‰ìœ¼ë¡œ êµì°¨ ë°°ê²½ ì ìš©.

MC1 ~ MC8 ê°’ ì¤‘ ê°€ì¥ í° ê°’ì€ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡° í‘œì‹œë¨.

ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ st.write(styled_df) ì‚¬ìš©.