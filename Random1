using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Text.RegularExpressions;

namespace YourNamespace
{
    class Program
    {
        static void Main(string[] args)
        {
            List<string> columns = new List<string>();
            Regex regex = new Regex("[your_pattern_here]");
            
            // Assume sheet is some kind of 2D array or List
            foreach (var cell in sheet[2].Skip(1))
            {
                string result = regex.Replace(cell.Value, "-");
                string columnName = "C_" + result;
                if (columnName.StartsWith("C_"))
                {
                    columns.Add(columnName);
                }
            }
            
            using (SqlConnection conn = new SqlConnection("Your Connection String Here"))
            {
                conn.Open();
                SqlCommand cmd = new SqlCommand();
                cmd.Connection = conn;
                DateTime currentTime = DateTime.Now;
                string formattedTime = currentTime.ToString("yyyy-MM-dd HH:mm:ss");
                int numbb = 1;
                
                // Assume sheetRows is an IEnumerable that you can loop through
                foreach (var row in sheetRows)
                {
                    if (row.All(element => element == null))
                    {
                        break;
                    }
                    
                    if (string.IsNullOrEmpty(row[2].ToString()))
                    {
                        continue;
                    }
                    
                    Dictionary<string, object> data = new Dictionary<string, object>();
                    for (int i = 0; i < columns.Count; i++)
                    {
                        data[columns[i]] = row[i];
                    }
                    
                    List<string> dataWithQuotes = new List<string>();
                    foreach (var value in data.Values)
                    {
                        dataWithQuotes.Add($"'{value}'");
                    }
                    
                    dataWithQuotes.Add(numbb.ToString());
                    dataWithQuotes.Add($"'{formattedTime}'");
                    
                    string insertQuery = $"INSERT INTO T_메인확정 ({string.Join(",", columns)}, N_number, N_time) VALUES ({string.Join(",", dataWithQuotes)})";
                    cmd.CommandText = insertQuery;
                    cmd.ExecuteNonQuery();
                    
                    numbb++;
                }
                
                conn.Close();
            }
        }
    }
}
