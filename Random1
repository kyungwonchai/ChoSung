알겠습니다. 두 계정(kw, kwkw)이 생성하는 모든 파일과 디렉토리를 완벽하게 공유하고, 앞으로도 영구적으로 이 설정이 유지되도록 하는 가장 확실한 방법을 단계별로 안내해 드리겠습니다.

아래 코드를 순서대로 실행하시면 됩니다.

해결 방법: 공유 그룹 생성 및 자동 권한 설정
핵심은 kwteam이라는 공유 그룹을 만들고, 두 사용자가 이 그룹에 속하게 하는 것입니다. 그리고 각 사용자의 홈 디렉토리에 setgid 설정을 적용하여, 해당 디렉토리 안에서 새로 생성되는 모든 파일/디렉토리의 소유 그룹이 자동으로 kwteam이 되도록 만듭니다.

1단계: kwteam 그룹 생성 및 사용자 추가
먼저, 두 계정을 모두 포함할 kwteam이라는 그룹을 생성합니다.

Bash

sudo groupadd kwteam
이제 kw와 kwkw 사용자를 kwteam 그룹에 추가합니다.

Bash

sudo usermod -aG kwteam kw
sudo usermod -aG kwteam kwkw
?? 중요: 그룹 설정을 시스템에 완전히 적용하려면, 두 계정 모두 로그아웃했다가 다시 로그인하거나 시스템을 재부팅해야 합니다.

2단계: 기존 파일 및 디렉토리 권한 변경
이미 생성된 파일과 디렉토리들의 소유 그룹을 kwteam으로 변경하고, 그룹 멤버들이 읽고, 쓰고, 실행할 수 있도록 권한을 부여합니다.

Bash

# /home/kw 디렉토리와 그 안의 모든 내용의 소유 그룹을 kwteam으로 변경
sudo chown -R :kwteam /home/kw

# /home/kwkw 디렉토리와 그 안의 모든 내용의 소유 그룹을 kwteam으로 변경
sudo chown -R :kwteam /home/kwkw

# 두 홈 디렉토리와 그 안의 모든 내용에 그룹 쓰기(w) 및 실행(x) 권한 추가
sudo chmod -R g+rwx /home/kw
sudo chmod -R g+rwx /home/kwkw
3단계: 향후 생성될 파일/디렉토리에 자동 권한 부여 (가장 중요)
이 단계가 앞으로 생성되는 모든 파일에 대한 공유를 자동화하는 핵심입니다. 홈 디렉토리에 setgid 비트를 설정합니다.

Bash

sudo chmod g+s /home/kw
sudo chmod g+s /home/kwkw
이제 kw 또는 kwkw 사용자가 각자의 홈 디렉토리(/home/kw 또는 /home/kwkw) 아래에 새로운 파일이나 디렉토리를 만들면, 해당 파일/디렉토리의 소유 그룹이 자동으로 kwteam으로 지정됩니다.

4단계: 기본 파일 생성 권한(umask) 설정
파일을 새로 만들 때 그룹 멤버가 바로 수정할 수 있도록 기본 권한을 설정해야 합니다. 각 사용자의 .bashrc 파일에 umask 002 설정을 추가합니다.

kw 사용자로 다음 명령을 실행하세요.

Bash

echo "umask 002" >> /home/kw/.bashrc
kwkw 사용자로 다음 명령을 실행하세요.

Bash

echo "umask 002" >> /home/kwkw/.bashrc
이 설정을 적용하려면 터미널을 새로 열거나 source ~/.bashrc 명령을 실행해야 합니다. (1단계에서 로그아웃/재로그인했다면 이미 적용됩니다.)

? 전체 명령어 요약 (복사해서 바로 사용)
아래 코드를 터미널에 그대로 붙여넣고 실행하시면 위 모든 과정이 한 번에 처리됩니다.

Bash

# 1. 공유 그룹 생성
sudo groupadd kwteam

# 2. 사용자들을 그룹에 추가
sudo usermod -aG kwteam kw
sudo usermod -aG kwteam kwkw

# 3. 기존 파일/디렉토리 소유 그룹 및 권한 변경
sudo chown -R :kwteam /home/kw /home/kwkw
sudo chmod -R g+rwx /home/kw /home/kwkw

# 4. 향후 자동 소유 그룹 설정을 위한 setgid 설정
sudo chmod g+s /home/kw /home/kwkw

# 5. umask 설정을 각 사용자 프로필에 추가
echo "umask 002" | sudo tee -a /home/kw/.bashrc /home/kwkw/.bashrc > /dev/null

echo "? 모든 설정이 완료되었습니다."
echo "?? kw와 kwkw 계정 모두 로그아웃 후 다시 로그인해야 모든 설정이 적용됩니다!"
이제 두 계정은 어떤 작업을 하든 서로의 파일에 완벽하게 접근하고 수정할 수 있으며, 새로 만드는 모든 파일도 자동으로 공유됩니