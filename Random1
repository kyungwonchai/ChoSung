아래는 MSSQL에서 요청하신 내용을 구현하는 SQL 쿼리입니다. LogSensors와 View_LogSensors 테이블을 조인하여 Pstart와 Pend 컬럼을 계산하여 조회하는 방식입니다.

sql
코드 복사
SELECT 
    LS.IP,
    (SELECT TOP 1 VL.Time1 
     FROM View_LogSensors VL 
     WHERE VL.IP = LS.IP AND VL.ReceivedMessage = 'processing start' 
     ORDER BY VL.ID DESC) AS Pstart,
    (SELECT TOP 1 VL.Time1 
     FROM View_LogSensors VL 
     WHERE VL.IP = LS.IP AND VL.ReceivedMessage = 'processing end' 
     ORDER BY VL.ID DESC) AS Pend
FROM 
    LogSensors LS;
쿼리 설명
LogSensors 테이블과 View_LogSensors 테이블의 관계 설정:

LogSensors의 IP 값을 기준으로 View_LogSensors의 IP를 조회합니다.
Pstart와 Pend 계산:

Pstart: View_LogSensors 테이블에서 ReceivedMessage 값이 'processing start'인 행의 Time1 컬럼 값을 가져오고, ID를 기준으로 내림차순 정렬하여 가장 최근 값을 선택합니다.
Pend: View_LogSensors 테이블에서 ReceivedMessage 값이 'processing end'인 행의 Time1 컬럼 값을 가져오고, ID를 기준으로 내림차순 정렬하여 가장 최근 값을 선택합니다.
서브쿼리:

각각의 컬럼(Pstart, Pend) 값을 서브쿼리로 가져와 LogSensors 테이블에 추가로 출력합니다.
결과 출력:
