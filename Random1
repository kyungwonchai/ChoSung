 VBA에서 특정 셀의 값에 **줄바꿈(개행)**이 포함되어 있을 때, 좌우에 따옴표가 자동으로 붙는 문제를 해결하려면 셀 값을 텍스트로 인식하면서 적절히 처리해야 합니다.

아래는 VBA 코드로 이를 해결하는 방법입니다.

VBA 코드
vba
코드 복사
Sub AddTTT1TTT2()
    Dim ws As Worksheet
    Dim targetCell As Range
    Dim cellValue As String
    Dim modifiedValue As String
    
    ' 현재 시트 선택
    Set ws = ThisWorkbook.Sheets(1) ' 1번 시트를 기준으로 함. 필요에 따라 수정하세요.
    
    ' 특정 셀 설정 (예: A1 셀)
    Set targetCell = ws.Range("A1") ' 여기서 "A1"을 원하는 셀 주소로 변경하세요.
    
    ' 셀 값 가져오기
    cellValue = targetCell.Value
    
    ' 줄바꿈이 포함된 셀 값 처리
    ' 기존 값을 "ttt1"과 "ttt2"로 감싸되, 따옴표 문제를 해결
    modifiedValue = "ttt1" & Replace(cellValue, vbLf, "ttt2" & vbLf & "ttt1") & "ttt2"
    
    ' 처리된 값을 다시 셀에 입력
    targetCell.Value = modifiedValue
    
    ' 값이 잘 바뀌었는지 확인
    MsgBox "변경 완료!", vbInformation
End Sub
코드 설명
targetCell 설정
targetCell에 원하는 셀 주소를 넣어줍니다. 예를 들어 A1입니다.

vbLf(줄바꿈 문자) 처리
줄바꿈이 포함된 셀의 값에 대해 Replace를 사용해서
각 줄의 앞뒤에 ttt1과 ttt2를 추가합니다.

결과 형태
예를 들어,

코드 복사
첫줄
둘줄
셋줄
이라는 값이 있었다면 최종 결과는

코드 복사
ttt1첫줄ttt2
ttt1둘줄ttt2
ttt1셋줄ttt2
Replace 함수

vbLf를 기준으로 각 줄 사이에 ttt2를 추가하면서 다음 줄에 ttt1을 삽입합니다.
처음과 끝에도 ttt1과 ttt2를 붙입니다.
문제 해결 확인
이 코드는 줄바꿈이 있는 셀에서도 따옴표가 붙지 않고 정상적으로 ttt1과 ttt2를 각 줄의 앞뒤에 추가합니다.