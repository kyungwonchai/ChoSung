import os

# --- 설정 (이 부분만 수정하세요) ---

# 1. 내용을 추출할 리액트 프로젝트 폴더 경로
PROJECT_PATH = r"C:\path\to\your\react\project"

# 2. 결과가 저장될 파일 이름
OUTPUT_FILENAME = "_summary.txt"

# --- 메인 코드 (수정할 필요 없음) ---

def summarize_react_project(project_path: str, output_filename: str):
    """
    지정된 프로젝트 폴더에서 소스 코드 파일들을 읽어 하나의 텍스트 파일로 합칩니다.
    """
    if not os.path.isdir(project_path):
        print(f"오류: '{project_path}'는 유효한 폴더가 아닙니다. 경로를 확인해주세요.")
        return

    print(f"'{project_path}' 폴더에서 텍스트 추출을 시작합니다...")
    
    all_text_content = []
    
    # 학습할 파일 확장자 목록
    target_extensions = ['.js', '.jsx', '.ts', '.tsx', '.md', '.txt', '.json']
    # 무시할 폴더 및 파일 목록
    ignore_items = ['node_modules', '.git', 'build', 'dist', 'public', 'package-lock.json']

    # os.walk를 사용하여 모든 하위 폴더와 파일을 순회합니다.
    for root, dirs, files in os.walk(project_path):
        # 무시할 폴더는 더 이상 탐색하지 않도록 설정
        dirs[:] = [d for d in dirs if d not in ignore_items]
        
        for file in files:
            # 무시할 파일 건너뛰기
            if file in ignore_items:
                continue
            
            # 원하는 확장자를 가진 파일만 처리
            if any(file.endswith(ext) for ext in target_extensions):
                file_path = os.path.join(root, file)
                relative_path = os.path.relpath(file_path, project_path)
                
                try:
                    with open(file_path, 'r', encoding='utf-8') as f:
                        content = f.read()
                        # 각 파일의 시작 부분에 경로를 헤더로 추가하여 구분
                        header = f"\n\n--- 파일 시작: {relative_path} ---\n\n"
                        all_text_content.append(header + content)
                except Exception as e:
                    print(f"    - 경고: {file_path} 파일을 읽는 중 오류 발생 - {e}")

    if not all_text_content:
        print("경고: 텍스트를 추출할 수 있는 파일을 찾지 못했습니다.")
        return

    # 추출된 모든 텍스트를 하나의 문자열로 합치고 최종 파일에 저장
    final_text = "".join(all_text_content)
    output_path = os.path.join(project_path, output_filename)
    
    try:
        with open(output_path, 'w', encoding='utf-8') as f:
            f.write(final_text)
        print("\n" + "="*50)
        print("? 텍스트 추출 및 병합 완료!")
        print(f"총 {len(all_text_content)}개 파일의 내용이 아래 파일에 저장되었습니다:")
        print(f"-> {output_path}")
        print("="*50)
    except Exception as e:
        print(f"오류: 최종 파일을 저장하는 데 실패했습니다 - {e}")


# --- 스크립트 실행 ---
if __name__ == "__main__":
    summarize_react_project(PROJECT_PATH, OUTPUT_FILENAME)