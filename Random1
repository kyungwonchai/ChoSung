W 시트의 A열에서 찾은 위치 사이의 B열 값 중 중복되지 않는 값을 가져오는 것입니다. 또한, B열에서 0이 아닌 값만 필터링해야 합니다.

목표:
설정1 시트의 B1과 J1 값을 RAW 시트의 A열에서 찾고, 해당 위치 사이의 B열 값 중 중복을 제거하고, 0이 아닌 값만 필터링하여 설정1 시트의 K1 셀에 표시하는 방법입니다.
해결 방법:
B1과 J1 값의 위치 찾기 (RAW 시트 A열에서)
B열 값 중 중복 제거 및 0 값 필터링하여 K1에 표시
단계별 구현
1. B1과 J1 값의 위치 찾기 (MATCH 함수)
먼저 B1과 J1 값이 RAW 시트의 A열에서 어디에 있는지 찾습니다. 이를 위해 MATCH 함수를 사용하여 B1과 J1 값의 위치를 찾아냅니다.

excel
코드 복사
=MATCH(B1, RAW!A:A, 0)  'B1 값이 RAW 시트의 A열에서 있는 위치 찾기
=MATCH(J1, RAW!A:A, 0)  'J1 값이 RAW 시트의 A열에서 있는 위치 찾기
2. 찾은 위치 사이의 B열 값 가져오기 (INDEX 함수)
이제, 찾은 위치 사이의 B열 값을 가져옵니다. INDEX 함수를 사용하여 RAW 시트의 B열 값을 가져오고, 그 중 0이 아닌 값만 필터링합니다.

excel
코드 복사
=UNIQUE(FILTER(RAW!B:B, (RAW!B:B<>0)*(ROW(RAW!A:A)>=MATCH(B1, RAW!A:A, 0))*(ROW(RAW!A:A)<=MATCH(J1, RAW!A:A, 0))))
3. 최종 수식
위 수식을 설정1 시트의 K1 셀에 입력합니다.

최종 수식 (설정1 시트의 K1 셀에 입력):
excel
코드 복사
=UNIQUE(FILTER(RAW!B:B, (RAW!B:B<>0)*(ROW(RAW!A:A)>=MATCH(B1, RAW!A:A, 0))*(ROW(RAW!A:A)<=MATCH(J1, RAW!A:A, 0))))
수식 설명:
MATCH(B1, RAW!A:A, 0): RAW 시트의 A열에서 B1 값이 있는 행을 찾습니다.
MATCH(J1, RAW!A:A, 0): RAW 시트의 A열에서 J1 값이 있는 행을 찾습니다.
ROW(RAW!A:A)>=...: B1 값이 있는 행부터 J1 값이 있는 행 사이의 행을 필터링합니다.
RAW!B:B<>0: B열 값 중에서 0이 아닌 값만 필터링합니다.
FILTER(..., ...): 필터 조건에 맞는 데이터를 가져옵니다.
UNIQUE(...): 중복된 값을 제거하여 고유한 값만 반환합니다.