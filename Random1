    시트의 2행을 순회하며 날짜 형식의 셀을 찾습니다.
    찾은 날짜가 이번 주에 해당하는지 확인합니다.
    이번 주에 해당하는 열의 배경색을 노랑색으로 변경합니다.

vba

Sub UpdateWeeklyPlanColor()
    Dim fd As FileDialog
    Dim filePath As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim cell As Range
    Dim startDate As Date
    Dim endDate As Date
    
    ' 파일 선택 대화상자 생성
    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    
    ' 파일 선택 대화상자 표시
    If fd.Show = -1 Then
        filePath = fd.SelectedItems(1)
    Else
        Exit Sub
    End If
    
    ' 선택된 파일 열기
    Set wb = Workbooks.Open(filePath)
    Set ws = wb.Sheets("당주계획")

    ' 이번 주 시작일과 종료일 계산
    startDate = Date - Weekday(Date, vbMonday) + 1
    endDate = startDate + 6

    ' 2행의 모든 셀을 순회
    For Each cell In ws.Rows(2).Cells
        If IsDate(cell.Value) Then
            Dim cellDate As Date
            cellDate = DateValue(cell.Value)
            
            ' 셀의 날짜가 이번 주에 해당하는지 확인
            If cellDate >= startDate And cellDate <= endDate Then
                ' 배경색을 노랑색으로 변경
                ws.Columns(cell.Column).Interior.Color = vbYellow
            End If
        End If
    Next cell

    ' 파일을 닫지 않고 열어둔 상태로 둠
End Sub

이 코드는 '당주계획' 시트의 2행에 있는 날짜 데이터를 기반으로 이번 주 해당하는 열의