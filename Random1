아래는 C# WinForms에서 특정 프린터 이름(예: CCC444)이 포함된 경우 해당 프린터로 출력하고, 그렇지 않으면 기본 프린터로 출력하도록 설정하는 코드입니다.

코드
csharp
코드 복사
using System;
using System.Drawing.Printing;
using System.Linq;
using System.Windows.Forms;

namespace PrintExample
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void PrintDocument()
        {
            try
            {
                // 출력할 문서 생성
                PrintDocument printDoc = new PrintDocument();

                // 모든 프린터 가져오기
                PrinterSettings.StringCollection installedPrinters = PrinterSettings.InstalledPrinters;

                // 특정 프린터 이름 찾기
                string specificPrinter = installedPrinters.Cast<string>()
                    .FirstOrDefault(p => p.Contains("CCC444"));

                if (specificPrinter != null)
                {
                    // 특정 프린터가 존재하면 해당 프린터로 설정
                    printDoc.PrinterSettings.PrinterName = specificPrinter;
                    MessageBox.Show($"프린터 '{specificPrinter}'로 출력합니다.");
                }
                else
                {
                    // 특정 프린터가 없으면 기본 프린터로 설정
                    printDoc.PrinterSettings.PrinterName = new PrinterSettings().PrinterName;
                    MessageBox.Show("기본 프린터로 출력합니다.");
                }

                // PrintPage 이벤트에 출력할 내용을 설정
                printDoc.PrintPage += (sender, e) =>
                {
                    e.Graphics.DrawString("테스트 출력", new Font("Arial", 12), Brushes.Black, new PointF(100, 100));
                };

                // 출력
                printDoc.Print();
            }
            catch (Exception ex)
            {
                MessageBox.Show($"출력 중 오류 발생: {ex.Message}");
            }
        }

        private void btnPrint_Click(object sender, EventArgs e)
        {
            PrintDocument();
        }
    }
}
코드 설명
모든 프린터 검색

PrinterSettings.InstalledPrinters를 사용해 설치된 프린터 목록을 가져옵니다.
LINQ의 FirstOrDefault를 사용해 이름에 CCC444가 포함된 프린터를 검색합니다.
특정 프린터 설정

특정 프린터 이름(CCC444)이 발견되면 printDoc.PrinterSettings.PrinterName에 해당 이름을 설정합니다.
발견되지 않으면 기본 프린터(PrinterSettings().PrinterName)를 사용합니다.
PrintPage 이벤트

출력할 내용을 설정합니다. 여기서는 "테스트 출력" 텍스트를 출력합니다.
출력

PrintDocument.Print()를 호출해 출력합니다.
사용 방법
PrintDocument()를 호출해 출력 과정을 실행합니다.