VBAì—ì„œ MSSQLì— ê°’ì„ INSERTí•  ë•Œ, í˜„ì¬ ì‹œê°„ì„ "yyyy-MM-dd HH:mm:00" í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê³ , mmì„ ê°€ê¹Œìš´ 10ë¶„ ë‹¨ìœ„ë¡œ ë°˜ì˜¬ë¦¼í•˜ì—¬ ì €ì¥í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

âœ… VBA ì½”ë“œ (MSSQL INSERT with Time Rounding)
vba
ì½”ë“œ ë³µì‚¬
Sub InsertIntoMSSQL()
    Dim conn As Object
    Dim cmd As Object
    Dim strSQL As String
    Dim connString As String
    Dim roundedTime As String
    
    ' 1. í˜„ì¬ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
    Dim nowTime As Date
    nowTime = Now()
    
    ' 2. ë¶„ ë‹¨ìœ„ ë°˜ì˜¬ë¦¼ (10ë¶„ ë‹¨ìœ„)
    Dim minutes As Integer
    minutes = Minute(nowTime)
    
    ' 3. ê°€ì¥ ê°€ê¹Œìš´ 10ë¶„ ë‹¨ìœ„ë¡œ ì¡°ì •
    minutes = ((minutes \ 10) + 1) * 10
    If minutes = 60 Then
        nowTime = DateAdd("h", 1, nowTime) ' í•œ ì‹œê°„ ì¦ê°€
        minutes = 0 ' 60ë¶„ -> 00ë¶„ ì²˜ë¦¬
    End If
    
    ' 4. ìµœì¢… í¬ë§· (yyyy-MM-dd HH:mm:00)
    roundedTime = Format(nowTime, "yyyy-MM-dd HH:" & Format(minutes, "00") & ":00")
    
    ' 5. SQL ì—°ê²° ë¬¸ìì—´ (í•„ìš”ì— ë§ê²Œ ë³€ê²½)
    connString = "Provider=SQLOLEDB;Data Source=ì„œë²„ì´ë¦„;Initial Catalog=DBì´ë¦„;User ID=ì‚¬ìš©ìID;Password=ë¹„ë°€ë²ˆí˜¸;"

    ' 6. MSSQL ì—°ê²° ë° INSERT ì‹¤í–‰
    Set conn = CreateObject("ADODB.Connection")
    Set cmd = CreateObject("ADODB.Command")
    
    On Error Resume Next
    conn.Open connString
    If Err.Number <> 0 Then
        MsgBox "ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜: " & Err.Description, vbCritical
        Exit Sub
    End If
    
    ' 7. INSERT SQL ì‹¤í–‰
    strSQL = "INSERT INTO TableName (TimeColumn) VALUES ('" & roundedTime & "')"
    
    cmd.ActiveConnection = conn
    cmd.CommandText = strSQL
    cmd.Execute
    
    ' 8. ì—°ê²° ë‹«ê¸°
    conn.Close
    Set cmd = Nothing
    Set conn = Nothing
    
    ' 9. ì™„ë£Œ ë©”ì‹œì§€
    MsgBox "ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤: " & roundedTime, vbInformation
End Sub
ğŸ”¹ ì„¤ëª…
Now()ë¡œ í˜„ì¬ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°.
Minute(Now)ë¥¼ ì´ìš©í•´ í˜„ì¬ ë¶„ í™•ì¸.
10ë¶„ ë‹¨ìœ„ë¡œ ë°˜ì˜¬ë¦¼:
ì˜ˆ: 14:50 â†’ 15:00, 15:10 â†’ 15:20
60ë¶„ì´ ë˜ë©´ í•œ ì‹œê°„ ì¦ê°€ (15:60 â†’ 16:00)
Format()ì„ ì‚¬ìš©í•´ "yyyy-MM-dd HH:mm:00" í˜•ì‹ìœ¼ë¡œ ë³€í™˜.
ADODB.Connectionì„ ì‚¬ìš©í•˜ì—¬ MSSQLì— ì—°ê²°.
INSERT INTO TableName (TimeColumn) VALUES ('yyyy-MM-dd HH:mm:00') ì‹¤í–‰.
âœ… ì˜ˆì œ ê²°ê³¼
í˜„ì¬ ì‹œê°„	ì €ì¥ë˜ëŠ” ê°’
14:50:30	15:00:00
15:09:15	15:10:00