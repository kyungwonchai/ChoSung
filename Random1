using iText.Kernel.Pdf;
using iText.Kernel.Pdf.Canvas.Parser;
using iText.Kernel.Pdf.Canvas.Parser.Listener;
using iText.Kernel.Utils;
using System.IO;

// ...

string pdfFilePath = "example.pdf";
string outputFolder = "output";

using (PdfDocument pdfDocument = new PdfDocument(new PdfReader(pdfFilePath)))
{
    Directory.CreateDirectory(outputFolder);

    for (int pageNum = 1; pageNum <= pdfDocument.GetNumberOfPages(); pageNum++)
    {
        string imagePath = Path.Combine(outputFolder, $"page{pageNum}.png");
        using (FileStream fs = new FileStream(imagePath, FileMode.Create))
        {
            PdfPage pdfPage = pdfDocument.GetPage(pageNum);
            PageSize pageSize = pdfPage.GetPageSize();

            PdfCanvasProcessor parser = new PdfCanvasProcessor(new ImageRenderListener(new PdfCanvasProcessor(new PdfCanvas(pdfPage)), fs));
            parser.ProcessPageContent(pdfPage);

            ImageData imageData = ImageDataFactory.Create(imagePath);
            ImageConverter converter = new ImageConverter();
            converter.ConvertToPng(imageData, new FileStream(imagePath, FileMode.Create));
        }
    }
}
