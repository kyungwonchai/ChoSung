using System;
using System.Drawing;
using System.IO;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using DevExpress.XtraEditors;
using System.Timers;

public partial class MainForm : Form
{
    // ...
    // 이전의 필드 및 코드는 동일하게 유지합니다.
    private System.Timers.Timer restoreTimer;

    public MainForm()
    {
        InitializeComponent();

        // 타이머를 생성하고 설정합니다.
        restoreTimer = new System.Timers.Timer(1000);  // 1초 후에 실행됩니다.
        restoreTimer.AutoReset = false;  // 타이머가 한 번만 실행되도록 설정합니다.
        restoreTimer.Elapsed += RestoreTimer_Elapsed;

        // Resize 이벤트 핸들러를 추가합니다.
        this.Resize += MainForm_Resize;
    }

    private void MainForm_Resize(object sender, EventArgs e)
    {
        // 폼이 최소화 상태일 경우 타이머를 시작합니다.
        if (this.WindowState == FormWindowState.Minimized)
        {
            restoreTimer.Start();
        }
    }

    private void RestoreTimer_Elapsed(object sender, ElapsedEventArgs e)
    {
        // 타이머가 실행되면 폼의 상태를 복원합니다.
        this.Invoke(new Action(() =>
        {
            this.WindowState = FormWindowState.Normal;
        }));
    }

    // 나머지 코드는 이전과 동일합니다.
}
