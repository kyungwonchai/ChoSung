using System;
using System.Drawing;
using System.IO;
using System.Windows.Forms;
using Excel = Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        try
        {
            // 엑셀 어플리케이션 시작
            Excel.Application excelApp = new Excel.Application();
            excelApp.Visible = false;

            // 엑셀 파일 열기
            Excel.Workbook workbook = excelApp.Workbooks.Open("파일경로.xlsx"); // 엑셀 파일 경로 입력
            Excel.Worksheet worksheet = workbook.ActiveSheet;

            // 셀 범위 지정
            Excel.Range range = worksheet.Range["A1:B2"]; // 이미지로 저장할 셀 범위

            // 범위를 이미지로 변환
            Image image = CopyRangeToImage(range);

            // 이미지를 클립보드로 복사
            Clipboard.SetImage(image);

            // 이미지를 파일로 저장
            string filePath = "이미지파일경로.png"; // 저장할 이미지 파일 경로와 확장자 지정
            image.Save(filePath, System.Drawing.Imaging.ImageFormat.Png);

            // 엑셀 종료
            workbook.Close(false);
            excelApp.Quit();

            Console.WriteLine("이미지가 성공적으로 저장되었습니다.");
        }
        catch (Exception ex)
        {
            Console.WriteLine("에러: " + ex.Message);
        }
    }

    static Image CopyRangeToImage(Excel.Range range)
    {
        // 셀 범위를 이미지 크기로 조정
        range.CopyPicture(Excel.XlPictureAppearance.xlScreen, Excel.XlCopyPictureFormat.xlBitmap);
        Image image = Clipboard.GetImage();

        return image;
    }
}
