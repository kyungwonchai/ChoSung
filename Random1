using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public partial class MainForm : Form
{
    [DllImport("user32.dll")]
    static extern void mouse_event(int dwFlags, int dx, int dy, int dwData, int dwExtraInfo);

    private const int MOUSEEVENTF_LEFTDOWN = 0x02;
    private const int MOUSEEVENTF_LEFTUP = 0x04;
    private Timer clickTimer = new Timer();

    public MainForm()
    {
        InitializeComponent();
        clickTimer.Tick += ClickTimer_Tick;
    }

    private void startButton_Click(object sender, EventArgs e)
    {
        if (int.TryParse(xCoordTextBox.Text, out int x) && int.TryParse(yCoordTextBox.Text, out int y) && int.TryParse(delayTextBox.Text, out int delay))
        {
            clickTimer.Interval = delay * 1000;  // Convert seconds to milliseconds
            clickTimer.Start();
        }
        else
        {
            MessageBox.Show("Please enter valid coordinates and delay.");
        }
    }

    private void ClickTimer_Tick(object sender, EventArgs e)
    {
        if (int.TryParse(xCoordTextBox.Text, out int x) && int.TryParse(yCoordTextBox.Text, out int y))
        {
            Cursor.Position = new System.Drawing.Point(x, y);
            mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, x, y, 0, 0);
        }
    }
}
