ReceivedMessage 컬럼에서 send:와 receive:를 기준으로 데이터를 추출하여 두 개의 별도 컬럼(magno, ngname)으로 정리하고, 나머지 컬럼은 전체 조회하는 MSSQL 쿼리를 작성하겠습니다.

아래는 SQL 쿼리입니다:

sql
코드 복사
SELECT 
    *,
    SUBSTRING(
        ReceivedMessage,
        CHARINDEX('send:', ReceivedMessage) + 5, 
        CHARINDEX(' ', ReceivedMessage + ' ', CHARINDEX('send:', ReceivedMessage) + 5) - CHARINDEX('send:', ReceivedMessage) - 5
    ) AS magno,
    SUBSTRING(
        ReceivedMessage,
        CHARINDEX('receive:', ReceivedMessage) + 8, 
        LEN(ReceivedMessage) - CHARINDEX('receive:', ReceivedMessage) - 7
    ) AS ngname
FROM YourTableName
WHERE CHARINDEX('send:', ReceivedMessage) > 0 AND CHARINDEX('receive:', ReceivedMessage) > 0;
쿼리 설명:
SUBSTRING과 CHARINDEX 사용:

magno 컬럼:
CHARINDEX('send:', ReceivedMessage)로 send:의 시작 위치를 찾습니다.
+5를 더해 send: 뒤의 첫 번째 문자의 위치를 계산합니다.
다음 공백의 위치를 찾기 위해 CHARINDEX(' ', ...)를 사용하고, 길이를 계산하여 해당 문자열을 추출합니다.
ngname 컬럼:
CHARINDEX('receive:', ReceivedMessage)로 receive:의 시작 위치를 찾습니다.
+8을 더해 receive: 뒤의 문자열부터 끝까지 추출합니다.
WHERE 조건:

send:와 receive:가 모두 포함된 경우에만 결과를 필터링합니다.
전체 조회:

나머지 컬럼은 *로 모두 조회합니다.
실행 예시:
ReceivedMessage 예제 데이터:

makefile
코드 복사
send: MAG001 receive: NGNameExample
send: MAG002 receive: AnotherNGName
결과:

ReceivedMessage	magno	ngname
send: MAG001 receive: NGNameExample	MAG001	NGNameExample