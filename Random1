using System;
using System.Windows.Forms;

public class Program : Form
{
    private NotifyIcon notifyIcon;
    private ContextMenu contextMenu;
    private MenuItem menuItem;

    public Program()
    {
        this.Text = "Tray Example";
        this.WindowState = FormWindowState.Minimized;
        this.ShowInTaskbar = false;

        contextMenu = new ContextMenu();
        menuItem = new MenuItem("닫기");

        menuItem.Click += new EventHandler(ExitApp);
        contextMenu.MenuItems.Add(menuItem);

        notifyIcon = new NotifyIcon
        {
            Icon = new System.Drawing.Icon("your_icon.ico"), // 아이콘 경로를 지정해주세요.
            ContextMenu = contextMenu,
            Visible = true
        };

        notifyIcon.DoubleClick += new EventHandler(ShowApp);
        this.FormClosing += new FormClosingEventHandler(OnFormClosing);
    }

    private void ShowApp(object sender, EventArgs e)
    {
        this.WindowState = FormWindowState.Normal;
        this.ShowInTaskbar = true;
    }

    private void ExitApp(object sender, EventArgs e)
    {
        notifyIcon.Dispose();
        Application.Exit();
    }

    private void OnFormClosing(object sender, FormClosingEventArgs e)
    {
        e.Cancel = true;
        this.WindowState = FormWindowState.Minimized;
        this.ShowInTaskbar = false;
    }

    public static void Main()
    {
        Application.Run(new Program());
    }
}
