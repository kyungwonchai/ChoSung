우스를 특정 위치로 이동
✅ 해당 위치에서 Ctrl + C 키 입력 (복사)
✅ 비동기 (async) 지원 가능

🚀 C# 키 입력을 통한 Ctrl + C 복사 코드
csharp
코드 복사
using System;
using System.Runtime.InteropServices;
using System.Threading.Tasks;

class Program
{
    // 마우스 이동 및 키 입력을 위한 WinAPI 호출
    [DllImport("user32.dll")]
    private static extern void SetCursorPos(int x, int y);

    [DllImport("user32.dll", SetLastError = true)]
    private static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, int dwExtraInfo);

    private const byte VK_CONTROL = 0x11; // Ctrl 키
    private const byte VK_C = 0x43;       // C 키
    private const uint KEYEVENTF_KEYDOWN = 0x0000;
    private const uint KEYEVENTF_KEYUP = 0x0002;

    static async Task Main()
    {
        int targetX = 1000;  // 원하는 X 좌표
        int targetY = 500;   // 원하는 Y 좌표

        Console.WriteLine("📌 마우스 이동 및 Ctrl+C 키 전송 시작...");
        await CopyAtPositionAsync(targetX, targetY);
        Console.WriteLine("✅ 복사 완료!");
    }

    /// <summary>
    /// 특정 위치에서 `Ctrl + C` 키 입력 (복사)
    /// </summary>
    static async Task CopyAtPositionAsync(int x, int y)
    {
        await Task.Run(() =>
        {
            // 1️⃣ 마우스 특정 위치로 이동
            SetCursorPos(x, y);
            Task.Delay(100).Wait(); // 잠시 대기

            // 2️⃣ Ctrl + C 키 입력
            keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYDOWN, 0); // Ctrl 누르기
            keybd_event(VK_C, 0, KEYEVENTF_KEYDOWN, 0);       // C 누르기

            Task.Delay(50).Wait(); // 입력 유지

            keybd_event(VK_C, 0, KEYEVENTF_KEYUP, 0);         // C 떼기
            keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYUP, 0);   // Ctrl 떼기
        });
    }
}
✅ 코드 설명
🖱 마우스 이동

SetCursorPos(x, y); → 특정 위치로 마우스 이동
⌨ Ctrl + C 입력

keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYDOWN, 0); → Ctrl 누름
keybd_event(VK_C, 0, KEYEVENTF_KEYDOWN, 0); → C 누름
(50ms 유지)
keybd_event(VK_C, 0, KEYEVENTF_KEYUP, 0); → C 떼기
keybd_event(VK_CONTROL, 0, KEYEVENTF_KEYUP, 0); → Ctrl 떼기
비동기 실행

await Task.Run(() => { ... }) → 비동기로 실행하여 UI 블록 방지
Task.Delay(100).Wait(); → 이벤트 간 지연 추가 (정확한 입력 보장)
📌 실행 예시 (콘솔 출력)
mathematica
코드 복사
📌 마우스 이동 및 Ctrl+C 키 전송 시작...
✅ 복사 완료!
✔ 특정 좌표에서 Ctrl + C 입력 성공
✔ 비동기로 실행되어 프로그램이 멈추지 않음

🔥 추가 개선 가능 요소
✅ Task.Delay() 값 조정 가능 (0.05~0.2초 추천)
✅ 입력값 변경 (Ctrl + X, Ctrl + V 가능)
✅ OCR 연동 → Ctrl + C 후 클립보드에서 텍스트 읽기 가능
