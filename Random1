Windows 11에서 Process Monitor (ProcMon) 전체 로그를 일정 시간 동안 기록하여 파일로 저장하는 방법을 안내해 드리겠습니다. ProcMon은 시스템에서 발생하는 모든 파일 시스템, 레지스트리, 네트워크, 프로세스 및 스레드 활동을 실시간으로 모니터링하는 강력한 도구입니다.

방법은 크게 두 가지가 있습니다:

GUI를 이용한 수동 방법: 사용자가 직접 시작하고 중지하는 방식입니다.
명령줄(Command Line)을 이용한 자동 방법: 지정된 시간 동안 실행 후 자동으로 종료하고 저장합니다.
📝 방법 1: GUI를 이용한 수동 기록 및 저장
Process Monitor 다운로드 및 실행:

Microsoft Sysinternals 사이트에서 Process Monitor를 다운로드합니다.
압축을 풀고 Procmon.exe 파일을 관리자 권한으로 실행합니다. (마우스 오른쪽 클릭 > 관리자 권한으로 실행)
캡처 시작:

ProcMon이 실행되면 자동으로 이벤트 캡처를 시작합니다. 만약 자동으로 시작되지 않거나 중지된 상태라면, 툴바의 **돋보기 아이콘 (Capture Events)**을 클릭하거나 Ctrl+E를 눌러 캡처를 시작합니다.
(예시 아이콘 이미지)

원하는 시간 동안 대기:

로그를 기록하고자 하는 시간 동안 그대로 둡니다. 백그라운드에서 모든 활동이 기록됩니다.
캡처 중지:

원하는 시간이 지나면 다시 돋보기 아이콘을 클릭하거나 Ctrl+E를 눌러 캡처를 중지합니다.
로그 파일로 저장:

메뉴에서 File > Save... 를 선택합니다.
Events to save 옵션에서 All events를 선택합니다.
Format 옵션에서 **Native Process Monitor Format (PML)**을 선택하는 것이 좋습니다. 이 형식은 나중에 ProcMon에서 다시 열어 분석하기에 가장 좋습니다. (CSV 등으로도 저장 가능하나, 정보 손실이 있을 수 있습니다.)
파일 경로와 이름을 지정한 후 OK 버튼을 누릅니다.
(예시 저장 옵션 이미지)

⚙️ 방법 2: 명령줄(Command Line)을 이용한 자동 기록 및 저장
이 방법은 정확히 지정된 시간 동안만 로그를 기록하고 자동으로 종료하여 파일로 저장하고 싶을 때 유용합니다.

Process Monitor 다운로드:

위의 방법 1과 동일하게 다운로드하고 원하는 경로에 압축을 해제합니다. (예: C:\ProcMon)
명령 프롬프트 또는 PowerShell을 관리자 권한으로 실행:

시작 메뉴에서 cmd 또는 powershell을 검색하고, 마우스 오른쪽 클릭 > 관리자 권한으로 실행을 선택합니다.
명령어 입력:

다음 형식의 명령어를 입력합니다.
<!-- end list -->

DOS

C:\ProcMon\Procmon.exe /AcceptEula /Quiet /Minimized /BackingFile C:\경로\파일명.PML /Runtime <초단위 시간>
C:\ProcMon\Procmon.exe: ProcMon 실행 파일의 실제 경로로 수정하세요.
/AcceptEula: 처음 실행 시 나타나는 EULA(최종 사용자 사용권 계약) 창을 자동으로 수락합니다.
/Quiet: ProcMon GUI 창을 표시하지 않고 백그라운드에서 실행합니다. (GUI를 보려면 이 옵션을 빼거나 /Minimized 대신 /Nofilter 등을 사용할 수 있습니다.)
/Minimized: ProcMon 창을 최소화된 상태로 시작합니다. (GUI를 숨기려면 /Quiet 사용)
/BackingFile C:\경로\파일명.PML: 로그를 저장할 파일의 전체 경로와 파일명을 지정합니다. 반드시 .PML 확장자를 사용하세요. (예: C:\Logs\MyProcMonLog.PML)
/Runtime <초단위 시간>: ProcMon을 실행할 총 시간을 초 단위로 지정합니다. 예를 들어 10분 동안 기록하려면 600 (10분 * 60초)을 입력합니다.
예시 (15분 동안 로그 기록 후 D:\Temp\SystemLog.PML 파일로 저장):

DOS

C:\ProcMon\Procmon.exe /AcceptEula /Quiet /Minimized /BackingFile D:\Temp\SystemLog.PML /Runtime 900
실행 및 대기:

명령어를 입력하고 Enter 키를 누르면 ProcMon이 지정된 시간 동안 백그라운드에서 실행되며 로그를 기록합니다. 지정된 시간이 지나면 자동으로 종료되고 로그 파일이 생성됩니다.
⚠️ 주의사항 및 팁
관리자 권한: ProcMon은 시스템의 모든 활동을 감시하므로 반드시 관리자 권한으로 실행해야 완전한 로그를 얻을 수 있습니다.
로그 파일 크기: 전체 시스템 활동을 로깅하면 파일 크기가 매우 커질 수 있습니다. 디스크 공간이 충분한지 확인하세요.
불필요한 프로그램 종료: 정확한 분석을 원한다면, 로그 기록 전에 불필요한 응용 프로그램을 최대한 종료하여 노이즈를 줄이는 것이 좋습니다.