using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Threading.Tasks;

class Program
{
    // ë§ˆìš°ìŠ¤ í´ë¦­ì„ ìœ„í•œ WinAPI í˜¸ì¶œ
    [DllImport("user32.dll")]
    private static extern void SetCursorPos(int x, int y);

    [DllImport("user32.dll")]
    private static extern void mouse_event(int dwFlags, int dx, int dy, int dwData, int dwExtraInfo);

    private const int MOUSEEVENTF_LEFTDOWN = 0x02;
    private const int MOUSEEVENTF_LEFTUP = 0x04;

    static async Task Main()
    {
        // ìˆ«ì ê°ì§€ í›„ ê°’ ë°›ê¸°
        (int number, string text) = await DetectNumberAsync();

        // ìˆ«ìê°€ ìŒìˆ˜ì¸ì§€ í™•ì¸
        if (number < 0)
        {
            Console.WriteLine($"ğŸš« ìŒìˆ˜ ê°ì§€ë¨: {text} (ìˆ«ì: {number}) â†’ í´ë¦­ ì•ˆ í•¨");
        }
        else
        {
            Console.WriteLine($"âœ… ìˆ«ì ê°ì§€: {text} (ìˆ«ì: {number}) â†’ í´ë¦­ ìˆ˜í–‰");
            await ClickAsync(100, 200); // ì˜ˆì œ í´ë¦­
        }
    }

    /// <summary>
    /// ğŸ” ìˆ«ì ê°ì§€ í•¨ìˆ˜ (ìˆ«ì + ë¬¸ì ë¦¬í„´)
    /// </summary>
    static async Task<(int, string)> DetectNumberAsync()
    {
        return await Task.Run(() =>
        {
            int detectedNumber = -3;   // ê°ì§€ëœ ìˆ«ì (ì˜ˆì œ)
            string detectedText = "-3"; // ê°ì§€ëœ ë¬¸ì ê°’ (ì˜ˆì œ)

            return (detectedNumber, detectedText); // 2ê°œ ê°’ ë°˜í™˜ (Tuple)
        });
    }

    /// <summary>
    /// ğŸ–±ï¸ ë¹„ë™ê¸° ë§ˆìš°ìŠ¤ í´ë¦­ (0.5ì´ˆ ì´ë‚´ ì‹¤í–‰)
    /// </summary>
    static async Task ClickAsync(int x, int y)
    {
        await Task.Run(() =>
        {
            SetCursorPos(x, y);
            mouse_event(MOUSEEVENTF_LEFTDOWN, x, y, 0, 0);
            mouse_event(MOUSEEVENTF_LEFTUP, x, y, 0, 0);
        });

        Console.WriteLine($"í´ë¦­: X={x}, Y={y}");
    }