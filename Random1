using System;
using System.Data;
using System.Data.SqlClient;

class Program
{
    static void Main()
    {
        string connectionString = "your_connection_string_here";

        // Step 1: Get data from T_메인확정
        DataTable dataTable = new DataTable();
        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            string query = "SELECT C_Basicname, C_18 FROM T_메인확정";
            using (SqlCommand command = new SqlCommand(query, connection))
            {
                connection.Open();
                using (SqlDataAdapter adapter = new SqlDataAdapter(command))
                {
                    adapter.Fill(dataTable);
                }
            }
        }

        // Step 2: Loop through the data and update 모델정보_조장
        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            connection.Open();
            using (SqlTransaction transaction = connection.BeginTransaction())
            {
                try
                {
                    for (int i = 0; i < dataTable.Rows.Count; i++)
                    {
                        string C_Basicname = dataTable.Rows[i]["C_Basicname"].ToString();
                        decimal C_18 = Convert.ToDecimal(dataTable.Rows[i]["C_18"]);

                        string updateQuery = "UPDATE 모델정보_조장 SET 모델효율 = @C_18 WHERE 모델명 = @C_Basicname";
                        using (SqlCommand updateCommand = new SqlCommand(updateQuery, connection, transaction))
                        {
                            updateCommand.Parameters.AddWithValue("@C_18", C_18);
                            updateCommand.Parameters.AddWithValue("@C_Basicname", C_Basicname);
                            updateCommand.ExecuteNonQuery();
                        }
                    }

                    // Commit the transaction
                    transaction.Commit();
                }
                catch (Exception ex)
                {
                    // Rollback the transaction if any error occurs
                    transaction.Rollback();
                    Console.WriteLine("Error: " + ex.Message);
                }
            }
        }

        Console.WriteLine("Update completed successfully.");
    }
}
