PM2 서비스가 단 한 번도 온라인 상태가 되지 않으면 재부팅되도록 설정하는 개념은 다음과 같이 요약할 수 있습니다.

와치독의 3분 감시 개념
이 설정은 "와치독 데몬(Daemon)"과 "하드웨어 와치독 타이머"라는 두 가지 요소의 상호작용으로 이루어집니다.

와치독 데몬 (주인):

interval = 20 설정에 따라 20초마다 한 번씩 PM2 서비스의 상태를 확인하는 스크립트(pm2-app-check.sh)를 실행합니다.

스크립트가 성공(exit 0)하면, 와치독 데몬은 하드웨어 타이머를 리셋(펫팅)하여 **'시스템이 살아있다'**는 신호를 보냅니다.

스크립트가 실패(exit 1)하면, 데몬은 신호를 보내지 않고 침묵합니다.

하드웨어 와치독 타이머 (강아지):

watchdog-timeout = 185 설정에 따라 185초라는 카운트다운을 시작합니다.

데몬으로부터 리셋 신호를 받으면, 타이머는 다시 185초부터 카운트를 시작합니다.

데몬이 침묵하여 185초 동안 리셋 신호를 받지 못하면, 타이머는 0이 됩니다.

전체 시나리오
PM2 서비스가 온라인 상태일 때:
20초마다 스크립트가 성공(exit 0)합니다. → 와치독 데몬이 185초 타이머를 계속해서 리셋합니다. → 재부팅은 절대 일어나지 않습니다.

PM2 서비스가 3분(180초) 동안 한 번도 온라인이 아닐 때:
20초마다 스크립트가 계속해서 실패(exit 1)합니다. → 와치독 데몬이 185초 타이머를 리셋하지 않습니다. → 185초가 지나면 타이머가 만료되어 하드웨어적인 신호로 시스템을 강제 재부팅합니다.