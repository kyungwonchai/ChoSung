using System;
using System.Collections.Generic;
using System.Data.SqlClient;

namespace UpdateQueryExample
{
    class Program
    {
        static void Main(string[] args)
        {
            List<string> columns = new List<string> { "Column1", "Column2", "Column3", /* ... */ };  // 전체 컬럼명
            List<string> excludeColumns = new List<string> { "Exclude1", "Exclude2" };  // 제외할 컬럼명
            Dictionary<string, string> data1 = new Dictionary<string, string> { { "Column1", "Value1" }, { "Column2", "Value2" }, /* ... */ };

            // 제외할 컬럼을 제외한 업데이트할 컬럼 리스트 생성
            List<string> updateColumns = new List<string>();
            foreach (string col in columns)
            {
                if (!excludeColumns.Contains(col))
                {
                    updateColumns.Add(col);
                }
            }

            // 업데이트 쿼리 문자열 생성
            string updateSetClause = string.Join(", ", updateColumns.ConvertAll(col => $"{col} = @{col}"));
            string updateQuery = $"UPDATE YourTable SET {updateSetClause} WHERE YourCondition";

            string connectionString = "Your Connection String Here";

            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                conn.Open();
                using (SqlCommand cmd = new SqlCommand(updateQuery, conn))
                {
                    foreach (string col in updateColumns)
                    {
                        cmd.Parameters.AddWithValue($"@{col}", data1[col]);
                    }

                    cmd.ExecuteNonQuery();
                }
                conn.Close();
            }
        }
    }
}
