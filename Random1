using System;
using System.Diagnostics;
using System.Linq;
using System.Windows.Forms;

namespace ProcessTerminationExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void TerminateKnoxProcessesButton_Click(object sender, EventArgs e)
        {
            // Knox로 시작하는 프로세스들을 찾습니다.
            Process[] processes = Process.GetProcesses()
                .Where(p => p.ProcessName.StartsWith("Knox"))
                .ToArray();

            // 각 프로세스를 종료합니다.
            foreach (Process process in processes)
            {
                try
                {
                    process.Kill();
                    process.WaitForExit(); // 프로세스가 완전히 종료될 때까지 대기합니다.
                    process.Dispose();
                }
                catch (Exception ex)
                {
                    // 종료 중에 오류가 발생한 경우 예외 처리를 합니다.
                    Console.WriteLine($"Failed to terminate process {process.ProcessName}: {ex.Message}");
                }
            }

            MessageBox.Show($"{processes.Length}개의 Knox 프로세스가 종료되었습니다.");
        }
    }
}
