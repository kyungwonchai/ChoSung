[실전용 전체 코드: autodoc_agent.py]
Python

import os
import json
import re
import sys
from datetime import datetime

# ==========================================
# 1. 설정 및 경로 정의
# ==========================================
TARGET_SOLUTION_PATH = "."  # 현재 디렉토리 기준
WORKSPACE = "autodoc_workspace"
DOCS_DIR = os.path.join(WORKSPACE, "menu_docs")
STATE_FILE = os.path.join(WORKSPACE, "status.json")
MASTER_HTML = os.path.join(WORKSPACE, "index.html")
LOG_FILE = os.path.join(WORKSPACE, "dev_log.md")

# 메뉴 추출 및 필터링 패턴
EXCLUDE_PATTERN = re.compile(r'http|www|\.exe|mailto:|#', re.IGNORECASE)
# WPF, WinForms, C# 등 다양한 메뉴 속성 추출용 Regex
MENU_REGEX = re.compile(r'<(?:MenuItem|ToolStripMenuItem|Button).*?(?:Header|Content|Name)="(.*?)".*?>', re.IGNORECASE)

# ==========================================
# 2. 핵심 기능 함수
# ==========================================

def initialize():
    """환경 구축 및 솔루션 내 메뉴 항목 추출"""
    if not os.path.exists(WORKSPACE):
        os.makedirs(WORKSPACE)
    if not os.path.exists(DOCS_DIR):
        os.makedirs(DOCS_DIR)

    if os.path.exists(STATE_FILE):
        return

    print("[*] 솔루션 스캔 및 메뉴 리스트 생성 중...")
    menu_items = set()
    for root, dirs, files in os.walk(TARGET_SOLUTION_PATH):
        # 빌드 결과물 및 Git 폴더 제외
        if any(x in root for x in ["obj", "bin", ".git", ".vs", "autodoc_workspace"]):
            continue
        
        for file in files:
            if file.endswith(('.xaml', '.designer.cs', '.cs', '.razor')):
                try:
                    with open(os.path.join(root, file), 'r', encoding='utf-8', errors='ignore') as f:
                        content = f.read()
                        matches = MENU_REGEX.findall(content)
                        for m in matches:
                            clean_name = m.strip()
                            # 외부 링크 및 빈 이름 필터링
                            if clean_name and not EXCLUDE_PATTERN.search(clean_name) and len(clean_name) > 1:
                                menu_items.add(clean_name)
                except Exception as e:
                    print(f"[!] 파일 읽기 오류 ({file}): {e}")

    items = [{"id": i+1, "name": name, "status": "대기", "content_file": f"{i+1:03d}.html"} 
             for i, name in enumerate(sorted(list(menu_items)))]
    
    state = {"total": len(items), "completed": 0, "items": items}
    with open(STATE_FILE, 'w', encoding='utf-8') as f:
        json.dump(state, f, indent=4, ensure_ascii=False)
    
    with open(LOG_FILE, 'w', encoding='utf-8') as f:
        f.write(f"# 개발 관통 문서 (생성일: {datetime.now().isoformat()})\n\n")

    print(f"[v] 초기화 완료: {len(items)}개의 분석 대상 메뉴가 등록되었습니다.")

def get_status():
    with open(STATE_FILE, 'r', encoding='utf-8') as f:
        return json.load(f)

def update_status(task_id, status, menu_name):
    state = get_status()
    for item in state["items"]:
        if item["id"] == task_id:
            if item["status"] != "완료" and status == "완료":
                state["completed"] += 1
            item["status"] = status
            break
    
    with open(STATE_FILE, 'w', encoding='utf-8') as f:
        json.dump(state, f, indent=4, ensure_ascii=False)
    
    with open(LOG_FILE, 'a', encoding='utf-8') as f:
        f.write(f"- [{datetime.now().strftime('%H:%M:%S')}] {menu_name}: {status}\n")

def build_master_html():
    """상태 기반 모던 대시보드 생성 (Tailwind CSS)"""
    state = get_status()
    
    sidebar_items = ""
    for item in state["items"]:
        status_color = "bg-green-500" if item["status"] == "완료" else "bg-red-400" if item["status"] == "실패" else "bg-gray-300"
        text_color = "text-gray-900" if item["status"] == "완료" else "text-gray-400"
        
        sidebar_items += f"""
        <div class="flex items-center p-3 mb-2 rounded-lg hover:bg-slate-100 cursor-pointer transition-all border-b border-gray-100" 
             onclick="loadDoc('{item['content_file']}')">
            <span class="w-3 h-3 rounded-full {status_color} mr-3"></span>
            <div class="flex-1 overflow-hidden">
                <p class="text-sm font-semibold {text_color} truncate">{item['name']}</p>
                <p class="text-xs text-gray-400 font-mono">ID: {item['id']:03d}</p>
            </div>
        </div>"""

    html_template = f"""
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Visual Studio Solution 분석 대시보드</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
        <style>
            body {{ font-family: 'Inter', sans-serif; }}
            .custom-scrollbar::-webkit-scrollbar {{ width: 5px; }}
            .custom-scrollbar::-webkit-scrollbar-thumb {{ background: #cbd5e1; border-radius: 10px; }}
        </style>
    </head>
    <body class="bg-slate-50 h-screen flex flex-col overflow-hidden">
        <header class="bg-slate-900 text-white px-8 py-4 flex justify-between items-center shadow-lg z-10">
            <div>
                <h1 class="text-xl font-bold tracking-tight">AutoDoc-Agent <span class="text-slate-400 font-normal">v2.0</span></h1>
                <p class="text-xs text-slate-400 uppercase tracking-widest mt-1">Solution Functional Specification</p>
            </div>
            <div class="flex items-center space-x-6">
                <div class="text-right">
                    <p class="text-xs text-slate-400">Progress</p>
                    <p class="text-lg font-bold">{state['completed']} / {state['total']}</p>
                </div>
                <div class="w-32 bg-slate-700 h-2 rounded-full overflow-hidden">
                    <div class="bg-blue-500 h-full" style="width: {(state['completed']/state['total']*100) if state['total']>0 else 0}%"></div>
                </div>
            </div>
        </header>
        
        <div class="flex flex-1 overflow-hidden">
            <aside class="w-80 bg-white border-r border-slate-200 overflow-y-auto p-4 custom-scrollbar">
                <h3 class="text-xs font-bold text-slate-500 uppercase mb-4 px-2">Menu List</h3>
                {sidebar_items}
            </aside>
            
            <main class="flex-1 overflow-y-auto bg-slate-50 p-10 custom-scrollbar">
                <div id="content-viewer" class="max-w-4xl mx-auto">
                    <div class="bg-white border border-slate-200 rounded-2xl p-12 shadow-sm text-center">
                        <div class="w-20 h-20 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-6">
                            <svg class="w-10 h-10 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        </div>
                        <h2 class="text-2xl font-bold text-slate-800 mb-2">분석 문서를 선택하십시오</h2>
                        <p class="text-slate-500">좌측 사이드바에서 메뉴 항목을 클릭하면 상세 기능 설명이 표시됩니다.</p>
                    </div>
                </div>
            </main>
        </div>

        <script>
            function loadDoc(file) {{
                const viewer = document.getElementById('content-viewer');
                viewer.innerHTML = '<div class="flex justify-center p-20"><div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500"></div></div>';
                
                fetch('menu_docs/' + file)
                    .then(r => {{
                        if(!r.ok) throw new Error();
                        return r.text();
                    }})
                    .then(html => viewer.innerHTML = html)
                    .catch(() => {{
                        viewer.innerHTML = '<div class="bg-red-50 border border-red-200 text-red-700 p-8 rounded-xl text-center">분석 데이터가 아직 생성되지 않았습니다.</div>';
                    }});
            }}
        </script>
    </body>
    </html>
    """
    with open(MASTER_HTML, 'w', encoding='utf-8') as f:
        f.write(html_template)

# ==========================================
# 3. 메인 실행 로직 (CLI 인터페이스)
# ==========================================

if __name__ == "__main__":
    initialize()
    
    # 1. 상태 업데이트 처리
    if len(sys.argv) > 2:
        action = sys.argv[1]
        target_id = int(sys.argv[2])
        menu_name = sys.argv[3] if len(sys.argv) > 3 else "Unknown"
        
        if action == "--done":
            update_status(target_id, "완료", menu_name)
        elif action == "--fail":
            update_status(target_id, "실패", menu_name)
            
    # 2. 대시보드 갱신
    build_master_html()
    
    # 3. 다음 할 일 검색 및 안내
    state = get_status()
    next_task = None
    for item in state["items"]:
        if item["status"] == "대기":
            next_task = item
            break
            
    if next_task:
        print("\n" + "="*60)
        print(f" [NEXT STEP] ID: {next_task['id']} | Menu: {next_task['name']}")
        print("="*60)
        print(f"1. `{next_task['name']}`의 클릭 이벤트 및 기능 코드를 분석하라.")
        print(f"2. 결과는 `{DOCS_DIR}/{next_task['content_file']}`에 HTML 조각으로 저장하라.")
        print(f"   (주의: <html>태그 없이 <div>로 시작하는 카드 디자인 적용)")
        print(f"3. 성공 시: `python autodoc_agent.py --done {next_task['id']} \"{next_task['name']}\"`")
        print(f"4. 실패 시: `python autodoc_agent.py --fail {next_task['id']} \"{next_task['name']}\"`")
        print(f"5. 그 후 다시 `python autodoc_agent.py`를 실행하여 다음으로 넘어가라.")
        print("="*60 + "\n")
    else:
        print("\n[COMPLETE] 모든 메뉴 분석이 완료되었습니다. index.html을 확인하십시오.")
[경원님을 위한 Cline 주입용 최종 프롬프트]
Cline 터미널에 이 명령을 복사해서 넣으시면 됩니다.

"경원이다. autodoc_agent.py를 실행하여 분석을 시작해라. 멈추지 말고 끝까지 자율 루프를 돌아라. 각 메뉴 분석 HTML 생성 시 아래 형식을 지켜라."

[HTML 생성 규칙]

<div>로 시작하는 카드 스타일 (Tailwind CSS 활용)

섹션: [기능 요약], [핵심 로직 흐름], [관련 소스 파일 경로]

코드 블록은 <pre class="bg-slate-900 text-slate-100 p-4 rounded">를 사용

분석이 끝나면 반드시 --done 명령을 실행하고 다시 autodoc_agent.py를 호출할 것.