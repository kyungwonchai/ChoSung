 매크로입니다. 패턴은 CA와 AC가 매주 번갈아가며 반복되도록 설계되었으며, 조건에 따라 데이터가 생성됩니다.

VBA 코드
vba
코드 복사
Sub GenerateShiftData()
    Dim ws As Worksheet
    Dim startDate As Date
    Dim endDate As Date
    Dim currentDate As Date
    Dim row As Long
    Dim currentPattern As String
    Dim isCAPattern As Boolean ' True이면 CA, False이면 AC
    Dim dayOfWeek As Integer
    Dim shiftName As String
    Dim i As Integer
    
    ' 초기화
    Set ws = ThisWorkbook.Sheets(1) ' 첫 번째 시트 사용
    ws.Cells.Clear ' 기존 데이터 삭제
    ws.Range("A1:D1").Value = Array("날짜", "요일", "조", "명칭") ' 헤더 설정
    
    ' 날짜 설정
    startDate = DateValue("2024-11-01")
    endDate = DateAdd("yyyy", 10, startDate)
    
    ' 초기 패턴 설정 (2024-11-03부터 시작, 첫 주는 CA)
    isCAPattern = True ' CA 패턴 시작
    row = 2 ' 데이터 시작 행
    
    ' 데이터 생성
    For currentDate = startDate To endDate
        dayOfWeek = Weekday(currentDate, vbSunday) ' 일요일: 1, 월요일: 2, ...
        
        ' 매주 일요일에 패턴 전환
        If dayOfWeek = 1 Then
            isCAPattern = Not isCAPattern ' CA → AC → CA 반복
        End If
        
        ' 현재 날짜의 패턴 설정
        If isCAPattern Then
            currentPattern = "CA"
        Else
            currentPattern = "AC"
        End If
        
        ' 1조와 2조 데이터 생성
        For i = 1 To 2
            ws.Cells(row, 1).Value = Format(currentDate, "yyyy-MM-dd") ' 날짜
            ws.Cells(row, 2).Value = dayOfWeek ' 요일
            ws.Cells(row, 3).Value = i ' 조
            
            ' 명칭 설정
            If i = 1 Then
                shiftName = Left(currentPattern, 1) ' 첫 번째 문자 (1조)
            Else
                shiftName = Right(currentPattern, 1) ' 두 번째 문자 (2조)
            End If
            ws.Cells(row, 4).Value = shiftName ' 명칭
            row = row + 1
        Next i
    Next currentDate
    
    ' 완료 메시지
    MsgBox "10년 간의 데이터를 생성했습니다!", vbInformation
End Sub
실행 방법
엑셀에서 Alt + F11을 눌러 VBA 편집기를 엽니다.
상단 메뉴에서 삽입 > 모듈을 선택합니다.
위 코드를 붙여넣습니다.
VBA 편집기를 닫고 엑셀로 돌아옵니다.
Alt + F8을 눌러 매크로 실행 창을 엽니다.
GenerateShiftData를 선택한 후 실행을 클릭합니다.
데이터 설명
A열 (날짜): 2024-11-01부터 시작하여 10년간의 날짜를 포함합니다.
B열 (요일): 1은 일요일, 2는 월요일, ..., 7은 토요일입니다.
C열 (조): 각 날짜에 대해 1조와 2조가 기록됩니다.
D열 (명칭):
주 단위로 CA와 AC가 번갈아 가며 반복됩니다.
예: 한 주가 CA라면 다음 주는 AC로 설정됩니다.
1조는 패턴의 첫 번째 문자, 2조는 두 번째 문자입니다.
예시 결과 (2024년 11월 첫 주)
날짜	요일	조	명칭
2024-11-01	6	1	C
2024-11-01	6	2	A
2024-11-02	7	1	C
2024-11-02	7	2	A
2024-11-03	1	1	C
2024-11-03	1	2	A
2024-11-04	2	1	A