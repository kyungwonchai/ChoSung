using System;
using System.Drawing;
using System.Windows.Forms;
using Microsoft.WindowsAPICodePack.Taskbar;

namespace BlueTaskbarButton
{
    public partial class Form1 : Form
    {
        private TaskbarManager taskbarManager;

        public Form1()
        {
            InitializeComponent();
        }

        protected override void OnLoad(EventArgs e)
        {
            base.OnLoad(e);

            // 작업 표시줄 버튼 색상 설정
            SetTaskbarButtonColor(Color.Blue);
        }

        private void SetTaskbarButtonColor(Color color)
        {
            taskbarManager = TaskbarManager.Instance;
            var overlayIcon = IconFromImage(color);
            taskbarManager.SetOverlayIcon(overlayIcon, "Description");
        }

        private Icon IconFromImage(Color color)
        {
            Bitmap bmp = new Bitmap(16, 16);

            using (Graphics g = Graphics.FromImage(bmp))
            {
                using (SolidBrush brush = new SolidBrush(color))
                {
                    g.FillRectangle(brush, 0, 0, 16, 16);
                }
            }

            return Icon.FromHandle(bmp.GetHicon());
        }
    }
}
