Sub CopyDataToTempSheet()
    Dim wsTemp1 As Worksheet
    Dim wsTemp2 As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim j As Integer
    Dim colOffset As Integer
    
    ' 임시1시트와 임시2시트 지정
    Set wsTemp1 = ThisWorkbook.Sheets("임시1시트")
    On Error Resume Next
    Set wsTemp2 = ThisWorkbook.Sheets("임시2시트")
    On Error GoTo 0
    
    ' 임시2시트가 이미 존재하면 삭제
    If Not wsTemp2 Is Nothing Then
        Application.DisplayAlerts = False
        wsTemp2.Delete
        Application.DisplayAlerts = True
    End If
    
    ' 새로운 임시2시트 생성
    Set wsTemp2 = ThisWorkbook.Sheets.Add
    wsTemp2.Name = "임시2시트"
    
    ' B열이 있는 행까지 순환
    lastRow = wsTemp1.Cells(wsTemp1.Rows.Count, "B").End(xlUp).Row
    For i = 3 To lastRow ' 3행부터 시작
        colOffset = 0 ' 열 오프셋 초기화
        ' 3열부터 U열까지 3칸씩 이동하며 처리
        For j = 3 To 21 Step 3 ' 3열부터 U열까지 3칸씩 이동
            ' 현재 컬럼에 값이 있는지 확인
            If Not IsEmpty(wsTemp1.Cells(i, j).Value) Then
                ' 값이 있는 경우 해당 위치의 컬럼에 누적 복사
                wsTemp1.Cells(i, j).Copy Destination:=wsTemp2.Cells(i - 2, j + colOffset)
                wsTemp1.Cells(i, j + 1).Copy Destination:=wsTemp2.Cells(i - 2, j + colOffset + 1)
                colOffset = colOffset + 2 ' 열 오프셋 증가
            End If
        Next j
    Next i
End Sub
