// 시리얼 포트 데이터 수신 이벤트 핸들러
private void SerialPort_DataReceived(object sender, SerialDataReceivedEventArgs e)
{
    try
    {
        // 시리얼 포트에서 데이터를 읽음
        string receivedData = serialPort.ReadExisting();
        // 수신된 데이터를 로그에 추가
        Dispatcher.Invoke(() => LogMessage($"PLC로부터 데이터 수신: {receivedData} (포트: {currentPortName}).", Brushes.Blue));
        
        // 수신된 데이터가 특정 형식인지 확인하고 처리
        if (receivedData.StartsWith("%01$"))
        {
            // 응답이 성공적인 경우
            Dispatcher.Invoke(() => LogMessage($"성공적인 응답 수신: {receivedData}", Brushes.Blue));
        }
        else
        {
            // 응답이 실패하거나 다른 경우
            Dispatcher.Invoke(() => LogError($"잘못된 응답 수신: {receivedData}"));
        }
    }
    catch (Exception ex)
    {
        Dispatcher.Invoke(() => LogError($"PLC로부터 데이터 수신 중 오류: {ex.Message}"));
    }
}
