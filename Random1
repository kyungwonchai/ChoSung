엑셀에서 주어진 날짜와 시프트 정보를 기반으로 날짜별로 시프트를 정리하는 매크로를 작성해 드리겠습니다. 이 매크로는 두 열에 날짜가 있는 경우, 각 날짜에 대해 Shift1, Shift2, Shift3를 생성하여 새로운 시트에 정리합니다.

다음은 VBA 매크로 코드입니다:

vba
코드 복사
Sub GenerateShiftSchedule()
    Dim ws As Worksheet
    Dim newWs As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim newRow As Long
    
    ' 현재 시트
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' 새로운 시트 생성
    Set newWs = ThisWorkbook.Sheets.Add
    newWs.Name = "Shift Schedule"
    
    ' 헤더 추가
    newWs.Cells(1, 1).Value = "Date"
    newWs.Cells(1, 2).Value = "Shift"
    
    ' 현재 시트의 마지막 행 찾기
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' 새 시트에 데이터 작성
    newRow = 2
    For i = 2 To lastRow
        Dim dateValue As String
        dateValue = ws.Cells(i, 1).Value
        
        newWs.Cells(newRow, 1).Value = dateValue
        newWs.Cells(newRow, 2).Value = "Shift1"
        newRow = newRow + 1
        
        newWs.Cells(newRow, 1).Value = dateValue
        newWs.Cells(newRow, 2).Value = "Shift2"
        newRow = newRow + 1
        
        newWs.Cells(newRow, 1).Value = dateValue
        newWs.Cells(newRow, 2).Value = "Shift3"
        newRow = newRow + 1
    Next i
End Sub
이 매크로는 다음과 같이 동작합니다:

"Sheet1"에서 날짜 데이터를 읽습니다.
새로운 시트를 생성하고, "Shift Schedule"이라는 이름을 부여합니다.
각 날짜에 대해 Shift1, Shift2, Shift3를 새 시트에 작성합니다.
이 매크로를 사용하려면:

엑셀을 열고 Alt + F11을 눌러 VBA 편집기를 엽니다.
삽입 -> 모듈을 선택하여 새로운 모듈을 추가합니다.
위의 코드를 복사하여 붙여넣습니다.
F5를 눌러 매크로를 실행합니다.
이 매크로는 "Sheet1"에 날짜 데이터가 있는 경우, 새로운 시트에 날짜별로 Shift1, Shift2, Shift3를 작성해 줍니다. 필요한 경우 시트 이름이나 데이터 위치를 조정하여 사용할 수 있습니