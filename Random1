날짜 기준으로 매일 두 개의 조가 있는 CSV 파일을 만드는 Python 코드를 작성해드리겠습니다. 날짜 형식은 yyyy-MM-dd, 요일은 월화수목금토일, 조는 1과 2로 구성됩니다. 아래 코드를 참고하세요.

python
코드 복사
import csv
from datetime import datetime, timedelta

# CSV 파일 이름 지정
filename = 'schedule.csv'

# CSV 파일 헤더 정의
header = ['날짜', '요일', '조']

# 시작 날짜와 끝 날짜 설정
start_date = datetime(2023, 1, 1)  # 시작 날짜를 원하는 날짜로 설정
end_date = datetime(2023, 12, 31)  # 끝 날짜를 원하는 날짜로 설정

# 요일 리스트 (한국어로 월요일부터 일요일까지)
days_of_week = ['월', '화', '수', '목', '금', '토', '일']

# CSV 파일 작성
with open(filename, 'w', newline='', encoding='utf-8') as file:
    writer = csv.writer(file)
    writer.writerow(header)  # 헤더 작성

    current_date = start_date
    while current_date <= end_date:
        # 날짜 형식 지정 (yyyy-MM-dd)
        date_str = current_date.strftime('%Y-%m-%d')
        # 요일을 숫자로 변환 후 요일 리스트에서 한국어 요일 가져오기
        day_name = days_of_week[current_date.weekday()]

        # 매일 두 개의 조(1, 2) 기록
        for shift in [1, 2]:
            writer.writerow([date_str, day_name, shift])

        # 다음 날로 이동
        current_date += timedelta(days=1)

print(f'{filename} 파일이 생성되었습니다.')
설명
날짜 설정: start_date와 end_date를 지정하여 CSV 파일에 포함할 기간을 설정합니다.
요일 계산: days_of_week 리스트를 사용하여 weekday() 함수로 요일을 구합니다.
조 기록: 매일 2개의 조가 작성되도록 for shift in [1, 2]: 루프를 사용합니다.
CSV 파일 작성: 매일 두 개의 조 정보가 포함된 날짜, 요일, 조가 파일에 기록됩니다.