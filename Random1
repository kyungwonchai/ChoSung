ë„¤, "ë§ˆìŠ¤í„° ëª¨ë“œ í™œì„±í™”" ë©”ì‹œì§€ëŠ” ëœ¨ëŠ”ë° í•´ë‹¹ íƒ­ì´ ë³´ì´ì§€ ì•ŠëŠ” ë¬¸ì œëŠ” XAML ë°”ì¸ë”©(Binding) ì„¤ì •, íŠ¹íˆ Visibility ì†ì„±ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

ê°€ì¥ ìœ ë ¥í•œ ì›ì¸ì€ Visibility ë°”ì¸ë”©ì— ì‚¬ìš©ëœ BooleanToVisibilityConverterê°€ í”„ë¡œì íŠ¸ì— ì •ì˜ë˜ì§€ ì•Šì•˜ê±°ë‚˜ XAML ë¦¬ì†ŒìŠ¤ì— ì¶”ê°€ë˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ ì»¨ë²„í„°ëŠ” ViewModelì˜ bool íƒ€ì… ì†ì„±(IsMasterModeEnabled) ê°’ì„ UIì˜ Visibility ì†ì„±(Visible/Collapsed)ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ì»¨ë²„í„°ê°€ ì—†ìœ¼ë©´ ë°”ì¸ë”©ì´ ì‹¤íŒ¨í•˜ê³ , FallbackValue=Collapsed ì„¤ì • ë•Œë¬¸ì— íƒ­ì´ ìˆ¨ê²¨ì§„ ìƒíƒœë¡œ ìœ ì§€ë©ë‹ˆë‹¤.

í•´ê²° ë‹¨ê³„:

BooleanToVisibilityConverter í´ë˜ìŠ¤ êµ¬í˜„: Infrastructure í´ë”ì— ì»¨ë²„í„° í´ë˜ìŠ¤ íŒŒì¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
XAML ë¦¬ì†ŒìŠ¤ì— ì»¨ë²„í„° ì¶”ê°€: MainWindow.xamlì˜ ë¦¬ì†ŒìŠ¤ ì„¹ì…˜ì— ìƒì„±í•œ ì»¨ë²„í„°ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤.
MainViewModel í™•ì¸: IsMasterModeEnabled ì†ì„±ì´ ë³€ê²½ë  ë•Œ OnPropertyChanged ì•Œë¦¼ì´ ì œëŒ€ë¡œ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤ (SetProperty ë©”ì„œë“œ ì‚¬ìš© í™•ì¸).
ìˆ˜ì •/ì¶”ê°€í•´ì•¼ í•  íŒŒì¼:

Infrastructure/BooleanToVisibilityConverter.cs (ì‹ ê·œ)
Views/MainWindow.xaml (ë¦¬ì†ŒìŠ¤ ì¶”ê°€)
ViewModels/MainViewModel.cs (í™•ì¸ìš©ìœ¼ë¡œ ì „ì²´ ì½”ë“œ ì œê³µ)
ì•„ë˜ì— í•´ë‹¹ íŒŒì¼ë“¤ì˜ ì „ì²´ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

1. Infrastructure/BooleanToVisibilityConverter.cs (ì‹ ê·œ íŒŒì¼)

ì´ íŒŒì¼ì„ í”„ë¡œì íŠ¸ì˜ Infrastructure í´ë”ì— ì¶”ê°€í•˜ì„¸ìš”.

C#

using System;
using System.Globalization; // CultureInfo ì‚¬ìš©
using System.Windows; // Visibility ì‚¬ìš©
using System.Windows.Data; // IValueConverter ì‚¬ìš©

namespace LockerManagementApp.Infrastructure
{
    /// <summary>
    /// bool ê°’ì„ Visibility ê°’ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” WPF IValueConverter ì…ë‹ˆë‹¤.
    /// true -> Visibility.Visible
    /// false -> Visibility.Collapsed
    /// </summary>
    [ValueConversion(typeof(bool), typeof(Visibility))] // ì»¨ë²„í„° íƒ€ì… ëª…ì‹œ (ì„ íƒ ì‚¬í•­)
    public class BooleanToVisibilityConverter : IValueConverter
    {
        /// <summary>
        /// ì†ŒìŠ¤(bool) ê°’ì„ íƒ€ê²Ÿ(Visibility) ê°’ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
        /// </summary>
        /// <param name="value">ì†ŒìŠ¤ ê°’ (bool)</param>
        /// <param name="targetType">íƒ€ê²Ÿ íƒ€ì… (Visibility)</param>
        /// <param name="parameter">ì»¨ë²„í„° íŒŒë¼ë¯¸í„° (ì—¬ê¸°ì„œëŠ” ì‚¬ìš© ì•ˆ í•¨)</param>
        /// <param name="culture">ë¬¸í™”ê¶Œ ì •ë³´</param>
        /// <returns>Visibility ê°’</returns>
        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            // valueê°€ bool íƒ€ì…ì¸ì§€ í™•ì¸í•˜ê³ , trueì´ë©´ Visible, falseì´ë©´ Collapsed ë°˜í™˜
            if (value is bool boolValue)
            {
                return boolValue ? Visibility.Visible : Visibility.Collapsed;
            }
            // ê¸°ë³¸ê°’ ë˜ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ (ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ê°’ Collapsed ë°˜í™˜)
            return Visibility.Collapsed;
        }

        /// <summary>
        /// íƒ€ê²Ÿ(Visibility) ê°’ì„ ì†ŒìŠ¤(bool) ê°’ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. (ì—¬ê¸°ì„œëŠ” ì‚¬ìš© ì•ˆ í•¨)
        /// </summary>
        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            // ì–‘ë°©í–¥ ë°”ì¸ë”©ì´ ì•„ë‹ˆë¯€ë¡œ êµ¬í˜„ ë¶ˆí•„ìš”
            throw new NotImplementedException();
        }
    }
}
2. Views/MainWindow.xaml (ìˆ˜ì •)

<dx:ThemedWindow.Resources> ì„¹ì…˜ ì•ˆì— BooleanToVisibilityConverterë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. Visibility ë°”ì¸ë”© ë¶€ë¶„ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€í•©ë‹ˆë‹¤ (ì»¨ë²„í„°ë§Œ ì¶”ê°€ë˜ë©´ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤).

XML

<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    xmlns:models="clr-namespace:LockerManagementApp.Models"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure" Title="ì‚¬ë¬¼í•¨ ê´€ë¦¬ í”„ë¡œê·¸ë¨ (DevExpress MVVM - .NET Framework 4.8)" Height="750" Width="1300"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"
    >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <Style x:Key="LightBlueHeaderStyle" TargetType="dxg:BaseGridHeader"> <Setter Property="Background" Value="LightBlue"/> <Setter Property="HorizontalContentAlignment" Value="Center"/> <Setter Property="FontWeight" Value="Bold"/> </Style>
        <Style TargetType="dxg:GridColumnHeader" BasedOn="{StaticResource LightBlueHeaderStyle}"/> <Style TargetType="dxg:BandHeaderControl" BasedOn="{StaticResource LightBlueHeaderStyle}"/>
    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="5">
                <TextBlock Text="ë§ˆìŠ¤í„° í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Content="í™•ì¸" Margin="5,0,0,0" Command="{Binding CheckMasterPasswordCommand}"/>
            </StackPanel>
            <Border Background="LightGray" Padding="5">
                 <StackPanel Orientation="Horizontal"> <Button Content="ğŸ”„ ìƒˆë¡œê³ ì¹¨" Margin="3" Command="{Binding LoadDataCommand}"/> <Button Content="ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥" Margin="3" Command="{Binding SaveChangesCommand}"/> </StackPanel>
            </Border>
        </DockPanel>

        <TabControl Grid.Row="1" Margin="5">
            <TabItem Header="ì‚¬ë¬¼í•¨ ê´€ë¦¬">
                <Grid>
                    <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
                    <Border Grid.Row="0" Background="WhiteSmoke" Padding="3"> <StackPanel Orientation="Horizontal"> <Button Content="â• ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€" Margin="3" Command="{Binding AddNewCommand}"/> <Button Content="âŒ ì„ íƒ í•­ëª© ì‚­ì œ" Margin="3" Command="{Binding DeleteCommand}"/> <Button Content="ğŸ§¹ ë°°ì • í•´ì œ" Margin="3" Command="{Binding ClearAssignmentCommand}"/> </StackPanel> </Border>
                    <dxg:GridControl Grid.Row="1" ItemsSource="{Binding LockerAssignments}" SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}">
                        <dxg:GridControl.View> <dxg:TableView AllowPerPixelScrolling="True" ShowGroupPanel="True" AllowEditing="True" NavigationStyle="Cell" ShowAutoFilterRow="True" NewItemRowPosition="None" ShowIndicator="True" ShowSearchPanelMode="Always"> <dxg:TableView.RowCellMenuCustomizations> <dxb:BarButtonItem Content="ë°°ì • í•´ì œ" Command="{Binding View.DataContext.ClearAssignmentCommand}" Glyph="{dx:DXImage Svg/Actions/DeleteList.svg}"/> <dxb:BarItemSeparator/> <dxb:BarButtonItem Content="í–‰ ì‚­ì œ" Command="{Binding View.DataContext.DeleteCommand}" Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/> </dxg:TableView.RowCellMenuCustomizations> </dxg:TableView> </dxg:GridControl.View>
                        <dxg:GridControl.Columns>
                            <dxg:GridColumn FieldName="LockerType" Header="ì¢…ë¥˜" Width="100" Fixed="Left" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllLockerTypes}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Floor" Header="ì¸µ" Width="60" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllFloors}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Zone" Header="êµ¬ì—­" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllZones}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="SpecificLocation" Header="ì„¸ë¶€ ìœ„ì¹˜" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="UserName" Header="ì„±ëª…" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="SubPart" Header="ì†ŒíŒŒíŠ¸" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllSubParts}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Administrator" Header="ê´€ë¦¬ ë‹´ë‹¹ì" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllAdministrators}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="TransferStatus" Header="ì „ë°°ë³µì§" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Details" Header="ë‚´ìš©" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Remarks" Header="íŠ¹ì´ì‚¬í•­" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Notes" Header="ë¹„ê³ " Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="LastUpdated" Header="ìµœì¢… ìˆ˜ì •ì¼ì‹œ" Width="150" AllowEditing="False" ReadOnly="True" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                            <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
                        </dxg:GridControl.Columns>
                    </dxg:GridControl>
                </Grid>
            </TabItem>
            <TabItem Header="ë³€ê²½ ë¡œê·¸" DataContext="{Binding LogVM}">
                 <Grid>
                     <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>
                     <Button Grid.Row="0" Content="ğŸ”„ ë¡œê·¸ ìƒˆë¡œê³ ì¹¨" Command="{Binding LoadLogsCommand}" HorizontalAlignment="Left" Margin="5"/>
                     <dxg:GridControl Grid.Row="1" ItemsSource="{Binding AuditLogs}">
                         <dxg:GridControl.View> <dxg:TableView AllowPerPixelScrolling="True" AllowEditing="False" ShowGroupPanel="False" ShowAutoFilterRow="True"/> </dxg:GridControl.View>
                         <dxg:GridControl.Columns>
                             <dxg:GridColumn FieldName="Timestamp" Header="ì‹œê°„" Width="150" SortOrder="Descending" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="UserName" Header="ì‚¬ìš©ì" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="Action" Header="ì‘ì—…" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="TableName" Header="í…Œì´ë¸”" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="RecordId" Header="ë ˆì½”ë“œ ID" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="AffectedColumns" Header="ë³€ê²½ ì»¬ëŸ¼" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="OldValues" Header="ë³€ê²½ ì „ ê°’" Width="200" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                             <dxg:GridColumn FieldName="NewValues" Header="ë³€ê²½ í›„ ê°’" Width="200" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                         </dxg:GridControl.Columns>
                     </dxg:GridControl>
                     <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem><TextBlock Text="{Binding StatusMessage}" Margin="5,0"/></StatusBarItem> </StatusBar>
                 </Grid>
            </TabItem>
            <TabItem Header="ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬" DataContext="{Binding MasterDataVM}"
                     Visibility="{Binding DataContext.IsMasterModeEnabled, RelativeSource={RelativeSource AncestorType={dx:ThemedWindow}}, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}">
                 <Grid>
                     <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
                     <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5"> <Button Content="ğŸ’¾ ë§ˆìŠ¤í„° ë°ì´í„° ì €ì¥" Command="{Binding SaveChangesCommand}" Margin="3"/> <Button Content="ğŸ”„ ë§ˆìŠ¤í„° ë°ì´í„° ìƒˆë¡œê³ ì¹¨" Command="{Binding LoadAllMasterDataCommand}" Margin="3"/> <TextBlock Text="{Binding StatusMessage}" Margin="10,0,0,0" VerticalAlignment="Center" Foreground="Gray"/> </StackPanel>
                     <dxlc:LayoutControl Grid.Row="1" Orientation="Vertical">
                         <dxlc:LayoutGroup Header="ì‚¬ë¬¼í•¨ ì¢…ë¥˜" View="GroupBox" Orientation="Vertical"> <StackPanel Orientation="Horizontal" Margin="0,0,0,5"> <Button Content="ì¢…ë¥˜ ì¶”ê°€" Command="{Binding AddItemCommand}" CommandParameter="LockerType" Margin="0,0,5,0"/> <Button Content="ì„ íƒ ì‚­ì œ" Command="{Binding DeleteItemCommand}" /> </StackPanel> <dxg:GridControl ItemsSource="{Binding LockerTypes}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" Height="150" MaxHeight="200"> <dxg:GridControl.View><dxg:TableView AllowEditing="True" NewItemRowPosition="None"/></dxg:GridControl.View> <dxg:GridControl.Columns> <dxg:GridColumn FieldName="Name" Header="ì¢…ë¥˜ ì´ë¦„"/> </dxg:GridControl.Columns> </dxg:GridControl> </dxlc:LayoutGroup>
                         <dxlc:LayoutGroup Header="ì¸µ" View="GroupBox" Orientation="Vertical"> <StackPanel Orientation="Horizontal" Margin="0,0,0,5"> <Button Content="ì¸µ ì¶”ê°€" Command="{Binding AddItemCommand}" CommandParameter="Floor" Margin="0,0,5,0"/> <Button Content="ì„ íƒ ì‚­ì œ" Command="{Binding DeleteItemCommand}" /> </StackPanel> <dxg:GridControl ItemsSource="{Binding Floors}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" Height="150" MaxHeight="200"> <dxg:GridControl.View><dxg:TableView AllowEditing="True" NewItemRowPosition="None"/></dxg:GridControl.View> <dxg:GridControl.Columns> <dxg:GridColumn FieldName="Name" Header="ì¸µ ì´ë¦„"/> </dxg:GridControl.Columns> </dxg:GridControl> </dxlc:LayoutGroup>
                         <dxlc:LayoutGroup Header="êµ¬ì—­" View="GroupBox" Orientation="Vertical"> <StackPanel Orientation="Horizontal" Margin="0,0,0,5"> <Button Content="êµ¬ì—­ ì¶”ê°€" Command="{Binding AddItemCommand}" CommandParameter="Zone" Margin="0,0,5,0"/> <Button Content="ì„ íƒ ì‚­ì œ" Command="{Binding DeleteItemCommand}" /> </StackPanel> <dxg:GridControl ItemsSource="{Binding Zones}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" Height="150" MaxHeight="200"> <dxg:GridControl.View><dxg:TableView AllowEditing="True" NewItemRowPosition="None"/></dxg:GridControl.View> <dxg:GridControl.Columns> <dxg:GridColumn FieldName="Name" Header="êµ¬ì—­ ì´ë¦„"/> </dxg:GridControl.Columns> </dxg:GridControl> </dxlc:LayoutGroup>
                         <dxlc:LayoutGroup Header="ì†ŒíŒŒíŠ¸" View="GroupBox" Orientation="Vertical"> <StackPanel Orientation="Horizontal" Margin="0,0,0,5"> <Button Content="ì†ŒíŒŒíŠ¸ ì¶”ê°€" Command="{Binding AddItemCommand}" CommandParameter="SubPart" Margin="0,0,5,0"/> <Button Content="ì„ íƒ ì‚­ì œ" Command="{Binding DeleteItemCommand}" /> </StackPanel> <dxg:GridControl ItemsSource="{Binding SubParts}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" Height="150" MaxHeight="200"> <dxg:GridControl.View><dxg:TableView AllowEditing="True" NewItemRowPosition="None"/></dxg:GridControl.View> <dxg:GridControl.Columns> <dxg:GridColumn FieldName="Name" Header="ì†ŒíŒŒíŠ¸ ì´ë¦„"/> </dxg:GridControl.Columns> </dxg:GridControl> </dxlc:LayoutGroup>
                         <dxlc:LayoutGroup Header="ê´€ë¦¬ì" View="GroupBox" Orientation="Vertical"> <StackPanel Orientation="Horizontal" Margin="0,0,0,5"> <Button Content="ê´€ë¦¬ì ì¶”ê°€" Command="{Binding AddItemCommand}" CommandParameter="Administrator" Margin="0,0,5,0"/> <Button Content="ì„ íƒ ì‚­ì œ" Command="{Binding DeleteItemCommand}" /> </StackPanel> <dxg:GridControl ItemsSource="{Binding Administrators}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}" Height="150" MaxHeight="200"> <dxg:GridControl.View><dxg:TableView AllowEditing="True" NewItemRowPosition="None"/></dxg:GridControl.View> <dxg:GridControl.Columns> <dxg:GridColumn FieldName="Name" Header="ê´€ë¦¬ì ì´ë¦„"/> </dxg:GridControl.Columns> </dxg:GridControl> </dxlc:LayoutGroup>
                     </dxlc:LayoutControl>
                 </Grid>
            </TabItem>
        </TabControl>

        <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem><TextBlock Text="{Binding StatusBarText}" Margin="5,0"/></StatusBarItem> </StatusBar>
    </Grid>

</dx:ThemedWindow>
3. ViewModels/MainViewModel.cs (í™•ì¸ìš©)

IsMasterModeEnabled ì†ì„± ì •ì˜ ë¶€ë¶„ì´ SetPropertyë¥¼ ì‚¬ìš©í•˜ì—¬ PropertyChanged ì•Œë¦¼ì„ ì œëŒ€ë¡œ ë°œìƒì‹œí‚¤ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. (ì´ì „ ì½”ë“œì™€ ë™ì¼í•˜ë©° ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.)

C#

using LockerManagementApp.Data;
using LockerManagementApp.Models;
using LockerManagementApp.Infrastructure;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Configuration;
using System.Data.Entity;
using System.Data.Entity.Infrastructure;
using System.Linq;
using System.Security;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;
using System.Runtime.InteropServices;

namespace LockerManagementApp.ViewModels
{
    public class MainViewModel : ViewModelBase, IDisposable
    {
        // ... (ë‹¤ë¥¸ ë©¤ë²„ ë³€ìˆ˜ë“¤) ...

        private SecureString _masterPasswordInput;
        private bool _isMasterModeEnabled = false; // ë§ˆìŠ¤í„° ê´€ë¦¬ íƒ­ í™œì„±í™” ì—¬ë¶€

        // ... (ë‹¤ë¥¸ ì»¬ë ‰ì…˜ë“¤) ...

        public MasterDataViewModel MasterDataVM { get; private set; }
        public LogViewModel LogVM { get; private set; }

        #region Public Properties
        // ... (ë‹¤ë¥¸ ì†ì„±ë“¤) ...

        public SecureString MasterPasswordInput { get => _masterPasswordInput; set => SetProperty(ref _masterPasswordInput, value); }

        /// <summary>
        /// ë§ˆìŠ¤í„° ê´€ë¦¬ íƒ­ì˜ í‘œì‹œ ì—¬ë¶€ (ë§ˆìŠ¤í„° í‚¤ í™•ì¸ í›„ trueë¡œ ë³€ê²½)
        /// ì´ ì†ì„± ê°’ì´ ë³€ê²½ë  ë•Œ SetPropertyë¥¼ í†µí•´ PropertyChanged ì´ë²¤íŠ¸ê°€ ë°œìƒí•´ì•¼ í•©ë‹ˆë‹¤.
        /// </summary>
        public bool IsMasterModeEnabled
        {
            get => _isMasterModeEnabled;
            // SetPropertyë¥¼ ì‚¬ìš©í•˜ì—¬ ê°’ ë³€ê²½ ë° UI ì•Œë¦¼ ì²˜ë¦¬
            set => SetProperty(ref _isMasterModeEnabled, value);
        }

        // ... (ë‹¤ë¥¸ ì†ì„±ë“¤) ...
        #endregion

        // ... (ìƒì„±ì, ë©”ì„œë“œ, IDisposable êµ¬í˜„ ë“± ë‚˜ë¨¸ì§€ ì½”ë“œ) ...
        public MainViewModel()
        {
            try { _context = new LockerDbContext(); }
            catch (Exception ex) { MessageBox.Show($"DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); StatusBarText = "DB ì—°ê²° ì˜¤ë¥˜!"; return; }

            _lockerAssignments = new ObservableCollection<LockerAssignment>();
            _allLockerTypes = new ObservableCollection<LockerType>();
            _allFloors = new ObservableCollection<Floor>();
            _allZones = new ObservableCollection<Zone>();
            _allSubParts = new ObservableCollection<SubPart>();
            _allAdministrators = new ObservableCollection<Administrator>();

            MasterDataVM = new MasterDataViewModel();
            LogVM = new LogViewModel();

            LoadDataCommand = new RelayCommand(async _ => await LoadInitialDataAsync());
            SaveChangesCommand = new RelayCommand(async _ => await SaveChangesAsync());
            AddNewCommand = new RelayCommand(AddNewLocker);
            DeleteCommand = new RelayCommand(async _ => await DeleteSelectedAsync(), _ => SelectedAssignment != null);
            ClearAssignmentCommand = new RelayCommand(ClearSelectedAssignment, _ => SelectedAssignment != null && SelectedAssignment.IsAssigned);
            CheckMasterPasswordCommand = new RelayCommand(CheckMasterPassword);
            RefreshMasterDataCommand = new RelayCommand(async _ => await LoadMasterDataAsync());

            if (_context != null) { _ = LoadInitialDataAsync(); }
        }

        private async Task LoadInitialDataAsync() { await LoadMasterDataAsync(); await LoadAssignmentsAsync(); }
        private async Task LoadAssignmentsAsync() { if (_context == null) return; StatusBarText = "ì‚¬ë¬¼í•¨ ëª©ë¡ ë¡œë”© ì¤‘..."; try { var assignments = await _context.LockerAssignments.OrderBy(l => l.Floor).ThenBy(l => l.Zone).ThenBy(l => l.SpecificLocation).ToListAsync(); LockerAssignments = new ObservableCollection<LockerAssignment>(assignments); StatusBarText = $"ì´ {LockerAssignments.Count}ê°œ ë¡œë“œ ì™„ë£Œ."; } catch (Exception ex) { HandleGenericException("ì‚¬ë¬¼í•¨ ëª©ë¡ ë¡œë”©", ex); } }
        private async Task LoadMasterDataAsync() { if (_context == null) return; StatusBarText = "ë§ˆìŠ¤í„° ë°ì´í„°(ì½¤ë³´ë°•ìŠ¤ìš©) ë¡œë”© ì¤‘..."; try { AllLockerTypes = new ObservableCollection<LockerType>(await _context.LockerTypes.OrderBy(t => t.Name).AsNoTracking().ToListAsync()); AllFloors = new ObservableCollection<Floor>(await _context.Floors.OrderBy(f => f.Name).AsNoTracking().ToListAsync()); AllZones = new ObservableCollection<Zone>(await _context.Zones.OrderBy(z => z.Name).AsNoTracking().ToListAsync()); AllSubParts = new ObservableCollection<SubPart>(await _context.SubParts.OrderBy(p => p.Name).AsNoTracking().ToListAsync()); AllAdministrators = new ObservableCollection<Administrator>(await _context.Administrators.OrderBy(a => a.Name).AsNoTracking().ToListAsync()); StatusBarText = "ë§ˆìŠ¤í„° ë°ì´í„°(ì½¤ë³´ë°•ìŠ¤ìš©) ë¡œë“œ ì™„ë£Œ."; } catch (InvalidOperationException ioEx) when (ioEx.Message.Contains("DataReader")) { HandleGenericException("ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© (DataReader ì¶©ëŒ ê°€ëŠ¥ì„±)", ioEx); MessageBox.Show("ë°ì´í„° ë¡œë”© ì¤‘ ì¶©ëŒ ë°œìƒ. App.config ì—°ê²° ë¬¸ìì—´ì— MultipleActiveResultSets=True; ì˜µì…˜ í™•ì¸ ë˜ëŠ” ì¬ì‹œë„.", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); } catch (Exception ex) { HandleGenericException("ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”©", ex); } }
        private void CheckMasterPassword(object parameter) { try { string storedMasterKey = ConfigurationManager.AppSettings["MasterKey"]; if (string.IsNullOrEmpty(storedMasterKey)) { MessageBox.Show("App.configì— ë§ˆìŠ¤í„° í‚¤(MasterKey) ì—†ìŒ.", "ì„¤ì • ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); return; } string plainPassword = ConvertToUnsecureString(MasterPasswordInput); if (plainPassword == storedMasterKey) { IsMasterModeEnabled = true; StatusBarText = "ë§ˆìŠ¤í„° ëª¨ë“œ í™œì„±í™”."; MessageBox.Show("ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì™„ë£Œ.", "ì„±ê³µ", MessageBoxButton.OK, MessageBoxImage.Information); } else { IsMasterModeEnabled = false; MessageBox.Show("ë§ˆìŠ¤í„° í‚¤ ë¶ˆì¼ì¹˜.", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } } catch (ConfigurationErrorsException confEx) { MessageBox.Show($"ì„¤ì • íŒŒì¼ ì˜¤ë¥˜:\n{confEx.Message}", "ì„¤ì • ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } catch (Exception ex) { MessageBox.Show($"ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì˜¤ë¥˜: {ex.Message}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } }
        private async Task SaveChangesAsync() { if (_context == null) return; StatusBarText = "ë³€ê²½ ì‚¬í•­ ì €ì¥ ì¤‘..."; List<DbEntityEntry> allChangedEntriesForRollback = _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged).ToList(); try { var changedLockerEntries = _context.ChangeTracker.Entries<LockerAssignment>().Where(e => e.State == EntityState.Added || e.State == EntityState.Modified).ToList(); var allItemsToCheck = LockerAssignments.ToList(); var duplicates = allItemsToCheck.GroupBy(l => new { l.Floor, l.Zone, l.SpecificLocation }).Where(g => g.Count() > 1).Select(g => g.Key); if (duplicates.Any()) { MessageBox.Show($"ì €ì¥ ë¶ˆê°€: ì¤‘ë³µ ìœ„ì¹˜ ë°œê²¬ - {string.Join(", ", duplicates.Select(d => $"{d.Floor}-{d.Zone}-{d.SpecificLocation}"))}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); RollbackChanges(allChangedEntriesForRollback); return; } foreach(var entry in changedLockerEntries) { entry.Entity.Administrator = _currentAdmin; } int changedCount = await _context.SaveChangesAsync(); StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œ ì €ì¥ë¨."; } catch (DbUpdateException dbEx) { HandleDbUpdateException(dbEx); RollbackChanges(allChangedEntriesForRollback); } catch (Exception ex) { HandleGenericException("ì €ì¥", ex); RollbackChanges(allChangedEntriesForRollback); } }
        private void RollbackChanges(IEnumerable<DbEntityEntry> changedEntries) { if (_context == null || changedEntries == null) return; foreach (var entry in changedEntries.ToList()) { switch (entry.State) { case EntityState.Modified: entry.CurrentValues.SetValues(entry.OriginalValues); entry.State = EntityState.Unchanged; break; case EntityState.Added: entry.State = EntityState.Detached; if (entry.Entity is LockerAssignment addedEntity && LockerAssignments.Contains(addedEntity)) LockerAssignments.Remove(addedEntity); break; case EntityState.Deleted: entry.State = EntityState.Unchanged; break; } } StatusBarText = "ë³€ê²½ ë¡¤ë°±ë¨."; }
        private void AddNewLocker(object parameter) { if (_context == null) return; var newAssignment = new LockerAssignment { LockerType = AllLockerTypes.FirstOrDefault()?.Name ?? "ê°œì¸ì‚¬ë¬¼í•¨", Floor = AllFloors.FirstOrDefault()?.Name ?? "1", Zone = AllZones.FirstOrDefault()?.Name ?? "A", SpecificLocation = "ìƒˆ ìœ„ì¹˜-" + Guid.NewGuid().ToString("N").Substring(0, 4), Administrator = _currentAdmin, LastUpdated = DateTime.Now }; LockerAssignments.Add(newAssignment); _context.LockerAssignments.Add(newAssignment); SelectedAssignment = newAssignment; StatusBarText = "ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€ë¨. ì €ì¥ í•„ìš”."; }
        private async Task DeleteSelectedAsync() { if (_context == null || SelectedAssignment == null) return; if (MessageBox.Show($"'{SelectedAssignment.Floor}-{SelectedAssignment.Zone}-{SelectedAssignment.SpecificLocation}' ì‚­ì œ?", "í™•ì¸", MessageBoxButton.YesNo, MessageBoxImage.Warning) == MessageBoxResult.Yes) { StatusBarText = "ì‚­ì œ ì¤‘..."; List<DbEntityEntry> changesForRollback = _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged).ToList(); try { var assignmentToDelete = SelectedAssignment; var entry = _context.Entry(assignmentToDelete); if (entry.State == EntityState.Detached) { _context.LockerAssignments.Attach(assignmentToDelete); } _context.LockerAssignments.Remove(assignmentToDelete); int changedCount = await _context.SaveChangesAsync(); LockerAssignments.Remove(assignmentToDelete); SelectedAssignment = null; StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œ ì‚­ì œë¨."; } catch (DbUpdateException dbEx) { HandleDbUpdateException(dbEx); RollbackChanges(changesForRollback); await LoadAssignmentsAsync(); } catch (Exception ex) { HandleGenericException("ì‚­ì œ", ex); RollbackChanges(changesForRollback); await LoadAssignmentsAsync(); } } }
        private void ClearSelectedAssignment(object parameter) { if (_context == null || SelectedAssignment == null) return; SelectedAssignment.UserName = null; SelectedAssignment.KnoxId = null; SelectedAssignment.SubPart = null; _context.Entry(SelectedAssignment).State = EntityState.Modified; SelectedAssignment.Administrator = _currentAdmin; StatusBarText = "ë°°ì • í•´ì œë¨. ì €ì¥ í•„ìš”."; }
        private void HandleGenericException(string operation, Exception ex) { StatusBarText = $"{operation} ì˜¤ë¥˜: {ex.Message}"; MessageBox.Show($"{operation} ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
        private void HandleDbUpdateException(DbUpdateException dbEx) { var innerExMsg = dbEx.InnerException?.InnerException?.Message ?? dbEx.InnerException?.Message ?? dbEx.Message; StatusBarText = $"DB ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: {innerExMsg}"; MessageBox.Show($"DB ì‘ì—… ì˜¤ë¥˜:\n{innerExMsg}\n\n{dbEx.ToString()}", "DB ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); try { foreach(var entry in dbEx.Entries) { entry.Reload(); } } catch { /* Reload ì‹¤íŒ¨ ë¬´ì‹œ */ } }
        private string ConvertToUnsecureString(SecureString securePassword) { if (securePassword == null) return string.Empty; IntPtr ptr = IntPtr.Zero; try { ptr = Marshal.SecureStringToGlobalAllocUnicode(securePassword); return Marshal.PtrToStringUni(ptr); } finally { Marshal.ZeroFreeGlobalAllocUnicode(ptr); } }
        private bool disposed = false;
        protected virtual void Dispose(bool disposing) { if (!disposed) { if (disposing) { _context?.Dispose(); } disposed = true; } }
        public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }
    }
}
í•µì‹¬ í™•ì¸ ì‚¬í•­:

BooleanToVisibilityConverter êµ¬í˜„ ë° ë“±ë¡: Infrastructure í´ë”ì— BooleanToVisibilityConverter.cs íŒŒì¼ì´ ìˆëŠ”ì§€, ê·¸ë¦¬ê³  MainWindow.xamlì˜ <dx:ThemedWindow.Resources> ì•ˆì— <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/> ë¦¬ì†ŒìŠ¤ê°€ ì£¼ì„ ì²˜ë¦¬ë˜ì§€ ì•Šê³  ì˜¬ë°”ë¥´ê²Œ ë“±ë¡ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”. ì´ ì»¨ë²„í„°ê°€ ì—†ìœ¼ë©´ Visibility ë°”ì¸ë”©ì´ ì‘ë™í•˜ì§€ ì•Šì•„ íƒ­ì´ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
MainViewModelì˜ IsMasterModeEnabled ì†ì„±: ì´ ì†ì„±ì˜ set ì ‘ê·¼ìì—ì„œ SetProperty(ref _isMasterModeEnabled, value)ê°€ í˜¸ì¶œë˜ì–´ UIì— ë³€ê²½ ì•Œë¦¼ì´ ê°€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. (ìœ„ ì½”ë“œì—ëŠ” ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤.)
XAML ë°”ì¸ë”© ê²½ë¡œ: MainWindow.xamlì˜ ë§ˆìŠ¤í„° ë°ì´í„° íƒ­ Visibility ë°”ì¸ë”© ê²½ë¡œê°€ ì •í™•í•œì§€ ë‹¤ì‹œ í™•ì¸í•©ë‹ˆë‹¤.
XML

 Visibility="{Binding DataContext.IsMasterModeEnabled, RelativeSource={RelativeSource AncestorType={dx:ThemedWindow}}, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"