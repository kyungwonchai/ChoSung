public async Task<string> SendCommandAsync(string cmd)
{
    try
    {
        // 포트가 열려 있는지 확인
        if (_serialPort == null || !_serialPort.IsOpen)
        {
            throw new InvalidOperationException("COM port is not open.");
        }

        // 명령 전송
        _serialPort.WriteLine(cmd); // 동기 메서드 사용 (비동기 메서드가 없는 경우)

        // 응답을 읽는 작업
        var readTask = Task.Run(() => _serialPort.ReadLine());

        // 타임아웃 설정 (2초)
        var timeoutTask = Task.Delay(TimeSpan.FromSeconds(2));

        // Any를 사용하여 먼저 완료된 Task를 기다림
        var completedTask = await Task.WhenAny(readTask, timeoutTask);

        // 응답이 먼저 완료된 경우
        if (completedTask == readTask)
        {
            return await readTask; // 결과 반환
        }
        else
        {
            // 타임아웃이 먼저 완료된 경우
            return "Timeout: No response from PLC within 2 seconds.";
        }
    }
    catch (InvalidOperationException ex)
    {
        // 포트가 열려 있지 않은 경우
        return $"Error: {ex.Message}";
    }
    catch (Exception ex)
    {
        // 다른 예외 처리
        return $"Error: {ex.Message}";
    }
}
