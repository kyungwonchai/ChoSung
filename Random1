vExpress WPF GridControl에서 여러 줄 텍스트를 엑셀로 내보낼 때 줄 바꿈이 유지되지 않는 문제를 해결하기 위해, 셀 내의 줄 바꿈을 인식하도록 설정해야 합니다. 이를 위해서는 셀의 텍스트가 줄 바꿈 문자를 포함하고, Excel 내보내기 시 이 줄 바꿈 문자가 유지되도록 해야 합니다.

다음은 WPF 코드 샘플입니다. 이 샘플에서는 GridControl의 데이터를 엑셀로 내보낼 때 줄 바꿈이 유지되도록 설정합니다.

csharp
코드 복사
using DevExpress.Export;
using DevExpress.Xpf.Grid;
using DevExpress.XtraPrinting;
using System.IO;
using System.Text.RegularExpressions;

private void ExportGridToExcel(GridControl gridControl, string filePath)
{
    // CustomExport 이벤트 핸들러 추가
    gridControl.CustomExport += GridControl_CustomExport;

    // XlsxExportOptions 객체를 생성합니다.
    XlsxExportOptions options = new XlsxExportOptions();
    options.TextExportMode = TextExportMode.Value;

    // GridControl 데이터를 Excel 파일로 내보냅니다.
    gridControl.View.ExportToXlsx(filePath, options);

    // CustomExport 이벤트 핸들러 제거
    gridControl.CustomExport -= GridControl_CustomExport;
}

private void GridControl_CustomExport(object sender, CustomExportEventArgs e)
{
    if (e.Value is string text)
    {
        // 줄 바꿈 문자를 인식하도록 설정
        e.ExportValue = Regex.Replace(text, @"\r\n|\n", "\n");
    }
}

// 엑셀로 내보내기 버튼 클릭 이벤트 핸들러
private void btnExportToExcel_Click(object sender, RoutedEventArgs e)
{
    string filePath = "output.xlsx";
    ExportGridToExcel(myGridControl, filePath);
    MessageBox.Show("엑셀로 내보내기가 완료되었습니다: " + filePath);
}
이 코드에서는 CustomExport 이벤트를 사용하여 GridControl에서 데이터를 내보내기 전에 각 셀의 값을 수정합니다. 줄 바꿈 문자를 "\n"으로 변경하여 엑셀 내보내기 시 줄 바꿈이 유지되도록 합니다.

이제 GridControl의 데이터를