ìŠµë‹ˆë‹¤. ì´ì–´ì„œ íŒŒì¼ ëª©ë¡ì˜ 19, 20, 21ë²ˆì§¸ íŒŒì¼(MasterDataViewModel.cs, MainWindow.xaml, MainWindow.xaml.cs)ì˜ ì „ì²´ ì½”ë“œë¥¼ ì—¬ê¸°ì— ë°”ë¡œ ì‘ì„±í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

19. ViewModels/MasterDataViewModel.cs

ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬ ì°½ì˜ ViewModelì…ë‹ˆë‹¤. ìì²´ DbContextë¥¼ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ë©°, ë§ˆìŠ¤í„° ë°ì´í„° CRUD ë° ì—°ì‡„ ì—…ë°ì´íŠ¸ ë¡œì§ì„ í¬í•¨í•©ë‹ˆë‹¤. IsMasterModeEnabled ê´€ë ¨ ë¡œì§ì€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.

C#

using LockerManagementApp.Data;
using LockerManagementApp.Models;
using LockerManagementApp.Infrastructure;
using System;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Data.Entity;
using System.Data.Entity.Infrastructure;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;
using System.Collections.Generic;
using System.Diagnostics;

namespace LockerManagementApp.ViewModels
{
    /// <summary>
    /// ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬ ViewModel (DbContext ìì²´ ìƒì„± ë° ê´€ë¦¬)
    /// </summary>
    public class MasterDataViewModel : ViewModelBase, IDisposable
    {
        private readonly LockerDbContext _context; // ì´ ViewModel ì „ìš© DbContext

        #region Observable Collections & Properties
        public ObservableCollection<LockerType> LockerTypes { get; set; }
        public ObservableCollection<Floor> Floors { get; set; }
        public ObservableCollection<Zone> Zones { get; set; }
        public ObservableCollection<SubPart> SubParts { get; set; }
        public ObservableCollection<Administrator> Administrators { get; set; }
        private object _selectedItem;
        public object SelectedItem { get => _selectedItem; set { if (SetProperty(ref _selectedItem, value)) RaiseCanExecuteChanged(); } } // CanExecute ê°±ì‹ 
        private string _statusMessage;
        public string StatusMessage { get => _statusMessage; set => SetProperty(ref _statusMessage, value); }
        #endregion

        #region Commands
        public ICommand LoadAllMasterDataCommand { get; }
        public ICommand AddItemCommand { get; }
        public ICommand DeleteItemCommand { get; }
        public ICommand SaveChangesCommand { get; }
        #endregion

        public MasterDataViewModel() // DbContext ë§¤ê°œë³€ìˆ˜ ì œê±°
        {
            try { _context = new LockerDbContext(); } // ìì‹ ì˜ DbContext ìƒì„±
            catch (Exception ex) { MessageBox.Show($"[MasterData] DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); StatusMessage = "[MasterData] DB ì—°ê²° ì˜¤ë¥˜!"; LockerTypes = new ObservableCollection<LockerType>(); Floors = new ObservableCollection<Floor>(); Zones = new ObservableCollection<Zone>(); SubParts = new ObservableCollection<SubPart>(); Administrators = new ObservableCollection<Administrator>(); LoadAllMasterDataCommand = new RelayCommand(_ => { }, _ => false); AddItemCommand = new RelayCommand(_ => { }, _ => false); DeleteItemCommand = new RelayCommand(_ => { }, _ => false); SaveChangesCommand = new RelayCommand(_ => { }, _ => false); return; }

            LockerTypes = new ObservableCollection<LockerType>(); Floors = new ObservableCollection<Floor>(); Zones = new ObservableCollection<Zone>(); SubParts = new ObservableCollection<SubPart>(); Administrators = new ObservableCollection<Administrator>();
            // Command ì´ˆê¸°í™” (CanExecuteì—ì„œ IsMasterModeEnabled ì¡°ê±´ ì œê±°ë¨)
            LoadAllMasterDataCommand = new RelayCommand(async _ => await LoadAllMasterDataAsync());
            AddItemCommand = new RelayCommand(AddItem, CanAddItemExecute);
            DeleteItemCommand = new RelayCommand(DeleteItem, CanDeleteItemExecute);
            SaveChangesCommand = new RelayCommand(async _ => await SaveMasterDataChangesAsync(), CanSaveChangesExecute); // ì €ì¥ ê°€ëŠ¥ ì¡°ê±´ì€ ë³€ê²½ ì—¬ë¶€ë§Œ í™•ì¸
            if (_context != null) { _ = LoadAllMasterDataAsync(); }
        }

        #region Data Loading and CRUD Methods
        public async Task LoadAllMasterDataAsync() { if (_context == null) return; StatusMessage = "ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© ì¤‘..."; try { var lockerTypes = await _context.LockerTypes.OrderBy(x => x.Name).AsNoTracking().ToListAsync(); LockerTypes.Clear(); lockerTypes.ForEach(LockerTypes.Add); var floors = await _context.Floors.OrderBy(x => x.Name).AsNoTracking().ToListAsync(); Floors.Clear(); floors.ForEach(Floors.Add); var zones = await _context.Zones.OrderBy(x => x.Name).AsNoTracking().ToListAsync(); Zones.Clear(); zones.ForEach(Zones.Add); var subParts = await _context.SubParts.OrderBy(x => x.Name).AsNoTracking().ToListAsync(); SubParts.Clear(); subParts.ForEach(SubParts.Add); var administrators = await _context.Administrators.OrderBy(x => x.Name).AsNoTracking().ToListAsync(); Administrators.Clear(); administrators.ForEach(Administrators.Add); StatusMessage = "ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë“œ ì™„ë£Œ."; } catch (Exception ex) { StatusMessage = $"ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© ì˜¤ë¥˜: {ex.Message}"; MessageBox.Show(StatusMessage, "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } }

        // CanExecute ë©”ì„œë“œì—ì„œ IsMasterModeEnabled ì¡°ê±´ ì œê±°ë¨
        private bool CanAddItemExecute(object parameter) => _context != null && parameter is string category && !string.IsNullOrEmpty(category);
        private bool CanDeleteItemExecute(object parameter) => _context != null && SelectedItem != null;
        private bool CanSaveChangesExecute(object parameter) => _context != null && _context.ChangeTracker.HasChanges();

        private void AddItem(object parameter) { if (!CanAddItemExecute(parameter)) return; if (parameter is string category) { try { object newItem = null; switch (category.ToLower()) { case "lockertype": newItem = _context.LockerTypes.Add(new LockerType { Name = "ìƒˆ ì¢…ë¥˜" }); LockerTypes.Add((LockerType)newItem); break; case "floor": newItem = _context.Floors.Add(new Floor { Name = "ìƒˆ ì¸µ" }); Floors.Add((Floor)newItem); break; case "zone": newItem = _context.Zones.Add(new Zone { Name = "ìƒˆ êµ¬ì—­" }); Zones.Add((Zone)newItem); break; case "subpart": newItem = _context.SubParts.Add(new SubPart { Name = "ìƒˆ ì†ŒíŒŒíŠ¸" }); SubParts.Add((SubPart)newItem); break; case "administrator": newItem = _context.Administrators.Add(new Administrator { Name = "ìƒˆ ê´€ë¦¬ì" }); Administrators.Add((Administrator)newItem); break; default: MessageBox.Show("ì•Œ ìˆ˜ ì—†ëŠ” ì¹´í…Œê³ ë¦¬.", "ì˜¤ë¥˜"); return; } SelectedItem = newItem; StatusMessage = "ìƒˆ í•­ëª© ì¶”ê°€ë¨. ì €ì¥ í•„ìš”."; RaiseCanExecuteChanged(); } catch (Exception ex) { StatusMessage = $"í•­ëª© ì¶”ê°€ ì˜¤ë¥˜: {ex.Message}"; MessageBox.Show(StatusMessage, "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } } }
        private void DeleteItem(object parameter) { if (!CanDeleteItemExecute(parameter)) return; string itemName = GetItemName(SelectedItem); if (itemName == null) return; string confirmMessage = $"'{itemName}' ì‚­ì œ?"; if (HasAssociatedAssignments(SelectedItem, itemName)) { confirmMessage += "\n\nê²½ê³ : ì‚¬ìš© ì¤‘ì¸ ì‚¬ë¬¼í•¨ ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤!"; } if (MessageBox.Show(confirmMessage, "ì‚­ì œ í™•ì¸", MessageBoxButton.YesNo, MessageBoxImage.Warning) == MessageBoxResult.Yes) { try { object entityToDelete = null; if (SelectedItem is LockerType lt) entityToDelete = lt; else if (SelectedItem is Floor f) entityToDelete = f; else if (SelectedItem is Zone z) entityToDelete = z; else if (SelectedItem is SubPart sp) entityToDelete = sp; else if (SelectedItem is Administrator ad) entityToDelete = ad; else return; var entry = _context.Entry(entityToDelete); if (entry.State == EntityState.Detached) _context.Set(entityToDelete.GetType()).Attach(entityToDelete); entry.State = EntityState.Deleted; if (SelectedItem is LockerType lt1) LockerTypes.Remove(lt1); else if (SelectedItem is Floor f1) Floors.Remove(f1); else if (SelectedItem is Zone z1) Zones.Remove(z1); else if (SelectedItem is SubPart sp1) SubParts.Remove(sp1); else if (SelectedItem is Administrator ad1) Administrators.Remove(ad1); SelectedItem = null; StatusMessage = "í•­ëª© ì‚­ì œ ëŒ€ê¸° ì¤‘. ì €ì¥ í•„ìš”."; RaiseCanExecuteChanged(); } catch (Exception ex) { StatusMessage = $"í•­ëª© ì‚­ì œ ì˜¤ë¥˜: {ex.Message}"; MessageBox.Show(StatusMessage, "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); _ = LoadAllMasterDataAsync(); } } }
        private string GetItemName(object item) { return item?.GetType().GetProperty("Name")?.GetValue(item)?.ToString(); }
        private bool HasAssociatedAssignments(object item, string itemName) { if (_context == null || item == null || string.IsNullOrEmpty(itemName)) return false; try { if (item is LockerType) return _context.LockerAssignments.Any(a => a.LockerType == itemName); if (item is Floor) return _context.LockerAssignments.Any(a => a.Floor == itemName); if (item is Zone) return _context.LockerAssignments.Any(a => a.Zone == itemName); if (item is SubPart) return _context.LockerAssignments.Any(a => a.SubPart == itemName); if (item is Administrator) return _context.LockerAssignments.Any(a => a.Administrator == itemName); } catch (Exception ex) { Debug.WriteLine($"ì—°ê´€ ë°ì´í„° í™•ì¸ ì˜¤ë¥˜: {ex.Message}"); return true; } return false; }

        /// <summary>
        /// ë§ˆìŠ¤í„° ë°ì´í„° ë³€ê²½ ì‚¬í•­ ì €ì¥ (ì—°ì‡„ ì—…ë°ì´íŠ¸ í¬í•¨) - ë§ˆìŠ¤í„° ëª¨ë“œ í™•ì¸ ì œê±°ë¨
        /// </summary>
        private async Task SaveMasterDataChangesAsync()
        {
            if (!CanSaveChangesExecute(null)) { StatusMessage = "ì €ì¥í•  ë³€ê²½ ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤."; return; }
            StatusMessage = "ë§ˆìŠ¤í„° ë°ì´í„° ì €ì¥ ì¤‘...";
            List<DbEntityEntry> changesForRollback = _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged).ToList();

            using (var transaction = _context.Database.BeginTransaction()) { try { Debug.WriteLine("ë§ˆìŠ¤í„° ë°ì´í„° ì €ì¥ ì‹œì‘ - íŠ¸ëœì­ì…˜ ì‹œì‘ë¨."); var modifiedNameEntries = _context.ChangeTracker.Entries().Where(e => e.State == EntityState.Modified && (e.Entity is LockerType || e.Entity is Floor || e.Entity is Zone || e.Entity is SubPart || e.Entity is Administrator)).Select(e => new { Entry = e, EntityType = e.Entity.GetType(), OriginalName = e.OriginalValues["Name"]?.ToString(), CurrentName = e.CurrentValues["Name"]?.ToString() }).Where(x => x.OriginalName != null && x.CurrentName != null && x.OriginalName != x.CurrentName).ToList(); Debug.WriteLine($"ì´ë¦„ ë³€ê²½ ê°ì§€ëœ ë§ˆìŠ¤í„° ë°ì´í„° ìˆ˜: {modifiedNameEntries.Count}"); foreach (var modified in modifiedNameEntries) { StatusMessage = $"'{modified.OriginalName}' -> '{modified.CurrentName}' ì—°ì‡„ ì—…ë°ì´íŠ¸ ì¤‘..."; Debug.WriteLine($"ì—°ì‡„ ì—…ë°ì´íŠ¸ ì‹œë„: Type={modified.EntityType.Name}, Original='{modified.OriginalName}', New='{modified.CurrentName}'"); int updatedCount = 0; string updateSql = ""; string targetColumn = ""; if (modified.EntityType == typeof(LockerType)) targetColumn = "LockerType"; else if (modified.EntityType == typeof(Floor)) targetColumn = "Floor"; else if (modified.EntityType == typeof(Zone)) targetColumn = "Zone"; else if (modified.EntityType == typeof(SubPart)) targetColumn = "SubPart"; else if (modified.EntityType == typeof(Administrator)) targetColumn = "Administrator"; if (!string.IsNullOrEmpty(targetColumn)) { updateSql = $"UPDATE LockerAssignments SET [{targetColumn}] = {{0}} WHERE [{targetColumn}] = {{1}}"; try { updatedCount = await _context.Database.ExecuteSqlCommandAsync(updateSql, modified.CurrentName, modified.OriginalName); StatusMessage = $"'{modified.OriginalName}' -> '{modified.CurrentName}' ({updatedCount}ê°œ ì—…ë°ì´íŠ¸ ì™„ë£Œ)."; Debug.WriteLine($"  SQL ì‹¤í–‰ ì„±ê³µ: {updateSql} | Params: '{modified.CurrentName}', '{modified.OriginalName}' | Rows Affected: {updatedCount}"); } catch (Exception sqlEx) { Debug.WriteLine($"*** ì—°ì‡„ ì—…ë°ì´íŠ¸ SQL ì‹¤í–‰ ì˜¤ë¥˜! SQL: {updateSql}, Params: '{modified.CurrentName}', '{modified.OriginalName}'\n*** ì˜¤ë¥˜: {sqlEx.ToString()}"); StatusMessage = $"'{modified.OriginalName}' ì—°ì‡„ ì—…ë°ì´íŠ¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ!"; throw; } } else { Debug.WriteLine($"  ê²½ê³ : ì—”í‹°í‹° íƒ€ì… '{modified.EntityType.Name}'ì— ëŒ€í•œ ëŒ€ìƒ ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); } } Debug.WriteLine("ë§ˆìŠ¤í„° ë°ì´í„° ë³€ê²½ ì‚¬í•­ ì €ì¥ ì‹œë„ (SaveChangesAsync)..."); int masterDataChanges = await _context.SaveChangesAsync(); Debug.WriteLine($"ë§ˆìŠ¤í„° ë°ì´í„° SaveChanges ì™„ë£Œ. ë³€ê²½ ê±´ìˆ˜: {masterDataChanges}"); transaction.Commit(); Debug.WriteLine("íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì™„ë£Œ."); StatusMessage = $"ë§ˆìŠ¤í„° ë°ì´í„° ë³€ê²½ ì‚¬í•­ ({masterDataChanges}ê±´) ë° ì—°ì‡„ ì—…ë°ì´íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."; } catch (Exception ex) { Debug.WriteLine($"*** ë§ˆìŠ¤í„° ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ! íŠ¸ëœì­ì…˜ ë¡¤ë°± ì‹œë„...\n*** ì˜¤ë¥˜: {ex.ToString()}"); try { transaction.Rollback(); Debug.WriteLine("íŠ¸ëœì­ì…˜ ë¡¤ë°± ì™„ë£Œ."); } catch (Exception rollbackEx) { Debug.WriteLine($"*** íŠ¸ëœì­ì…˜ ë¡¤ë°± ì¤‘ ì˜¤ë¥˜ ë°œìƒ!\n*** ì˜¤ë¥˜: {rollbackEx.ToString()}"); } StatusMessage = $"ë§ˆìŠ¤í„° ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {ex.Message}"; MessageBox.Show($"{StatusMessage}\n\nìì„¸í•œ ë‚´ìš©ì€ ì¶œë ¥ ì°½ì„ í™•ì¸í•˜ì„¸ìš”.", "ì €ì¥ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); RollbackMasterDataChanges(changesForRollback); } } await LoadAllMasterDataAsync(); RaiseCanExecuteChanged(); // ì €ì¥ í›„ CanExecute ìƒíƒœ ê°±ì‹ 
        }
        private void RollbackMasterDataChanges(List<DbEntityEntry> changedEntries) { if (_context == null || changedEntries == null) return; foreach (var entry in changedEntries) { switch (entry.State) { case EntityState.Modified: try { entry.Reload(); } catch { entry.State = EntityState.Unchanged; } break; case EntityState.Added: entry.State = EntityState.Detached; break; case EntityState.Deleted: entry.State = EntityState.Unchanged; break; } } StatusMessage = "ë§ˆìŠ¤í„° ë°ì´í„° ë³€ê²½ ë¡¤ë°±ë¨."; _ = LoadAllMasterDataAsync(); }
        #endregion

        /// <summary>
        /// ëª¨ë“  Commandì˜ CanExecute ìƒíƒœë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤.
        /// </summary>
        private void RaiseCanExecuteChanged()
        {
            (AddItemCommand as RelayCommand)?.RaiseCanExecuteChanged();
            (DeleteItemCommand as RelayCommand)?.RaiseCanExecuteChanged();
            (SaveChangesCommand as RelayCommand)?.RaiseCanExecuteChanged();
        }

        #region IDisposable êµ¬í˜„
        private bool disposed = false;
        protected virtual void Dispose(bool disposing) { if (!disposed) { if (disposing) { _context?.Dispose(); } disposed = true; } }
        public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }
        #endregion
    }
}
20. Views/MainWindow.xaml

ë©”ì¸ ìœˆë„ìš° XAMLì…ë‹ˆë‹¤. ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬ ì°½ì„ ì—¬ëŠ” ë²„íŠ¼ê³¼ Visibility ë°”ì¸ë”©, ë©”ì¸ ê·¸ë¦¬ë“œì˜ ì½¤ë³´ë°•ìŠ¤ ì„¤ì •(ValueMember) ë“±ì´ í¬í•¨ëœ ìµœì¢… ë²„ì „ì…ë‹ˆë‹¤.

XML

<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    xmlns:models="clr-namespace:LockerManagementApp.Models"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure"
    Title="ì‚¬ë¬¼í•¨ ê´€ë¦¬ í”„ë¡œê·¸ë¨ (DevExpress MVVM - .NET Framework 4.8)" Height="750" Width="1300"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"
    >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <Style x:Key="LightBlueHeaderStyle" TargetType="dxg:BaseGridHeader"> <Setter Property="Background" Value="LightBlue"/> <Setter Property="HorizontalContentAlignment" Value="Center"/> <Setter Property="FontWeight" Value="Bold"/> </Style>
        <Style TargetType="dxg:GridColumnHeader" BasedOn="{StaticResource LightBlueHeaderStyle}"/> <Style TargetType="dxg:BandHeaderControl" BasedOn="{StaticResource LightBlueHeaderStyle}"/>
    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="5">
                <TextBlock Text="ë§ˆìŠ¤í„° í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Content="í™•ì¸" Margin="5,0,0,0" Command="{Binding CheckMasterPasswordCommand}"/>
            </StackPanel>
            <Border Background="LightGray" Padding="5">
                 <StackPanel Orientation="Horizontal">
                    <Button Content="ğŸ”„ ìƒˆë¡œê³ ì¹¨" Margin="3" Command="{Binding LoadDataCommand}" ToolTip="ì‚¬ë¬¼í•¨ ëª©ë¡ ë° ì½¤ë³´ë°•ìŠ¤ ëª©ë¡ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤."/>
                    <Button Content="ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥" Margin="3" Command="{Binding SaveChangesCommand}" ToolTip="ì‚¬ë¬¼í•¨ ëª©ë¡ì˜ ë³€ê²½ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤."/>
                    <Button Content="âš™ï¸ ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬" Margin="15,3,3,3"
                             Command="{Binding OpenMasterDataWindowCommand}"
                             ToolTip="ë§ˆìŠ¤í„° ë°ì´í„°(ì¸µ, êµ¬ì—­ ë“±)ë¥¼ ê´€ë¦¬í•˜ëŠ” ìƒˆ ì°½ì„ ì—½ë‹ˆë‹¤."
                             Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                 </StackPanel>
            </Border>
        </DockPanel>

        <Grid Grid.Row="1" Margin="5">
            <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
            <Border Grid.Row="0" Background="WhiteSmoke" Padding="3"> <StackPanel Orientation="Horizontal"> <Button Content="â• ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€" Margin="3" Command="{Binding AddNewCommand}"/> <Button Content="âŒ ì„ íƒ í•­ëª© ì‚­ì œ" Margin="3" Command="{Binding DeleteCommand}"/> <Button Content="ğŸ§¹ ë°°ì • í•´ì œ" Margin="3" Command="{Binding ClearAssignmentCommand}"/> </StackPanel> </Border>
            <dxg:GridControl Grid.Row="1" ItemsSource="{Binding LockerAssignments}" SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}">
                <dxg:GridControl.View> <dxg:TableView AllowPerPixelScrolling="True" ShowGroupPanel="True" AllowEditing="True" NavigationStyle="Cell" ShowAutoFilterRow="True" NewItemRowPosition="None" ShowIndicator="True" ShowSearchPanelMode="Always"> <dxg:TableView.RowCellMenuCustomizations> <dxb:BarButtonItem Content="ë°°ì • í•´ì œ" Command="{Binding View.DataContext.ClearAssignmentCommand}" Glyph="{dx:DXImage Svg/Actions/DeleteList.svg}"/> <dxb:BarItemSeparator/> <dxb:BarButtonItem Content="í–‰ ì‚­ì œ" Command="{Binding View.DataContext.DeleteCommand}" Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/> </dxg:TableView.RowCellMenuCustomizations> </dxg:TableView> </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="LockerType" Header="ì¢…ë¥˜" Width="100" Fixed="Left" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllLockerTypes}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Floor" Header="ì¸µ" Width="60" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllFloors}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Zone" Header="êµ¬ì—­" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllZones}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SpecificLocation" Header="ì„¸ë¶€ ìœ„ì¹˜" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="UserName" Header="ì„±ëª…" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SubPart" Header="ì†ŒíŒŒíŠ¸" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllSubParts}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Administrator" Header="ê´€ë¦¬ ë‹´ë‹¹ì" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllAdministrators}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="TransferStatus" Header="ì „ë°°ë³µì§" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Details" Header="ë‚´ìš©" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Remarks" Header="íŠ¹ì´ì‚¬í•­" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Notes" Header="ë¹„ê³ " Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="LastUpdated" Header="ìµœì¢… ìˆ˜ì •ì¼ì‹œ" Width="150" AllowEditing="False" ReadOnly="True" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
                </dxg:GridControl.Columns>
            </dxg:GridControl>
        </Grid>

        <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem><TextBlock Text="{Binding StatusBarText}" Margin="5,0"/></StatusBarItem> </StatusBar>
    </Grid>

</dx:ThemedWindow>
21. Views/MainWindow.xaml.cs

ë©”ì¸ ìœˆë„ìš°ì˜ ì½”ë“œ ë¹„í•˜ì¸ë“œì…ë‹ˆë‹¤. Closing ì´ë²¤íŠ¸ì—ì„œ MainViewModelì˜ Disposeë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

C#

using DevExpress.Xpf.Core;
using LockerManagementApp.ViewModels;
using System;
using System.ComponentModel;
using System.Windows;

namespace LockerManagementApp.Views
{
    /// <summary>
    /// MainWindow.xamlì— ëŒ€í•œ ìƒí˜¸ ì‘ìš© ë…¼ë¦¬
    /// </summary>
    public partial class MainWindow : ThemedWindow
    {
        public MainWindow()
        {
            InitializeComponent();
            // í•„ìš” ì‹œ í…Œë§ˆ ì„¤ì •
            // ApplicationThemeHelper.ApplicationThemeName = Theme.Office2019ColorfulName;
        }

        // DataContextë¥¼ MainViewModel íƒ€ì…ìœ¼ë¡œ ìºìŠ¤íŒ…
        private MainViewModel ViewModel => DataContext as MainViewModel;

        // ì°½ ë¡œë“œ ì‹œ ì´ë²¤íŠ¸ (í•„ìš” ì‹œ ì‚¬ìš©)
        private void MainWindow_Loaded(object sender, RoutedEventArgs e) { }

        // ì°½ì´ ë‹«í ë•Œ MainViewModelì˜ Disposeë¥¼ í˜¸ì¶œí•˜ì—¬ í•´ë‹¹ ViewModelì˜ DbContext ì •ë¦¬
        private void MainWindow_Closing(object sender, CancelEventArgs e)
        {
            if (ViewModel is IDisposable disposableViewModel)
            {
                disposableViewModel.Dispose();
            }
        }
    }