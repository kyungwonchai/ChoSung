ë‹¨ê³„: í•µì‹¬ ë¡œì§ (app.py) ì„¤ëª…
ì´ ì½”ë“œëŠ” Githubì—ì„œ ë‚´ìš©ì„ 'ê°€ì ¸ì˜¤ê¸°'ë§Œ í•˜ê³ , ì›ë³¸ì„ ìˆ˜ì •í•˜ëŠ” ê¸°ëŠ¥ì€ ì•„ì˜ˆ ë°°ì œí–ˆìŠµë‹ˆë‹¤. ê°€ì ¸ì˜¨ ë°ì´í„°ëŠ” ê²½ì›ë‹˜ì˜ MSSQL 2014ì— INSERTë§Œ ìˆ˜í–‰í•˜ì—¬ íˆìŠ¤í† ë¦¬ë¥¼ ìŒ“ìŠµë‹ˆë‹¤.

ê¸°ëŠ¥ 1 (Fetch): GitHub APIë¡œ ì›ì‹œ(Raw) í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ DBì— ì €ì¥ í›„ í™”ë©´ì— ë¿Œë¦½ë‹ˆë‹¤.

ê¸°ëŠ¥ 2 (Search): DBì— ìŒ“ì¸ ë¡œê·¸ë¥¼ LIKE ê²€ìƒ‰ìœ¼ë¡œ ì¡°íšŒí•©ë‹ˆë‹¤.

íŒŒì¼ëª…: app.py

Python

import os
import pyodbc
import requests
from flask import Flask, render_template, request, jsonify
from datetime import datetime

app = Flask(__name__)

# ==========================================
# [ì„¤ì •] MSSQL ë° GitHub ì •ë³´ ìˆ˜ì • í•„ìˆ˜
# ==========================================
DB_CONFIG = {
    'driver': '{ODBC Driver 17 for SQL Server}', # í˜¹ì€ ì„¤ì¹˜ëœ ë“œë¼ì´ë²„ ë²„ì „ì— ë§ê²Œ
    'server': '192.168.0.xxx,1433', # MSSQL ì„œë²„ IP ë° í¬íŠ¸
    'database': 'YOUR_DB_NAME',     # ì‚¬ìš©í•  ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
    'uid': 'YOUR_ID',               # ì ‘ì† ID
    'pwd': 'YOUR_PASSWORD'          # ì ‘ì† ë¹„ë²ˆ
}

# Private Repoë¼ë©´ í† í° í•„ìˆ˜, Publicì´ë©´ ë¹„ì›Œë„ ë¨
GITHUB_TOKEN = "YOUR_GITHUB_TOKEN" 
# ==========================================

def get_db_connection():
    conn_str = f"DRIVER={DB_CONFIG['driver']};SERVER={DB_CONFIG['server']};DATABASE={DB_CONFIG['database']};UID={DB_CONFIG['uid']};PWD={DB_CONFIG['pwd']}"
    return pyodbc.connect(conn_str)

# ì„œë²„ ì‹œì‘ ì‹œ í…Œì´ë¸”ì´ ì—†ìœ¼ë©´ ìë™ ìƒì„± (ë¡œê·¸ ì €ì¥ìš©)
def init_db():
    try:
        conn = get_db_connection()
        cursor = conn.cursor()
        # ë‹¨ìˆœíˆ ì¡°íšŒ ì´ë ¥ì„ ìŒ“ëŠ” í…Œì´ë¸”ì…ë‹ˆë‹¤.
        query = '''
        IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='MyCodeHistory' AND xtype='U')
        CREATE TABLE MyCodeHistory (
            ID INT IDENTITY(1,1) PRIMARY KEY,
            RepoInfo NVARCHAR(255),
            FilePath NVARCHAR(255),
            CodeContent NVARCHAR(MAX),
            SavedAt DATETIME DEFAULT GETDATE()
        )
        '''
        cursor.execute(query)
        conn.commit()
        conn.close()
        print(">> DB í…Œì´ë¸” ì²´í¬/ìƒì„± ì™„ë£Œ")
    except Exception as e:
        print(f">> DB ì ‘ì† ì˜¤ë¥˜ (ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”): {e}")

@app.route('/')
def index():
    return render_template('index.html')

# [í•µì‹¬] ê¹ƒí—ˆë¸Œì—ì„œ ê°€ì ¸ì˜¤ê¸° + DB ì €ì¥ (ë‹¨ë°©í–¥)
@app.route('/fetch', methods=['POST'])
def fetch_code():
    data = request.json
    owner = data.get('owner')
    repo = data.get('repo')
    path = data.get('path')
    
    # GitHub Raw API URL êµ¬ì„±
    url = f"https://api.github.com/repos/{owner}/{repo}/contents/{path}"
    headers = {'Accept': 'application/vnd.github.v3.raw'}
    if GITHUB_TOKEN:
        headers['Authorization'] = f'token {GITHUB_TOKEN}'

    try:
        # 1. ê¹ƒí—ˆë¸Œ ë‚´ìš© ê°€ì ¸ì˜¤ê¸°
        resp = requests.get(url, headers=headers)
        resp.raise_for_status()
        content = resp.text
        
        # 2. DBì— 'ì½ê¸° ì „ìš©'ìœ¼ë¡œ ê¸°ë¡ (Insert Only)
        conn = get_db_connection()
        cursor = conn.cursor()
        sql = "INSERT INTO MyCodeHistory (RepoInfo, FilePath, CodeContent, SavedAt) VALUES (?, ?, ?, GETDATE())"
        cursor.execute(sql, (f"{owner}/{repo}", path, content))
        conn.commit()
        conn.close()
        
        return jsonify({'status': 'ok', 'content': content})
    except Exception as e:
        return jsonify({'status': 'error', 'msg': str(e)}), 500

# [í•µì‹¬] DB ë¼ì´í¬ ê²€ìƒ‰
@app.route('/search')
def search_code():
    keyword = request.args.get('q', '')
    if not keyword: return jsonify([])
    
    conn = get_db_connection()
    cursor = conn.cursor()
    # ë‚´ìš©(Content)ì´ë‚˜ íŒŒì¼ëª…(Path)ì— í‚¤ì›Œë“œê°€ ìˆëŠ” ê²½ìš° ê²€ìƒ‰
    sql = """
    SELECT TOP 20 ID, RepoInfo, FilePath, SavedAt 
    FROM MyCodeHistory 
    WHERE CodeContent LIKE ? OR FilePath LIKE ? 
    ORDER BY SavedAt DESC
    """
    param = f"%{keyword}%"
    cursor.execute(sql, (param, param))
    
    results = []
    for row in cursor.fetchall():
        results.append({
            'id': row.ID,
            'repo': row.RepoInfo,
            'path': row.FilePath,
            'date': row.SavedAt.strftime('%Y-%m-%d %H:%M')
        })
    conn.close()
    return jsonify(results)

# [í•µì‹¬] ê²€ìƒ‰ëœ ê¸°ë¡ ìƒì„¸ë³´ê¸°
@app.route('/history/<int:id>')
def get_history(id):
    conn = get_db_connection()
    cursor = conn.cursor()
    cursor.execute("SELECT CodeContent FROM MyCodeHistory WHERE ID = ?", (id,))
    row = cursor.fetchone()
    conn.close()
    if row:
        return jsonify({'content': row.CodeContent})
    return jsonify({'error': 'Not found'}), 404

if __name__ == '__main__':
    init_db()
    app.run(host='0.0.0.0', port=5000)
3ë‹¨ê³„: UI (templates/index.html) ì„¤ëª…
ìš”ì²­í•˜ì‹  ë‹¤í¬ ëª¨ë“œ + ê·¸ë¼ë°ì´ì…˜ ë””ìì¸ì…ë‹ˆë‹¤.

ë°°ê²½: ì§™ì€ ë‚¨ìƒ‰~ë³´ë¼ ê³„ì—´ì˜ ê·¸ë¼ë°ì´ì…˜ (linear-gradient)ì„ ì‚¬ìš©í•˜ì—¬ ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ëŠë‚Œì„ ì¤¬ìŠµë‹ˆë‹¤.

ì¹´ë“œ: ë°˜íˆ¬ëª…í•œ ê²€ì€ìƒ‰ ë°°ê²½(rgba)ì„ ì‚¬ìš©í•˜ì—¬ ë°°ê²½ê³¼ ì–´ìš°ëŸ¬ì§€ê²Œ í–ˆìŠµë‹ˆë‹¤.

ê°€ë…ì„±: ì½”ë“œëŠ” ì–´ë‘ìš´ í…Œë§ˆì˜ ì—ë””í„° ëŠë‚Œìœ¼ë¡œ ì¶œë ¥ë©ë‹ˆë‹¤.

ê²½ë¡œ: templates/index.html (ë°˜ë“œì‹œ templates í´ë” ì•ˆì— ìƒì„±)

HTML

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Kyungwon's Code Vault</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* [ë””ìì¸] ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ë‹¤í¬ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ */
        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            color: #e0e0e0;
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* [ë””ìì¸] ì¹´ë“œ ìŠ¤íƒ€ì¼: ë°˜íˆ¬ëª… ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ íš¨ê³¼ */
        .card {
            background-color: rgba(30, 30, 40, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .card-header {
            background-color: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-weight: bold;
            color: #4facfe; /* í¬ì¸íŠ¸ ì»¬ëŸ¬ */
        }
        
        /* ì…ë ¥ í¼ ìŠ¤íƒ€ì¼ */
        .form-control {
            background-color: #2b2b3b;
            border: 1px solid #444;
            color: #fff;
        }
        .form-control:focus {
            background-color: #3b3b4b;
            color: #fff;
            border-color: #4facfe;
            box-shadow: 0 0 0 0.25rem rgba(79, 172, 254, 0.25);
        }

        /* ì½”ë“œ ë·°ì–´ ì˜ì—­ */
        pre {
            background-color: #1a1a1a;
            color: #a9b7c6;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            max-height: 700px;
            overflow: auto;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        /* ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ */
        .list-group-item {
            background-color: transparent;
            border-color: rgba(255, 255, 255, 0.1);
            color: #ccc;
            cursor: pointer;
            transition: all 0.2s;
        }
        .list-group-item:hover {
            background-color: rgba(79, 172, 254, 0.2);
            color: #fff;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-primary {
            background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);
            border: none;
            color: #000;
            font-weight: bold;
        }
        .btn-success {
            background: linear-gradient(to right, #43e97b 0%, #38f9d7 100%);
            border: none;
            color: #000;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <h2 class="text-center mb-4" style="color:#fff; text-shadow: 0 2px 4px rgba(0,0,0,0.5);">
        ğŸ” GitHub Code Fetcher & History
    </h2>
    
    <div class="row">
        <div class="col-lg-4 mb-4">
            <div class="card mb-4">
                <div class="card-header">GitHub ê°€ì ¸ì˜¤ê¸° (Read Only)</div>
                <div class="card-body">
                    <div class="mb-2">
                        <input type="text" id="owner" class="form-control mb-2" placeholder="User (e.g. microsoft)">
                        <input type="text" id="repo" class="form-control mb-2" placeholder="Repo (e.g. vscode)">
                        <input type="text" id="path" class="form-control mb-2" placeholder="File Path (e.g. README.md)">
                    </div>
                    <button class="btn btn-primary w-100" onclick="fetchGithub()">ğŸš€ ê°€ì ¸ì˜¤ê¸° & ì €ì¥</button>
                </div>
            </div>

            <div class="card h-100">
                <div class="card-header">DB History ê²€ìƒ‰</div>
                <div class="card-body d-flex flex-column">
                    <div class="input-group mb-3">
                        <input type="text" id="keyword" class="form-control" placeholder="ë‚´ìš© ê²€ìƒ‰..." onkeyup="if(event.key==='Enter') searchDB()">
                        <button class="btn btn-success" onclick="searchDB()">ê²€ìƒ‰</button>
                    </div>
                    <div id="resultList" class="list-group list-group-flush overflow-auto" style="max-height: 400px;">
                        <div class="text-center text-muted mt-3">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-8">
            <div class="card h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span>ğŸ“œ Code Viewer</span>
                    <button class="btn btn-sm btn-light" onclick="copyCode()">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
                </div>
                <div class="card-body">
                    <pre id="codeView">// íŒŒì¼ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</pre>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // GitHub ê°€ì ¸ì˜¤ê¸°
    async function fetchGithub() {
        const data = {
            owner: document.getElementById('owner').value,
            repo: document.getElementById('repo').value,
            path: document.getElementById('path').value
        };
        
        if(!data.owner || !data.repo || !data.path) {
            alert('ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return;
        }

        try {
            const res = await fetch('/fetch', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(data)
            });
            const json = await res.json();
            
            if(json.status === 'ok') {
                document.getElementById('codeView').innerText = json.content;
            } else {
                alert('ì˜¤ë¥˜: ' + json.msg);
            }
        } catch (e) { alert('ì„œë²„ í†µì‹  ì˜¤ë¥˜'); }
    }

    // DB ê²€ìƒ‰
    async function searchDB() {
        const q = document.getElementById('keyword').value;
        const res = await fetch(`/search?q=${encodeURIComponent(q)}`);
        const list = await res.json();
        
        const container = document.getElementById('resultList');
        container.innerHTML = '';
        
        if(list.length === 0) {
            container.innerHTML = '<div class="text-center text-muted mt-3">ê²°ê³¼ ì—†ìŒ</div>';
            return;
        }

        list.forEach(item => {
            const el = document.createElement('a');
            el.className = 'list-group-item list-group-item-action';
            el.innerHTML = `
                <div class="d-flex w-100 justify-content-between">
                    <small class="text-info">${item.repo}</small>
                    <small class="text-muted" style="font-size:0.7em">${item.date}</small>
                </div>
                <p class="mb-1 text-truncate">${item.path}</p>
            `;
            el.onclick = () => loadHistory(item.id);
            container.appendChild(el);
        });
    }

    // íˆìŠ¤í† ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
    async function loadHistory(id) {
        const res = await fetch(`/history/${id}`);
        const json = await res.json();
        if(json.content) {
            document.getElementById('codeView').innerText = json.content;
        }
    }

    // í´ë¦½ë³´ë“œ ë³µì‚¬
    function copyCode() {
        const text = document.getElementById('codeView').innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert('ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! âœ¨');
        });
    }
</script>
</body>
</html>
ì‹¤í–‰ ë°©ë²•
í´ë”ë¥¼ í•˜ë‚˜ ë§Œë“¤ê³  ìœ„ **app.py**ì™€ **templates/index.html**ì„ ì €ì¥í•˜ì„¸ìš”.

í„°ë¯¸ë„ì—ì„œ ê²½ì›ë‹˜ì˜ ê°€ìƒí™˜ê²½ì„ ì¼­ë‹ˆë‹¤: source /home/myvenv1/bin/activate

ì‹¤í–‰í•©ë‹ˆë‹¤: python app.py

ì´ì œ ì›¹ì—ì„œ í¸í•˜ê²Œ ê¹ƒí—ˆë¸Œ ì½”ë“œë¥¼ ë‹¹ê²¨ì˜¤ê³ , ìë™ìœ¼ë¡œ ë°±ì—…ëœ ë‚´ìš©ì„ ì–¸ì œë“  ê·¸ë¼ë°ì´ì…˜ UIì—ì„œ ê²€ìƒ‰í•´ë³´ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í˜¹ì‹œ Nginx í¬íŠ¸ ì—°ê²°(ì˜ˆ: 8028) ì„¤ì •ì´ ì¶”ê°€ë¡œ í•„ìš”í•˜ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”.