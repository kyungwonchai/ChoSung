래는 C# WinForms에서 특정 웹 페이지의 버튼을 XPath를 사용하여 클릭하는 코드입니다. 이 코드는 WebView2 컨트롤을 활용하며, 버튼이 존재하지 않거나 클릭에 실패할 경우 메시지 박스를 띄우도록 구현했습니다.

[필요한 설치]
WebView2 추가

NuGet 패키지 관리자에서 Microsoft.Web.WebView2 설치
WinForms Form에 WebView2 컨트롤 추가

webView2 컨트롤을 폼에 추가
C# 코드 (WinForms)
csharp
코드 복사
using System;
using System.Threading.Tasks;
using System.Windows.Forms;
using Microsoft.Web.WebView2.Core;

namespace WebButtonClicker
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
            InitializeWebView();
        }

        private async void InitializeWebView()
        {
            try
            {
                await webView2.EnsureCoreWebView2Async(null);
                webView2.Source = new Uri("https://your-web-page.com"); // 웹사이트 주소 입력
            }
            catch (Exception ex)
            {
                MessageBox.Show("WebView2 초기화 실패: " + ex.Message, "오류", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }

        private async void btnClickWebButton_Click(object sender, EventArgs e)
        {
            string xPath = "//*[@id='your-button-id']"; // 복사한 XPath 입력

            try
            {
                string script = $@"
                (function() {{
                    let button = document.evaluate(""{xPath}"", document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
                    if (button) {{
                        button.click();
                        return 'SUCCESS';
                    }} else {{
                        return 'NOT_FOUND';
                    }}
                }})();";

                var result = await webView2.CoreWebView2.ExecuteScriptAsync(script);
                if (result.Contains("NOT_FOUND"))
                {
                    MessageBox.Show("버튼을 찾을 수 없습니다!", "오류", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show("웹 버튼 클릭 실패: " + ex.Message, "오류", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
        }
    }
}
설명
WebView2 초기화

EnsureCoreWebView2Async()를 사용하여 WebView2 엔진을 로드
웹 페이지 (webView2.Source = new Uri(...)) 로드
버튼 클릭 코드

ExecuteScriptAsync()를 사용하여 JavaScript 실행
XPath를 사용하여 버튼을 찾고 click() 호출
버튼이 없으면 "NOT_FOUND"를 반환하여 경고 메시지 표시
오류 처리

WebView2가 초기화되지 않거나 버튼이 없으면 팝업 창으로 사용자에게 알림
결과
버튼이 정상적으로 있으면 자동으로 클릭