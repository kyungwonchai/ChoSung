using System;
using System.Data.SqlClient;

namespace YourNamespace
{
    class Program
    {
        static void Main(string[] args)
        {
            string connectionString = "Server=your_server;Database=your_database;User Id=your_username;Password=your_password;";
            string[] columns = new string[] { "Column1", "Column2", /* ... 50개의 컬럼 */ };

            string updateSetClause = string.Join(", ", Array.ConvertAll(columns, column => $"{column} = @Updated{column}"));

            string insertQuery = $"INSERT INTO T_메인확정 ({string.Join(",", columns)}) VALUES (@{string.Join(", @", columns)})";
            string updateQuery = $"UPDATE T_메인확정 SET {updateSetClause} WHERE N_datek = @N_datek AND C_Site_Name = @C_Site_Name AND C_Resource_Name = @C_Resource_Name AND C_Basic_Name__Fix_ = @C_Basic_Name__Fix_";

            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();

                try
                {
                    using (SqlCommand cmd = new SqlCommand(insertQuery, connection))
                    {
                        // 이 부분에서 파라미터를 설정합니다.
                        cmd.ExecuteNonQuery();
                    }
                }
                catch (SqlException ex)
                {
                    if (ex.Number == 2627 || ex.Number == 2601)  // 중복 키 에러
                    {
                        using (SqlCommand cmd = new SqlCommand(updateQuery, connection))
                        {
                            // 이 부분에서 업데이트 할 파라미터를 설정합니다.
                            cmd.ExecuteNonQuery();
                        }
                    }
                    else
                    {
                        Console.WriteLine("SQL Error: " + ex.Message);
                    }
                }

                connection.Close();
            }
        }
    }
}
