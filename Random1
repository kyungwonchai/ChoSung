을 노란색으로 변경하는 VBA 코드입니다. 조건을 만족하면 병합된 셀의 배경색을 변경합니다.

vba
코드 복사
Sub HighlightOnlyMergedCells()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    Dim mergeArea As Range
    Dim b4Color As Long
    Dim hasSum As Boolean
    
    ' 시트 변수 설정
    Set ws = ThisWorkbook.Sheets("주차2_시트")
    
    ' B3 셀의 CurrentRegion 설정
    Set rng = ws.Range("B3").CurrentRegion
    
    ' B4 셀의 배경색 가져오기
    b4Color = ws.Range("B4").Interior.Color
    
    ' C열과 D열에 대해 병합된 셀 확인
    For Each cell In rng.Columns("C:D").Cells
        ' 병합된 셀인지 확인
        If cell.MergeCells Then
            Set mergeArea = cell.MergeArea
            
            ' 병합된 셀이 C열과 D열에만 해당하는지 확인
            If mergeArea.Columns.Count = 2 Then
                ' 병합된 셀의 배경색이 B4와 같은지 확인
                If mergeArea.Interior.Color = b4Color Then
                    ' 병합 영역에 "합계"가 포함되어 있는지 확인
                    hasSum = False
                    If InStr(1, mergeArea.Value, "합계", vbTextCompare) > 0 Then
                        hasSum = True
                    End If
                    
                    ' "합계"가 없다면 배경색을 노랑으로 변경
                    If Not hasSum Then
                        mergeArea.Interior.Color = RGB(255, 255, 0) ' 노랑색
                    End If
                End If
            End If
        End If
    Next cell
    
    MsgBox "작업이 완료되었습니다.", vbInformation
End Sub
변경 사항
C열과 D열만 병합 확인:

병합 영역의 열 개수를 확인하기 위해 mergeArea.Columns.Count = 2 조건을 추가했습니다.
병합된 셀이 C열과 D열에만 해당할 때만 작업합니다.
배경색 비교:

병합된 셀의 배경색이 B4와 같은 경우에만 작업을 진행합니다.
"합계" 포함 여부 확인:

병합된 셀의 값을 확인해 "합계"라는 텍스트가 포함되어 있지 않을 경우에만 배경색을 노란색으로 변경합니다.
사용 방법
Excel에서 Alt + F11을 눌러 VBA 편집기를 엽니다.
삽입 > 모듈을 선택한 뒤 위 코드를 붙여넣습니다.