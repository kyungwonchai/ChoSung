import pandas as pd
import matplotlib.pyplot as plt
import matplotlib.dates as mdates

# 데이터 불러오기 (엑셀 파일의 'data' 시트에서 I열 불러오기)
file_path = 'YOUR_FILE_PATH.xlsx'
df = pd.read_excel(file_path, sheet_name='data', usecols=['I'])
df.columns = ['date1']

# datetime 형식으로 변환
df['date1'] = pd.to_datetime(df['date1'], format='%Y-%m-%d %H:%M:%S')

# 시간별 데이터 개수 집계
df['hour'] = df['date1'].dt.hour
df_grouped = df.groupby('hour').size()

# 히스토그램 그리기
fig, ax = plt.subplots()
df_grouped.plot(kind='bar', ax=ax)

# X축 설정 (시간대)
ax.set_xlabel('Hour of Day')
ax.set_ylabel('Number of Entries')
ax.set_title('Distribution of Entries by Hour of Day')

# X축 눈금 레이블 설정
tick_labels = [f'{hour}:00' for hour in range(24)]
ax.set_xticklabels(tick_labels, rotation=45)

# 그래프 보여주기
plt.tight_layout()