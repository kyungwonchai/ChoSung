Mat을 Bitmap으로 변환하는 ConvertMatToBitmap 함수 추가
이전 코드에서 ConvertMatToBitmap 함수가 빠져 있었네요. 확실하게 수정해서 Mat → Bitmap 변환하는 함수를 추가했습니다. 🚀

1. OpenCvSharp Mat → Bitmap 변환 방법
Mat을 Bitmap으로 변환하려면 OpenCvSharp의 ToBitmap() 메서드를 사용하면 됨.
또는 MemoryStream을 활용하여 BitmapImage로 변환할 수도 있음.
아래 함수는 Mat을 직접 Bitmap으로 변환하는 함수.
2. ConvertMatToBitmap 함수 추가
csharp
코드 복사
// Mat → Bitmap 변환 함수
private Bitmap ConvertMatToBitmap(Mat mat)
{
    return BitmapConverter.ToBitmap(mat);
}
3. 전체 WinForms 코드 (Form1.cs)
csharp
코드 복사
using System;
using System.Drawing;
using System.Windows.Forms;
using OpenCvSharp;
using OpenCvSharp.Extensions;

namespace WinFormsOpenCv
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        // 버튼 클릭 시 실행
        private void btnProcess_Click(object sender, EventArgs e)
        {
            // 화면 캡처
            Bitmap screenshot = CaptureScreen();

            // OpenCV Mat 변환 및 이진화 적용
            Mat matImage = BitmapConverter.ToMat(screenshot);
            Mat gray = new Mat();
            Cv2.CvtColor(matImage, gray, ColorConversionCodes.BGR2GRAY);
            Mat binary = new Mat();
            Cv2.Threshold(gray, binary, 200, 255, ThresholdTypes.Binary);

            // PictureBox에 표시
            pictureBox1.Image = ConvertMatToBitmap(binary);
        }

        // 화면 캡처 함수
        private Bitmap CaptureScreen()
        {
            Rectangle bounds = Screen.PrimaryScreen.Bounds;
            Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height);
            using (Graphics g = Graphics.FromImage(bitmap))
            {
                g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
            }
            return bitmap;
        }

        // Mat → Bitmap 변환 함수
        private Bitmap ConvertMatToBitmap(Mat mat)
        {
            return BitmapConverter.ToBitmap(mat);
        }
    }
}
4. 코드 설명
✔ ConvertMatToBitmap 함수
csharp
코드 복사
private Bitmap ConvertMatToBitmap(Mat mat)
{
    return BitmapConverter.ToBitmap(mat);
}