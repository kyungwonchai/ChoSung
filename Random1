만 유지하고 나머지를 자동으로 삭제하는 기능을 추가하도록 하겠습니다. 수정된 코드는 다음과 같습니다:

csharp

using System;
using System.IO;
using System.Linq;

namespace LogManagement
{
    public class LogManager
    {
        private string logFolderPath;
        private string logFilePath;

        public LogManager(string folderPath)
        {
            logFolderPath = folderPath;
            logFilePath = CreateLogFilePath();
        }

        private string CreateLogFilePath()
        {
            string fileName = DateTime.Now.ToString("yyyyMMdd") + ".log";
            string filePath = Path.Combine(logFolderPath, fileName);

            if (!File.Exists(filePath))
            {
                File.Create(filePath).Dispose();
            }

            return filePath;
        }

        public void AddLogEntry(string logEntry)
        {
            string logLine = $"[{DateTime.Now.ToString("yyyyMMddHHmmss")}]: {logEntry}";
            using (StreamWriter sw = File.AppendText(logFilePath))
            {
                sw.WriteLine(logLine);
            }

            DeleteOldLogFiles(14); // 최근 2주간의 로그 파일 유지, 나머지 삭제
        }

        private void DeleteOldLogFiles(int retentionDays)
        {
            DateTime retentionDate = DateTime.Now.AddDays(-retentionDays);
            var logFiles = Directory.GetFiles(logFolderPath)
                                    .Where(file => File.GetCreationTime(file) < retentionDate);

            foreach (var file in logFiles)
            {
                File.Delete(file);
            }
        }
    }
}

위의 코드에서 AddLogEntry() 함수에서 로그를 추가한 후, DeleteOldLogFiles() 함수를 호출하여 최근 2주 동안의 로그 파일만 유지하고 나머지를 삭제합니다. 이를 통해 자동으로 로그 파일이 유지되고 관리됩니다.

사용 예시:

csharp

using System;
using LogManagement;

namespace LogExample
{
    class Program
    {
        static void Main()
        {
            string logFolderPath = @"C:\Agent\KnoxAPILog";

            LogManager logManager = new LogManager(logFolderPath);
            logManager.AddLogEntry("This is a log entry.");
        }
    }
}

위의 예시에서는 LogManager 클래스의 인스턴스를 생성한 후, AddLogEntry() 메서드를 호출하여 로그를 추가합니다. 이 함수를 호출할 때마다 최근 2주간의 로그 파일을 유지하고