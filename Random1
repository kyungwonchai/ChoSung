using Python.Runtime;
using System.Collections.Generic;

...

private void SearchButton_Click(object sender, EventArgs e)
{
    using (Py.GIL()) // 파이썬 글로벌 인터프리터 락 획득
    {
        dynamic pyModule = Py.Import("predict"); // 파이썬 모듈 import (predict.py 파일)
        dynamic getSimilarity = pyModule.GetAttr("get_similarity"); // 함수 가져오기

        string userInput = inputTextBox.Text;
        PyObject pyResult = getSimilarity(userInput); // 파이썬 함수 호출

        // 결과를 C# 리스트로 변환
        List<string> similarItems = new List<string>();
        foreach (PyObject item in pyResult)
        {
            similarItems.Add(item.As<string>());
        }

        resultsListBox.Items.Clear();
        foreach (var item in similarItems)
        {
            resultsListBox.Items.Add(item);
        }
    }
}
