reamlitìœ¼ë¡œ npmlog ì¡°íšŒ ëŒ€ì‹œë³´ë“œ ë§Œë“¤ê¸° (for Ubuntu)
ì•„ë˜ëŠ” pymssqlì„ ì‚¬ìš©í•˜ì—¬ SQL Serverì˜ npmlog í…Œì´ë¸” ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê³ , Streamlitì„ ì´ìš©í•´ ì›¹ í…Œì´ë¸” í˜•íƒœë¡œ í‘œì‹œí•˜ëŠ” ì „ì²´ ì½”ë“œì…ë‹ˆë‹¤.

Ubuntu í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ì„¤ì¹˜ ì•ˆë‚´ë„ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

1. Ubuntuì— í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
í„°ë¯¸ë„ì„ ì—´ê³  ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ì„¸ìš”. pymssqlì€ FreeTDS ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì˜ì¡´í•˜ë¯€ë¡œ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

Bash

# FreeTDS ê°œë°œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
sudo apt-get update
sudo apt-get install freetds-dev -y

# Python íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install streamlit pandas pymssql
2. Streamlit íŒŒì´ì¬ ì½”ë“œ (app.py)
ì•„ë˜ ì½”ë“œë¥¼ app.pyì™€ ê°™ì€ íŒŒì¼ ì´ë¦„ìœ¼ë¡œ ì €ì¥í•˜ì„¸ìš”.

âš ï¸ ì¤‘ìš”: ì½”ë“œ ë‚´ì˜ SERVER, USER, PASSWORD, DATABASE ê°’ì„ ì‹¤ì œ DB ì ‘ì† ì •ë³´ë¡œ ë°˜ë“œì‹œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.

Python

import streamlit as st
import pandas as pd
import pymssql
from datetime import datetime

# -----------------------------------------------------------
# DB ì ‘ì† ì •ë³´ (ì‚¬ìš©ì í™˜ê²½ì— ë§ê²Œ ë°˜ë“œì‹œ ìˆ˜ì •í•´ì£¼ì„¸ìš”)
# -----------------------------------------------------------
DB_CONFIG = {
    'server': 'YOUR_SERVER_IP_OR_HOSTNAME',  # ì˜ˆ: 192.168.0.100 ë˜ëŠ” mssql.example.com
    'user': 'YOUR_USERNAME',                # ì˜ˆ: sa
    'password': 'YOUR_PASSWORD',            # ì˜ˆ: 'your_strong_password'
    'database': 'SControlFlaskDB',
    'as_dict': True # ê²°ê³¼ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ë°›ê¸°
}
# -----------------------------------------------------------

# í˜ì´ì§€ ê¸°ë³¸ ì„¤ì •
st.set_page_config(
    page_title="npmlog ì‹¤ì‹œê°„ ì¡°íšŒ",
    page_icon="ğŸ“œ",
    layout="wide"
)

# ì œëª©
st.title("ğŸ“œ npmlog ì‹¤ì‹œê°„ ë¡œê·¸ ì¡°íšŒ")

# ë°ì´í„° ë¡œë”© í•¨ìˆ˜ (ìºì‹œ ì‚¬ìš©ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ)
@st.cache_data(ttl=10) # 10ì´ˆë§ˆë‹¤ ìºì‹œ ë§Œë£Œ
def load_data():
    """npmlog í…Œì´ë¸”ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì—¬ Pandas DataFrameìœ¼ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤."""
    try:
        conn = pymssql.connect(**DB_CONFIG)
        # ìµœì‹  ë¡œê·¸ê°€ ìœ„ë¡œ ì˜¤ë„ë¡ no1 ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
        query = "SELECT no1, line, onoff, datetime1 FROM npmlog ORDER BY no1 DESC;"
        df = pd.read_sql(query, conn)
        conn.close()
        
        # datetime1 ì»¬ëŸ¼ì˜ ì‹œê°„ í¬ë§·ì„ ë³´ê¸° ì¢‹ê²Œ ë³€ê²½ (ë°€ë¦¬ì´ˆ ì œê±°)
        if 'datetime1' in df.columns:
            df['datetime1'] = pd.to_datetime(df['datetime1']).dt.strftime('%Y-%m-%d %H:%M:%S')

        return df

    except Exception as e:
        # DB ì—°ê²° ì‹¤íŒ¨ ë˜ëŠ” ì¿¼ë¦¬ ì˜¤ë¥˜ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
        st.error(f"ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë˜ëŠ” ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}")
        return pd.DataFrame() # ë¹ˆ ë°ì´í„°í”„ë ˆì„ ë°˜í™˜

# ë°ì´í„° ë¡œë“œ
df_log = load_data()

# ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼ê³¼ ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ í‘œì‹œ
col1, col2 = st.columns([1, 5])
with col1:
    if st.button("ìƒˆë¡œê³ ì¹¨ ğŸ”„"):
        st.cache_data.clear() # ìºì‹œ ì§€ìš°ê³  ìƒˆë¡œ ë¡œë“œ
        st.experimental_rerun()

with col2:
    st.markdown(f"""
    <div style="text-align: right; color: grey;">
        ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}
    </div>
    """, unsafe_allow_html=True)

# ë°ì´í„°í”„ë ˆì„ í‘œì‹œ
if not df_log.empty:
    st.dataframe(df_log, use_container_width=True, height=600)
    st.info(f"ì´ {len(df_log)}ê°œì˜ ë¡œê·¸ê°€ ì¡°íšŒë˜ì—ˆìŠµë‹ˆë‹¤.")
else:
    st.warning("ì¡°íšŒí•  ë°ì´í„°ê°€ ì—†ê±°ë‚˜, DB ì—°ê²° ì •ë³´ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.")

3. Streamlit ì•± ì‹¤í–‰
í„°ë¯¸ë„ì—ì„œ app.py íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•œ í›„ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.

Bash
