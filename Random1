에서 특정 탭을 찾는 전체 코드를 다시 제공하겠습니다.

csharp

using DevExpress.XtraTab;
using System;
using System.Diagnostics;
using System.Threading;
using System.Windows.Automation;

// ...

private XtraTabPage FindTabByName(string processName, string tabControlName, string tabName)
{
    Process[] processes = Process.GetProcessesByName(processName);
    if (processes.Length == 0)
    {
        Console.WriteLine($"프로세스 '{processName}'을(를) 찾을 수 없습니다.");
        return null;
    }

    Process targetProcess = processes[0];
    IntPtr mainWindowHandle = targetProcess.MainWindowHandle;

    AutomationElement rootElement = AutomationElement.FromHandle(mainWindowHandle);
    AutomationElement tabControlElement = FindElementByName(rootElement, tabControlName);
    if (tabControlElement == null)
    {
        Console.WriteLine($"탭 컨트롤 '{tabControlName}'을(를) 찾을 수 없습니다.");
        return null;
    }

    AutomationElementCollection tabElements = tabControlElement.FindAll(TreeScope.Descendants, Condition.TrueCondition);
    foreach (AutomationElement tabElement in tabElements)
    {
        if (tabElement.Current.ControlType == ControlType.TabItem && tabElement.Current.Name == tabName)
        {
            XtraTabPage tabPage = new XtraTabPage();
            tabPage.Text = tabElement.Current.Name;
            return tabPage;
        }
    }

    Console.WriteLine($"탭 '{tabName}'을(를) 찾을 수 없습니다.");
    return null;
}

private AutomationElement FindElementByName(AutomationElement parentElement, string elementName)
{
    PropertyCondition condition = new PropertyCondition(AutomationElement.NameProperty, elementName);
    AutomationElement element = parentElement.FindFirst(TreeScope.Descendants, condition);
    return element;
}

// 사용 예시
private void btnFindTab_Click(object sender, EventArgs e)
{
    string processName = "ExternalProcessName";
    string tabControlName = "TabControlName";
    string tabName = "TabName";

    XtraTabPage tabToFind = FindTabByName(processName, tabControlName, tabName);
    if (tabToFind != null)
    {
        // 탭을 찾았을 때의 처리
        // tabToFind를 사용하여 해당 탭의 GridControl을 조작하거나 캡처하면 됩니다.
    }
    else
    {
        Console.WriteLine($"탭 '{tabName}'을(를) 찾을 수 없습니다.");
    }
}

위의 코드에서 FindTabByName 메서드는 다른 프로세스의 DevExpress XtraTabControl에서 특정 탭을 찾는 함수입니다. 프로세스 이름(processName), 탭 컨트롤 이름(tabControlName), 그리고 찾고자 하는 탭 이름(tabName)을 매개변수로 받습니다.

FindElementByName 메서드는 UI Automation을 사용하여 지정된 이름의 엘리먼트를 찾는 함수입니다. AutomationElement의 Name 속성과 입력된 이름을 비교하여 일치하는 엘리먼트를 찾습니다.

사용 예시에서는 btnFindTab_Click 이벤트 핸들러에서 프로세스 이름, 탭 컨트롤