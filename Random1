using System.Globalization;
using System.Resources;
using System.Threading;
using System.Windows.Forms;

public partial class MainForm : Form
{
    ResourceManager resManager;
    CultureInfo cultureInfo;

    public MainForm()
    {
        InitializeComponent();

        // ResourceManager 초기화 (리소스 파일 경로에 맞게 설정)
        resManager = new ResourceManager("YourProjectNamespace.Properties.Lang", typeof(MainForm).Assembly);

        // 기본 시스템 언어 설정
        cultureInfo = CultureInfo.CurrentUICulture;

        // 모든 컨트롤에 리소스 적용
        ApplyLocalization(this);
    }

    // 폼과 모든 하위 컨트롤에 대해 리소스를 적용하는 함수
    private void ApplyLocalization(Control parentControl)
    {
        // 현재 컨트롤의 Tag 속성을 확인하여 리소스 키에 해당하는 값을 적용
        if (!string.IsNullOrEmpty(parentControl.Tag?.ToString()))
        {
            string resourceKey = parentControl.Tag.ToString();
            string localizedText = resManager.GetString(resourceKey, cultureInfo);
            if (!string.IsNullOrEmpty(localizedText))
            {
                parentControl.Text = localizedText;
            }
        }

        // 재귀적으로 모든 하위 컨트롤에 대해 동일하게 처리
        foreach (Control childControl in parentControl.Controls)
        {
            ApplyLocalization(childControl);
        }
    }

    // 언어 변경 함수
    private void ChangeLanguage(string culture)
    {
        cultureInfo = new CultureInfo(culture);
        Thread.CurrentThread.CurrentUICulture = cultureInfo;

        // 모든 컨트롤에 대해 새로운 언어로 리소스 재적용
        ApplyLocalization(this);
    }

    // 예시: 한국어로 변경
    private void buttonChangeToKorean_Click(object sender, EventArgs e)
    {
        ChangeLanguage("ko");
    }

    // 예시: 영어로 변경
    private void buttonChangeToEnglish_Click(object sender, EventArgs e)
    {
        ChangeLanguage("en");
    }