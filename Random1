CUDA 라이브러리(cudart64_12.dll)가 12.8을 참조하는지 확인
✅ (1) 현재 로드된 CUDA 라이브러리 확인
1️⃣ Python 실행 후 다음 코드 입력

python
코드 복사
import os
print("CUDA_PATH:", os.environ.get("CUDA_PATH"))
print("PATH:", os.environ.get("PATH"))
🚨 출력에서 CUDA_PATH가 C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.8이라면 잘못된 것임.
→ 환경 변수를 수동으로 바꿔야 함.

2️⃣ Python에서 CUDA DLL 경로 확인

python
코드 복사
import ctypes
print(ctypes.util.find_library("cudart64_12"))
✅ 출력이 C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4\bin\cudart64_12.dll이면 정상
❌ 출력이 C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.8\bin\cudart64_12.dll이면, 여전히 12.8이 로드됨.

🚀 해결 방법: cudart64_12.dll을 강제로 CUDA 12.4의 경로로 지정해야 함.

2. CUDA 12.4를 강제로 참조하도록 설정
✅ (1) 기존 CUDA 12.8 환경 변수를 제거

sh
코드 복사
setx CUDA_HOME "C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4"
setx PATH "C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4\bin;C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4\libnvvp"
✅ (2) cudart64_12.dll을 강제로 교체 🚨 경고: DLL 파일이 충돌하는 경우, 시스템이 CUDA를 감지하지 못할 수 있음.

sh
코드 복사
del C:\Windows\System32\cudart64_12.dll
del C:\Windows\SysWOW64\cudart64_12.dll
copy "C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4\bin\cudart64_12.dll" C:\Windows\System32\
copy "C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v12.4\bin\cudart64_12.dll" C:\Windows\SysWOW64\
✅ 이제 CUDA 12.8이 감지되지 않고, 12.4만 인식됨.

✅ (3) 시스템 재부팅 후 다시 확인

sh
코드 복사
nvcc --version
✅ 출력에서 12.4만 나와야 함.

3. PyTorch가 CUDA 12.4를 감지하도록 재설치
🚨 PyTorch가 CUDA 12.8에서 설치되었을 가능성이 높음.
→ CUDA 12.4용 PyTorch를 다시 설치해야 함.

1️⃣ PyTorch 제거

sh
코드 복사
pip uninstall torch torchvision torchaudio
2️⃣ CUDA 12.4 버전 PyTorch 재설치

sh
코드 복사
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
3️⃣ CUDA 12.4 감지 확인

python
코드 복사
import torch
print("CUDA Available:", torch.cuda.is_available())
print("CUDA Version:", torch.version.cuda)
print("GPU Name:", torch.cuda.get_device_name(0) if torch.cuda.is_available() else "No GPU Found")
✅ 출력이 CUDA 12.4여야 정상 적용됨.
❌ 만약 False가 나오면, 환경 변수를 다시 확인해야 함.

4. 최종 정리 (이렇게 하면 100% 해결됨)
1️⃣ CUDA 12.8이 남아 있는지 확인 (ctypes.util.find_library("cudart64_12"))
2️⃣ 환경 변수에서 CUDA 12.8을 제거 (setx CUDA_HOME 실행)
3️⃣ cudart64_12.dll을 강제로 교체 (del & copy 실행)
4️⃣ 재부팅 후 nvcc --version 실행하여 12.4만 나오는지 확인
5️⃣ PyTorch 제거 후, CUDA 12.4용 PyTorch 재설치 (pip install torch --index-url https://download.pytorch.org/whl/cu124)
6️⃣ Python에서 torch.version.cuda 확인