var recipients = recipientEmailAddresses.Select(emailAddress =>
{
    var recipientType = recipientDictionary.ContainsKey(emailAddress) ? recipientDictionary[emailAddress] : "TO";
    return new { emailAddress, recipientType };
}).ToList();
