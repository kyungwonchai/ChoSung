import subprocess
import time

from flask import Flask

app = Flask(__name__)

def restart_flask_service():
    # 플라스크 서비스 재시작 명령어 실행
    result = subprocess.run(['systemctl', 'restart', 'flask.service'], capture_output=True, text=True)
    
    # 실행 결과 확인
    if result.returncode == 0:
        return "Success"
    else:
        return "Failed"

@app.route('/')
def index():
    # 플라스크 서비스 재시작 시도
    restart_result = restart_flask_service()
    
    # 현재 시간 표시
    current_time = time.strftime('%Y-%m-%d %H:%M:%S', time.localtime())
    
    # 결과와 시간 반환
    return f"Restart Result: {restart_result}<br>Current Time: {current_time}"

if __name__ == '__main__':
    app.run()
