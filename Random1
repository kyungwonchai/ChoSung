셀 VBA 코드를 업데이트하여 팝업 창이 뜨지 않도록 하고, 수식을 사용하여 데이터를 빠르게 처리한 후 값을 복사하는 방법을 제공합니다.

아래 코드는 수식 대신 범위를 직접 비교하고 값을 복사하는 방식으로 변경합니다:

vba
코드 복사
Sub CopyMatchingRows()
    Dim wsABC As Worksheet
    Dim wsZZZ As Worksheet
    Dim lastRowABC As Long
    Dim lastRowZZZ As Long
    Dim dict As Object
    Dim i As Long, j As Long
    Dim key As String
    
    ' 시트 설정
    Set wsABC = ThisWorkbook.Sheets("abc")
    Set wsZZZ = ThisWorkbook.Sheets("zzz")
    
    ' 마지막 행 찾기
    lastRowABC = wsABC.Cells(wsABC.Rows.Count, "A").End(xlUp).Row
    lastRowZZZ = wsZZZ.Cells(wsZZZ.Rows.Count, "C").End(xlUp).Row
    
    ' Dictionary 생성
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' abc 시트의 데이터를 Dictionary에 저장
    For i = 2 To lastRowABC
        key = wsABC.Cells(i, 1).Value & "|" & wsABC.Cells(i, 2).Value & "|" & wsABC.Cells(i, 3).Value
        If Not dict.exists(key) Then
            dict.Add key, wsABC.Cells(i, 4).Resize(1, 8).Value
        End If
    Next i
    
    ' zzz 시트와 비교하여 일치하는 경우 값 복사
    For j = 2 To lastRowZZZ
        key = wsZZZ.Cells(j, 3).Value & "|" & wsZZZ.Cells(j, 6).Value & "|" & wsZZZ.Cells(j, 8).Value
        If dict.exists(key) Then
            wsZZZ.Cells(j, 12).Resize(1, 8).Value = dict(key)
        End If
    Next j
    
    ' Dictionary 해제
    Set dict = Nothing
End Sub
이 코드는 다음과 같이 동작합니다:

wsABC와 wsZZZ로 abc 시트와 zzz 시트를 설정합니다.
각 시트의 마지막 행을 찾습니다.
abc 시트의 데이터를 Dictionary에 저장합니다. 키는 A, B, C 열의 조합이며, 값은 D부터 K 열까지의 데이터입니다.
zzz 시트의 각 행과 Dictionary를 비교하여 일치하는 경우 해당 데이터를 복사합니다.
이 방법은 수식을 사용하지 않기 때문에 팝업 창이 뜨는 문제를 해결할 수 있습니다.






