CREATE TABLE TBL1
(
    HeaderName VARCHAR(255) PRIMARY KEY,
    DiagramContent TEXT
);
그 다음은 C# 코드입니다. DevExpress의 XtraTabControl에서 헤더가 포커스를 잃을 때마다 DiagramControl의 내용을 가져와서 'TBL1'에 저장하고, 헤더가 포커스를 얻을 때마다 'TBL1'에서 DiagramControl의 내용을 불러오는 코드입니다.
csharp
Copy code
using DevExpress.XtraTab;
using System.Data.SqlClient;
using System.IO;
using System;

private void xtraTabControl1_SelectedPageChanged(object sender, TabPageChangedEventArgs e)
{
    string headerName = "dia" + e.Page.Text;

    using (SqlConnection connection = new SqlConnection(/*your connection string*/))
    {
        connection.Open();

        // Check if the tab is changed to another or it's deselected
        if (e.Page != null) // If another tab is selected
        {
            // Load diagram from the database
            using (SqlCommand cmd = new SqlCommand("SELECT DiagramContent FROM TBL1 WHERE HeaderName = @headerName", connection))
            {
                cmd.Parameters.AddWithValue("@headerName", headerName);

                string diagramContent = cmd.ExecuteScalar() as string;
                if (diagramContent != null)
                {
                    byte[] bytes = Convert.FromBase64String(diagramContent);
                    using (MemoryStream ms = new MemoryStream(bytes))
                    {
                        ms.Position = 0;
                        diagramControl1.LoadDocument(ms);
                    }
                }
            }
        }

        if (e.PrevPage != null) // If a tab was previously selected
        {
            // Save diagram to the database
            string diagramContent;
            using (MemoryStream ms = new MemoryStream())
            {
                diagramControl1.SaveDocument(ms);
                ms.Position = 0;
                byte[] bytes = ms.ToArray();
                diagramContent = Convert.ToBase64String(bytes);
            }

            string prevHeaderName = "dia" + e.PrevPage.Text;
            using (SqlCommand cmd = new SqlCommand("SELECT COUNT(*) FROM TBL1 WHERE HeaderName = @headerName", connection))
            {
                cmd.Parameters.AddWithValue("@headerName", prevHeaderName);
                int count = (int)cmd.ExecuteScalar();

                if (count == 0)
                {
                    // Insert new entry
                    cmd.CommandText = "INSERT INTO TBL1 (HeaderName, DiagramContent) VALUES (@headerName, @diagramContent)";
                    cmd.Parameters.AddWithValue("@diagramContent", diagramContent);
                    cmd.ExecuteNonQuery();
                }
                else
                {
                    // Update existing entry
                    cmd.CommandText = "UPDATE TBL1 SET DiagramContent = @diagramContent WHERE HeaderName = @headerName";
                    cmd.Parameters.AddWithValue("@diagramContent", diagramContent);
                    cmd.ExecuteNonQuery();
                }
            }
        }
    }
}