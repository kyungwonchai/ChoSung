using DevExpress.XtraGrid;
using System;
using System.Drawing;
using System.IO;
using System.Threading;
using System.Windows.Forms;

// ...

private void CaptureGridControlImageInBackground(GridControl gridControl, string filePath)
{
    Thread thread = new Thread(() =>
    {
        // 스레드에서 그리드 컨트롤의 이미지 캡처 작업 수행
        Bitmap gridImage = null;
        Invoke(new Action(() =>
        {
            gridImage = new Bitmap(gridControl.Width, gridControl.Height);
            gridControl.DrawToBitmap(gridImage, new Rectangle(0, 0, gridControl.Width, gridControl.Height));
        }));

        // 이미지를 파일로 저장
        if (gridImage != null)
        {
            gridImage.Save(filePath);
            gridImage.Dispose();
        }
    });
    thread.SetApartmentState(ApartmentState.STA); // STA 스레드로 설정 (UI 컨트롤 접근을 위해)
    thread.Start();
    thread.Join(); // 스레드 완료 대기
}

// 사용 예시
private void btnSaveImage_Click(object sender, EventArgs e)
{
    string filePath = "경로/파일명.png";
    CaptureGridControlImageInBackground(gridControl1, filePath);
}
