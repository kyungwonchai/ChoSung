e_menu 테이블을 생성하는 스크립트입니다.

sql

CREATE DATABASE swiftAImemo;

USE swiftAImemo;

CREATE TABLE Table_menu (
    ID INT PRIMARY KEY IDENTITY(1,1),
    menuName NVARCHAR(50)
);

CREATE TABLE Table_spdMemo (
    ID INT PRIMARY KEY IDENTITY(1,1),
    Title NVARCHAR(100),
    Category NVARCHAR(50),
    TextVal NVARCHAR(MAX)
);

그리고 C# 코드는 다음과 같이 구성하였습니다.

    DB 연결 및 ComboBox 채우기

csharp

using System.Data.SqlClient;

private void FillComboBox()
{
    using (SqlConnection conn = new SqlConnection("데이터베이스 연결 문자열"))
    {
        conn.Open();
        using (SqlCommand cmd = new SqlCommand("SELECT menuName FROM Table_menu", conn))
        {
            SqlDataReader reader = cmd.ExecuteReader();
            while (reader.Read())
            {
                comboBox1.Items.Add(reader["menuName"].ToString());
            }
        }
    }
}

    텍스트 추가

csharp

private void AddText()
{
    using (SqlConnection conn = new SqlConnection("데이터베이스 연결 문자열"))
    {
        conn.Open();
        using (SqlCommand cmd = new SqlCommand("INSERT INTO Table_spdMemo (Title, Category, TextVal) VALUES (@Title, @Category, @TextVal)", conn))
        {
            cmd.Parameters.AddWithValue("@Title", textEdit1.Text);
            cmd.Parameters.AddWithValue("@Category", comboEdit1.Text);
            cmd.Parameters.AddWithValue("@TextVal", textBox1.Text);
            cmd.ExecuteNonQuery();
        }
    }
}

    텍스트 수정

csharp

// 업데이트 함수입니다.
private void UpdateText(int id)
{
    using (SqlConnection conn = new SqlConnection("데이터베이스 연결 문자열"))
    {
        conn.Open();
        using (SqlCommand cmd = new SqlCommand("UPDATE Table_spdMemo SET Title = @Title, Category = @Category, TextVal = @TextVal WHERE ID = @ID", conn))
        {
            cmd.Parameters.AddWithValue("@Title", textEdit1.Text);
            cmd.Parameters.AddWithValue("@Category", comboEdit1.Text);
            cmd.Parameters.AddWithValue("@TextVal", textBox1.Text);
            cmd.Parameters.AddWithValue("@ID", id);
            cmd.ExecuteNonQuery();
        }
    }
}

    텍스트 삭제

csharp

// 삭제 함수입니다.
private void DeleteText(int id)
{
    using (SqlConnection conn = new SqlConnection("데이터베이스 연결 문자열"))
    {
        conn.Open();
        using (SqlCommand cmd = new SqlCommand("DELETE FROM Table_spdMemo WHERE ID = @ID", conn))
        {
            cmd.Parameters.AddWithValue("@ID", id);
            cmd.ExecuteNonQuery();
        }
    }
}
