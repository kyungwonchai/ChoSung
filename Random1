썬으로 요청하신 작업을 수행하는 프로그램을 작성해드리겠습니다. 이 프로그램은 주어진 디렉토리에서 파일 이름에 L02가 포함된 모든 CSV 파일을 읽고, 특정 조건에 맞는 행을 필터링한 후, 결과를 새로운 CSV 파일로 저장합니다.

먼저, 필요한 라이브러리를 설치하고 임포트해야 합니다.

python
코드 복사
import os
import pandas as pd
다음으로, 주어진 디렉토리에서 파일 이름에 L02가 포함된 모든 CSV 파일을 읽고, 조건에 맞는 행을 필터링하는 코드를 작성하겠습니다.

python
코드 복사
# 경로 설정
folder_path = r'c:\abcd\1'

# 결과를 저장할 데이터프레임 초기화
filtered_rows = pd.DataFrame()

# 모든 파일 탐색
for filename in os.listdir(folder_path):
    if 'L02' in filename and filename.endswith('.csv'):
        file_path = os.path.join(folder_path, filename)
        df = pd.read_csv(file_path)

        # 조건에 맞는 행 필터링
        filtered_df = df[(df['D'] == 'Front') & (df['E'] == '10003L')]

        # 파일명 컬럼 추가
        filtered_df['filename'] = filename

        # 결과 데이터프레임에 추가
        filtered_rows = pd.concat([filtered_rows, filtered_df])

# 결과를 새로운 CSV 파일로 저장
output_path = os.path.join(folder_path, 'filtered_results.csv')
filtered_rows.to_csv(output_path, index=False)

print(f"Filtered rows have been saved to {output_path}")
이 프로그램은 다음과 같은 작업을 수행합니다:

주어진 폴더 (c:\abcd\1)에서 파일 이름에 L02가 포함된 모든 CSV 파일을 찾습니다.
각 파일을 읽고, D열의 값이 Front이고 E열의 값이 10003L인 행을 필터링합니다.
필터링된 행에 파일명을 나타내는 새로운 컬럼 (filename)을 추가합니다.
모든 필터링된 행을 하나의 데이터프레임에 모아서 새로운 CSV 파일 (filtered_results.csv)로 저장합니다.
이 코드를 실행하면 지정된 폴더에 결과 파일이 생성됩니다. 원하는 조건에 맞는 모든 행이 포함된 CSV 파일을 얻을 수 있습니