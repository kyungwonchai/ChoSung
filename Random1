DECLARE @날짜컬럼 VARCHAR(MAX)
DECLARE @동적쿼리 NVARCHAR(MAX)

-- 테이블에서 모든 고유한 날짜를 가져옵니다.
SELECT @날짜컬럼 = COALESCE(@날짜컬럼 + ', ', '') + QUOTENAME(시작일)
FROM (
    SELECT DISTINCT 시작일
    FROM view_r
) AS 날짜테이블

-- 동적 쿼리를 생성합니다.
SET @동적쿼리 = '
SELECT
    과제명, ' + @날짜컬럼 + '
FROM
    (
    SELECT
        과제명,
        CONVERT(VARCHAR, 시작일, 112) AS 날짜,
        SUM(CASE WHEN 성공컬럼 = 1 THEN 1 ELSE 0 END) / COUNT(성공컬럼) * 100 AS 성공율
    FROM
        view_r
    GROUP BY
        과제명,
        CONVERT(VARCHAR, 시작일, 112)
    ) AS 데이터
PIVOT
    (
    MAX(성공율)
    FOR 날짜 IN (' + @날짜컬럼 + ')
    ) AS 피벗테이블
ORDER BY
    과제명;
'

-- 동적 쿼리를 실행합니다.
EXEC sp_executesql @동적쿼리;
