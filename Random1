 지난 파일을 자동으로 삭제합니다.
Part 1 - 녹화 및 파일 저장

csharp

using System;
using System.IO;
using System.Timers;
using ScreenRecorderLib;

namespace ScreenRecorderExample
{
    class Program
    {
        static Recorder _recorder;
        static Timer _recordTimer;
        static Timer _deleteTimer;
        static int _fileCounter = 0;
        static string _folderPath = @"D:\kwblackbox";

        static void Main(string[] args)
        {
            Directory.CreateDirectory(_folderPath); // 폴더 생성

            // 1분마다 녹화 이벤트를 발생시키는 타이머 설정
            _recordTimer = new Timer(60000);
            _recordTimer.Elapsed += OnRecordEvent;
            _recordTimer.AutoReset = true;
            _recordTimer.Start();

            // 1시간마다 삭제 이벤트를 발생시키는 타이머 설정
            _deleteTimer = new Timer(3600000);
            _deleteTimer.Elapsed += OnDeleteEvent;
            _deleteTimer.AutoReset = true;
            _deleteTimer.Start();

            // 녹화 옵션 설정 (기본 설정 사용)
            RecorderOptions options = new RecorderOptions();

            // 녹화 시작
            _recorder = Recorder.CreateRecorder(options);
            _recorder.Record(Path.Combine(_folderPath, $"recording{_fileCounter}.mp4"));

            Console.WriteLine("녹화 시작. 프로그램을 강제 종료하면 녹화가 중지됩니다.");

            AppDomain.CurrentDomain.ProcessExit += OnProcessExit;

            // 무한 루프를 사용하여 프로그램이 계속 실행되도록 함
            while (true) { }
        }

        private static void OnProcessExit(object sender, EventArgs e)
        {
            // 프로세스 종료 시 녹화 중단
            _recorder.Stop();
            Console.WriteLine("녹화 중지.");
        }
        
        // ...
    }
}

Part 2 - 녹화 및 삭제 이벤트 처리

csharp

        private static void OnRecordEvent(Object source, ElapsedEventArgs e)
        {
            // 현재 녹화 중단
            _recorder.Stop();

            // 파일명 변경
            _fileCounter++;
            string fileName = Path.Combine(_folderPath, $"recording{_fileCounter}.mp4");

            // 다시 녹화 시작
            _recorder.Record(fileName);
            Console.WriteLine($"{fileName} 저장 시작.");
        }

        private static void OnDeleteEvent(Object source, ElapsedEventArgs e)
        {
            // 7일이 지난 파일 삭제
            DirectoryInfo di = new DirectoryInfo(_folderPath);
            foreach (FileInfo file in di.GetFiles())
            {
                if (file.LastWriteTime < DateTime.Now.AddDays(-7))
                {
                    file.Delete();
                    Console.WriteLine($"{file.Name} 삭제됨.");
                }
            }
        }
    }
}

이 코드는 D:\kwblackbox 폴더에 녹화 파일을 저장하고, 1시간마다 7일이 지난 파일을 삭제합니다. 프로그램을 강제 종료