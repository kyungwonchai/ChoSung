import openpyxl
from datetime import datetime

def process_excel_and_output(file_path):
    # 엑셀 파일 로드
    wb = openpyxl.load_workbook(file_path)
    sheet = wb.active
    
    # B2 셀 검증
    if sheet['B2'].value != 'Reel 번호':
        print('B2셀에 "Reel 번호"가 아닙니다.')
        return None

    # 데이터 추출 및 딕셔너리 저장
    unique_dict = {}
    for row in sheet.iter_rows(min_row=3, min_col=2, max_col=9):
        d_cell_value = row[3].value
        if d_cell_value:  # D열 값이 있는 행만 처리
            i_cell_value = row[8].value
            e_cell_value = row[4].value
            p_cell_value = row[7].value
            key_format = f"{datetime.today().strftime('%Y%m%d')}_{i_cell_value}_{e_cell_value}_{d_cell_value}"
            if key_format not in unique_dict:  # 중복된 키가 아니면 추가
                unique_dict[key_format] = p_cell_value
    
    # 딕셔너리 출력
    for key, value in unique_dict.items():
        print(f"{key}: {value}")

# 함수 호출 예
# process_excel_and_output('파일경로.xlsx')
