QL에서 CASE 문을 사용하여 날짜 조건에 따라 서로 다른 조건을 조회할 수 있습니다.

아래는 MSSQL 2014에서 날짜가 1월 1일인지 확인한 뒤, 조건에 따라 쿼리를 실행하는 예제입니다.

기본 문법:
sql
코드 복사
SELECT *
FROM YourTable
WHERE 
    CASE 
        WHEN DATEPART(MONTH, GETDATE()) = 1 AND DATEPART(DAY, GETDATE()) = 1 THEN 조건_A
        ELSE 조건_B
    END
하지만, WHERE 절에서 CASE 문은 전체 조건을 제어하기 어렵기 때문에, OR 또는 개별 조건을 분리하는 방식이 더 일반적입니다.

예제 1: 특정 조건에 따라 데이터를 필터링
예를 들어, 테이블 이름이 Orders이고, 1월 1일이면 Status = 'Active'를 조회하고, 그렇지 않으면 Status = 'Completed'를 조회한다고 가정합니다.

쿼리:
sql
코드 복사
SELECT *
FROM Orders
WHERE 
    (
        -- 조건 A: 날짜가 1월 1일인 경우
        (DATEPART(MONTH, GETDATE()) = 1 AND DATEPART(DAY, GETDATE()) = 1 AND Status = 'Active')
    )
    OR 
    (
        -- 조건 B: 1월 1일이 아닌 경우
        (NOT (DATEPART(MONTH, GETDATE()) = 1 AND DATEPART(DAY, GETDATE()) = 1) AND Status = 'Completed')
    )
예제 2: 조건을 CASE로 필드에 적용
CASE 문을 사용하여 출력 결과에 조건을 적용하고 싶을 때는 다음과 같이 할 수 있습니다.

쿼리:
sql
코드 복사
SELECT 
    OrderID,
    OrderDate,
    Status,
    CASE 
        WHEN DATEPART(MONTH, GETDATE()) = 1 AND DATEPART(DAY, GETDATE()) = 1 THEN 'Condition A'
        ELSE 'Condition B'
    END AS FilterCondition
FROM Orders
예제 3: 날짜가 지정된 특정 조건으로 필터링
지정된 날짜가 동적으로 주어질 때(예: @CheckDate), 조건에 따라 필터링하는 방법:

쿼리:
sql
코드 복사
DECLARE @CheckDate DATE = GETDATE(); -- 현재 날짜 사용

SELECT *
FROM Orders
WHERE 
    (
        -- 조건 A: 날짜가 1월 1일인 경우
        (@CheckDate = '2025-01-01' AND Status = 'Active')
    )
    OR 
    (
        -- 조건 B: 1월 1일이 아닌 경우
        (@CheckDate != '2025-01-01' AND Status = 'Completed')
    )
핵심 포인트
CASE 문은 출력 값을 제어하는 데 주로 사용됩니다.
WHERE 절에서는 CASE 문보다 OR 조건과 분리된 필터링을 사용하는 것이 더 효율적입니다.
동적으로 현재 날짜를 확인하려면 GETDATE()를 활용하고, 특정 날짜를 비교하려면 DATEPART나 FORMAT 함수를 사용하십시오.
실행 결과