EAD 또는 LAG 함수를 사용하면 현재 행과 다음/이전 행의 데이터를 한 행에 볼 수 있습니다. 아래 쿼리는 gg 컬럼을 기준으로 데이터를 정렬하고, 현재 행과 이전 행의 데이터를 같이 표시합니다.

sql

WITH RankedTable AS (
    SELECT *, 
           LEAD(gg) OVER (ORDER BY gg) AS NextGG,
           LAG(gg) OVER (ORDER BY gg) AS PrevGG
    FROM TableA
)
SELECT *
FROM RankedTable
WHERE gg != NextGG OR gg != PrevGG;

이 쿼리에서 TableA는 테이블의 이름이며, gg는 정렬하려는 컬럼입니다. LEAD 함수는 다음 행의 gg 값을 가져오고, LAG 함수는 이전 행의 gg 값을 가져옵니다. 마지막으로 WHERE 절에서 현재 행의 gg 값이 다음 행이나 이전 행과 다른 경우만 필터링됩니다.