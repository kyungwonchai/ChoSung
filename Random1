using System;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Windows.Forms;
using DevExpress.XtraCharts;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        private string connectionString = "Your_MSSQL_Connection_String";

        public YourForm()
        {
            InitializeComponent();
        }

        private void YourForm_Load(object sender, EventArgs e)
        {
            // 데이터 가져오기
            DataTable data = GetDataFromMSSQL();

            // 차트 생성
            ChartControl chartControl = new ChartControl();
            chartControl.Dock = DockStyle.Fill;

            // 전체 성공율 원형 차트 생성 및 설정
            ChartControl overallChart = CreateDonutChart("Overall Success Rate", Convert.ToDouble(data.Rows[0]["OverallSuccessRate"]));
            overallChart.Titles[0].TextColor = Color.White;
            overallChart.Titles[0].Font = new Font("Arial", 16, FontStyle.Bold);
            overallChart.Titles[0].Alignment = StringAlignment.Center;
            overallChart.Titles[0].Dock = ChartTitleDockStyle.Bottom;
            overallChart.Titles[0].Indent = 0;
            overallChart.Titles[0].WordWrap = true;
            chartControl.Titles.Add(new ChartTitle());
            chartControl.Titles[0].Dock = ChartTitleDockStyle.Top;
            chartControl.Titles[0].Text = "Overall Success Rate";
            chartControl.Titles[0].TextColor = Color.White;
            chartControl.Titles[0].Font = new Font("Arial", 16, FontStyle.Bold);
            chartControl.Titles[0].Alignment = StringAlignment.Center;
            chartControl.Titles[0].Indent = 0;
            chartControl.Titles[0].WordWrap = true;
            chartControl.Titles[1].Text = " ";
            chartControl.Titles[1].Alignment = StringAlignment.Center;
            chartControl.Titles[1].Dock = ChartTitleDockStyle.Bottom;
            chartControl.Titles[1].Visible = false;
            chartControl.Titles[1].TextColor = Color.White;
            chartControl.Titles[1].Font = new Font("Arial", 14, FontStyle.Bold);
            chartControl.Titles[1].Indent = 0;
            chartControl.Titles[1].WordWrap = true;
            chartControl.Titles[1].Dock = ChartTitleDockStyle.Bottom;
            overallChart.Dock = ChartDocking.Bottom;
            overallChart.DockingOptions.DockPanel = ChartDockPanel.Right;
            overallChart.DockingOptions.SizeMode = ChartElementSizeMode.Relative;
            overallChart.DockingOptions.SnapMode = ChartDockingSnapMode.InnerEdge;
            chartControl.Titles[1].DockTarget = overallChart;
            chartControl.Titles[1].Visible = true;
            chartControl.Titles[1].Text = "Overall Success Rate";
            chartControl.Titles[1].TextColor = Color.White;
            chartControl.Titles[1].Font = new Font("Arial", 14, FontStyle.Bold);
            chartControl.Titles[1].Alignment = StringAlignment.Center;

            // 일별 성공율 원형 차트 생성 및 설정
            ChartControl dailyChart = CreateDonutChart("Daily Success Rate", Convert.ToDouble(data.Rows[0]["DailySuccessRate"]));
            dailyChart.Titles[0].Text = "Daily Success Rate";
            dailyChart.Titles[0].TextColor = Color.White;
            dailyChart.Titles[0].Font = new Font("Arial", 16, FontStyle.Bold);
            dailyChart.Titles[0].Alignment = StringAlignment.Center;
            dailyChart.Titles[0].Indent = 0;
            dailyChart.Titles[0].WordWrap = true;
            dailyChart.Titles[0].Dock = ChartTitleDockStyle.Bottom;
            dailyChart.Dock = ChartDocking.Bottom;
            dailyChart.DockingOptions.DockPanel = ChartDockPanel.Right;
            dailyChart.DockingOptions.SizeMode = ChartElementSizeMode.Relative;
            dailyChart.DockingOptions.SnapMode = ChartDockingSnapMode.InnerEdge;

            // 차트를 Form에 추가
            chartControl.Series.Add(new Series());
            chartControl.Series[0].Points.Add(new SeriesPoint(0, 0));
            chartControl.Series[0].Visible = false;
            chartControl.Series.Add(new Series());
            chartControl.Series[1].Points.Add(new SeriesPoint(0, 0));
            chartControl.Series[1].Visible = false;
            chartControl.Titles[0].DockTarget = dailyChart;
            chartControl.Titles[1].DockTarget = dailyChart;
            chartControl.DockingOptions.DockPanel = ChartDockPanel.Fill;
            chartControl.DockingOptions.SizeMode = ChartElementSizeMode.Relative;
            chartControl.DockingOptions.SnapMode = ChartDockingSnapMode.OuterEdge;
            chartControl.DockingOptions.FloatOnMouseOver = true;
            chartControl.DockingOptions.ShowCloseButton = false;
            chartControl.DockingOptions.ShowMaximizeButton = false;
            chartControl.DockingOptions.ShowMinimizeButton = false;
            chartControl.DockingOptions.ShowSnapModeButton = false;

            // 전체 성공율 원형 차트를 dailyChart에 추가
            dailyChart.Titles.Add(new ChartTitle());
            dailyChart.Titles[1].DockTarget = overallChart;
            dailyChart.Titles[1].Text = "Overall Success Rate";
            dailyChart.Titles[1].Visible = true;
            dailyChart.Titles[1].TextColor = Color.White;
            dailyChart.Titles[1].Font = new Font("Arial", 14, FontStyle.Bold);
            dailyChart.Titles[1].Alignment = StringAlignment.Center;
            dailyChart.Titles[1].Indent = 0;
            dailyChart.Titles[1].WordWrap = true;
            dailyChart.Titles[1].Dock = ChartTitleDockStyle.Bottom;

            // Form에 차트 추가
            Controls.Add(chartControl);
        }

        private DataTable GetDataFromMSSQL()
        {
            DataTable dataTable = new DataTable();

            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                // 쿼리 작성 (예시)
                string query = "SELECT '30%' AS OverallSuccessRate, '70%' AS DailySuccessRate";

                // 쿼리 실행
                using (SqlCommand command = new SqlCommand(query, connection))
                {
                    connection.Open();
                    SqlDataReader reader = command.ExecuteReader();

                    // 결과를 DataTable에 로드
                    dataTable.Load(reader);

                    reader.Close();
                }
            }

            return dataTable;
        }

        private ChartControl CreateDonutChart(string title, double value)
        {
            ChartControl chart = new ChartControl();

            Series series = new Series("Series1", ViewType.Doughnut);
            series.Points.Add(new SeriesPoint("SuccessRate", value));
            series.Points.Add(new SeriesPoint("FailureRate
