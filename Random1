using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Windows.Forms;

class Program
{
    [STAThread]
    static void Main(string[] args)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new MainForm());
    }
}

public class MainForm : Form
{
    public MainForm()
    {
        var panel1 = new Panel
        {
            Dock = DockStyle.Fill
        };

        var dataGridView = new DataGridView
        {
            Dock = DockStyle.Fill,
            AutoGenerateColumns = true,
            AllowUserToAddRows = false,
            AllowUserToDeleteRows = false,
            ReadOnly = true
        };

        // 컬럼 정의
        dataGridView.Columns.Add("ProcessName", "프로세스 이름");
        dataGridView.Columns.Add("PID", "PID");
        dataGridView.Columns.Add("HandleCount", "핸들 수");

        foreach (Process process in Process.GetProcesses())
        {
            try
            {
                int pid = process.Id;
                string processName = process.ProcessName;
                int handleCount = process.HandleCount;

                // DataGridView에 행 추가
                dataGridView.Rows.Add(processName, pid, handleCount);
            }
            catch
            {
                // 접근 제한이 있는 프로세스는 무시
            }
        }

        // 정렬 가능하게 설정
        foreach (DataGridViewColumn column in dataGridView.Columns)
        {
            column.SortMode = DataGridViewColumnSortMode.Automatic;
        }

        panel1.Controls.Add(dataGridView);
        Controls.Add(panel1);
    }
}
