로 한 MS SQL 2014 프로시저를 작성해 보겠습니다. 이 프로시저는 입력된 시간에 따라 날짜와 '주후야' 컬럼에 적절한 값을 자동으로 설정합니다. 주어진 시간 범위는 다음과 같습니다:

주(07:00 ~ 15:00)
후(15:00 ~ 23:00)
야(23:00 ~ 07:00 다음날)
'야' 시간대에는 날짜 컬럼이 전날 날짜로 설정되어야 합니다. 예를 들어, 00:30에 데이터가 입력되면 '야'로 설정되고 날짜는 전날 날짜가 되어야 합니다.

아래는 해당 기능을 수행하는 T-SQL 프로시저입니다. 프로시저는 InsertShiftData라는 이름으로, 입력된 시간에 따라 '주후야' 컬럼과 날짜 컬럼을 설정합니다.

sql
Copy code
CREATE PROCEDURE InsertShiftData
    @InputDateTime DATETIME
AS
BEGIN
    DECLARE @ShiftType NVARCHAR(10)
    DECLARE @ShiftDate DATE

    -- 시간 구간에 따른 주후야 결정
    IF CAST(@InputDateTime AS TIME) >= '07:00:00' AND CAST(@InputDateTime AS TIME) < '15:00:00'
        SET @ShiftType = '주'
    ELSE IF CAST(@InputDateTime AS TIME) >= '15:00:00' AND CAST(@InputDateTime AS TIME) < '23:00:00'
        SET @ShiftType = '후'
    ELSE
        SET @ShiftType = '야'

    -- 야간의 경우 날짜 조정
    IF @ShiftType = '야' AND CAST(@InputDateTime AS TIME) < '07:00:00'
        SET @ShiftDate = CAST(DATEADD(DAY, -1, @InputDateTime) AS DATE)
    ELSE
        SET @ShiftDate = CAST(@InputDateTime AS DATE)

    -- 데이터베이스에 데이터 삽입
    -- 예시: INSERT INTO YourTable (DateColumn, ShiftTypeColumn) VALUES (@ShiftDate, @ShiftType)
    -- 실제 테이블 이름과 컬럼 이름으로 바꿔야 합니다.

    PRINT 'Inserted data for date ' + CAST(@ShiftDate AS NVARCHAR) + ' with shift type ' + @ShiftType
END
이 프로시저는 주어진 시간에 따라 적절한 '주후야' 값을 계산하고, 이와 함께 날짜 값을 데이터베이스 테이블에 삽입합니다. 데이터베이스 테이블 이름과 컬럼 이름은 실제 사용하는 환경에 맞게 수정해야 합니다.

프로시저를 사용하기 전에 실제 데이터베이스 구조에 맞게 쿼리를 수정하고, 필요에 따라 추가적인 로직을 포함시켜야 할 수도 있습