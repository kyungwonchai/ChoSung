using DevExpress.XtraSplashScreen;
using System;

namespace WpfApp
{
    public partial class MainWindow
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void LoadExcelData()
        {
            SplashScreenManager.ShowForm(typeof(MySplashScreen));
            
            int totalRows = GetTotalExcelRows(); // 엑셀 파일의 전체 행 수를 얻습니다.
            for (int i = 0; i < totalRows; i++)
            {
                // 엑셀 데이터를 업로드하는 쿼리를 실행합니다.
                ExecuteExcelUploadQuery(i);

                // 진행 비율을 계산하고 프로그레스바를 업데이트합니다.
                int progress = (int)((double)(i + 1) / totalRows * 100);
                SplashScreenManager.Default.SendCommand(MySplashScreen.SplashScreenCommand.SetProgress, progress);
            }
            
            SplashScreenManager.CloseForm();
        }
    }

    public class MySplashScreen : SplashScreen
    {
        public enum SplashScreenCommand
        {
            SetProgress
        }

        public override void ProcessCommand(Enum cmd, object arg)
        {
            base.ProcessCommand(cmd, arg);
            if (cmd.Equals(SplashScreenCommand.SetProgress))
            {
                // 프로그레스바를 업데이트하는 로직을 여기에 작성합니다.
            }
        }
    }
}
