ì•Œê² ìŠµë‹ˆë‹¤. ì—¬ëŸ¬ ê°œì˜ ë¸”ë¡ìœ¼ë¡œ ë‚˜ëˆ„ì§€ ì•Šê³ , ì „ì²´ ì½”ë“œë¥¼ ì—¬ê¸°ì— ë°”ë¡œ ì‘ì„±í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë³µì‚¬í•´ì„œ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

ì£¼ì˜: ì½”ë“œê°€ ë§¤ìš° ê¸¸ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (MS SQL Server)

(ì´ì „ê³¼ ë™ì¼)

SQL

-- ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤.
IF NOT EXISTS (SELECT * FROM sys.databases WHERE name = 'LockerManagementDB')
BEGIN
    CREATE DATABASE LockerManagementDB;
END
GO

-- ìƒì„±ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
USE LockerManagementDB;
GO

-- í…Œì´ë¸”ì´ ì´ë¯¸ ì¡´ì¬í•˜ë©´ ì‚­ì œí•©ë‹ˆë‹¤ (ìŠ¤í¬ë¦½íŠ¸ ì¬ì‹¤í–‰ ìš©ì´ì„±ì„ ìœ„í•´).
IF OBJECT_ID('dbo.LockerAssignments', 'U') IS NOT NULL
    DROP TABLE dbo.LockerAssignments;
GO

-- ê¸°ë³¸ ì‚¬ë¬¼í•¨ ë°°ì • ì •ë³´ë¥¼ ì €ì¥í•  í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤.
CREATE TABLE LockerAssignments (
    Id INT PRIMARY KEY IDENTITY(1,1),             -- ê° ë ˆì½”ë“œì˜ ê³ ìœ  ì‹ë³„ì (ìë™ ì¦ê°€)
    LockerType NVARCHAR(50) NOT NULL,            -- ì‚¬ë¬¼í•¨ ì¢…ë¥˜ ('ê°œì¸ì‚¬ë¬¼í•¨', 'ë½ì»¤', 'ì‹ ë°œì¥')
    Floor NVARCHAR(10) NOT NULL,                 -- ì¸µ ('B1', '1', '2', '3', '4')
    Zone NVARCHAR(50) NOT NULL,                  -- êµ¬ì—­ ('A'~'H', 'B1'~'B4', 'ê¸°íƒ€' ë“±)
    SpecificLocation NVARCHAR(100) NOT NULL,     -- ì„¸ë¶€ ìœ„ì¹˜ (ìˆ˜ê¸°ì…ë ¥ - ë¬¼ë¦¬ì  ì‚¬ë¬¼í•¨ì„ ì‹ë³„í•˜ëŠ” ê³ ìœ ê°’)
    UserName NVARCHAR(100) NULL,                -- ì‚¬ìš©ì ì´ë¦„ (ìˆ˜ê¸°ì…ë ¥ - ë¹„ì–´ìˆìœ¼ë©´ NULL)
    KnoxId NVARCHAR(100) NULL,                   -- Knox ID (ìˆ˜ê¸°ì…ë ¥ - ë¹„ì–´ìˆìœ¼ë©´ NULL)
    SubPart NVARCHAR(50) NULL,                   -- ì†Œì† íŒŒíŠ¸ ('Main(ì‹œìƒì‚°)', 'MainA'~'Z' - ë¹„ì–´ìˆìœ¼ë©´ NULL)
    Administrator NVARCHAR(100) NULL,           -- ê´€ë¦¬ì ('í™ê¸¸ë™A'~'X' - ì´ ë ˆì½”ë“œ/ë°°ì •ì„ ê´€ë¦¬í•˜ëŠ” ì‚¬ëŒ)
    LastUpdated DATETIME2 NOT NULL DEFAULT GETDATE() -- ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ì‹œ (ë³€ê²½ ì¶”ì ìš©)
);
GO

-- ì˜µì…˜: ì´ˆê¸° ë°ì´í„°ë¡œ ë¹ˆ ì‚¬ë¬¼í•¨ ëª‡ ê°œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
INSERT INTO LockerAssignments (LockerType, Floor, Zone, SpecificLocation, Administrator, LastUpdated)
VALUES
('ê°œì¸ì‚¬ë¬¼í•¨', '1', 'A', 'A-01', 'System', GETDATE()),
('ê°œì¸ì‚¬ë¬¼í•¨', '1', 'A', 'A-02', 'System', GETDATE()),
('ë½ì»¤', 'B1', 'B1', 'R-B1-01', 'System', GETDATE()),
('ì‹ ë°œì¥', '2', '2F', 'S-2F-01', 'System', GETDATE());

-- ì˜µì…˜: ì‚¬ìš©ì ë°°ì • ì˜ˆì‹œ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
INSERT INTO LockerAssignments (LockerType, Floor, Zone, SpecificLocation, UserName, KnoxId, SubPart, Administrator, LastUpdated)
VALUES
('ê°œì¸ì‚¬ë¬¼í•¨', '1', 'B', 'B-15', 'ê¹€ì² ìˆ˜', 'kimcs', 'MainA', 'í™ê¸¸ë™A', GETDATE());
GO

-- ì˜µì…˜: ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. (íŠ¹íˆ ì‚¬ë¬¼í•¨ ê°œìˆ˜ê°€ ë§ì„ ê²½ìš° ìœ ìš©)
CREATE INDEX IX_LockerAssignments_Location ON dbo.LockerAssignments (Floor, Zone, SpecificLocation);
CREATE INDEX IX_LockerAssignments_User ON dbo.LockerAssignments (UserName);
GO

PRINT 'ë°ì´í„°ë² ì´ìŠ¤ ë° í…Œì´ë¸” ìƒì„±ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
2. App.config íŒŒì¼

XML

<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
  </configSections>

  <connectionStrings>
    <add name="LockerDbConnection"
         connectionString="Server=YOUR_SERVER_NAME;Database=LockerManagementDB;Trusted_Connection=True;"
         providerName="System.Data.SqlClient"/>
  </connectionStrings>

  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.8" /> </startup>

  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="mssqllocaldb" />
      </parameters>
    </defaultConnectionFactory>
    <providers>
      <provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
    </providers>
  </entityFramework>
</configuration>
3. ëª¨ë¸ (Models/LockerAssignment.cs) Â  

C#

using System;
using System.Collections.Generic; // EqualityComparer ì‚¬ìš©
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using System.Runtime.CompilerServices;

namespace LockerManagementApp.Models
{
    /// <summary>
    /// ì‚¬ë¬¼í•¨ ë°°ì • ì •ë³´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë°ì´í„° ëª¨ë¸ í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
    /// INotifyPropertyChangedë¥¼ êµ¬í˜„í•˜ì—¬ ì†ì„± ë³€ê²½ ì‹œ UIê°€ ì—…ë°ì´íŠ¸ë˜ë„ë¡ í•©ë‹ˆë‹¤.
    /// </summary>
    [Table("LockerAssignments")] // ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ë§¤í•‘
    public class LockerAssignment : INotifyPropertyChanged
    {
        // Private backing fields
        private int _id;
        private string _lockerType = string.Empty;
        private string _floor = string.Empty;
        private string _zone = string.Empty;
        private string _specificLocation = string.Empty;
        private string _userName; // Nullable string ì‚¬ìš© ê°€ëŠ¥ (.NET Framework 4.8)
        private string _knoxId;
        private string _subPart;
        private string _administrator;
        private DateTime _lastUpdated = DateTime.Now;

        [Key]
        [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
        public int Id
        {
            get => _id;
            set => SetProperty(ref _id, value);
        }

        [Required(ErrorMessage = "ì‚¬ë¬¼í•¨ ì¢…ë¥˜ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.")]
        [StringLength(50)]
        public string LockerType
        {
            get => _lockerType;
            set => SetProperty(ref _lockerType, value);
        }

        [Required(ErrorMessage = "ì¸µ ì •ë³´ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.")]
        [StringLength(10)]
        public string Floor
        {
            get => _floor;
            set => SetProperty(ref _floor, value);
        }

        [Required(ErrorMessage = "êµ¬ì—­ ì •ë³´ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.")]
        [StringLength(50)]
        public string Zone
        {
            get => _zone;
            set => SetProperty(ref _zone, value);
        }

        [Required(ErrorMessage = "ì„¸ë¶€ ìœ„ì¹˜ëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.")]
        [StringLength(100)]
        public string SpecificLocation
        {
            get => _specificLocation;
            set => SetProperty(ref _specificLocation, value);
        }

        [StringLength(100)]
        public string UserName // Nullable stringì€ C# 8.0 ê¸°ëŠ¥ì´ë¯€ë¡œ ? ì œê±° (ë˜ëŠ” í”„ë¡œì íŠ¸ ì–¸ì–´ ë²„ì „ í™•ì¸)
        {
            get => _userName;
            set
            {
                if (SetProperty(ref _userName, value))
                {
                    OnPropertyChanged(nameof(IsAssigned));
                }
            }
        }

        [StringLength(100)]
        public string KnoxId
        {
            get => _knoxId;
            set => SetProperty(ref _knoxId, value);
        }

        [StringLength(50)]
        public string SubPart
        {
            get => _subPart;
            set => SetProperty(ref _subPart, value);
        }

        [StringLength(100)]
        public string Administrator
        {
            get => _administrator;
            set => SetProperty(ref _administrator, value);
        }

        public DateTime LastUpdated
        {
            get => _lastUpdated;
            set => SetProperty(ref _lastUpdated, value);
        }

        [NotMapped]
        public bool IsAssigned => !string.IsNullOrWhiteSpace(UserName);

        public override string ToString()
        {
            return $"{Floor}-{Zone}-{SpecificLocation}: {(IsAssigned ? UserName : "(ë¹„ì–´ ìˆìŒ)")}";
        }

        // --- INotifyPropertyChanged êµ¬í˜„ ---
        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }

        protected bool SetProperty<T>(ref T storage, T value, [CallerMemberName] string propertyName = null)
        {
            if (EqualityComparer<T>.Default.Equals(storage, value)) return false;
            storage = value;
            OnPropertyChanged(propertyName);
            return true;
        }
        // --- INotifyPropertyChanged êµ¬í˜„ ë ---
    }
}
4. ë°ì´í„° ì»¨í…ìŠ¤íŠ¸ (Data/LockerDbContext.cs)

C#

using LockerManagementApp.Models;
using System; // DateTime ì‚¬ìš©
using System.Data.Entity; // EF6 DbContext ì‚¬ìš©
using System.Data.Entity.Infrastructure; // DbEntityEntry ì‚¬ìš©
using System.Linq;
using System.Threading.Tasks; // Task ì‚¬ìš© (EF6ëŠ” ë¹„ë™ê¸° ì§€ì›)

namespace LockerManagementApp.Data
{
    /// <summary>
    /// Entity Framework 6 DbContext í´ë˜ìŠ¤ì…ë‹ˆë‹¤.
    /// App.configì˜ ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ì‘ìš©í•©ë‹ˆë‹¤.
    /// </summary>
    public class LockerDbContext : DbContext
    {
        /// <summary>
        /// LockerAssignments í…Œì´ë¸”ì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ DbSetì…ë‹ˆë‹¤.
        /// </summary>
        public DbSet<LockerAssignment> LockerAssignments { get; set; }

        /// <summary>
        /// ê¸°ë³¸ ìƒì„±ì. App.configì˜ "LockerDbConnection" ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
        /// </summary>
        public LockerDbContext() : base("name=LockerDbConnection")
        {
            // EF6ì—ì„œëŠ” OnConfiguring ë©”ì„œë“œê°€ ì—†ìŠµë‹ˆë‹¤.
            // ì—°ê²° ë¬¸ìì—´ì€ App.config ë˜ëŠ” ìƒì„±ìë¥¼ í†µí•´ ì„¤ì •ë©ë‹ˆë‹¤.
        }

        /// <summary>
        /// ëª¨ë¸(í…Œì´ë¸”) ìƒì„± ì‹œ ì¶”ê°€ êµ¬ì„±ì„ ìœ„í•œ ë©”ì„œë“œì…ë‹ˆë‹¤ (Fluent API).
        /// </summary>
        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            // í•„ìš”í•œ ê²½ìš° Fluent API ë˜ëŠ” Data Annotationì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ êµ¬ì„±
            base.OnModelCreating(modelBuilder);
        }

        /// <summary>
        /// ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í•˜ê¸° ì „ì— LastUpdated íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        /// </summary>
        public override int SaveChanges()
        {
            UpdateTimestamps();
            return base.SaveChanges();
        }

        /// <summary>
        /// ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í•˜ê¸° ì „ì— LastUpdated íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        /// </summary>
        public override Task<int> SaveChangesAsync()
        {
            UpdateTimestamps();
            return base.SaveChangesAsync();
        }

        /// <summary>
        /// ì¶”ê°€(Added)ë˜ê±°ë‚˜ ìˆ˜ì •(Modified)ëœ LockerAssignment ì—”í‹°í‹°ì˜ LastUpdated ì†ì„±ì„ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
        /// </summary>
        private void UpdateTimestamps()
        {
            var entries = ChangeTracker.Entries<LockerAssignment>()
                .Where(e => e.State == EntityState.Added || e.State == EntityState.Modified);

            foreach (var entry in entries)
            {
                entry.Entity.LastUpdated = DateTime.Now;
            }
        }
    }
}
5. ViewModel ë² ì´ìŠ¤ (Infrastructure/ViewModelBase.cs)

C#

using System.Collections.Generic; // EqualityComparer ì‚¬ìš©
using System.ComponentModel;
using System.Runtime.CompilerServices;

namespace LockerManagementApp.Infrastructure
{
    public abstract class ViewModelBase : INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged([CallerMemberName] string propertyName = null)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }

        protected bool SetProperty<T>(ref T storage, T value, [CallerMemberName] string propertyName = null)
        {
            if (EqualityComparer<T>.Default.Equals(storage, value)) return false;
            storage = value;
            OnPropertyChanged(propertyName);
            return true;
        }
    }
}
6. RelayCommand (Infrastructure/RelayCommand.cs)

C#

using System;
using System.Windows.Input;

namespace LockerManagementApp.Infrastructure
{
    public class RelayCommand : ICommand
    {
        private readonly Action<object> _execute; // object? ëŒ€ì‹  object ì‚¬ìš©
        private readonly Predicate<object> _canExecute; // object? ëŒ€ì‹  object ì‚¬ìš©

        public event EventHandler CanExecuteChanged
        {
            add { CommandManager.RequerySuggested += value; }
            remove { CommandManager.RequerySuggested -= value; }
        }

        public RelayCommand(Action<object> execute, Predicate<object> canExecute = null)
        {
            _execute = execute ?? throw new ArgumentNullException(nameof(execute));
            _canExecute = canExecute;
        }

        public bool CanExecute(object parameter)
        {
            return _canExecute == null || _canExecute(parameter);
        }

        public void Execute(object parameter)
        {
            _execute(parameter);
        }

        public void RaiseCanExecuteChanged()
        {
            CommandManager.InvalidateRequerySuggested();
        }
    }
}
7. ë©”ì¸ ViewModel (ViewModels/MainViewModel.cs) Â  

C#

using LockerManagementApp.Data;
using LockerManagementApp.Models;
using LockerManagementApp.Infrastructure;
using System; // IDisposable ì‚¬ìš©
using System.Collections.Generic; // List ì‚¬ìš©
using System.Collections.ObjectModel;
using System.Data.Entity; // EF6 ë„¤ì„ìŠ¤í˜ì´ìŠ¤ (ToListAsync ë“±)
using System.Data.Entity.Infrastructure; // DbUpdateException (EF6)
using System.Linq;
using System.Threading.Tasks;
using System.Windows; // MessageBox ì‚¬ìš©
using System.Windows.Input;

namespace LockerManagementApp.ViewModels
{
    /// <summary>
    /// ë©”ì¸ ViewModel í´ë˜ìŠ¤ (.NET Framework 4.8 ë²„ì „)
    /// DbContextë¥¼ ì§ì ‘ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.
    /// </summary>
    public class MainViewModel : ViewModelBase, IDisposable // IDisposable êµ¬í˜„
    {
        private LockerDbContext _context; // DbContext ì¸ìŠ¤í„´ìŠ¤
        private ObservableCollection<LockerAssignment> _lockerAssignments;
        private LockerAssignment _selectedAssignment; // Nullable ? ì œê±°
        private string _statusBarText = "ì¤€ë¹„ ì™„ë£Œ";
        private string _currentAdmin = "í™ê¸¸ë™A"; // ì˜ˆì‹œ ê´€ë¦¬ì

        public ObservableCollection<LockerAssignment> LockerAssignments
        {
            get => _lockerAssignments;
            set => SetProperty(ref _lockerAssignments, value);
        }

        public LockerAssignment SelectedAssignment
        {
            get => _selectedAssignment;
            set
            {
                if (SetProperty(ref _selectedAssignment, value))
                {
                    ((RelayCommand)DeleteCommand).RaiseCanExecuteChanged();
                    ((RelayCommand)ClearAssignmentCommand).RaiseCanExecuteChanged();
                }
            }
        }

        public string StatusBarText
        {
            get => _statusBarText;
            set => SetProperty(ref _statusBarText, value);
        }

        // --- Commands ---
        public ICommand LoadDataCommand { get; }
        public ICommand SaveChangesCommand { get; }
        public ICommand AddNewCommand { get; }
        public ICommand DeleteCommand { get; }
        public ICommand ClearAssignmentCommand { get; }

        // --- Predefined Lists ---
        public List<string> LockerTypes { get; } = new List<string> { "ê°œì¸ì‚¬ë¬¼í•¨", "ë½ì»¤", "ì‹ ë°œì¥" };
        public List<string> Floors { get; } = new List<string> { "B1", "1", "2", "3", "4" };
        public List<string> Zones { get; } = new List<string> { "A", "B", "C", "D", "E", "F", "G", "H", "B1", "B2", "B3", "B4", "1F", "2F", "3F", "4F", "ê¸°íƒ€" };
        public List<string> SubParts { get; } = new List<string> { "Main(ì‹œìƒì‚°)", "MainA", "MainB", "MainC", "MainD", "MainE", "MainF", "MainG", "MainH", "MainI", "MainJ", "MainK", "MainL", "MainM", "MainN", "MainO", "MainP", "MainQ", "MainR", "MainS", "MainT", "MainU", "MainV", "MainW", "MainX", "MainY", "MainZ" };
        public List<string> Administrators { get; } = new List<string> { "í™ê¸¸ë™A", "í™ê¸¸ë™B", "í™ê¸¸ë™C", "í™ê¸¸ë™D", "í™ê¸¸ë™E", "í™ê¸¸ë™F", "í™ê¸¸ë™G", "í™ê¸¸ë™H", "í™ê¸¸ë™I", "í™ê¸¸ë™J", "í™ê¸¸ë™K", "í™ê¸¸ë™L", "í™ê¸¸ë™M", "í™ê¸¸ë™N", "í™ê¸¸ë™O", "í™ê¸¸ë™P", "í™ê¸¸ë™Q", "í™ê¸¸ë™R", "í™ê¸¸ë™S", "í™ê¸¸ë™T", "í™ê¸¸ë™U", "í™ê¸¸ë™V", "í™ê¸¸ë™W", "í™ê¸¸ë™X" };

        /// <summary>
        /// MainViewModel ìƒì„±ì. DbContextë¥¼ ì§ì ‘ ìƒì„±í•©ë‹ˆë‹¤.
        /// </summary>
        public MainViewModel()
        {
            try
            {
                _context = new LockerDbContext(); // DbContext ì§ì ‘ ìƒì„±
            }
            catch (Exception ex)
            {
                 // DbContext ìƒì„± ì‹¤íŒ¨ ì‹œ (ì˜ˆ: App.config ì˜¤ë¥˜)
                 MessageBox.Show($"ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                 // ì•± ì¢…ë£Œ ë˜ëŠ” ì˜¤ë¥˜ ìƒíƒœ ì²˜ë¦¬ í•„ìš”
                 StatusBarText = "ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜!";
                 // ìƒì„±ìì—ì„œ ì˜ˆì™¸ë¥¼ ë˜ì§€ë©´ ì•±ì´ ë¶ˆì•ˆì •í•´ì§ˆ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìƒíƒœ í‘œì‹œ ë° ê¸°ëŠ¥ ì œí•œ ê³ ë ¤
                 return; // ì´í›„ ë¡œì§ ì‹¤í–‰ ì¤‘ë‹¨
            }

            _lockerAssignments = new ObservableCollection<LockerAssignment>();

            // Command ì´ˆê¸°í™”
            LoadDataCommand = new RelayCommand(async _ => await LoadDataAsync());
            SaveChangesCommand = new RelayCommand(async _ => await SaveChangesAsync());
            AddNewCommand = new RelayCommand(AddNewLocker);
            DeleteCommand = new RelayCommand(async _ => await DeleteSelectedAsync(), _ => SelectedAssignment != null);
            ClearAssignmentCommand = new RelayCommand(ClearSelectedAssignment, _ => SelectedAssignment != null && SelectedAssignment.IsAssigned);

            // ìƒì„± ì‹œ ë°ì´í„° ë¡œë“œ (DbContext ìƒì„± ì„±ê³µ ì‹œ)
            if (_context != null)
            {
                 _ = LoadDataAsync();
            }
        }

        private async Task LoadDataAsync()
        {
            if (_context == null) return; // DbContext ìƒì„± ì‹¤íŒ¨ ì‹œ ì‹¤í–‰ ë°©ì§€

            StatusBarText = "ë°ì´í„° ë¡œë”© ì¤‘...";
            try
            {
                var assignments = await _context.LockerAssignments
                                               .OrderBy(l => l.Floor)
                                               .ThenBy(l => l.Zone)
                                               .ThenBy(l => l.SpecificLocation)
                                               .ToListAsync();
                LockerAssignments = new ObservableCollection<LockerAssignment>(assignments);
                StatusBarText = $"ì´ {LockerAssignments.Count}ê°œì˜ ë ˆì½”ë“œë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.";
            }
            catch (Exception ex)
            {
                StatusBarText = $"ë°ì´í„° ë¡œë”© ì˜¤ë¥˜: {ex.Message}";
                MessageBox.Show($"ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë˜ëŠ” ì¿¼ë¦¬ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{ex.Message}\n\nApp.configì˜ ì—°ê²° ë¬¸ìì—´ì„ í™•ì¸í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.", "ë¡œë“œ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
            }
        }

        private async Task SaveChangesAsync()
        {
             if (_context == null) return;

            StatusBarText = "ë³€ê²½ ì‚¬í•­ ì €ì¥ ì¤‘...";
            try
            {
                 var changedEntries = _context.ChangeTracker.Entries<LockerAssignment>()
                    .Where(e => e.State == EntityState.Added || e.State == EntityState.Modified);

                 var addedOrModifiedEntities = changedEntries.Select(e => e.Entity).ToList();

                 // í˜„ì¬ ì»¬ë ‰ì…˜(UI) ìƒíƒœ ê¸°ì¤€ìœ¼ë¡œ ì¤‘ë³µ ê²€ì‚¬ (DB ì €ì¥ ì „)
                 var allItemsToCheck = LockerAssignments.ToList(); // í˜„ì¬ UI ëª©ë¡ ë³µì‚¬
                 var duplicates = allItemsToCheck
                    .GroupBy(l => new { l.Floor, l.Zone, l.SpecificLocation })
                    .Where(g => g.Count() > 1)
                    .Select(g => g.Key);


                 if (duplicates.Any())
                 {
                     MessageBox.Show($"ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¤‘ë³µëœ ë¬¼ë¦¬ì  ì‚¬ë¬¼í•¨ ìœ„ì¹˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤: {string.Join(", ", duplicates.Select(d => $"{d.Floor}-{d.Zone}-{d.SpecificLocation}"))}", "ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning);
                     StatusBarText = "ì¤‘ë³µ ìœ„ì¹˜ë¡œ ì¸í•´ ì €ì¥ ì‹¤íŒ¨.";
                     // ë³€ê²½ ì‚¬í•­ ë¡¤ë°± (EF6)
                     RollbackChanges(changedEntries);
                     return;
                 }


                foreach(var entry in changedEntries) // changedEntriesëŠ” DB ì»¨í…ìŠ¤íŠ¸ ê¸°ì¤€
                {
                    entry.Entity.Administrator = _currentAdmin;
                }

                int changedCount = await _context.SaveChangesAsync();
                StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œì˜ ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í–ˆìŠµë‹ˆë‹¤.";
            }
            catch (DbUpdateException dbEx)
            {
                var innerExceptionMessage = dbEx.InnerException?.Message ?? dbEx.Message;
                StatusBarText = $"ë°ì´í„° ì €ì¥ ì˜¤ë¥˜: {innerExceptionMessage}";
                MessageBox.Show($"ë°ì´í„°ë² ì´ìŠ¤ì— ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{innerExceptionMessage}", "ì €ì¥ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                // ë³€ê²½ ì‚¬í•­ ë¡¤ë°± (EF6)
                RollbackChanges(_context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged));
            }
            catch (Exception ex)
            {
                StatusBarText = $"ë°ì´í„° ì €ì¥ ì˜¤ë¥˜: {ex.Message}";
                MessageBox.Show($"ì €ì¥ ì¤‘ ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{ex.Message}", "ì €ì¥ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                RollbackChanges(_context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged));
            }
        }

        /// <summary>
        /// EF6ì—ì„œ ë³€ê²½ ì‚¬í•­ ë¡¤ë°± (ê°„ë‹¨ ë²„ì „)
        /// </summary>
        private void RollbackChanges(IEnumerable<DbEntityEntry> changedEntries)
        {
            if (_context == null) return;

            foreach (var entry in changedEntries.ToList()) // ToList()ë¡œ ë³µì‚¬ë³¸ ì‚¬ìš©
            {
                switch (entry.State)
                {
                    case EntityState.Modified:
                        entry.CurrentValues.SetValues(entry.OriginalValues);
                        entry.State = EntityState.Unchanged;
                        break;
                    case EntityState.Added:
                        entry.State = EntityState.Detached;
                        // UI ì»¬ë ‰ì…˜ì—ì„œë„ ì œê±°í•´ì•¼ í•  ìˆ˜ ìˆìŒ
                        if (entry.Entity is LockerAssignment addedEntity)
                        {
                            LockerAssignments.Remove(addedEntity);
                        }
                        break;
                    case EntityState.Deleted:
                        entry.State = EntityState.Unchanged; // ë˜ëŠ” OriginalValuesë¡œ ë³µì›
                        break;
                }
            }
             StatusBarText = "ë³€ê²½ ì‚¬í•­ì´ ë¡¤ë°±ë˜ì—ˆìŠµë‹ˆë‹¤.";
        }


        private void AddNewLocker(object parameter)
        {
            if (_context == null) return;

            var newAssignment = new LockerAssignment
            {
                LockerType = LockerTypes.FirstOrDefault() ?? "ê°œì¸ì‚¬ë¬¼í•¨",
                Floor = Floors.FirstOrDefault() ?? "1",
                Zone = Zones.FirstOrDefault() ?? "A",
                SpecificLocation = "ìƒˆ ìœ„ì¹˜-" + Guid.NewGuid().ToString().Substring(0, 4),
                Administrator = _currentAdmin,
                LastUpdated = DateTime.Now
            };
            LockerAssignments.Add(newAssignment);
            _context.LockerAssignments.Add(newAssignment);
            SelectedAssignment = newAssignment;
            StatusBarText = "ìƒˆ ì‚¬ë¬¼í•¨ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. ì„¸ë¶€ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³  'ë³€ê²½ ì‚¬í•­ ì €ì¥'ì„ í´ë¦­í•˜ì„¸ìš”.";
        }

        private async Task DeleteSelectedAsync()
        {
             if (_context == null || SelectedAssignment == null) return;


            if (MessageBox.Show($"'{SelectedAssignment.Floor}-{SelectedAssignment.Zone}-{SelectedAssignment.SpecificLocation}' ì‚¬ë¬¼í•¨ ì •ë³´ë¥¼ ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
                                "ì‚­ì œ í™•ì¸", MessageBoxButton.YesNo, MessageBoxImage.Warning) == MessageBoxResult.Yes)
            {
                StatusBarText = "ë ˆì½”ë“œ ì‚­ì œ ì¤‘...";
                try
                {
                    var assignmentToDelete = SelectedAssignment;
                    // ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì—”í‹°í‹°ë¥¼ ì°¾ì•„ ì‚­ì œ ìƒíƒœë¡œ ë³€ê²½
                    var entry = _context.Entry(assignmentToDelete);
                    if (entry.State == EntityState.Detached) // ì»¨í…ìŠ¤íŠ¸ì— ì—†ëŠ” ê²½ìš° Attach í›„ ì‚­ì œ
                    {
                         _context.LockerAssignments.Attach(assignmentToDelete);
                    }
                     _context.LockerAssignments.Remove(assignmentToDelete);

                    int changedCount = await _context.SaveChangesAsync();

                    LockerAssignments.Remove(assignmentToDelete);
                    SelectedAssignment = null;
                    StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œì˜ ë ˆì½”ë“œë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.";
                }
                 catch (DbUpdateException dbEx)
                {
                    var innerExceptionMessage = dbEx.InnerException?.Message ?? dbEx.Message;
                    StatusBarText = $"ë°ì´í„° ì‚­ì œ ì˜¤ë¥˜: {innerExceptionMessage}";
                    MessageBox.Show($"ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë ˆì½”ë“œë¥¼ ì‚­ì œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{innerExceptionMessage}", "ì‚­ì œ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                    // ì˜¤ë¥˜ ì‹œ ìƒíƒœ ë³µì› (í•„ìš” ì‹œ)
                    _context.Entry(dbEx.Entries.First().Entity).State = EntityState.Unchanged; // ê°„ë‹¨ ë³µì› ì˜ˆì‹œ
                    await LoadDataAsync(); // ë°ì´í„° ë‹¤ì‹œ ë¡œë“œ
                }
                catch (Exception ex)
                {
                    StatusBarText = $"ë°ì´í„° ì‚­ì œ ì˜¤ë¥˜: {ex.Message}";
                     MessageBox.Show($"ì‚­ì œ ì¤‘ ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{ex.Message}", "ì‚­ì œ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                     await LoadDataAsync(); // ë°ì´í„° ë‹¤ì‹œ ë¡œë“œ
                }
            }
        }

        private void ClearSelectedAssignment(object parameter)
        {
             if (_context == null || SelectedAssignment == null) return;

            SelectedAssignment.UserName = null;
            SelectedAssignment.KnoxId = null;
            SelectedAssignment.SubPart = null;

            _context.Entry(SelectedAssignment).State = EntityState.Modified;
            SelectedAssignment.Administrator = _currentAdmin;

            StatusBarText = $"'{SelectedAssignment.Floor}-{SelectedAssignment.Zone}-{SelectedAssignment.SpecificLocation}' ì‚¬ë¬¼í•¨ì˜ ë°°ì •ì„ í•´ì œí–ˆìŠµë‹ˆë‹¤. ë³€ê²½ ì‚¬í•­ì„ ì €ì¥í•˜ì„¸ìš”.";
        }


        #region IDisposable êµ¬í˜„
        private bool disposed = false;

        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                if (disposing)
                {
                    // ê´€ë¦¬ë˜ëŠ” ë¦¬ì†ŒìŠ¤ í•´ì œ (DbContext ë“±)
                    _context?.Dispose();
                }
                disposed = true;
            }
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
        #endregion
    }
}
8. ë©”ì¸ View (Views/MainWindow.xaml)

XML

<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels" xmlns:models="clr-namespace:LockerManagementApp.Models"
    Title="ì‚¬ë¬¼í•¨ ê´€ë¦¬ í”„ë¡œê·¸ë¨ (DevExpress MVVM - .NET Framework 4.8)" Height="700" Width="1200"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing" >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <RowDefinition Height="*"/>    <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="LightGray" Padding="5"> <StackPanel Orientation="Horizontal">
                <Button Content="ğŸ”„ ë¡œë“œ/ìƒˆë¡œê³ ì¹¨" Margin="3" Command="{Binding LoadDataCommand}" ToolTip="ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìµœì‹  ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤."/>
                <Button Content="ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥" Margin="3" Command="{Binding SaveChangesCommand}" ToolTip="ê·¸ë¦¬ë“œì—ì„œ ë³€ê²½ëœ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•©ë‹ˆë‹¤."/>
                <Button Content="â• ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€" Margin="3" Command="{Binding AddNewCommand}" ToolTip="ìƒˆë¡œìš´ ì‚¬ë¬¼í•¨ ì •ë³´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤ (ìƒˆ í–‰ì´ ì¶”ê°€ë˜ë©° ì§ì ‘ í¸ì§‘)."/>
                <Button Content="âŒ ì„ íƒ í•­ëª© ì‚­ì œ" Margin="3" Command="{Binding DeleteCommand}" ToolTip="ì„ íƒëœ ì‚¬ë¬¼í•¨ ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚­ì œí•©ë‹ˆë‹¤."/>
                <Button Content="ğŸ§¹ ë°°ì • í•´ì œ" Margin="3,3,15,3" Command="{Binding ClearAssignmentCommand}" ToolTip="ì„ íƒëœ ì‚¬ë¬¼í•¨ì˜ ì‚¬ìš©ì ë°°ì • ì •ë³´(ì´ë¦„, ID ë“±)ë¥¼ ì œê±°í•©ë‹ˆë‹¤."/>
            </StackPanel>
        </Border>

        <dxg:GridControl Grid.Row="1"
                         ItemsSource="{Binding LockerAssignments}"
                         SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}"
                         AutoGenerateColumns="None"
                         EnableSmartColumnsGeneration="False"
                         SelectionMode="Row"
                         >
            <dxg:GridControl.View>
                <dxg:TableView AllowPerPixelScrolling="True"
                               ShowTotalSummary="False"
                               ShowGroupPanel="True"
                               AllowEditing="True"
                               NavigationStyle="Cell"
                               ShowAutoFilterRow="True"
                               NewItemRowPosition="None"
                               ShowIndicator="True"
                               ShowSearchPanelMode="Always"
                               ShowSearchPanelFindButton="True"
                               ShowSearchPanelCloseButton="True"
                               SearchPanelHighlightResults="True"
                               >
                     <dxg:TableView.RowCellMenuCustomizations>
                         <dxb:BarButtonItem Content="ì„ íƒ í•­ëª© ë°°ì • í•´ì œ"
                                            Command="{Binding View.DataContext.ClearAssignmentCommand}"
                                            Glyph="{dx:DXImage Svg/Actions/DeleteList.svg}"/>
                         <dxb:BarItemSeparator/>
                         <dxb:BarButtonItem Content="ì„ íƒ í–‰ ì‚­ì œ"
                                            Command="{Binding View.DataContext.DeleteCommand}"
                                            Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/>
                     </dxg:TableView.RowCellMenuCustomizations>
                </dxg:TableView>
            </dxg:GridControl.View>

            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="LockerType" Header="ì¢…ë¥˜" Width="100" Fixed="Left">
                    <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings ItemsSource="{Binding LockerTypes}" IsTextEditable="False"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                 <dxg:GridColumn FieldName="Floor" Header="ì¸µ" Width="60">
                     <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings ItemsSource="{Binding Floors}" IsTextEditable="False"/>
                    </dxg:GridColumn.EditSettings>
                 </dxg:GridColumn>
                <dxg:GridColumn FieldName="Zone" Header="êµ¬ì—­" Width="80">
                     <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings ItemsSource="{Binding Zones}" IsTextEditable="True"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                <dxg:GridColumn FieldName="SpecificLocation" Header="ì„¸ë¶€ ìœ„ì¹˜" Width="120"/>
                <dxg:GridColumn FieldName="UserName" Header="ì„±ëª…" Width="100"/>
                <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100"/>
                <dxg:GridColumn FieldName="SubPart" Header="ì†ŒíŒŒíŠ¸" Width="120">
                     <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings ItemsSource="{Binding SubParts}" IsTextEditable="True"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                 <dxg:GridColumn FieldName="Administrator" Header="ê´€ë¦¬ ë‹´ë‹¹ì" Width="120">
                      <dxg:GridColumn.EditSettings>
                        <dxe:ComboBoxEditSettings ItemsSource="{Binding Administrators}" IsTextEditable="True"/>
                    </dxg:GridColumn.EditSettings>
                 </dxg:GridColumn>
                <dxg:GridColumn FieldName="LastUpdated" Header="ìµœì¢… ìˆ˜ì •ì¼ì‹œ" Width="150" AllowEditing="False" ReadOnly="True">
                     <dxg:GridColumn.EditSettings>
                        <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True"/>
                    </dxg:GridColumn.EditSettings>
                </dxg:GridColumn>
                <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
            </dxg:GridControl.Columns>

        </dxg:GridControl>

        <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem>
                <TextBlock Text="{Binding StatusBarText}" Margin="5,0"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>

</dx:ThemedWindow>
9. ë©”ì¸ View ì½”ë“œ ë¹„í•˜ì¸ë“œ (Views/MainWindow.xaml.cs)

C#

using DevExpress.Xpf.Core; // ThemedWindow, ApplicationThemeHelper ì‚¬ìš©
using LockerManagementApp.ViewModels; // MainViewModel ì°¸ì¡°
using System; // IDisposable ì‚¬ìš©
using System.ComponentModel; // CancelEventArgs ì‚¬ìš©
using System.Windows;

namespace LockerManagementApp.Views
{
    /// <summary>
    /// MainWindow.xamlì— ëŒ€í•œ ìƒí˜¸ ì‘ìš© ë…¼ë¦¬ (.NET Framework 4.8)
    /// </summary>
    public partial class MainWindow : ThemedWindow
    {
        public MainWindow()
        {
            InitializeComponent();

            // ì˜µì…˜: DevExpress í…Œë§ˆ ì„¤ì •
            // ApplicationThemeHelper.ApplicationThemeName = Theme.Office2019ColorfulName;
        }

        // í¸ì˜ë¥¼ ìœ„í•´ DataContextë¥¼ ViewModel íƒ€ì…ìœ¼ë¡œ ìºìŠ¤íŒ…í•˜ëŠ” ì†ì„±
        private MainViewModel ViewModel => DataContext as MainViewModel;

        // ì°½ì´ ë¡œë“œë˜ì—ˆì„ ë•Œ í˜¸ì¶œë  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        private void MainWindow_Loaded(object sender, RoutedEventArgs e)
        {
            // í•„ìš” ì‹œ ViewModelì˜ ì´ˆê¸°í™” ë¡œì§ í˜¸ì¶œ (ì˜ˆ: ë°ì´í„° ë¡œë“œ)
            // ViewModel?.LoadDataCommand.Execute(null); // ViewModel ìƒì„±ìì—ì„œ ì´ë¯¸ í˜¸ì¶œë¨
        }

        // ì°½ì´ ë‹«íˆê¸° ì „ì— í˜¸ì¶œë  ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        private void MainWindow_Closing(object sender, CancelEventArgs e)
        {
            // ViewModelì´ IDisposableì„ êµ¬í˜„í–ˆìœ¼ë¯€ë¡œ, Dispose í˜¸ì¶œí•˜ì—¬ ë¦¬ì†ŒìŠ¤ ì •ë¦¬
            if (ViewModel is IDisposable disposableViewModel)
            {
                disposableViewModel.Dispose();
            }
        }
    }
}
10. ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì  (App.xaml)

XML

<Application x:Class="LockerManagementApp.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:LockerManagementApp"
             StartupUri="Views/MainWindow.xaml"> <Application.Resources>
        </Application.Resources>
</Application>
11. ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì  (App.xaml.cs)

C#

using System;
using System.Diagnostics; // Debug ì‚¬ìš©
using System.Threading.Tasks; // TaskScheduler ì‚¬ìš©
using System.Windows;
using System.Windows.Threading; // DispatcherUnhandledException ì‚¬ìš©

namespace LockerManagementApp
{
    /// <summary>
    /// App.xamlì— ëŒ€í•œ ìƒí˜¸ ì‘ìš© ë…¼ë¦¬ (.NET Framework 4.8)
    /// </summary>
    public partial class App : Application
    {
        protected override void OnStartup(StartupEventArgs e)
        {
            base.OnStartup(e);
            // ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ ì„¤ì •
            SetupGlobalExceptionHandling();
        }

        #region ì „ì—­ ì˜ˆì™¸ ì²˜ë¦¬ (Global Exception Handling)

        private void SetupGlobalExceptionHandling()
        {
            DispatcherUnhandledException += (s, e) =>
            {
                LogAndShowException(e.Exception, "UI Thread Exception");
                e.Handled = true;
            };
            TaskScheduler.UnobservedTaskException += (s, e) =>
            {
                LogAndShowException(e.Exception, "Background Task Exception");
                e.SetObserved();
            };
            AppDomain.CurrentDomain.UnhandledException += (s, e) =>
            {
                LogAndShowException((Exception)e.ExceptionObject, "AppDomain Exception");
            };
        }

        private void LogAndShowException(Exception exception, string source)
        {
            string errorMessage = $"ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤ ({source}):\n\n{exception.ToString()}";
            Debug.WriteLine($"*** ì˜ˆì™¸ ë°œìƒ ({source}) ***\n{errorMessage}");
            try
            {
                 MessageBox.Show(errorMessage, "ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
            }
            catch (Exception msgEx)
            {
                 Debug.WriteLine($"*** ë©”ì‹œì§€ ë°•ìŠ¤ í‘œì‹œ ì‹¤íŒ¨ ({source}) ***\n{msgEx.ToString()}");
            }
        }

        #endregion
    }