SSQL 2014에서 특정 값을 LIKE 조건으로 검색하여 문자열 하나를 반환하는 함수 및 프로시저
1️⃣ UDF(User Defined Function) - 특정 값 LIKE 검색 후 문자열 반환
sql
Copy code
CREATE FUNCTION dbo.GetMatchingValue (@searchValue NVARCHAR(100))
RETURNS NVARCHAR(100)
AS
BEGIN
    DECLARE @result NVARCHAR(100)

    SELECT TOP 1 @result = ColumnName
    FROM YourTable
    WHERE ColumnName LIKE '%' + @searchValue + '%'
    ORDER BY ColumnName -- 정렬 기준 필요 시 설정

    RETURN @result
END
✔ 설명

@searchValue 값을 LIKE 검색으로 포함하는 ColumnName을 조회.
첫 번째 결과(TOP 1)를 반환.
ORDER BY ColumnName 추가하여 특정 정렬 기준 설정 가능.
2️⃣ 프로시저 - LIKE 검색 후 값 반환
sql
Copy code
CREATE PROCEDURE dbo.SearchValueProc
    @searchValue NVARCHAR(100),
    @result NVARCHAR(100) OUTPUT
AS
BEGIN
    SET NOCOUNT ON;

    SELECT TOP 1 @result = ColumnName
    FROM YourTable
    WHERE ColumnName LIKE '%' + @searchValue + '%'
    ORDER BY ColumnName -- 정렬 기준 필요 시 설정
END
✔ 설명

@result을 OUTPUT 변수로 받아 프로시저 호출 시 값을 저장 가능.
3️⃣ 프로시저에서 함수 사용 (함수를 프로시저 안에서 사용하기)
sql
Copy code
CREATE PROCEDURE dbo.UseFunctionInProcedure
    @searchValue NVARCHAR(100),
    @outputValue NVARCHAR(100) OUTPUT
AS
BEGIN
    SET NOCOUNT ON;
    SET @outputValue = dbo.GetMatchingValue(@searchValue)
END
✔ 설명

dbo.GetMatchingValue 함수를 프로시저 내에서 호출하여 결과를 반환.
4️⃣ 실행 예제
sql
Copy code
-- 1️⃣ 함수 실행
SELECT dbo.GetMatchingValue('Test')

-- 2️⃣ 프로시저 실행
DECLARE @output NVARCHAR(100)
EXEC dbo.SearchValueProc 'Test', @output OUTPUT
PRINT @output

-- 3️⃣ 프로시저에서 함수 호출 실행
DECLARE @finalOutput NVARCHAR(100)
EXEC dbo.UseFunctionInProcedure 'Test', @finalOutput OUTPUT
PRINT @finalOutput
✅ 요약
함수 (dbo.GetMatchingValue): 단일 값 반환 가능.