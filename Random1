ëŠ” C# OpenCVë¥¼ ì‚¬ìš©í•˜ì—¬ ì§€ì •ëœ ì˜ì—­ì—ì„œ íŠ¹ì • ìƒ‰ìƒ ë²”ìœ„ë¥¼ ë§Œì¡±í•˜ëŠ” ì§ì‚¬ê°í˜•ì„ íƒìƒ‰í•˜ê³ , 200x30 ì´ìƒì˜ í¬ê¸°ë¥¼ ë§Œì¡±í•˜ëŠ” ê²½ìš° ë§ˆìš°ìŠ¤ í´ë¦­ ë° í‚¤ë³´ë“œ ì…ë ¥ì„ ìë™ ìˆ˜í–‰í•˜ëŠ” ë¹„ë™ê¸° ì½”ë“œì…ë‹ˆë‹¤.

ğŸ”¹ í•µì‹¬ ê¸°ëŠ¥
ìŠ¤í¬ë¦°ìƒ·ì„ ìº¡ì²˜í•˜ì—¬ OpenCV Mat ê°ì²´ë¡œ ë³€í™˜
ì§€ì •ëœ RGB ìƒ‰ìƒ ë²”ìœ„(BGR ê¸°ì¤€) ì— ë§ëŠ” ë§ˆìŠ¤í¬ ìƒì„±
200x30 ì´ìƒì˜ í¬ê¸° ë¥¼ ë§Œì¡±í•˜ëŠ” ì‚¬ê°í˜• íƒìƒ‰
ì¡°ê±´ ì¶©ì¡± ì‹œ
TOPì—ì„œ 157 ìƒë‹¨ í´ë¦­
í‚¤ë³´ë“œ ì…ë ¥ í›„ TAB, ë‹¤ì‹œ í‚¤ë³´ë“œ ì…ë ¥
ì°¾ì€ ë²„íŠ¼ì˜ ì¤‘ì•™ í´ë¦­
ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ UI ì§€ì—° ë°©ì§€
ListBoxì— ë¡œê·¸ ì¶œë ¥ (ìµœëŒ€ 500ê°œ ìœ ì§€)
ğŸ’» C# ì½”ë“œ
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Threading.Tasks;
using System.Windows.Forms;
using OpenCvSharp;
using OpenCvSharp.Extensions;

public partial class MainForm : Form
{
    private const int MaxLogCount = 500;

    public MainForm()
    {
        InitializeComponent();
    }

    private async Task PerformAutomationAsync()
    {
        // ìŠ¤ìº”í•  ì˜ì—­ (X, Y ì¢Œí‘œ ë²”ìœ„)
        int startX = 1200;
        int endX = 1500;
        int startY = 500;
        int endY = 600;

        // ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
        Bitmap screenshot = CaptureScreen(startX, startY, endX - startX, endY - startY);
        Mat src = BitmapConverter.ToMat(screenshot);

        // ìƒ‰ìƒ ë²”ìœ„ ì„¤ì • (BGR ê¸°ì¤€)
        Scalar lower = new Scalar(10, 77, 100);  // B: 10~50, G: 77~88, R: 100~120
        Scalar upper = new Scalar(50, 88, 120);

        // ìƒ‰ìƒ ë²”ìœ„ ë§ˆìŠ¤í¬ ìƒì„±
        Mat mask = new Mat();
        Cv2.InRange(src, lower, upper, mask);

        // ìœ¤ê³½ì„  ì°¾ê¸°
        Cv2.FindContours(mask, out Point[][] contours, out _, RetrievalModes.External, ContourApproximationModes.ApproxSimple);

        foreach (var contour in contours)
        {
            // ìœ¤ê³½ì„ ìœ¼ë¡œë¶€í„° ì™¸ì ‘ ì‚¬ê°í˜• ìƒì„±
            Rect rect = Cv2.BoundingRect(contour);

            // ì‚¬ê°í˜• í¬ê¸° ì¡°ê±´ í™•ì¸ (ë„ˆë¹„ 200 ì´ìƒ, ë†’ì´ 30 ì´ìƒ)
            if (rect.Width >= 200 && rect.Height >= 30)
            {
                int centerX = startX + rect.X + rect.Width / 2;
                int centerY = startY + rect.Y + rect.Height / 2;
                int topClickY = startY + rect.Y - 157;

                LogMessage($"ì°¾ì€ ë²„íŠ¼: X={centerX}, Y={centerY}, Width={rect.Width}, Height={rect.Height}");

                // ìƒë‹¨ í´ë¦­
                SetCursorPos(centerX, topClickY);
                mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, (uint)centerX, (uint)topClickY, 0, 0);

                // í‚¤ë³´ë“œ ì…ë ¥
                await Task.Delay(100);
                SendKeys.SendWait("kkkkbbbbb");
                await Task.Delay(100);
                SendKeys.SendWait("{TAB}");
                await Task.Delay(100);
                SendKeys.SendWait("aaaaabbbb");

                // ë²„íŠ¼ ì¤‘ì•™ í´ë¦­
                await Task.Delay(100);
                SetCursorPos(centerX, centerY);
                mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, (uint)centerX, (uint)centerY, 0, 0);

                LogMessage("ì…ë ¥ ë° ë²„íŠ¼ í´ë¦­ ì™„ë£Œ");
                return;
            }
        }

        LogMessage("ì¡°ê±´ì— ë§ëŠ” ì§ì‚¬ê°í˜•ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ");
    }

    private Bitmap CaptureScreen(int x, int y, int width, int height)
    {
        Bitmap bmp = new Bitmap(width, height);
        using (Graphics g = Graphics.FromImage(bmp))
        {
            g.CopyFromScreen(x, y, 0, 0, new System.Drawing.Size(width, height), CopyPixelOperation.SourceCopy);
        }
        return bmp;
    }

    private void LogMessage(string message)
    {
        if (listBox1.InvokeRequired)
        {
            listBox1.Invoke(new Action(() => AddMessageToListBox(message)));
        }
        else
        {
            AddMessageToListBox(message);
        }
    }

    private void AddMessageToListBox(string message)
    {
        listBox1.Items.Add($"{DateTime.Now:HH:mm:ss} - {message}");

        if (listBox1.Items.Count > MaxLogCount)
        {
            listBox1.Items.RemoveAt(0);
        }

        listBox1.TopIndex = listBox1.Items.Count - 1;
    }

    // ë§ˆìš°ìŠ¤ ì´ë™ ë° í´ë¦­ì„ ìœ„í•œ WinAPI í•¨ìˆ˜
    [DllImport("user32.dll")]
    private static extern bool SetCursorPos(int X, int Y);

    [DllImport("user32.dll")]
    private static extern void mouse_event(uint dwFlags, uint dx, uint dy, uint dwData, int dwExtraInfo);

    private const uint MOUSEEVENTF_LEFTDOWN = 0x0002;
    private const uint MOUSEEVENTF_LEFTUP = 0x0004;
}
ğŸš€ ì‹¤í–‰ íë¦„
ì§€ì •ëœ í™”ë©´ ì˜ì—­ (12001500, 500600)ì—ì„œ ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
RGB ë²”ìœ„ ì„¤ì • (BGR: B=1050, G=7788, R=100~120)
Cv2.InRange() ì‚¬ìš©í•˜ì—¬ ë§ˆìŠ¤í¬ ìƒì„±
ë§ˆìŠ¤í¬ì—ì„œ ì™¸ê³½ì„  ì¶”ì¶œ â†’ Cv2.BoundingRect()ë¡œ ì‚¬ê°í˜• í¬ê¸° í™•ì¸
200x30 ì´ìƒì¸ ê²½ìš°
ë²„íŠ¼ ìœ„ì¹˜ TOP Y - 157 í´ë¦­
"kkkkbbbbb" ì…ë ¥ í›„ TAB í‚¤
"aaaaabbbb" ì…ë ¥ í›„ ë²„íŠ¼ ì¤‘ì•™ í´ë¦­
ë¡œê·¸ (ListBox) ì— ê¸°ë¡ (ìµœëŒ€ 500ê°œ ìœ ì§€)
ğŸ“Œ ê°œì„ ëœ ì 
âœ… RGB ë²”ìœ„ ì„¤ì • ì •í™•í•˜ê²Œ ë°˜ì˜
âœ… ë¹„ë™ê¸°(async ì ìš©) UI ë©ˆì¶¤ ë°©ì§€
âœ… í‚¤ë³´ë“œ ë° ë§ˆìš°ìŠ¤ ì…ë ¥ ìë™í™”
âœ… ListBoxì— ë¡œê·¸ ì¶”ê°€ (500ê°œ ì´ˆê³¼ì‹œ ì œê±°)
âœ… ë²„íŠ¼ í¬ê¸° ì¡°ê±´ (200x30) ì ìš©

ğŸ”¹ ì˜ˆì œ ì‹¤í–‰ ë¡œê·¸
makefile
ì½”ë“œ ë³µì‚¬
12:30:05 - ì°¾ì€ ë²„íŠ¼: X=1340, Y=540, Width=220, Height=40