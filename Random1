using DevExpress.XtraEditors;
using DevExpress.XtraTab;
using System;
using System.IO;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : XtraForm
    {
        private string folderPath = @"c:\abc";

        public YourForm()
        {
            InitializeComponent();
        }

        private void btnLoadFiles_Click(object sender, EventArgs e)
        {
            string[] files = Directory.GetFiles(folderPath, "*.txt");

            xtraTabControl1.TabPages.Clear();

            foreach (string file in files)
            {
                string fileName = Path.GetFileName(file);

                XtraTabPage tabPage = new XtraTabPage();
                tabPage.Text = fileName;
                tabPage.Tag = file;

                TextEdit txtContent = new TextEdit();
                txtContent.Dock = DockStyle.Fill;
                tabPage.Controls.Add(txtContent);

                SimpleButton btnDelete = new SimpleButton();
                btnDelete.Text = "삭제";
                btnDelete.Dock = DockStyle.Bottom;
                btnDelete.Click += btnDelete_Click;
                tabPage.Controls.Add(btnDelete);

                xtraTabControl1.TabPages.Add(tabPage);
            }
        }

        private void xtraTabControl1_SelectedPageChanged(object sender, TabPageChangedEventArgs e)
        {
            XtraTabPage selectedTabPage = xtraTabControl1.SelectedTabPage;
            if (selectedTabPage != null)
            {
                string filePath = selectedTabPage.Tag as string;
                if (File.Exists(filePath))
                {
                    string fileContent = File.ReadAllText(filePath);
                    TextEdit txtContent = selectedTabPage.Controls[0] as TextEdit;
                    txtContent.Text = fileContent;
                }
            }
        }

        private void btnDelete_Click(object sender, EventArgs e)
        {
            XtraTabPage tabPage = (sender as SimpleButton).Parent as XtraTabPage;
            string filePath = tabPage.Tag as string;

            if (File.Exists(filePath))
            {
                File.Delete(filePath);
            }

            xtraTabControl1.TabPages.Remove(tabPage);
        }

        private void xtraTabControl1_SelectedPageChanging(object sender, TabPageChangingEventArgs e)
        {
            XtraTabPage tabPage = xtraTabControl1.SelectedTabPage;
            if (tabPage != null)
            {
                string filePath = tabPage.Tag as string;
                if (File.Exists(filePath))
                {
                    TextEdit txtContent = tabPage.Controls[0] as TextEdit;
                    File.WriteAllText(filePath, txtContent.Text);
                }
            }
        }
    }
}
