using System;
using System.Data;
using System.Text;
using System.Windows.Forms;
using DevExpress.XtraGrid;
using DevExpress.XtraGrid.Columns;
using DevExpress.XtraGrid.Views.Grid;
using DevExpress.XtraRichEdit.API.Native;

namespace WinFormApp
{
    public partial class MainForm : Form
    {
        private GridControl gridControl;
        private RichEditControl richEditControl;

        public MainForm()
        {
            InitializeComponent();
        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            // GridControl 초기화 및 데이터 바인딩
            gridControl = new GridControl();
            // 데이터를 GridControl에 바인딩하는 코드 작성

            // RichEditControl 초기화
            richEditControl = new RichEditControl();

            // 폼에 컨트롤 추가
            Controls.Add(gridControl);
            Controls.Add(richEditControl);
        }

        private void CopyGridDataToRichEditControl()
        {
            // GridControl의 데이터 가져오기
            DataTable dataTable = ((GridView)gridControl.MainView).DataSource as DataTable;
            if (dataTable == null)
                return;

            // HTML 표 생성
            StringBuilder htmlBuilder = new StringBuilder();
            htmlBuilder.AppendLine("<table>");

            // 열 제목 추가
            htmlBuilder.AppendLine("<tr>");
            foreach (GridColumn column in ((GridView)gridControl.MainView).Columns)
            {
                htmlBuilder.AppendLine("<th>" + column.Caption + "</th>");
            }
            htmlBuilder.AppendLine("</tr>");

            // 데이터 추가
            foreach (DataRow row in dataTable.Rows)
            {
                htmlBuilder.AppendLine("<tr>");
                foreach (GridColumn column in ((GridView)gridControl.MainView).Columns)
                {
                    htmlBuilder.AppendLine("<td>" + row[column.FieldName].ToString() + "</td>");
                }
                htmlBuilder.AppendLine("</tr>");
            }

            htmlBuilder.AppendLine("</table>");

            // HTML을 RichEditControl에 추가
            DocumentFormat format = DocumentFormat.Html;
            richEditControl.Document.BeginUpdate();
            richEditControl.Document.InsertHtml(richEditControl.Document.CaretPosition, htmlBuilder.ToString(), format);
            richEditControl.Document.EndUpdate();
        }

        private void CopyButton_Click(object sender, EventArgs e)
        {
            CopyGridDataToRichEditControl();
        }
    }
}
