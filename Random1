, ì•Œê² ìŠµë‹ˆë‹¤. ìš”ì²­í•˜ì‹  UI ë³€ê²½ ì‚¬í•­ë“¤ì„ ë°˜ì˜í•˜ê² ìŠµë‹ˆë‹¤.

ì „ì²´ ê¸€ì”¨ í¬ê¸° +1: MainWindow.xamlì˜ ë£¨íŠ¸ ìš”ì†Œ(ThemedWindow)ì— FontSizeë¥¼ ì„¤ì •í•˜ì—¬ ì „ë°˜ì ì¸ ê¸€ì”¨ í¬ê¸°ë¥¼ í‚¤ì›ë‹ˆë‹¤. (ì˜ˆ: ê¸°ë³¸ê°’ì´ 12 ë˜ëŠ” 13 ê·¼ì²˜ì˜€ë‹¤ë©´ 14 ë˜ëŠ” 15 ì •ë„ë¡œ ì„¤ì •)
ì»¬ëŸ¼ í—¤ë” ê°€ìš´ë° ì •ë ¬: MainWindow.xamlì˜ LightBlueHeaderStyleì— HorizontalContentAlignment="Center"ê°€ ì´ë¯¸ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì ìš©í•©ë‹ˆë‹¤. (ì´ì „ ì½”ë“œì— ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤.)
ì—°ê´€ í–‰ ë…¸ë€ìƒ‰ ë°°ê²½: ë©”ì¸ ê·¸ë¦¬ë“œì—ì„œ íŠ¹ì • ì½¤ë³´ë°•ìŠ¤ ì…€ì„ í´ë¦­(ì„ íƒ)í–ˆì„ ë•Œ, í•´ë‹¹ ì…€ì˜ ê°’ê³¼ ë™ì¼í•œ ê°’ì„ ê°€ì§„ ë‹¤ë¥¸ ëª¨ë“  í–‰ë“¤ì˜ ë°°ê²½ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ìŒ ì‘ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤.
MainViewModelì— í˜„ì¬ ì„ íƒëœ ì…€ì˜ ì •ë³´(ì»¬ëŸ¼ëª…, ê°’)ë¥¼ ì €ì¥í•  ì†ì„± ì¶”ê°€.
MainWindow.xaml.csì—ì„œ ê·¸ë¦¬ë“œì˜ í¬ì»¤ìŠ¤ ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•˜ì—¬ ViewModelì˜ ì†ì„±ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë¡œì§ ì¶”ê°€.
í–‰ ë°°ê²½ì„ ë™ì ìœ¼ë¡œ ë³€ê²½í•˜ê¸° ìœ„í•œ IMultiValueConverter êµ¬í˜„ (HighlightRowConverter).
MainWindow.xamlì—ì„œ TableView.RowStyleì„ ì •ì˜í•˜ê³ , ìœ„ì—ì„œ ë§Œë“  ì»¨ë²„í„°ì™€ ViewModel ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ë°°ê²½ìƒ‰ì„ ì¡°ê±´ë¶€ë¡œ ë³€ê²½í•˜ëŠ” MultiBinding ì„¤ì •.
ìˆ˜ì •/ì¶”ê°€í•´ì•¼ í•  íŒŒì¼ ëª©ë¡:

Views/MainWindow.xaml (FontSize ì„¤ì •, RowStyle ì¶”ê°€, ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—°ê²°)
ViewModels/MainViewModel.cs (ì„ íƒ ì…€ ì •ë³´ ì†ì„± ë° ì—…ë°ì´íŠ¸ ë©”ì„œë“œ ì¶”ê°€)
Infrastructure/HighlightRowConverter.cs (ì‹ ê·œ ì»¨ë²„í„° êµ¬í˜„)
ì•„ë˜ì— ì´ 3ê°œ íŒŒì¼ì˜ ìˆ˜ì •ëœ ì „ì²´ ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

1. Views/MainWindow.xaml (ìˆ˜ì •)

ThemedWindowì— FontSize ì„¤ì •.
TableViewì— FocusedColumnChanged ë° CurrentItemChanged ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì¶”ê°€.
TableView.RowStyle ì¶”ê°€ ë° HighlightRowConverter ë¦¬ì†ŒìŠ¤ ì •ì˜.
XML

<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    xmlns:models="clr-namespace:LockerManagementApp.Models"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure"
    Title="ì‚¬ë¬¼í•¨ ê´€ë¦¬ í”„ë¡œê·¸ë¨ (DevExpress MVVM - .NET Framework 4.8)" Height="750" Width="1300"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"
    FontSize="14" >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <infra:HighlightRowConverter x:Key="HighlightRowConverter"/>

        <Style x:Key="LightBlueHeaderStyle" TargetType="dxg:BaseGridHeader"> <Setter Property="Background" Value="LightBlue"/> <Setter Property="HorizontalContentAlignment" Value="Center"/> <Setter Property="FontWeight" Value="Bold"/> </Style>
        <Style TargetType="dxg:GridColumnHeader" BasedOn="{StaticResource LightBlueHeaderStyle}"/> <Style TargetType="dxg:BandHeaderControl" BasedOn="{StaticResource LightBlueHeaderStyle}"/>

        <Style x:Key="ConditionalRowHighlightStyle" TargetType="dxg:RowControl">
            <Setter Property="Background">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource HighlightRowConverter}">
                        <Binding Path="DataContext"/>
                        <Binding Path="DataContext.SelectedCellValue" RelativeSource="{RelativeSource AncestorType={dx:ThemedWindow}}"/>
                        <Binding Path="DataContext.SelectedCellColumnFieldName" RelativeSource="{RelativeSource AncestorType={dx:ThemedWindow}}"/>
                    </MultiBinding>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                 <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="{dx:ThemeResource {dxgt:GridRowThemeKey ResourceKey=BorderSelectedBrush}}"/>
                    <Setter Property="Foreground" Value="{dx:ThemeResource {dxgt:GridRowThemeKey ResourceKey=TextRowSelectedBrush}}"/>
                </Trigger>
                 </Style.Triggers>
        </Style>

    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="5">
                <TextBlock Text="ë§ˆìŠ¤í„° í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Content="í™•ì¸" Margin="5,0,0,0" Command="{Binding CheckMasterPasswordCommand}"/>
            </StackPanel>
            <Border Background="LightGray" Padding="5">
                 <StackPanel Orientation="Horizontal"> <Button Content="ğŸ”„ ìƒˆë¡œê³ ì¹¨" Margin="3" Command="{Binding LoadDataCommand}"/> <Button Content="ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥" Margin="3" Command="{Binding SaveChangesCommand}"/>
                     <Button Content="âš™ï¸ ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬" Margin="15,3,3,3" Command="{Binding OpenMasterDataWindowCommand}" ToolTip="ë§ˆìŠ¤í„° ë°ì´í„°(ì¸µ, êµ¬ì—­ ë“±)ë¥¼ ê´€ë¦¬í•˜ëŠ” ìƒˆ ì°½ì„ ì—½ë‹ˆë‹¤." Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                 </StackPanel>
            </Border>
        </DockPanel>

        <Grid Grid.Row="1" Margin="5">
            <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
            <Border Grid.Row="0" Background="WhiteSmoke" Padding="3"> <StackPanel Orientation="Horizontal"> <Button Content="â• ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€" Margin="3" Command="{Binding AddNewCommand}"/> <Button Content="âŒ ì„ íƒ í•­ëª© ì‚­ì œ" Margin="3" Command="{Binding DeleteCommand}"/> <Button Content="ğŸ§¹ ë°°ì • í•´ì œ" Margin="3" Command="{Binding ClearAssignmentCommand}"/> </StackPanel> </Border>
            <dxg:GridControl Grid.Row="1" ItemsSource="{Binding LockerAssignments}" SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}">
                <dxg:GridControl.View>
                    <dxg:TableView AllowPerPixelScrolling="True" ShowGroupPanel="True" AllowEditing="True"
                                   NavigationStyle="Cell" ShowAutoFilterRow="True" NewItemRowPosition="None"
                                   ShowIndicator="True" ShowSearchPanelMode="Always"
                                   FocusedColumnChanged="TableView_FocusedColumnChanged"
                                   CurrentItemChanged="TableView_CurrentItemChanged"
                                   RowStyle="{StaticResource ConditionalRowHighlightStyle}">
                        <dxg:TableView.RowCellMenuCustomizations> <dxb:BarButtonItem Content="ë°°ì • í•´ì œ" Command="{Binding View.DataContext.ClearAssignmentCommand}" Glyph="{dx:DXImage Svg/Actions/DeleteList.svg}"/> <dxb:BarItemSeparator/> <dxb:BarButtonItem Content="í–‰ ì‚­ì œ" Command="{Binding View.DataContext.DeleteCommand}" Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/> </dxg:TableView.RowCellMenuCustomizations>
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="LockerType" Header="ì¢…ë¥˜" Width="100" Fixed="Left" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllLockerTypes}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Floor" Header="ì¸µ" Width="60" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllFloors}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Zone" Header="êµ¬ì—­" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllZones}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SpecificLocation" Header="ì„¸ë¶€ ìœ„ì¹˜" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="UserName" Header="ì„±ëª…" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SubPart" Header="ì†ŒíŒŒíŠ¸" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllSubParts}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Administrator" Header="ê´€ë¦¬ ë‹´ë‹¹ì" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllAdministrators}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="TransferStatus" Header="ì „ë°°ë³µì§" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Details" Header="ë‚´ìš©" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Remarks" Header="íŠ¹ì´ì‚¬í•­" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Notes" Header="ë¹„ê³ " Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="LastUpdated" Header="ìµœì¢… ìˆ˜ì •ì¼ì‹œ" Width="150" AllowEditing="False" ReadOnly="True" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
                </dxg:GridControl.Columns>
            </dxg:GridControl>
        </Grid>

        <StatusBar Grid.Row="2" Background="LightGray"> <StatusBarItem><TextBlock Text="{Binding StatusBarText}" Margin="5,0"/></StatusBarItem> </StatusBar>
    </Grid>

</dx:ThemedWindow>
2. ViewModels/MainViewModel.cs (ìˆ˜ì •)

ì„ íƒëœ ì…€ ì •ë³´(ê°’, ì»¬ëŸ¼ í•„ë“œëª…)ë¥¼ ì €ì¥í•  ì†ì„± ì¶”ê°€ (SelectedCellValue, SelectedCellColumnFieldName).
Viewì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ í˜¸ì¶œí•  ê³µê°œ ë©”ì„œë“œ ì¶”ê°€ (UpdateHighlightInfo).
C#

// í•„ìš”í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ (ê¸°ì¡´ í¬í•¨)
using LockerManagementApp.Data;
using LockerManagementApp.Models;
using LockerManagementApp.Infrastructure;
using LockerManagementApp.Views;
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Configuration;
using System.Data.Entity;
using System.Data.Entity.Infrastructure;
using System.Data.Entity.Validation;
using System.Linq;
using System.Security;
using System.Threading;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;
using System.Runtime.InteropServices;
using System.IO;
using System.Text;
using System.Windows.Threading;
using System.Diagnostics;

namespace LockerManagementApp.ViewModels
{
    /// <summary>
    /// ë©”ì¸ ViewModel (í–‰ í•˜ì´ë¼ì´íŠ¸ ë¡œì§ ì¶”ê°€)
    /// </summary>
    public class MainViewModel : ViewModelBase, IDisposable
    {
        private LockerDbContext _context;
        private ObservableCollection<LockerAssignment> _lockerAssignments;
        private LockerAssignment _selectedAssignment;
        private string _statusBarText = "ì¤€ë¹„ ì™„ë£Œ";
        private string _currentAdmin = "í™ê¸¸ë™A";
        private SecureString _masterPasswordInput;
        private bool _isMasterModeEnabled = false;
        private ObservableCollection<LockerType> _allLockerTypes;
        private ObservableCollection<Floor> _allFloors;
        private ObservableCollection<Zone> _allZones;
        private ObservableCollection<SubPart> _allSubParts;
        private ObservableCollection<Administrator> _allAdministrators;
        public LogViewModel LogVM { get; private set; }
        private readonly CancellationTokenSource _cts = new CancellationTokenSource();

        // *** ì‹ ê·œ: í–‰ í•˜ì´ë¼ì´íŠ¸ë¥¼ ìœ„í•œ ì†ì„± ***
        private object _selectedCellValue; // í˜„ì¬ ì„ íƒ(í¬ì»¤ìŠ¤)ëœ ì…€ì˜ ê°’
        private string _selectedCellColumnFieldName; // í˜„ì¬ ì„ íƒ(í¬ì»¤ìŠ¤)ëœ ì…€ì˜ ì»¬ëŸ¼ í•„ë“œëª…

        #region Public Properties
        public ObservableCollection<LockerAssignment> LockerAssignments { get => _lockerAssignments; set => SetProperty(ref _lockerAssignments, value); }
        public LockerAssignment SelectedAssignment { get => _selectedAssignment; set { if (SetProperty(ref _selectedAssignment, value)) { /* ... */ } } } // CurrentItemChanged ì´ë²¤íŠ¸ ì‚¬ìš©
        public string StatusBarText { get => _statusBarText; set => SetProperty(ref _statusBarText, value); }
        public SecureString MasterPasswordInput { get => _masterPasswordInput; set => SetProperty(ref _masterPasswordInput, value); }
        public bool IsMasterModeEnabled { get => _isMasterModeEnabled; set => SetProperty(ref _isMasterModeEnabled, value); }
        public ObservableCollection<LockerType> AllLockerTypes { get => _allLockerTypes; set => SetProperty(ref _allLockerTypes, value); }
        public ObservableCollection<Floor> AllFloors { get => _allFloors; set => SetProperty(ref _allFloors, value); }
        public ObservableCollection<Zone> AllZones { get => _allZones; set => SetProperty(ref _allZones, value); }
        public ObservableCollection<SubPart> AllSubParts { get => _allSubParts; set => SetProperty(ref _allSubParts, value); }
        public ObservableCollection<Administrator> AllAdministrators { get => _allAdministrators; set => SetProperty(ref _allAdministrators, value); }

        // *** ì‹ ê·œ: í–‰ í•˜ì´ë¼ì´íŠ¸ ì†ì„± Getter/Setter ***
        public object SelectedCellValue { get => _selectedCellValue; private set => SetProperty(ref _selectedCellValue, value); }
        public string SelectedCellColumnFieldName { get => _selectedCellColumnFieldName; private set => SetProperty(ref _selectedCellColumnFieldName, value); }

        #endregion

        #region Commands (ì´ì „ê³¼ ë™ì¼)
        public ICommand LoadDataCommand { get; }
        public ICommand SaveChangesCommand { get; }
        public ICommand AddNewCommand { get; }
        public ICommand DeleteCommand { get; }
        public ICommand ClearAssignmentCommand { get; }
        public ICommand CheckMasterPasswordCommand { get; }
        public ICommand RefreshMasterDataCommand { get; }
        public ICommand OpenMasterDataWindowCommand { get; }
        #endregion

        public MainViewModel()
        {
            // ... (ìƒì„±ì ë¡œì§ ì´ì „ê³¼ ë™ì¼) ...
            try { _context = new LockerDbContext(); } catch (Exception ex) { MessageBox.Show($"DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); StatusBarText = "DB ì—°ê²° ì˜¤ë¥˜!"; return; }
            _lockerAssignments = new ObservableCollection<LockerAssignment>(); _allLockerTypes = new ObservableCollection<LockerType>(); _allFloors = new ObservableCollection<Floor>(); _allZones = new ObservableCollection<Zone>(); _allSubParts = new ObservableCollection<SubPart>(); _allAdministrators = new ObservableCollection<Administrator>();
            LogVM = new LogViewModel();
            LoadDataCommand = new RelayCommand(async _ => await LoadInitialDataAsync()); SaveChangesCommand = new RelayCommand(async _ => await SaveChangesAsync()); AddNewCommand = new RelayCommand(AddNewLocker); DeleteCommand = new RelayCommand(async _ => await DeleteSelectedAsync(), _ => SelectedAssignment != null); ClearAssignmentCommand = new RelayCommand(ClearSelectedAssignment, _ => SelectedAssignment != null && SelectedAssignment.IsAssigned); CheckMasterPasswordCommand = new RelayCommand(CheckMasterPassword); RefreshMasterDataCommand = new RelayCommand(async _ => await LoadMasterDataAsync()); OpenMasterDataWindowCommand = new RelayCommand(OpenMasterDataWindow);
            if (_context != null) { _ = LoadInitialDataAsync(); }
        }

        // --- ë°ì´í„° ë¡œë”© ë©”ì„œë“œ (LoadAssignmentsAsync ìˆ˜ì •ë¨) ---
        private async Task LoadInitialDataAsync() { await LoadMasterDataAsync(); await LoadAssignmentsAsync(); }
        private async Task LoadAssignmentsAsync() { if (_context == null || _cts.IsCancellationRequested) return; StatusBarText = "ì‚¬ë¬¼í•¨ ëª©ë¡ ë¡œë”© ì¤‘..."; try { var trackedAssignments = _context.ChangeTracker.Entries<LockerAssignment>().ToList(); if (trackedAssignments.Any()) { Debug.WriteLine($"LoadAssignmentsAsync: Detaching {trackedAssignments.Count} tracked LockerAssignment entities."); foreach (var entry in trackedAssignments) entry.State = EntityState.Detached; } var assignments = await _context.LockerAssignments.OrderBy(l => l.Floor).ThenBy(l => l.Zone).ThenBy(l => l.SpecificLocation).ToListAsync(_cts.Token); if (!_cts.IsCancellationRequested) { LockerAssignments = new ObservableCollection<LockerAssignment>(assignments); StatusBarText = $"ì´ {LockerAssignments.Count}ê°œ ë¡œë“œ ì™„ë£Œ."; } } catch (OperationCanceledException) { Debug.WriteLine("LoadAssignmentsAsync ì‘ì—… ì·¨ì†Œë¨."); StatusBarText = "ì‚¬ë¬¼í•¨ ëª©ë¡ ë¡œë”© ì·¨ì†Œë¨."; } catch (Exception ex) { if (!_cts.IsCancellationRequested) HandleGenericException("ì‚¬ë¬¼í•¨ ëª©ë¡ ë¡œë”©", ex); } }
        private async Task LoadMasterDataAsync() { StatusBarText = "ë§ˆìŠ¤í„° ë°ì´í„°(ì½¤ë³´ë°•ìŠ¤ìš©) ë¡œë”© ì¤‘..."; LockerDbContext tempContext = null; try { using (tempContext = new LockerDbContext()) { AllLockerTypes = new ObservableCollection<LockerType>(await tempContext.LockerTypes.OrderBy(t => t.Name).AsNoTracking().ToListAsync(_cts.Token)); if (_cts.IsCancellationRequested) return; AllFloors = new ObservableCollection<Floor>(await tempContext.Floors.OrderBy(f => f.Name).AsNoTracking().ToListAsync(_cts.Token)); if (_cts.IsCancellationRequested) return; AllZones = new ObservableCollection<Zone>(await tempContext.Zones.OrderBy(z => z.Name).AsNoTracking().ToListAsync(_cts.Token)); if (_cts.IsCancellationRequested) return; AllSubParts = new ObservableCollection<SubPart>(await tempContext.SubParts.OrderBy(p => p.Name).AsNoTracking().ToListAsync(_cts.Token)); if (_cts.IsCancellationRequested) return; AllAdministrators = new ObservableCollection<Administrator>(await tempContext.Administrators.OrderBy(a => a.Name).AsNoTracking().ToListAsync(_cts.Token)); if (!_cts.IsCancellationRequested) StatusBarText = "ë§ˆìŠ¤í„° ë°ì´í„°(ì½¤ë³´ë°•ìŠ¤ìš©) ë¡œë“œ ì™„ë£Œ."; } } catch (OperationCanceledException) { Debug.WriteLine("LoadMasterDataAsync ì‘ì—… ì·¨ì†Œë¨."); StatusBarText = "ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© ì·¨ì†Œë¨."; } catch (InvalidOperationException ioEx) when (ioEx.Message.Contains("DataReader")) { if (!_cts.IsCancellationRequested) { HandleGenericException("ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”© (DataReader ì¶©ëŒ ê°€ëŠ¥ì„±)", ioEx); MessageBox.Show("ë°ì´í„° ë¡œë”© ì¤‘ ì¶©ëŒ ë°œìƒ. App.config ì—°ê²° ë¬¸ìì—´ì— MultipleActiveResultSets=True; ì˜µì…˜ í™•ì¸ ë˜ëŠ” ì¬ì‹œë„.", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); } } catch (Exception ex) { if (!_cts.IsCancellationRequested) HandleGenericException("ë§ˆìŠ¤í„° ë°ì´í„° ë¡œë”©", ex); } }
        private void CheckMasterPassword(object parameter) { try { string storedMasterKey = ConfigurationManager.AppSettings["MasterKey"]; if (string.IsNullOrEmpty(storedMasterKey)) { MessageBox.Show("App.configì— ë§ˆìŠ¤í„° í‚¤(MasterKey) ì—†ìŒ.", "ì„¤ì • ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); return; } string plainPassword = ConvertToUnsecureString(MasterPasswordInput); if (plainPassword == storedMasterKey) { IsMasterModeEnabled = true; /* ìƒíƒœ ë³€ê²½ */ MessageBox.Show("ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì™„ë£Œ.", "ì„±ê³µ", MessageBoxButton.OK, MessageBoxImage.Information); } else { IsMasterModeEnabled = false; /* ìƒíƒœ ë³€ê²½ */ MessageBox.Show("ë§ˆìŠ¤í„° í‚¤ ë¶ˆì¼ì¹˜.", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } } catch (ConfigurationErrorsException confEx) { MessageBox.Show($"ì„¤ì • íŒŒì¼ ì˜¤ë¥˜:\n{confEx.Message}", "ì„¤ì • ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } catch (Exception ex) { MessageBox.Show($"ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì˜¤ë¥˜: {ex.Message}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } }
        private void OpenMasterDataWindow(object parameter) { if (!BackupDataToCsv()) { if (MessageBox.Show("ë°ì´í„° ë°±ì—… ì‹¤íŒ¨. ê³„ì† ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", "ë°±ì—… ì‹¤íŒ¨", MessageBoxButton.YesNo, MessageBoxImage.Warning) == MessageBoxResult.No) return; } try { using (var masterDataVM = new MasterDataViewModel()) { var masterDataWindow = new MasterDataWindow { DataContext = masterDataVM, Owner = Application.Current.MainWindow }; masterDataWindow.ShowDialog(); _ = LoadMasterDataAsync(); _ = LoadAssignmentsAsync(); } } catch (Exception ex) { MessageBox.Show($"ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬ ì°½ ì—´ê¸° ì˜¤ë¥˜:\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); } }

        #region CRUD ë° ê¸°íƒ€ ë©”ì„œë“œ (ì´ì „ê³¼ ë™ì¼)
        private async Task SaveChangesAsync() { if (_context == null || _cts.IsCancellationRequested) return; StatusBarText = "ë³€ê²½ ì‚¬í•­ ì €ì¥ ì¤‘..."; List<DbEntityEntry> allChangedEntriesForRollback = _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged).ToList(); try { var changedLockerEntries = _context.ChangeTracker.Entries<LockerAssignment>().Where(e => e.State == EntityState.Added || e.State == EntityState.Modified).ToList(); var allItemsToCheck = LockerAssignments.ToList(); var duplicates = allItemsToCheck.GroupBy(l => new { l.Floor, l.Zone, l.SpecificLocation }).Where(g => g.Count() > 1).Select(g => g.Key); if (duplicates.Any()) { MessageBox.Show($"ì €ì¥ ë¶ˆê°€: ì¤‘ë³µ ìœ„ì¹˜ ë°œê²¬ - {string.Join(", ", duplicates.Select(d => $"{d.Floor}-{d.Zone}-{d.SpecificLocation}"))}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); RollbackChanges(allChangedEntriesForRollback); return; } foreach(var entry in changedLockerEntries) { entry.Entity.Administrator = _currentAdmin; } int changedCount = await _context.SaveChangesAsync(_cts.Token); StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œ ì €ì¥ë¨."; } catch (OperationCanceledException) { Debug.WriteLine("SaveChangesAsync ì‘ì—… ì·¨ì†Œë¨."); StatusBarText = "ì €ì¥ ì‘ì—… ì·¨ì†Œë¨."; RollbackChanges(allChangedEntriesForRollback); } catch (DbEntityValidationException vex) { HandleValidationException(vex); RollbackChanges(allChangedEntriesForRollback); } catch (DbUpdateException dbEx) { HandleDbUpdateException(dbEx); RollbackChanges(allChangedEntriesForRollback); } catch (Exception ex) { if (!_cts.IsCancellationRequested) HandleGenericException("ì €ì¥", ex); RollbackChanges(allChangedEntriesForRollback); } }
        private void RollbackChanges(IEnumerable<DbEntityEntry> changedEntries) { if (_context == null || changedEntries == null) return; foreach (var entry in changedEntries.ToList()) { switch (entry.State) { case EntityState.Modified: entry.CurrentValues.SetValues(entry.OriginalValues); entry.State = EntityState.Unchanged; break; case EntityState.Added: entry.State = EntityState.Detached; if (entry.Entity is LockerAssignment addedEntity && LockerAssignments.Contains(addedEntity)) LockerAssignments.Remove(addedEntity); break; case EntityState.Deleted: entry.State = EntityState.Unchanged; break; } } StatusBarText = "ë³€ê²½ ë¡¤ë°±ë¨."; }
        private void AddNewLocker(object parameter) { if (_context == null) return; var newAssignment = new LockerAssignment { LockerType = AllLockerTypes.FirstOrDefault()?.Name ?? "ê°œì¸ì‚¬ë¬¼í•¨", Floor = AllFloors.FirstOrDefault()?.Name ?? "1", Zone = AllZones.FirstOrDefault()?.Name ?? "A", SpecificLocation = "ìƒˆ ìœ„ì¹˜-" + Guid.NewGuid().ToString("N").Substring(0, 4), Administrator = _currentAdmin, LastUpdated = DateTime.Now }; LockerAssignments.Add(newAssignment); _context.LockerAssignments.Add(newAssignment); SelectedAssignment = newAssignment; StatusBarText = "ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€ë¨. ì €ì¥ í•„ìš”."; }
        private async Task DeleteSelectedAsync() { if (_context == null || SelectedAssignment == null || _cts.IsCancellationRequested) return; if (MessageBox.Show($"'{SelectedAssignment.Floor}-{SelectedAssignment.Zone}-{SelectedAssignment.SpecificLocation}' ì‚­ì œ?", "í™•ì¸", MessageBoxButton.YesNo, MessageBoxImage.Warning) == MessageBoxResult.Yes) { StatusBarText = "ì‚­ì œ ì¤‘..."; List<DbEntityEntry> changesForRollback = _context.ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged).ToList(); try { var assignmentToDelete = SelectedAssignment; var entry = _context.Entry(assignmentToDelete); if (entry.State == EntityState.Detached) { _context.LockerAssignments.Attach(assignmentToDelete); } _context.LockerAssignments.Remove(assignmentToDelete); int changedCount = await _context.SaveChangesAsync(_cts.Token); LockerAssignments.Remove(assignmentToDelete); SelectedAssignment = null; StatusBarText = $"ì„±ê³µì ìœ¼ë¡œ {changedCount}ê°œ ì‚­ì œë¨."; } catch (OperationCanceledException) { Debug.WriteLine("DeleteSelectedAsync ì‘ì—… ì·¨ì†Œë¨."); StatusBarText = "ì‚­ì œ ì‘ì—… ì·¨ì†Œë¨."; RollbackChanges(changesForRollback); } catch (DbUpdateException dbEx) { HandleDbUpdateException(dbEx); RollbackChanges(changesForRollback); await LoadAssignmentsAsync(); } catch (Exception ex) { if (!_cts.IsCancellationRequested) HandleGenericException("ì‚­ì œ", ex); RollbackChanges(changesForRollback); await LoadAssignmentsAsync(); } } }
        private void ClearSelectedAssignment(object parameter) { if (_context == null || SelectedAssignment == null) return; SelectedAssignment.UserName = null; SelectedAssignment.KnoxId = null; SelectedAssignment.SubPart = null; _context.Entry(SelectedAssignment).State = EntityState.Modified; SelectedAssignment.Administrator = _currentAdmin; StatusBarText = "ë°°ì • í•´ì œë¨. ì €ì¥ í•„ìš”."; }
        #endregion

        #region Backup Logic (CSV - ì´ì „ê³¼ ë™ì¼)
        private bool BackupDataToCsv() { string backupDir = @"C:\agent"; string fileName = $"LockerBackup_{DateTime.Now:yyyyMMdd_HHmmss}.csv"; string filePath = Path.Combine(backupDir, fileName); StatusBarText = "ë°ì´í„° ë°±ì—… ì‹œì‘..."; try { Directory.CreateDirectory(backupDir); using (var backupContext = new LockerDbContext()) using (var writer = new StreamWriter(filePath, false, Encoding.UTF8)) { WriteTableToCsv<LockerType>(backupContext, writer); WriteTableToCsv<Floor>(backupContext, writer); WriteTableToCsv<Zone>(backupContext, writer); WriteTableToCsv<SubPart>(backupContext, writer); WriteTableToCsv<Administrator>(backupContext, writer); WriteTableToCsv<LockerAssignment>(backupContext, writer); WriteTableToCsv<AuditLog>(backupContext, writer); } StatusBarText = $"ë°ì´í„° ë°±ì—… ì™„ë£Œ: {filePath}"; MessageBox.Show($"ë°ì´í„°ê°€ ë‹¤ìŒ ìœ„ì¹˜ì— ë°±ì—…ë˜ì—ˆìŠµë‹ˆë‹¤:\n{filePath}", "ë°±ì—… ì™„ë£Œ", MessageBoxButton.OK, MessageBoxImage.Information); return true; } catch (Exception ex) { StatusBarText = $"ë°ì´í„° ë°±ì—… ì‹¤íŒ¨: {ex.Message}"; MessageBox.Show($"ë°ì´í„° ë°±ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{ex.ToString()}", "ë°±ì—… ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); return false; } }
        private void WriteTableToCsv<T>(LockerDbContext context, StreamWriter writer) where T : class { var dbSet = context.Set<T>(); var entityType = typeof(T); var properties = entityType.GetProperties().Where(p => p.GetGetMethod().IsVirtual == false).ToList(); writer.WriteLine($"--- Table: {entityType.Name} ---"); writer.WriteLine(string.Join(",", properties.Select(p => EscapeCsvValue(p.Name)))); foreach (var entity in dbSet.AsNoTracking()) { var values = properties.Select(p => EscapeCsvValue(p.GetValue(entity)?.ToString() ?? "")); writer.WriteLine(string.Join(",", values)); } writer.WriteLine(); writer.WriteLine(); }
        private string EscapeCsvValue(string value) { if (string.IsNullOrEmpty(value)) return ""; if (value.Contains(",") || value.Contains("\"") || value.Contains("\r") || value.Contains("\n")) { return $"\"{value.Replace("\"", "\"\"")}\""; } return value; }
        #endregion

        #region Helper Methods (ì˜¤ë¥˜ ë©”ì‹œì§€ ìƒì„¸í™”)
        private void HandleGenericException(string operation, Exception ex) { StatusBarText = $"{operation} ì˜¤ë¥˜: {ex.Message}"; MessageBox.Show($"{operation} ì¤‘ ì˜ˆê¸°ì¹˜ ì•Šì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
        private void HandleDbUpdateException(DbUpdateException dbEx) { Exception innerMostException = dbEx; while (innerMostException.InnerException != null) innerMostException = innerMostException.InnerException; string innerExMsg = innerMostException.Message; var validationErrors = dbEx.Entries.SelectMany(e => e.GetValidationResult().ValidationErrors); string validationErrorMsg = ""; if (validationErrors.Any()) validationErrorMsg = "\n\nìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜:\n" + string.Join("\n", validationErrors.Select(err => $" - {err.PropertyName}: {err.ErrorMessage}")); StatusBarText = $"DB ì—…ë°ì´íŠ¸ ì˜¤ë¥˜: {innerExMsg}"; MessageBox.Show($"ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n{innerExMsg}{validationErrorMsg}\n\n(ì „ì²´ ì˜¤ë¥˜: {dbEx.ToString()})", "DB ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); try { foreach(var entry in dbEx.Entries) { entry.Reload(); } } catch { /* Reload ì‹¤íŒ¨ ë¬´ì‹œ */ } }
        private void HandleValidationException(DbEntityValidationException vex) { var errorMessages = vex.EntityValidationErrors.SelectMany(x => x.ValidationErrors).Select(x => $"{x.PropertyName}: {x.ErrorMessage}"); var fullErrorMessage = string.Join("\n", errorMessages); var exceptionMessage = $"ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜:\n{fullErrorMessage}"; StatusBarText = "ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜ ë°œìƒ"; MessageBox.Show(exceptionMessage, "ìœ íš¨ì„± ê²€ì‚¬ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); Debug.WriteLine($"!!! DbEntityValidationException ë°œìƒ:\n{exceptionMessage}\n{vex.ToString()}"); }
        private string ConvertToUnsecureString(SecureString securePassword) { if (securePassword == null) return string.Empty; IntPtr ptr = IntPtr.Zero; try { ptr = Marshal.SecureStringToGlobalAllocUnicode(securePassword); return Marshal.PtrToStringUni(ptr); } finally { Marshal.ZeroFreeGlobalAllocUnicode(ptr); } }
        #endregion

        #region Highlight Logic (ì‹ ê·œ)

        /// <summary>
        /// View(MainWindow.xaml.cs)ì—ì„œ í˜¸ì¶œí•  ë©”ì„œë“œ.
        /// ì„ íƒëœ ì…€ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•˜ì—¬ RowStyle ë°”ì¸ë”©ì´ ê°±ì‹ ë˜ë„ë¡ í•©ë‹ˆë‹¤.
        /// </summary>
        /// <param name="fieldName">í¬ì»¤ìŠ¤ëœ ì»¬ëŸ¼ì˜ FieldName</param>
        /// <param name="currentItem">í˜„ì¬ ì„ íƒëœ í–‰ì˜ ë°ì´í„° ê°ì²´ (LockerAssignment)</param>
        public void UpdateHighlightInfo(string fieldName, LockerAssignment currentItem)
        {
            // í•˜ì´ë¼ì´íŠ¸ë¥¼ ì ìš©í•  ì½¤ë³´ë°•ìŠ¤ ì»¬ëŸ¼ë“¤ ëª©ë¡
            var targetColumns = new List<string> { "LockerType", "Floor", "Zone", "SubPart", "Administrator" };

            if (currentItem != null && targetColumns.Contains(fieldName))
            {
                // ë¦¬í”Œë ‰ì…˜ì„ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ í•­ëª©ì—ì„œ í•´ë‹¹ í•„ë“œì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
                var propertyInfo = typeof(LockerAssignment).GetProperty(fieldName);
                if (propertyInfo != null)
                {
                    SelectedCellValue = propertyInfo.GetValue(currentItem);
                    SelectedCellColumnFieldName = fieldName;
                }
                else
                {
                    ClearHighlightInfo(); // ì†ì„±ì„ ì°¾ì§€ ëª»í•˜ë©´ ì´ˆê¸°í™”
                }
            }
            else
            {
                // ëŒ€ìƒ ì»¬ëŸ¼ì´ ì•„ë‹ˆê±°ë‚˜ ì„ íƒëœ í•­ëª©ì´ ì—†ìœ¼ë©´ í•˜ì´ë¼ì´íŠ¸ ì •ë³´ ì´ˆê¸°í™”
                ClearHighlightInfo();
            }

            // ì¤‘ìš”: ObservableCollectionì˜ ë³€ê²½ì„ ê°•ì œë¡œ ì•Œë ¤ RowStyleì´ ì¬í‰ê°€ë˜ë„ë¡ í•¨
            // (ë‹¨ìˆœ ì†ì„± ë³€ê²½ë§Œìœ¼ë¡œëŠ” RowStyleì˜ MultiBindingì´ ê°±ì‹ ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ)
            // ì•½ê°„ì˜ íŠ¸ë¦­: ì»¬ë ‰ì…˜ ìì²´ë¥¼ ë‹¤ì‹œ í• ë‹¹í•˜ê±°ë‚˜, ì„ì‹œ ë³€ê²½ì„ ê°€í–ˆë‹¤ ë˜ëŒë¦½ë‹ˆë‹¤.
            // ë˜ëŠ” ë” ë‚˜ì€ ë°©ë²•: RowStyle ë°”ì¸ë”©ì— ViewModel ìì²´ë¥¼ í¬í•¨ì‹œí‚¤ê³  PropertyChanged("SelectedCellValue") ë“±ì„ ë°œìƒì‹œí‚µë‹ˆë‹¤.
            // ì—¬ê¸°ì„œëŠ” ê°„ë‹¨íˆ PropertyChanged í˜¸ì¶œì„ ì‚¬ìš©í•©ë‹ˆë‹¤. (ViewModelBaseì— êµ¬í˜„ë¨)
            OnPropertyChanged(nameof(SelectedCellValue));
            OnPropertyChanged(nameof(SelectedCellColumnFieldName));
            // UI ìŠ¤ë ˆë“œì—ì„œ GridControlì˜ RefreshData()ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒë„ ë°©ë²•ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            // Application.Current.Dispatcher.Invoke(() => { /* gridControl.RefreshData(); */ });
        }

        /// <summary>
        /// í•˜ì´ë¼ì´íŠ¸ ì •ë³´ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
        /// </summary>
        private void ClearHighlightInfo()
        {
            SelectedCellValue = null;
            SelectedCellColumnFieldName = null;
        }

        #endregion

        #region IDisposable êµ¬í˜„ (CancellationToken ì·¨ì†Œ ì¶”ê°€)
        private bool disposed = false;
        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                if (disposing)
                {
                    _cts?.Cancel(); // ì§„í–‰ ì¤‘ì¸ ë¹„ë™ê¸° ì‘ì—… ì·¨ì†Œ ìš”ì²­
                    _cts?.Dispose();
                    _context?.Dispose(); // DbContext í•´ì œ
                    LogVM?.Dispose();    // LogViewModel í•´ì œ
                }
                disposed = true;
            }
        }
        public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }
        #endregion
    }
}
3. Infrastructure/HighlightRowConverter.cs (ì‹ ê·œ)

í–‰ ë°°ê²½ìƒ‰ì„ ì¡°ê±´ë¶€ë¡œ ë³€ê²½í•˜ëŠ” IMultiValueConverter êµ¬í˜„ì…ë‹ˆë‹¤. Infrastructure í´ë”ì— ì´ íŒŒì¼ì„ ì¶”ê°€í•˜ì„¸ìš”.

C#

using LockerManagementApp.Models; // LockerAssignment ëª¨ë¸ ì‚¬ìš©
using System;
using System.Globalization;
using System.Windows; // DependencyProperty, Visibility ì‚¬ìš©
using System.Windows.Data; // IMultiValueConverter ì‚¬ìš©
using System.Windows.Media; // Brush, Brushes ì‚¬ìš©

namespace LockerManagementApp.Infrastructure
{
    /// <summary>
    /// ì„ íƒëœ ì…€ì˜ ê°’ê³¼ í˜„ì¬ í–‰ì˜ í•´ë‹¹ ì»¬ëŸ¼ ê°’ì„ ë¹„êµí•˜ì—¬ ë°°ê²½ìƒ‰ì„ ë°˜í™˜í•˜ëŠ” MultiValueConverter ì…ë‹ˆë‹¤.
    /// </summary>
    public class HighlightRowConverter : IMultiValueConverter
    {
        // í•˜ì´ë¼ì´íŠ¸ ìƒ‰ìƒ (ë…¸ë€ìƒ‰)
        private static readonly Brush HighlightBrush = Brushes.Yellow;
        // ê¸°ë³¸ ë°°ê²½ìƒ‰ (ë˜ëŠ” í…Œë§ˆ ê¸°ë³¸ê°’ ì‚¬ìš©) - ì—¬ê¸°ì„œëŠ” UnsetValueë¥¼ ë°˜í™˜í•˜ì—¬ ê¸°ë³¸ê°’ ìœ ì§€
        // private static readonly Brush DefaultBrush = Brushes.Transparent;

        public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
        {
            // values ë°°ì—´ì—ëŠ” MultiBindingìœ¼ë¡œ ì „ë‹¬ëœ ê°’ë“¤ì´ ìˆœì„œëŒ€ë¡œ ë“¤ì–´ì˜µë‹ˆë‹¤.
            // [0]: í˜„ì¬ í–‰ì˜ DataContext (LockerAssignment ê°ì²´)
            // [1]: MainViewModelì˜ SelectedCellValue
            // [2]: MainViewModelì˜ SelectedCellColumnFieldName

            if (values == null || values.Length < 3 ||
                !(values[0] is LockerAssignment currentRow) || // í˜„ì¬ í–‰ ë°ì´í„° í™•ì¸
                values[1] == null || // ì„ íƒëœ ì…€ ê°’ í™•ì¸
                !(values[2] is string selectedFieldName) || // ì„ íƒëœ ì»¬ëŸ¼ í•„ë“œëª… í™•ì¸
                string.IsNullOrEmpty(selectedFieldName))
            {
                // í•„ìš”í•œ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ë°˜í™˜ (ë°°ê²½ìƒ‰ ë³€ê²½ ì—†ìŒ)
                return DependencyProperty.UnsetValue; // ë˜ëŠ” Brushes.Transparent ë“±
            }

            object selectedValue = values[1];

            try
            {
                // í˜„ì¬ í–‰(currentRow)ì—ì„œ ì„ íƒëœ ì»¬ëŸ¼(selectedFieldName)ì˜ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
                var propertyInfo = typeof(LockerAssignment).GetProperty(selectedFieldName);
                if (propertyInfo != null)
                {
                    object currentRowValue = propertyInfo.GetValue(currentRow);

                    // ì„ íƒëœ ì…€ ê°’ê³¼ í˜„ì¬ í–‰ì˜ ê°’ì„ ë¹„êµí•©ë‹ˆë‹¤. (null ì²˜ë¦¬ í¬í•¨)
                    if (Equals(selectedValue, currentRowValue))
                    {
                        // ê°’ì´ ê°™ìœ¼ë©´ í•˜ì´ë¼ì´íŠ¸ ìƒ‰ìƒ ë°˜í™˜
                        return HighlightBrush;
                    }
                }
            }
            catch (Exception ex)
            {
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë””ë²„ê·¸ ì¶œë ¥ (ì„ íƒ ì‚¬í•­)
                System.Diagnostics.Debug.WriteLine($"HighlightRowConverter ì˜¤ë¥˜: {ex.Message}");
            }

            // ì¡°ê±´ì— ë§ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ê°’ ë°˜í™˜
            return DependencyProperty.UnsetValue;
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
        {
            // ì—­ë³€í™˜ì€ í•„ìš”í•˜ì§€ ì•ŠìŒ
            throw new NotImplementedException();
        }
    }
}
í•µì‹¬ ë³€ê²½ ì‚¬í•­:

MainWindow.xaml:
ThemedWindowì— FontSize="14" (ë˜ëŠ” ì›í•˜ëŠ” í¬ê¸°) ì„¤ì • ì¶”ê°€.
LightBlueHeaderStyleì˜ HorizontalContentAlignment="Center" í™•ì¸ (ì´ë¯¸ ìˆì–´ì•¼ í•¨).
TableViewì— FocusedColumnChanged="TableView_FocusedColumnChanged" ë° CurrentItemChanged="TableView_CurrentItemChanged" ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì—°ê²° ì¶”ê°€.
TableView.RowStyleì„ ì •ì˜í•˜ê³  ConditionalRowHighlightStyle ë¦¬ì†ŒìŠ¤ë¥¼ ì°¸ì¡°í•˜ë„ë¡ ì„¤ì •.
ConditionalRowHighlightStyle ë¦¬ì†ŒìŠ¤ ì •ì˜: TargetType="dxg:RowControl", Background ì†ì„±ì— MultiBinding ì‚¬ìš© (HighlightRowConverter ë° ViewModel ì†ì„± ì°¸ì¡°).
<dx:ThemedWindow.Resources> ì•ˆì— <infra:HighlightRowConverter x:Key="HighlightRowConverter"/> ë¦¬ì†ŒìŠ¤ ì •ì˜ ì¶”ê°€.
MainViewModel.cs:
SelectedCellValue (object íƒ€ì…) ë° SelectedCellColumnFieldName (string íƒ€ì…) ì†ì„± ì¶”ê°€ (SetProperty ì‚¬ìš©).
UpdateHighlightInfo(string fieldName, LockerAssignment currentItem) ê³µê°œ ë©”ì„œë“œ ì¶”ê°€: Viewì˜ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ì—ì„œ í˜¸ì¶œë˜ì–´ ìœ„ ë‘ ì†ì„± ê°’ì„ ì—…ë°ì´íŠ¸í•˜ê³  OnPropertyChangedë¥¼ í˜¸ì¶œí•˜ì—¬ ë°”ì¸ë”© ê°±ì‹  íŠ¸ë¦¬ê±°.
ClearHighlightInfo() ë¹„ê³µê°œ í—¬í¼ ë©”ì„œë“œ ì¶”ê°€.
Infrastructure/HighlightRowConverter.cs (ì‹ ê·œ):
IMultiValueConverter ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„.
Convert ë©”ì„œë“œ: ì „ë‹¬ëœ ê°’(í–‰ ë°ì´í„°, ì„ íƒëœ ê°’, ì„ íƒëœ í•„ë“œëª…)ì„ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ í–‰ì˜ í•´ë‹¹ í•„ë“œ ê°’ê³¼ ì„ íƒëœ ì…€ ê°’ì„ ë¹„êµ. ê°™ìœ¼ë©´ Brushes.Yellow, ë‹¤ë¥´ë©´ DependencyProperty.UnsetValue ë°˜í™˜.
ì¶”ê°€ ì‘ì—…:
