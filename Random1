ëª¨ë‹ˆí„°ë§Œ ë” (ìµœëŒ€ ì ˆì „ X)
âœ… 15ì´ˆ ë™ì•ˆ ìž…ë ¥ ì—†ìœ¼ë©´ ëª¨ë‹ˆí„° OFF
âœ… ìž…ë ¥ ë°œìƒ ì‹œ ì¦‰ì‹œ ëª¨ë‹ˆí„° ON
âœ… íŠ¸ë ˆì´ë¡œ ìµœì†Œí™” ê°€ëŠ¥, ì¢…ë£Œ ê°€ëŠ¥
âœ… Windows 10/11 ì™„ë²½ ì§€ì›

ðŸ”¥ ìµœì‹  ì½”ë“œ (ìµœëŒ€ ì ˆì „ ì œê±° & ì¦‰ì‹œ ON/OFF)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Threading;
using System.Windows.Forms;

namespace MonitorAutoControl
{
    public partial class Form1 : Form
    {
        private static readonly int IDLE_TIME_LIMIT = 15000; // 15ì´ˆ
        private System.Threading.Timer _idleTimer;
        private NotifyIcon _trayIcon;
        private POINT _lastMousePosition;
        private bool _isMonitorOff = false;

        public Form1()
        {
            InitUI();
            InitTray();
            InitIdleTimer();
        }

        private void InitUI()
        {
            this.Text = "ëª¨ë‹ˆí„° ìžë™ OFF í”„ë¡œê·¸ëž¨";
            this.Size = new System.Drawing.Size(400, 200);
            this.FormClosing += Form1_FormClosing;

            Label label = new Label()
            {
                Text = "ëª¨ë‹ˆí„° ìžë™ OFF í”„ë¡œê·¸ëž¨ìž…ë‹ˆë‹¤",
                Dock = DockStyle.Fill,
                TextAlign = System.Drawing.ContentAlignment.MiddleCenter
            };
            this.Controls.Add(label);
        }

        private void InitTray()
        {
            _trayIcon = new NotifyIcon()
            {
                Icon = SystemIcons.Application,
                Visible = true,
                ContextMenuStrip = new ContextMenuStrip()
                {
                    Items = { new ToolStripMenuItem("ì¢…ë£Œ", null, (s, e) => ExitApplication()) }
                }
            };
            _trayIcon.DoubleClick += (s, e) => ShowMainForm();
        }

        private void InitIdleTimer()
        {
            _idleTimer = new System.Threading.Timer(CheckIdleState, null, 1000, 1000);
            GetCursorPos(out _lastMousePosition);
        }

        private void ShowMainForm()
        {
            this.Invoke(new Action(() =>
            {
                this.Show();
                this.WindowState = FormWindowState.Normal;
                this.Activate();
            }));
        }

        private void CheckIdleState(object state)
        {
            int idleTime = GetIdleTime();
            POINT currentMousePosition;
            GetCursorPos(out currentMousePosition);

            bool mouseMoved = (currentMousePosition.X != _lastMousePosition.X || currentMousePosition.Y != _lastMousePosition.Y);
            bool keyPressed = IsAnyKeyPressed();

            if (_isMonitorOff)
            {
                if (mouseMoved || keyPressed)
                {
                    WakeUpMonitor();
                }
            }
            else
            {
                if (idleTime > IDLE_TIME_LIMIT)
                {
                    TurnMonitorOff();
                }
            }

            _lastMousePosition = currentMousePosition;
        }

        private int GetIdleTime()
        {
            LASTINPUTINFO lastInputInfo = new LASTINPUTINFO();
            lastInputInfo.cbSize = Marshal.SizeOf(typeof(LASTINPUTINFO));

            if (GetLastInputInfo(ref lastInputInfo))
            {
                return Environment.TickCount - lastInputInfo.dwTime;
            }
            return 0;
        }

        private bool IsAnyKeyPressed()
        {
            for (int key = 0; key < 256; key++)
            {
                if (GetAsyncKeyState(key) != 0)
                {
                    return true;
                }
            }
            return false;
        }

        private void WakeUpMonitor()
        {
            if (_isMonitorOff)
            {
                // ëª¨ë‹ˆí„° ON
                SendMessage(GetDesktopWindow(), WM_SYSCOMMAND, (IntPtr)SC_MONITORPOWER, (IntPtr)MONITOR_ON);
                _isMonitorOff = false;
            }
        }

        private void TurnMonitorOff()
        {
            if (!_isMonitorOff)
            {
                // ëª¨ë‹ˆí„° OFF
                SendMessage(GetDesktopWindow(), WM_SYSCOMMAND, (IntPtr)SC_MONITORPOWER, (IntPtr)MONITOR_OFF);
                _isMonitorOff = true;
            }
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            e.Cancel = true;
            this.Hide();
        }

        private void ExitApplication()
        {
            _idleTimer.Dispose();
            _trayIcon.Dispose();
            Application.Exit();
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct LASTINPUTINFO
        {
            public int cbSize;
            public int dwTime;
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct POINT
        {
            public int X;
            public int Y;
        }

        [DllImport("user32.dll")]
        private static extern bool GetLastInputInfo(ref LASTINPUTINFO plii);

        [DllImport("user32.dll", SetLastError = true)]
        private static extern bool GetCursorPos(out POINT lpPoint);

        [DllImport("user32.dll")]
        private static extern short GetAsyncKeyState(int vKey);

        [DllImport("user32.dll", SetLastError = true)]
        private static extern IntPtr GetDesktopWindow();

        [DllImport("user32.dll", SetLastError = true)]
        private static extern IntPtr SendMessage(IntPtr hWnd, int Msg, IntPtr wParam, IntPtr lParam);

        private const int WM_SYSCOMMAND = 0x0112;
        private const int SC_MONITORPOWER = 0xF170;
        private const int MONITOR_ON = -1;
        private const int MONITOR_OFF = 2;

        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
}
âœ… ê¸°ëŠ¥ ì •ë¦¬
ëª¨ë“  ìž…ë ¥ì´ ì—†ìœ¼ë©´ 15ì´ˆ ë’¤ ëª¨ë‹ˆí„° OFF (ìµœëŒ€ ì ˆì „ X)
ìž…ë ¥ ê°ì§€ ì‹œ ì¦‰ì‹œ ëª¨ë‹ˆí„° ON
íŠ¸ë ˆì´ì—ì„œ ìµœì†Œí™” ê°€ëŠ¥, ì¢…ë£Œ ê°€ëŠ¥
Windows 10/11 ì™„ë²½ ì§€ì›
ðŸ“Œ ìµœì¢… í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸
 15ì´ˆ ë™ì•ˆ ìž…ë ¥ì´ ì—†ìœ¼ë©´ ëª¨ë‹ˆí„° ìžë™ OFF
 ìž…ë ¥ ì‹œ ì¦‰ì‹œ ëª¨ë‹ˆí„° ON
 Windows 10/11ì—ì„œ ì •ìƒ ìž‘ë™
 íŠ¸ë ˆì´ì—ì„œ ìµœì†Œí™” & ì¢…ë£Œ ê°€ëŠ¥