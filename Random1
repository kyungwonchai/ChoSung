using DevExpress.XtraRichEdit;
using System.Threading.Tasks;
using System.Windows.Forms;

// 백그라운드 작업을 위한 비동기 메서드
private async Task UpdateRichEditControlAsync(DataTable dataTable, RichEditControl richEditControl)
{
    // DataTable의 내용을 표 형태로 변환
    string tableHtml = ConvertDataTableToHtml(dataTable);

    // 백그라운드에서 RichEditControl 업데이트
    await Task.Run(() =>
    {
        richEditControl.Invoke(new MethodInvoker(() =>
        {
            // RichEditControl에 표 형태의 내용 설정
            richEditControl.Document.BeginUpdate();
            richEditControl.Document.HtmlText = tableHtml;
            richEditControl.Document.EndUpdate();
        }));
    });
}

// DataTable을 HTML 표 형태로 변환하는 메서드
private string ConvertDataTableToHtml(DataTable dataTable)
{
    string html = "<table>";

    // 테이블 헤더 생성
    html += "<tr>";
    foreach (DataColumn column in dataTable.Columns)
    {
        html += "<th>" + column.ColumnName + "</th>";
    }
    html += "</tr>";

    // 테이블 데이터 생성
    foreach (DataRow row in dataTable.Rows)
    {
        html += "<tr>";
        foreach (object item in row.ItemArray)
        {
            html += "<td>" + item.ToString() + "</td>";
        }
        html += "</tr>";
    }

    html += "</table>";

    return html;
}

// 예시로 사용하는 메서드
private async void LoadDataInBackground()
{
    // 예시로 DataTable 생성
    DataTable dataTable = new DataTable();
    dataTable.Columns.Add("Name", typeof(string));
    dataTable.Columns.Add("Age", typeof(int));
    dataTable.Rows.Add("John Doe", 30);
    dataTable.Rows.Add("Jane Smith", 25);

    // RichEditControl 업데이트를 백그라운드로 실행
    await UpdateRichEditControlAsync(dataTable, richEditControl1);
}
