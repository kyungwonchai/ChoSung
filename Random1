일을 수정하고, MainWindow.xaml.cs 파일을 다시 업데이트하겠습니다.

MainWindow.xaml 수정:
xaml
코드 복사
<Window x:Class="DataSyncApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Data Sync Application" Height="450" Width="800">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>
        
        <StackPanel Grid.Column="0" Margin="10">
            <TextBlock Text="General Log" FontWeight="Bold" Margin="0,0,0,10" />
            <ListBox x:Name="logListBox1" Height="200" Margin="0,0,0,10" />
            <TextBlock Text="ESD Check Log" FontWeight="Bold" Margin="0,0,0,10" />
            <ListBox x:Name="logListBox2" Height="200" Margin="0,0,0,10" />
            <Button Content="Load Data" HorizontalAlignment="Left" VerticalAlignment="Top" Click="LoadDataButton_Click" />
        </StackPanel>
        
        <Grid Grid.Column="1" Margin="10">
            <DataGrid x:Name="dataGrid" AutoGenerateColumns="False" Margin="0,30,0,0" CellEditEnding="DataGrid_CellEditEnding">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="USER_NAME" Binding="{Binding USER_NAME}" IsReadOnly="True"/>
                    <DataGridTextColumn Header="USER_CARD_ID" Binding="{Binding USER_CARD_ID}"/>
                    <DataGridTextColumn Header="E_NUM" Binding="{Binding E_NUM}" IsReadOnly="True"/>
                    <DataGridTextColumn Header="PROCESS" Binding="{Binding PROCESS}" IsReadOnly="True"/>
                    <DataGridTextColumn Header="GROUP_NAME" Binding="{Binding GROUP_NAME}" IsReadOnly="True"/>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</Window>
MainWindow.xaml.cs 수정:
csharp
코드 복사
using System;
using System.Data;
using System.Linq;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;

namespace DataSyncApp
{
    public partial class MainWindow : Window
    {
        private DataSync dataSync;
        private EsdCheckSync esdCheckSync;

        public MainWindow()
        {
            InitializeComponent();
            dataSync = new DataSync();
            esdCheckSync = new EsdCheckSync();

            Task.Run(() => dataSync.StartDataSyncAsync(LogAction1));
            Task.Run(() => esdCheckSync.StartDataSyncAsync(LogAction2));
        }

        private async void LoadDataButton_Click(object sender, RoutedEventArgs e)
        {
            await LoadGridControlAsync();
        }

        private async Task LoadGridControlAsync()
        {
            DataTable targetData = await dataSync.GetTargetDataAsync();

            var unmatchedRows = from target in targetData.AsEnumerable()
                                where string.IsNullOrEmpty(target.Field<string>("USER_CARD_ID"))
                                select new
                                {
                                    USER_NAME = target.Field<string>("USER_NAME"),
                                    USER_CARD_ID = "Not Matched",
                                    E_NUM = target.Field<string>("E_NUM"),
                                    PROCESS = target.Field<string>("PROCESS"),
                                    GROUP_NAME = target.Field<string>("GROUP_NAME")
                                };

            dataGrid.ItemsSource = unmatchedRows.ToList();

            foreach (var item in dataGrid.Items)
            {
                DataGridRow row = (DataGridRow)dataGrid.ItemContainerGenerator.ContainerFromItem(item);
                if (row != null && ((dynamic)row.Item).USER_CARD_ID == "Not Matched")
                {
                    row.Background = new SolidColorBrush(Colors.Red);
                }
            }
        }

        private void DataGrid_CellEditEnding(object sender, DataGridCellEditEndingEventArgs e)
        {
            if (e.Column.Header.ToString() == "USER_CARD_ID")
            {
                string userName = ((TextBox)e.EditingElement).Text;
                string userCardId = ((TextBox)e.EditingElement).Text;

                // Handle manual input for USER_CARD_ID
                // For example, you might update a local list or another table in the database.
            }
        }

        private void LogAction1(string message)
        {
            Dispatcher.Invoke(() =>
            {
                if (logListBox1.Items.Count >= 500)
                {
                    logListBox1.Items.Clear();
                }
                logListBox1.Items.Add(message);
            });
        }

        private void LogAction2(string message)
        {
            Dispatcher.Invoke(() =>
            {
                if (logListBox2.Items.Count >= 500)
                {
                    logListBox2.Items.Clear();
                }
                logListBox2.Items.Add(message);
            });
        }
    }
}
이제 MainWindow.xaml에는 두 개의 ListBox와 기존의 DataGrid가 포함되어 있으며, MainWindow.xaml.cs는 두 개의 로그 액션(LogAction1 및 LogAction2)을 처리하여 각각의 ListBox에 로그를 추가합니다. 두 개의 데이터 동기화 클래스(DataSync 및 EsdCheckSync)가 동