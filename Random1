import bpy

# 모든 오브젝트 삭제 - 초기화
bpy.ops.object.select_all(action='SELECT')
bpy.ops.object.delete(use_global=False)

# 텍스트 오브젝트 추가 및 설정
bpy.ops.object.text_add(location=(0, 0, 0))  # 텍스트 위치: 원점(0, 0, 0)
text_obj = bpy.context.object
text_obj.data.body = "Router ACR Middleware"  # 텍스트 내용 설정
text_obj.data.size = 1.5  # 텍스트 크기 설정
text_obj.data.extrude = 0.1  # 텍스트 두께 설정 (벡터 추출용이므로 약하게 설정)

# 카메라 위치 및 각도 설정 (카메라는 필요없지만 뷰 설정을 위해 기본값 유지)
bpy.ops.object.camera_add(location=(0, -6, 1.5))
camera = bpy.context.object
camera.rotation_euler = (1.5708, 0, 0)  # 텍스트를 정면에서 바라보게 설정

# Grease Pencil 오브젝트 추가
bpy.ops.object.gpencil_add(location=(0, 0, 0))
gpencil = bpy.context.object

# Grease Pencil에 새로운 레이어와 프레임 추가
gp_layer = gpencil.data.layers.new(name="GP_Layer", set_active=True)
gp_frame = gp_layer.frames.new(0)

# Grease Pencil의 윤곽선을 따라 그리기
bpy.ops.gpencil.stroke_placement_view3d()  # 3D 뷰에 Grease Pencil 설정
bpy.ops.gpencil.draw(type='STROKE')  # 윤곽선을 따라 Grease Pencil로 그리기

# SVG 파일로 내보내기
output_path = "C:/router_acr_middleware_text.svg"  # 실제 경로로 설정
bpy.ops.export.gpencil(filepath=output_path)  # Grease Pencil을 SVG로 내보내기
