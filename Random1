using Microsoft.Win32;
using System;
using System.Windows.Forms;

namespace ExcelRegistryExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void btnModifyRegistry_Click(object sender, EventArgs e)
        {
            const string excelRegistryKey = @"Software\Microsoft\Office\16.0\Excel\Options";
            const string excelPosValueName = "Pos";
            const string desiredPosValue = "0,0,1920,1280";

            try
            {
                using (RegistryKey key = Registry.CurrentUser.OpenSubKey(excelRegistryKey, true))
                {
                    if (key == null)
                    {
                        // Key does not exist, create it
                        using (RegistryKey newKey = Registry.CurrentUser.CreateSubKey(excelRegistryKey))
                        {
                            newKey.SetValue(excelPosValueName, desiredPosValue);
                        }
                    }
                    else
                    {
                        // Key exists, update the value
                        key.SetValue(excelPosValueName, desiredPosValue);
                    }
                }

                MessageBox.Show("레지스트리 수정이 완료되었습니다.");
            }
            catch (Exception ex)
            {
                MessageBox.Show($"레지스트리 수정 중 오류가 발생했습니다.\n\n{ex.Message}");
            }
        }
    }
}
