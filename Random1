엑셀에서 매크로 없이, 동적 드롭다운 목록을 만들어 C9 셀의 값에 따라 D9에 조건에 맞는 목록을 표시하려면 데이터 유효성 검사와 FILTER 함수를 활용하는 방법이 있습니다. 시트 yy의 A열에 있는 값을 중복 없이 표시할 수 있도록 처리하는 방법을 안내드리겠습니다.

방법 1: FILTER 함수와 데이터 유효성 검사를 활용하는 방법
시트 'yy'의 데이터 준비

시트 yy의 A열에 값들이 있다고 가정합니다. 예를 들어, A1
범위에 값이 있다고 가정할 수 있습니다.
중복 없이 값을 선택하는 조건으로 C9에 기준값이 설정됩니다 (예: "ABC").
유효성 검사에서 사용할 동적 범위 설정

중복을 제거하고 C9 셀 값에 따라 동적으로 필터링된 값을 표시하기 위해 FILTER 함수를 사용합니다.

예를 들어, 별도의 빈 셀 (예: Sheet1!E1 셀)에 아래의 수식을 입력합니다:

excel
코드 복사
=UNIQUE(FILTER(yy!A1:A100, yy!A1:A100=C9))
FILTER 함수는 C9 셀에 있는 값과 동일한 값만 yy!A1:A100 범위에서 필터링합니다.
UNIQUE 함수는 중복된 값을 제거해 줍니다.
이 수식이 E1에서 시작하는 동적 목록을 반환합니다.
데이터 유효성 검사 설정

D9 셀을 선택한 후, 데이터 유효성 검사 기능을 설정합니다.
데이터 탭 > 데이터 유효성 검사 > 데이터 유효성 대화 상자를 엽니다.

허용 옵션에서 목록을 선택합니다.

원본에 동적으로 필터링된 목록을 입력합니다. 수식으로 OFFSET을 사용해 동적 범위를 지정할 수 있습니다. 예를 들어:

excel
코드 복사
=OFFSET(Sheet1!$E$1, 0, 0, COUNTA(Sheet1!$E:$E), 1)
이 수식은 E1에서 시작하는 목록을 동적으로 생성하여 유효성 검사에서 사용할 수 있도록 합니다.

결과

이제, D9 셀을 클릭하면 C9 값에 따라 시트 yy의 A열에서 필터링된 중복 없는 값을 선택할 수 있는 드롭다운 목록이 나타납니다.
방법 2: 미리 정의된 테이블을 사용한 방법
만약 여러 가지 미리 정의된 조건에 따른 값 목록을 관리하고 싶다면, 테이블을 사전에 정의하고 이를 기반으로 유효성 검사 목록을 생성할 수 있습니다.

미리 정의된 테이블 생성

예를 들어, 시트 Lists에서 각 조건에 해당하는 값을 미리 정의한 테이블을 생성할 수 있습니다:
A1
: "ABC"에 해당하는 목록 (예: "Item1", "Item2", "Item3")
B1
: "DEF"에 해당하는 목록
이렇게 조건에 따른 목록들을 별도의 시트에 준비합니다.
이름 정의

해당 테이블에 이름을 정의합니다.
예: "ABC"라는 목록은 A1
범위에 대해 이름을 정의합니다 (수식 탭 > 이름 정의에서 설정).
"DEF"라는 목록도 마찬가지로 B1
범위에 이름을 정의합니다.
데이터 유효성 검사에서 이름 사용

D9 셀에서 유효성 검사 목록을 만들 때, C9 셀의 값을 참조하여 해당하는 목록 이름을 선택하도록 합니다.

데이터 유효성 검사 대화 상자의 원본에 다음과 같이 입력합니다:

excel
코드 복사
=INDIRECT(C9)
INDIRECT 함수는 C9 셀에 있는 텍스트 값을 목록 이름으로 해석하여 해당 목록을 선택할 수 있게 합니다.
결론
방법 1은 동적으로 시트 yy의 A열 값을 필터링하고 중복을 제거해 목록을 생성하는 방식으로, 데이터가 동적으로 변하는 경우에 유용합니다.