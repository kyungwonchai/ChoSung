using System.Drawing;
using System.Windows.Forms;
using System.IO;

// DataGridView와 RichTextBox 생성
DataGridView dataGridView = new DataGridView();
RichTextBox richTextBox = new RichTextBox();

// DataGridView에 데이터 바인딩
DataTable dataTable = new DataTable();
// DataTable에 데이터 추가 ...

dataGridView.DataSource = dataTable;

// DataGridView를 포함하는 Form 생성
Form form = new Form();
form.Controls.Add(dataGridView);

// Form의 크기를 DataGridView에 맞게 조정
form.ClientSize = new Size(dataGridView.Width + 20, dataGridView.Height + 20);

// DataGridView를 이미지로 캡처
Bitmap bitmap = new Bitmap(dataGridView.Width, dataGridView.Height);
dataGridView.DrawToBitmap(bitmap, new Rectangle(0, 0, dataGridView.Width, dataGridView.Height));

// RichTextBox에 기존 내용 및 이미지 추가
richTextBox.AppendText("기존 내용\n");

// 이미지를 RichTextBox에 추가
Clipboard.SetImage(bitmap);
richTextBox.Paste();

// RichTextBox에 삽입된 이미지 아래에 새로운 줄 추가
richTextBox.AppendText("\n");

// RichTextBox에 있는 내용 출력
Console.WriteLine(richTextBox.Text);

// 사용이 끝난 후, 폼을 닫고 리소스 해제
form.Close();
form.Dispose();
