Excel.Application xlApp = new Excel.Application();
Excel.Workbook xlWorkbook = xlApp.Workbooks.Open(@"경로"); // 여기에 엑셀 파일 경로를 넣으세요
Excel._Worksheet xlWorksheet = xlWorkbook.Sheets[1];
Excel.Range xlRange = xlWorksheet.UsedRange;

int rowCount = xlRange.Rows.Count;
int colCount = xlRange.Columns.Count;

DataTable dt = new DataTable();

// 데이터테이블 컬럼 생성
for (int col = 1; col <= colCount; col++)
{
    dt.Columns.Add("Column" + col.ToString());
}

// Excel의 데이터를 DataTable에 삽입
for (int row = 1; row <= rowCount; row++)
{
    DataRow dr = dt.NewRow();
    for (int col = 1; col <= colCount; col++)
    {
        dr[col - 1] = xlRange.Cells[row, col].Value ?? DBNull.Value;
    }
    dt.Rows.Add(dr);
}

string connectionString = "여기에 DB 연결 문자열"; // 여기에 연결 문자열을 넣으세요
using (SqlConnection connection = new SqlConnection(connectionString))
{
    connection.Open();
    using (SqlBulkCopy bulkCopy = new SqlBulkCopy(connection))
    {
        bulkCopy.DestinationTableName = "테이블명"; // 여기에 대상 테이블명을 입력하세요
        bulkCopy.WriteToServer(dt);
    }
}

xlWorkbook.Close();
xlApp.Quit();
