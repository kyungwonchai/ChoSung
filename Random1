Excel VBA에서 문자열을 다룰 때 큰따옴표(")는 문자열의 시작과 끝을 나타내는 구분자로 사용됩니다. 그런데 셀에 입력하려는 수식(Formula)이나 문자열 자체에 큰따옴표가 포함되어야 하는 경우가 있습니다. 이때 VBA는 어떤 큰따옴표가 구분자이고 어떤 것이 실제 문자열의 일부인지 혼동할 수 있습니다.

이 문제를 해결하고 혼동을 피하는 방법과 작성 규칙은 다음과 같습니다.

핵심 규칙: 문자열 내부에 큰따옴표를 사용하려면 큰따옴표를 두 번 연속으로 사용합니다 ("").

VBA는 문자열 리터럴 내에서 두 개의 연속된 큰따옴표("")를 만나면, 이를 문자열의 끝으로 해석하지 않고 하나의 실제 큰따옴표 문자로 해석합니다.

예시를 통해 이해하기

단순 문자열에 큰따옴표 포함하기

만약 셀 A1에 그는 "안녕하세요"라고 말했다. 라는 텍스트를 입력하고 싶다면:

VBA

Sub AddTextWithQuotes()
    Range("A1").Value = "그는 ""안녕하세요""라고 말했다."
End Sub
"그는 " : 문자열 시작
""안녕하세요"" : VBA는 ""를 만나 " (하나의 큰따옴표)로 해석합니다. 즉, "안녕하세요"가 됩니다.
"라고 말했다." : 나머지 문자열
결과적으로 셀 A1에는 그는 "안녕하세요"라고 말했다. 가 입력됩니다.
수식(Formula)에 큰따옴표 포함하기

만약 셀 A1에 =IF(B1="완료","OK","진행중") 이라는 수식을 입력하고 싶다면:

VBA

Sub AddFormulaWithQuotes()
    Range("A1").Formula = "=IF(B1=""완료"",""OK"",""진행중"")"
End Sub
"=IF(B1=" : 수식의 시작 부분
""완료"" : 수식 내의 문자열 "완료"를 나타내기 위해 ""를 두 번 사용합니다.
"," : 수식의 구분자
""OK"" : 수식 내의 문자열 "OK"
"," : 수식의 구분자
""진행중"" : 수식 내의 문자열 "진행중"
")" : 수식의 마무리
결과적으로 셀 A1에는 =IF(B1="완료","OK","진행중") 수식이 올바르게 입력됩니다.
작성 규칙 및 팁

문자열 구분자: VBA 코드에서 문자열은 항상 한 쌍의 큰따옴표(")로 감싸야 합니다.

VBA

Dim myString As String
myString = "이것은 문자열입니다."
문자열 내 큰따옴표: 문자열 자체에 큰따옴표 문자를 포함시키고 싶다면, 해당 위치에 큰따옴표를 두 개 연속("")으로 입력합니다.

VBA

myString = "따옴표 ""이 안에"" 있습니다." ' 결과: 따옴표 "이 안에" 있습니다.
Chr(34) 함수 사용: 또 다른 방법은 큰따옴표의 ASCII 코드 값인 34를 Chr() 함수와 함께 사용하는 것입니다. 가독성 측면에서 여러 개의 따옴표가 중첩될 때 유리할 수 있습니다.

VBA

Sub AddFormulaWithChr34()
    Dim quote As String
    quote = Chr(34) ' 큰따옴표 문자

    Range("A1").Formula = "=IF(B1=" & quote & "완료" & quote & "," & quote & "OK" & quote & "," & quote & "진행중" & quote & ")"
End Sub
이 방법은 ""를 사용하는 것보다 코드가 길어질 수 있지만, 각 큰따옴표의 역할을 명확히 구분하고 싶을 때 유용합니다.

변수 활용: 복잡한 수식이나 문자열을 만들 때는 중간중간 변수를 활용하여 문자열을 조립하면 가독성을 높이고 오류를 줄일 수 있습니다.

VBA

Sub ComplexFormula()
    Dim criteria As String
    Dim trueValue As String
    Dim falseValue As String
    Dim formulaString As String

    criteria = """완료"""  ' "완료" 문자열 (양쪽에 따옴표 포함)
    trueValue = """OK"""    ' "OK" 문자열
    falseValue = """진행중""" ' "진행중" 문자열

    formulaString = "=IF(B1=" & criteria & "," & trueValue & "," & falseValue & ")"
    ' formulaString 변수의 값: =IF(B1="완료","OK","진행중")

    Range("A1").Formula = formulaString
End Sub
위 예제에서 criteria = """완료"""는 criteria = Chr(34) & "완료" & Chr(34)와 동일한 결과를 줍니다. """는 바깥쪽 두 개가 VBA 문자열 구분자이고, 안쪽 ""가 실제 큰따옴표 하나를 의미합니다.

요약

VBA에서 문자열 내에 실제 큰따옴표(")를 넣고 싶으면, **"" (큰따옴표 두 개)**를 사용합니다.
또는 Chr(34)를 사용하여 큰따옴표 문자를 표현할 수 있습니다.
복잡한 경우 변수를 활용하여 문자열을 단계별로 만드는 것이 좋습니다.
이 규칙들을 따르면 VBA에서 문자열 내 큰따옴표를 정확하게 처리하여 원하는 수식이나 텍스트를 셀에 올바르게 입력할 수 있습니다.