using System;
using System.IO;
using DevExpress.XtraBars.Ribbon;
using DevExpress.XtraBars;

class Program
{
    static void Main()
    {
        // 파일 경로
        string filePath = @"C:\agent\menu123.txt";

        // 파일이 이미 존재하면 삭제
        if (File.Exists(filePath))
        {
            File.Delete(filePath);
        }

        // 파일 생성
        using (StreamWriter writer = new StreamWriter(filePath, true))
        {
            foreach (RibbonPage ribbonPage in ribbonK.Pages)
            {
                foreach (RibbonPageGroup ribbonGroup in ribbonPage.Groups)
                {
                    foreach (BarItemLink barItemLink in ribbonGroup.ItemLinks)
                    {
                        if (barItemLink.Item is BarButtonItem barButtonItem)
                        {
                            // 버튼 텍스트에서 줄바꿈을 \r\n으로 변환
                            string buttonText = barButtonItem.Caption.Replace("\r", "\\r").Replace("\n", "\\n");

                            // 버튼 이름 추가
                            string buttonName = barButtonItem.Name;

                            // "Page^Group^ButtonText^ButtonName" 형식으로 파일에 기록
                            string line = $"{ribbonPage.Text}^{ribbonGroup.Text}^{buttonText}^{buttonName}";
                            writer.WriteLine(line);
                        }
                    }
                }
            }
        }

        // 디버그로 완료 메시지 출력
        Debug.WriteLine("Menu information exported to C:\\agent\\menu123.txt");
    }
}
