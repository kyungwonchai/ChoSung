다. 먼저, SQL 쿼리와 C# 코드를 구분하여 설명드리겠습니다.

MSSQL2014 쿼리
기본 테이블 구조:
MainTable에는 고유한 값만 저장됩니다. 이 테이블에는 중복을 허용하지 않습니다.
ExistAlreadyTable에는 중복된 값을 저장합니다. 중복을 허용합니다.
sql
코드 복사
-- 메인 테이블 (MainTable): 고유값(Unique)과 BB 값 저장
CREATE TABLE MainTable (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    UniqueValue NVARCHAR(20) NOT NULL UNIQUE,
    BBValue NVARCHAR(100) NOT NULL
);

-- 중복된 값이 있을 경우 기록하는 테이블 (ExistAlreadyTable)
CREATE TABLE ExistAlreadyTable (
    ID INT IDENTITY(1,1) PRIMARY KEY,
    DuplicateValue NVARCHAR(20) NOT NULL,
    BBValue NVARCHAR(100) NOT NULL,
    InsertedDate DATETIME DEFAULT GETDATE()
);
INSERT 작업을 위한 쿼리:
이 쿼리는 먼저 메인 테이블에 값이 있는지 확인한 후, 없으면 메인 테이블에 삽입하고, 있으면 ExistAlreadyTable에 기록합니다.
sql
코드 복사
DECLARE @inputValue NVARCHAR(20) = 'yourInputValue'; -- 입력 받을 값
DECLARE @BBValue NVARCHAR(100) = 'yourBBValue'; -- BB 변수 값

-- 값이 메인 테이블에 있는지 체크
IF EXISTS (SELECT 1 FROM MainTable WHERE UniqueValue = @inputValue)
BEGIN
    -- 이미 존재하면 ExistAlreadyTable에 기록
    INSERT INTO ExistAlreadyTable (DuplicateValue, BBValue)
    VALUES (@inputValue, @BBValue);
END
ELSE
BEGIN
    -- 존재하지 않으면 MainTable에 삽입
    INSERT INTO MainTable (UniqueValue, BBValue)
    VALUES (@inputValue, @BBValue);
END
C# 코드 (MSSQL 연결 및 쿼리 실행)
데이터베이스 연결 및 처리:
C# 코드에서는 SqlConnection과 SqlCommand를 사용하여 위 쿼리를 실행합니다.
csharp
코드 복사
using System;
using System.Data.SqlClient;

class Program
{
    static void Main(string[] args)
    {
        // 입력값 설정
        string inputValue = "yourInputValue";  // DB에 넣을 값
        string bbValue = "yourBBValue";        // BB 변수 값

        // 데이터베이스 연결 문자열
        string connectionString = "Server=yourServer;Database=yourDatabase;User Id=yourUsername;Password=yourPassword;";

        // SQL 쿼리
        string query = @"
        DECLARE @inputValue NVARCHAR(20) = @inputParam;
        DECLARE @BBValue NVARCHAR(100) = @bbParam;

        IF EXISTS (SELECT 1 FROM MainTable WHERE UniqueValue = @inputValue)
        BEGIN
            INSERT INTO ExistAlreadyTable (DuplicateValue, BBValue)
            VALUES (@inputValue, @BBValue);
        END
        ELSE
        BEGIN
            INSERT INTO MainTable (UniqueValue, BBValue)
            VALUES (@inputValue, @BBValue);
        END";

        // 데이터베이스 연결 및 실행
        using (SqlConnection connection = new SqlConnection(connectionString))
        {
            try
            {
                connection.Open();
                using (SqlCommand command = new SqlCommand(query, connection))
                {
                    // 파라미터 추가
                    command.Parameters.AddWithValue("@inputParam", inputValue);
                    command.Parameters.AddWithValue("@bbParam", bbValue);

                    // 쿼리 실행
                    int rowsAffected = command.ExecuteNonQuery();
                    Console.WriteLine("쿼리가 성공적으로 실행되었습니다. 처리된 행 수: " + rowsAffected);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine("오류 발생: " + ex.Message);
            }
        }
    }
}
설명:
SQL 쿼리:

먼저 MainTable에 입력값이 있는지 확인합니다. 값이 존재하면 ExistAlreadyTable에 중복값을 기록하고, 값이 없으면 MainTable에 입력값과 BB 값을 저장합니다.
UniqueValue 컬럼은 고유값으로, 중복 삽입이 불가능합니다.
C# 코드:

SqlConnection을 사용해 MSSQL 데이터베이스에 연결하고, 파라미터화된 쿼리를 실행합니다.
@inputParam과 @bbParam으로 입력값과 BB 값을 전달합니다.
쿼리를 실행한 후, 결과로 변경된 행의 수를 출력합니다.
이 방법으로 DB에 있는지 확인하고, 중복 여부에 따라 다르게 처리할 수 있습