아래는 VBA를 사용하여 태그정리 시트의 데이터를 읽고, 새로운 태그결과 시트에 XML 형식으로 정리하는 매크로 코드입니다. 기존 태그결과 시트가 있다면 삭제 후 새로 생성하며, 결과는 **2열(태그값)**과 **1열(밸류값)**을 기반으로 작성됩니다.

VBA 코드
vba
코드 복사
Sub CreateTagResultSheet()
    Dim wsSource As Worksheet
    Dim wsResult As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim tagName As String
    Dim tagValue As String
    Dim resultRow As Long
    
    ' 데이터가 있는 시트 확인
    On Error Resume Next
    Set wsSource = ThisWorkbook.Worksheets("태그정리")
    On Error GoTo 0
    If wsSource Is Nothing Then
        MsgBox "태그정리 시트를 찾을 수 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 태그결과 시트 삭제
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsResult = ThisWorkbook.Worksheets("태그결과")
    If Not wsResult Is Nothing Then wsResult.Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' 태그결과 시트 생성
    Set wsResult = ThisWorkbook.Sheets.Add
    wsResult.Name = "태그결과"
    
    ' 태그정리 시트의 마지막 행 가져오기
    lastRow = wsSource.Cells(wsSource.Rows.Count, 2).End(xlUp).Row
    If lastRow < 2 Then
        MsgBox "태그정리 시트에 데이터가 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 태그결과 시트에 XML 형식으로 작성
    resultRow = 1 ' 결과 시트의 첫 행
    wsResult.Cells(resultRow, 1).Value = "<리소스파일>"
    resultRow = resultRow + 1
    
    For i = 2 To lastRow
        tagName = wsSource.Cells(i, 2).Value ' 2열: 태그값
        tagValue = wsSource.Cells(i, 1).Value ' 1열: 밸류값
        
        ' 비어있는 값은 건너뜀
        If tagName <> "" And tagValue <> "" Then
            wsResult.Cells(resultRow, 1).Value = "<Data name=""" & tagName & """ xml:space=""preserve"">"
            wsResult.Cells(resultRow + 1, 1).Value = "  <value>" & tagValue & "</value>"
            wsResult.Cells(resultRow + 2, 1).Value = "</Data>"
            resultRow = resultRow + 3
        End If
    Next i
    
    ' 닫는 태그 추가
    wsResult.Cells(resultRow, 1).Value = "</리소스파일>"
    
    ' 결과 시트 컬럼 폭 자동 조정
    wsResult.Cells.EntireColumn.AutoFit
    
    MsgBox "태그결과 시트 생성이 완료되었습니다.", vbInformation
End Sub
코드 설명
소스 시트 및 결과 시트 확인:

태그정리 시트를 확인하고, 데이터가 없으면 오류 메시지를 표시합니다.
기존의 태그결과 시트가 있으면 삭제 후 새로 생성합니다.
데이터 처리:

태그정리 시트의 **2열(태그값)**과 **1열(밸류값)**을 읽어와 XML 형식으로 작성합니다.
데이터는 <Data> 태그로 감싸져 저장됩니다.
빈 태그나 값은 무시합니다.
XML 형식 작성:

각 태그는 다음 형식으로 작성됩니다:
xml
코드 복사
<Data name="태그이름" xml:space="preserve">
  <value>값</value>
</Data>
결과 시트:

최종 결과는 태그결과라는 새 시트에 작성됩니다.
컬럼 폭은 자동으로 조정됩니다.
사용 방법