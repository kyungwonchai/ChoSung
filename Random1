ibbonControl에 동적으로 커스텀 버튼을 추가할 때, 페이지와 그룹, 버튼 이름 등의 파라미터를 받아 유연하게 구성할 수 있도록 코드를 개선하였습니다. 또한, RibbonControl의 이름을 ribbonK로 설정하였습니다.

1. 버튼 설정을 위한 클래스 및 딕셔너리 정의:

각 버튼의 속성을 관리하기 위해 ButtonConfig 클래스를 정의하고, 이를 저장하는 딕셔너리를 생성합니다.

csharp
코드 복사
using DevExpress.XtraBars;
using DevExpress.XtraBars.Ribbon;
using System.Collections.Generic;
using System.Drawing; // Image를 사용하기 위해 필요
using System.Linq;
using System.Windows.Forms;

public partial class MainForm : RibbonForm
{
    // 버튼 설정을 위한 클래스 정의
    public class ButtonConfig
    {
        public string PageName { get; set; }
        public string GroupName { get; set; }
        public string ButtonName { get; set; }
        public string Caption { get; set; }
        public string Tag { get; set; }
        public Image Image { get; set; }
        public RibbonItemStyles Style { get; set; }
    }

    // 버튼 설정을 저장할 딕셔너리
    private Dictionary<string, ButtonConfig> buttonConfigs = new Dictionary<string, ButtonConfig>
    {
        { "btnNew", new ButtonConfig { PageName = "File", GroupName = "FileOperations", ButtonName = "btnNew", Caption = "새로 만들기", Tag = "NewDocument", Image = Properties.Resources.NewIcon, Style = RibbonItemStyles.Large } },
        { "btnOpen", new ButtonConfig { PageName = "File", GroupName = "FileOperations", ButtonName = "btnOpen", Caption = "열기", Tag = "OpenDocument", Image = Properties.Resources.OpenIcon, Style = RibbonItemStyles.Large } },
        { "btnSave", new ButtonConfig { PageName = "File", GroupName = "FileOperations", ButtonName = "btnSave", Caption = "저장", Tag = "SaveDocument", Image = Properties.Resources.SaveIcon, Style = RibbonItemStyles.Large } },
        { "btnPrint", new ButtonConfig { PageName = "File", GroupName = "Print", ButtonName = "btnPrint", Caption = "인쇄", Tag = "PrintDocument", Image = Properties.Resources.PrintIcon, Style = RibbonItemStyles.Large } },
        { "btnCut", new ButtonConfig { PageName = "Edit", GroupName = "Clipboard", ButtonName = "btnCut", Caption = "잘라내기", Tag = "CutText", Image = Properties.Resources.CutIcon, Style = RibbonItemStyles.SmallWithText } },
        { "btnCopy", new ButtonConfig { PageName = "Edit", GroupName = "Clipboard", ButtonName = "btnCopy", Caption = "복사", Tag = "CopyText", Image = Properties.Resources.CopyIcon, Style = RibbonItemStyles.SmallWithText } },
        { "btnPaste", new ButtonConfig { PageName = "Edit", GroupName = "Clipboard", ButtonName = "btnPaste", Caption = "붙여넣기", Tag = "PasteText", Image = Properties.Resources.PasteIcon, Style = RibbonItemStyles.SmallWithText } },
        { "btnUndo", new ButtonConfig { PageName = "Edit", GroupName = "History", ButtonName = "btnUndo", Caption = "실행 취소", Tag = "UndoAction", Image = Properties.Resources.UndoIcon, Style = RibbonItemStyles.SmallWithText } },
        { "btnRedo", new ButtonConfig { PageName = "Edit", GroupName = "History", ButtonName = "btnRedo", Caption = "다시 실행", Tag = "RedoAction", Image = Properties.Resources.RedoIcon, Style = RibbonItemStyles.SmallWithText } },
        { "btnHelp", new ButtonConfig { PageName = "Help", GroupName = "Support", ButtonName = "btnHelp", Caption = "도움말", Tag = "Help", Image = Properties.Resources.HelpIcon, Style = RibbonItemStyles.SmallWithText } }
    };

    public MainForm()
    {
        InitializeComponent();

        // 커스텀 버튼 추가 메서드 호출
        AddCustomButtons();

        // 체크박스 생성 및 설정
        CheckBox toggleButtonVisibilityCheckBox = new CheckBox
        {
            Text = "커스텀 버튼 표시",
            Checked = true, // 기본적으로 체크 상태 (버튼 표시)
            AutoSize = true,
            Dock = DockStyle.Top
        };

        // 체크박스의 체크 상태 변경 이벤트 핸들러 등록
        toggleButtonVisibilityCheckBox.CheckedChanged += ToggleButtonVisibilityCheckBox_CheckedChanged;

        // 체크박스를 폼에 추가
        this.Controls.Add(toggleButtonVisibilityCheckBox);
    }

    private void AddCustomButtons()
    {
        // RibbonControl 인스턴스가 'ribbonK'라고 가정합니다.

        // 딕셔너리를 순회하며 버튼 생성 및 추가
        foreach (var config in buttonConfigs.Values)
        {
            // RibbonPage 찾기
            RibbonPage page = ribbonK.Pages.FirstOrDefault(p => p.Name == config.PageName);
            if (page == null)
            {
                // 페이지가 없으면 생성하여 추가
                page = new RibbonPage(config.PageName) { Text = config.PageName };
                ribbonK.Pages.Add(page);
            }

            // RibbonPageGroup 찾기
            RibbonPageGroup group = page.Groups.FirstOrDefault(g => g.Name == config.GroupName);
            if (group == null)
            {
                // 그룹이 없으면 생성하여 추가
                group = new RibbonPageGroup(config.GroupName) { Text = config.GroupName };
                page.Groups.Add(group);
            }

            // BarButtonItem 생성
            BarButtonItem newButton = new BarButtonItem
            {
                Name = config.ButtonName,
                Caption = config.Caption,
                Tag = config.Tag,
                Id = ribbonK.Manager.GetNewItemId(),
                ImageOptions = { Image = config.Image },
                RibbonStyle = config.Style
            };

            // 그룹에 새로운 버튼 추가
            group.ItemLinks.Add(newButton);
        }
    }

    private void ToggleButtonVisibilityCheckBox_CheckedChanged(object sender, System.EventArgs e)
    {
        CheckBox checkBox = sender as CheckBox;
        bool isChecked = checkBox.Checked;

        // 딕셔너리에 정의된 버튼들의 가시성 설정
        foreach (var config in buttonConfigs.Values)
        {
            BarButtonItem button = ribbonK.Items.OfType<BarButtonItem>().FirstOrDefault(b => b.Name == config.ButtonName);
            if (button != null)
            {
                button.Visibility = isChecked ? BarItemVisibility.Always : BarItemVisibility.Never;
            }
        }
    }
}
코드 설명:
