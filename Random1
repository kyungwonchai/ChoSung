예시: 동적 범위로 최소한의 정렬 구간만 지정
예를 들어, A열~F열까지 정렬하고자 할 때:

vba
코드 복사
Sub DynamicSort()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim sortRange As Range

    Set ws = ThisWorkbook.Sheets("Sheet1")

    ' ✅ 마지막 데이터 행 구하기 (예: A열 기준)
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' ✅ 정렬 범위 (A열~F열, 5행부터 마지막까지)
    Set sortRange = ws.Range("A5:F" & lastRow)

    ' ✅ 기존 정렬 필드 초기화
    ws.Sort.SortFields.Clear

    ' ✅ 필요한 만큼 정렬 기준 설정
    ws.Sort.SortFields.Add Key:=ws.Range("A5:A" & lastRow), Order:=xlAscending
    ws.Sort.SortFields.Add Key:=ws.Range("B5:B" & lastRow), Order:=xlAscending
    ws.Sort.SortFields.Add Key:=ws.Range("C5:C" & lastRow), Order:=xlAscending

    ' ✅ 정렬 실행
    With ws.Sort
        .SetRange sortRange
        .Header = xlNo  ' 헤더가 있다면 xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .Apply
    End With
End Sub
✅ 최소 범위 지정 팁
**정렬 대상 범위 (SetRange)**는 정렬 기준 열들을 포함하는 직사각형 범위여야 합니다.
정렬 기준은 열 하나만 따로 범위 줘도 되고,
전체 정렬 대상은 꼭 A5:F + lastRow 형식으로 최소화할 수 있습니다.
✅ 참고: 열 자동 감지 (데이터가 있는 마지막 열까지)
vba
코드 복사
Dim lastCol As Long
lastCol = ws.Cells(5, ws.Columns.Count).End(xlToLeft).Column
Set sortRange = ws.Range(ws.Cells(5, 1), ws.Cells(lastRow, lastCol))