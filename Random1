상황을 정확히 이해했습니다. 진짜 스캐너와 가상 장치를 동시에 사용할 수 있어야 하며, 스캐너와 가상 장치 간에 자유롭게 전환할 수 있어야 합니다. 이를 위해, 스캐너와 가상 COM 포트를 모두 COM5로 연결할 수 있는 가상 시리얼 포트 리다이렉션 설정이 필요합니다.

이를 구현하기 위해서는 com0com과 hub4com이라는 도구를 함께 사용해야 합니다. hub4com은 실제 장치(스캐너)와 가상 장치를 모두 동일한 COM 포트로 연결하는 허브 역할을 합니다. 아래는 그 절차입니다.

1. 필요한 도구 설치
1.1. com0com 설치
com0com을 다운로드하고 설치합니다.
설치 중에 드라이버 서명 경고가 나타날 수 있습니다. 이 경우, "드라이버 설치 허용"을 선택하세요.
1.2. hub4com 설치
hub4com도 com0com 패키지와 함께 설치됩니다. 이 도구를 사용하여 가상 포트를 연결할 수 있습니다.
2. 가상 포트 페어 생성
Setup Command Prompt를 관리자 권한으로 실행합니다.
다음 명령어로 가상 포트 페어를 생성합니다:
bash
코드 복사
install PortName=COM6 PortName=COM7
이 명령어는 COM6과 COM7이라는 가상 포트를 생성합니다.
3. 실제 스캐너와 가상 포트 연결
이제 실제 스캐너와 가상 장치를 모두 COM5로 연결하기 위해 hub4com을 설정합니다.

hub4com 명령어 실행:
다음 명령어를 사용하여 hub4com을 실행합니다:
bash
코드 복사
hub4com --baud=9600 --byte-size=8 --parity=n --stop-bits=1 --cobaud=9600 --cof="\\.\COM5" COM6 \\.\COM5
여기서 \\.\COM5는 실제 스캐너가 연결된 COM 포트입니다.
COM6은 PGMA 프로그램이 사용할 가상 포트입니다.
이 설정으로, 실제 스캐너와 가상 장치 모두 COM5로 연결됩니다. PGMA 프로그램에서 COM6으로 데이터를 받아도 실제 스캐너로부터 데이터를 수신할 수 있으며, 가상 장치로 데이터를 보낼 수도 있습니다.
4. 데이터 전송 시뮬레이션
데이터 송신 프로그램 준비:
데이터 전송을 시뮬레이션하려면, 시리얼 통신 도구(예: Tera Term, PuTTY 등)를 사용하여 COM7 포트로 데이터를 전송합니다.
이 데이터는 hub4com을 통해 COM6으로 전달되며, PGMA 프로그램에서 마치 스캐너로부터 받은 것처럼 인식됩니다.
5. 포트 페어 유지 및 전환
스캐너와 가상 장치 간의 전환:
이 설정에서는 실제 스캐너와 가상 장치가 모두 COM5를 통해 데이터를 전달하므로, 필요에 따라 자유롭게 전환할 수 있습니다.
스캐너를 사용하려면 스캐너를 통해 데이터를 보내고, 가상 데이터를 사용하려면 COM7 포트를 통해 데이터를 전송하면 됩니다.
6. 가상 포트 페어 삭제 (필요 시)
포트 페어 삭제:
가상 포트를 삭제해야 할 경우, Setup Command Prompt에서 다음 명령어를 실행합니다:
bash
코드 복사
uninstall PortName=COM6
uninstall PortName=COM7
이 설정을 통해 실제 스캐너와 가상 장치를 모두 COM5로 연결하여 사용할 수 있습니다. PGMA 프로그램은 스캐너에서 데이터를 받거나, 가상 장치에서 데이터를 수신하는 방식을 유연하게 전환할 수 있습니다.

다시 한번 혼란을 드려 죄송합니다. 추가적으로 질문이 있거나 문제가 발생한다면 언제든지 알