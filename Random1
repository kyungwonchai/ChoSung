진 피벗 테이블에서 특정 조건에 맞는 필드만 체크하는 VBA 코드를 제공하겠습니다. 이 코드는 피벗 테이블의 필드 중에서 이름이 6자리 숫자이며 2로 시작하는 필드들만 체크합니다.

vba

Sub SelectSpecificFieldsInPivot()
    Dim ws As Worksheet
    Dim pt As PivotTable
    Dim pf As PivotField
    Dim item As PivotItem
    Dim field As String
    
    ' "SOP 14주" 시트 설정
    Set ws = ThisWorkbook.Sheets("SOP 14주")

    ' "피벗테이블1" 피벗 테이블 설정
    Set pt = ws.PivotTables("피벗테이블1")

    ' 피벗 필드를 순회하면서 조건에 맞는 필드 선택
    For Each pf In pt.PivotFields
        field = pf.Name
        ' 필드 이름이 6자리 숫자이며 2로 시작하는 경우
        If Len(field) = 6 And IsNumeric(field) And Left(field, 1) = "2" Then
            ' 모든 아이템을 숨김 처리
            pf.ClearAllFilters
            For Each item In pf.PivotItems
                item.Visible = False
            Next item
            ' 조건에 맞는 아이템만 보이게 설정
            pf.PivotItems(field).Visible = True
        End If
    Next pf
End Sub

이 코드는 "SOP 14주" 시트에 있는 "피벗테이블1"의 모든 필드를 검사하여, 이름이 6