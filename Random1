using System;
using System.Runtime.InteropServices;
using Excel = Microsoft.Office.Interop.Excel;

public void SaveExcelToTxt(string excelFilePath, string txtFilePath)
{
    Excel.Application excelApp = new Excel.Application();
    Excel.Workbook workbook = null;
    Excel.Worksheet worksheet = null;

    try
    {
        workbook = excelApp.Workbooks.Open(excelFilePath);
        worksheet = (Excel.Worksheet)workbook.Sheets[1]; // 첫 번째 워크시트

        Excel.Range usedRange = worksheet.UsedRange;
        usedRange.Copy();

        System.IO.File.WriteAllText(txtFilePath, (string)usedRange.Value2);
    }
    catch (Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
    finally
    {
        workbook?.Close(false);
        excelApp?.Quit();

        Marshal.ReleaseComObject(worksheet);
        Marshal.ReleaseComObject(workbook);
        Marshal.ReleaseComObject(excelApp);
    }
}
