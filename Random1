ime1 필드에서 시간을 포함한 날짜 데이터에서 특정 조건에 따라 월을 계산하기 위해서는, time1이 오전 7시 이하일 때 하루를 빼서 월을 계산하도록 쿼리를 작성할 수 있습니다. 이를 위해 DATEADD와 CASE 문을 활용하여 다음과 같은 방식으로 쿼리를 작성하면 됩니다.

sql
코드 복사
SELECT 
    CASE 
        WHEN DATEPART(HOUR, time1) < 7 
            THEN MONTH(DATEADD(DAY, -1, time1))  -- 시간(hh)이 7시 이전이면 하루를 빼서 월을 계산
        ELSE 
            MONTH(time1)  -- 그 외는 그대로 월 계산
    END AS AdjustedMonth
FROM 
    YourTableName
설명
DATEPART(HOUR, time1) < 7: time1에서 시간(HOUR)을 추출하여 7시 이전인지 확인합니다.
DATEADD(DAY, -1, time1): 7시 이전일 경우, 하루를 빼서 날짜를 조정합니다.