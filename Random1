겠습니다! 각 세트(4행)를 한 번에 업데이트하도록 수정했습니다.
즉, 1세트 업데이트 → 2세트 업데이트 → 3세트 업데이트 순서로 들어가도록 만들었습니다.

✅ MSSQL 업데이트 쿼리 (세트별 업데이트)
sql
코드 복사
UPDATE dbo.ExcelData
SET 
    그룹 = N'새로운 그룹명',
    라인 = N'새로운 라인명',
    모델 = N'새로운 모델명',
    타입 = N'새로운 타입명',
    ECN = N'새로운 ECN',
    Edition = N'새로운 Edition',
    BCT1_1 = 10, BCT1_2 = 20, BCT1_3 = 30, BCT1_4 = 40, BCT1_5 = 50, BCT1_6 = 60, BCT1_7 = 70, BCT1_8 = 80,
    BCT2_1 = 15, BCT2_2 = 25, BCT2_3 = 35, BCT2_4 = 45, BCT2_5 = 55, BCT2_6 = 65, BCT2_7 = 75, BCT2_8 = 85,
    TCT1_1 = 11, TCT1_2 = 21, TCT1_3 = 31, TCT1_4 = 41, TCT1_5 = 51, TCT1_6 = 61, TCT1_7 = 71, TCT1_8 = 81,
    TCT2_1 = 12, TCT2_2 = 22, TCT2_3 = 32, TCT2_4 = 42, TCT2_5 = 52, TCT2_6 = 62, TCT2_7 = 72, TCT2_8 = 82
WHERE ID = 1;
WHERE ID = 1 → 각 세트별 ID를 기준으로 업데이트.
✅ VBA 코드 (세트 단위로 업데이트)
vba
코드 복사
Sub UpdateMSSQL()
    Dim conn As Object
    Dim cmd As Object
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long, j As Integer
    Dim updateQuery As String
    Dim values As String
    Dim colA, colB, colF, colG, colH, colI As String
    Dim bct1(1 To 8), bct2(1 To 8), tct1(1 To 8), tct2(1 To 8) As Integer
    Dim recordID As Integer

    ' MSSQL 연결 설정
    Set conn = CreateObject("ADODB.Connection")
    conn.Open "Provider=SQLOLEDB;Data Source=서버이름;Initial Catalog=DB이름;User ID=사용자이름;Password=비밀번호;"
    
    ' 엑셀 시트 설정
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' 마지막 행 찾기
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    ' 데이터 처리 및 업데이트
    recordID = 1
    For i = 5 To lastRow Step 4
        ' 그룹, 라인, 모델, 타입, ECN, Edition 추출 (첫 번째 행 기준)
        colA = Trim(ws.Cells(i, 1).Value)
        colB = Trim(ws.Cells(i, 2).Value)
        colF = Trim(ws.Cells(i, 6).Value)
        colG = Trim(ws.Cells(i, 7).Value)
        colH = Trim(ws.Cells(i, 8).Value)
        colI = Trim(ws.Cells(i, 9).Value)

        ' 각 행에서 S~Z (19~26열) 값을 가져오기
        For j = 1 To 8
            bct1(j) = IIf(ws.Cells(i, 18 + j).Value = "" Or ws.Cells(i, 18 + j).Value = "-", 0, ws.Cells(i, 18 + j).Value)
            bct2(j) = IIf(ws.Cells(i + 1, 18 + j).Value = "" Or ws.Cells(i + 1, 18 + j).Value = "-", 0, ws.Cells(i + 1, 18 + j).Value)
            tct1(j) = IIf(ws.Cells(i + 2, 18 + j).Value = "" Or ws.Cells(i + 2, 18 + j).Value = "-", 0, ws.Cells(i + 2, 18 + j).Value)
            tct2(j) = IIf(ws.Cells(i + 3, 18 + j).Value = "" Or ws.Cells(i + 3, 18 + j).Value = "-", 0, ws.Cells(i + 3, 18 + j).Value)
        Next j
        
        ' SQL UPDATE 문 생성
        updateQuery = "UPDATE dbo.ExcelData SET " & _
                      "그룹 = N'" & colA & "', " & _
                      "라인 = N'" & colB & "', " & _
                      "모델 = N'" & colF & "', " & _
                      "타입 = N'" & colG & "', " & _
                      "ECN = N'" & colH & "', " & _
                      "Edition = N'" & colI & "', "

        ' BCT1_1~8, BCT2_1~8, TCT1_1~8, TCT2_1~8 업데이트
        For j = 1 To 8
            updateQuery = updateQuery & "BCT1_" & j & " = " & bct1(j) & ", "
            updateQuery = updateQuery & "BCT2_" & j & " = " & bct2(j) & ", "
            updateQuery = updateQuery & "TCT1_" & j & " = " & tct1(j) & ", "
            updateQuery = updateQuery & "TCT2_" & j & " = " & tct2(j) & ", "
        Next j

        ' 마지막 ',' 제거 후 WHERE 절 추가
        updateQuery = Left(updateQuery, Len(updateQuery) - 2) & " WHERE ID = " & recordID

        ' SQL 실행
        Set cmd = CreateObject("ADODB.Command")
        cmd.ActiveConnection = conn
        cmd.CommandText = updateQuery
        cmd.Execute

        ' 다음 세트로 이동 (ID 증가)
        recordID = recordID + 1
    Next i

    ' 연결 해제
    conn.Close
    Set conn = Nothing
    Set cmd = Nothing

    MsgBox "데이터가 성공적으로 업데이트되었습니다.", vbInformation
End Sub
✅ 설명
한 세트(4개 행)를 업데이트한 후, 다음 세트로 이동
recordID = 1부터 시작 → 한 세트(4행) 업데이트 후 recordID = recordID + 1
즉, 1번 세트 → 2번 세트 → 3번 세트 순으로 업데이트!
업데이트 문에서 모든 컬럼 한 번에 처리
BCT1_1~8, BCT2_1~8, TCT1_1~8, TCT2_1~8 값을 한 번에 업데이트
WHERE ID = recordID로 각 세트가 정확한 위치에 업데이트됨.
✅ 올바른 동작 방식
📌 엑셀 데이터 (4행 1세트)
A	B	...	S	T	U	V	W	X	Y	Z
G1	L1	...	1	-	2	-	3	-	4	5
G1	L1	...	6	7	-	-	-	8	-	-
G1	L1	...	1	-	-	2	-	3	4	-
G1	L1	...	-	5	-	6	7	-	8	9
📌 업데이트 후 MSSQL
✅ WHERE ID = 1 → 첫 번째 세트
✅ WHERE ID = 2 → 두 번째 세트
✅ WHERE ID = 3 → 세 번째 세트
💡 이제 세트 단위로 순서대로 업데이트됨! 🚀




