가장 최근의 파일을 찾으려면, 각 .log 파일을 열어 파일 내용을 확인한 후 그 문구가 포함된 파일을 반환해야 합니다. 아래는 해당 기능을 구현한 C# 함수입니다.

csharp
코드 복사
using System;
using System.IO;
using System.Linq;

public class FileProcessor
{
    public string GetLatestLogFileContainingText(string folderPath, string keyword)
    {
        // 폴더 내 모든 .log 파일을 가져옵니다.
        var logFiles = Directory.GetFiles(folderPath, "*.log");

        // 파일이 없으면 null을 반환합니다.
        if (logFiles.Length == 0)
        {
            return null;
        }

        // 파일 중에 텍스트가 포함된 가장 최근 파일을 찾습니다.
        string latestFileWithKeyword = null;
        DateTime latestFileDate = DateTime.MinValue;

        foreach (var file in logFiles)
        {
            try
            {
                // 파일을 읽기 및 쓰기 공유 모드로 엽니다.
                using (FileStream fs = new FileStream(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                using (StreamReader sr = new StreamReader(fs))
                {
                    string line;
                    // 파일의 각 줄을 확인합니다.
                    while ((line = sr.ReadLine()) != null)
                    {
                        // 줄에 keyword(예: pppp)가 포함되어 있으면
                        if (line.Contains(keyword))
                        {
                            // 해당 파일이 가장 최신 파일인지 확인합니다.
                            var lastWriteTime = File.GetLastWriteTime(file);
                            if (lastWriteTime > latestFileDate)
                            {
                                latestFileWithKeyword = file;
                                latestFileDate = lastWriteTime;
                            }
                            break; // 키워드를 찾았으면 더 이상 읽을 필요가 없습니다.
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                // 오류 발생 시 메시지 출력
                Console.WriteLine($"파일 처리 중 오류 발생: {ex.Message}");
            }
        }

        // 가장 최근에 수정된, keyword가 포함된 파일 경로를 반환합니다.
        return latestFileWithKeyword;
    }
}
코드 설명:
Directory.GetFiles: 지정된 폴더에서 .log 파일 목록을 가져옵니다.
FileStream 및 StreamReader: 각 파일을 읽기 및 쓰기 공유 모드로 열고, 파일 내용을 한 줄씩 읽습니다.
Contains: 파일 내용에서 특정 키워드(예: pppp)가 포함된 줄이 있는지 확인합니다.
File.GetLastWriteTime: 파일의 최종 수정 시간을 가져와, 해당 키워드가 포함된 가장 최신 파일을 선택합니다.
예외 처리: 파일을 열거나 읽는 과정에서 발생할 수 있는 오류를 처리하고, 오류 메시지를 출력합니다.
이 코드를 호출할 때는 GetLatestLogFileContainingText 메서드에 폴더 경로와 검색할 키워드(pppp)를 전달하면 됩니