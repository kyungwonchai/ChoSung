using System.IO;
using PdfSharp.Drawing;
using PdfSharp.Pdf;
using PdfSharp.Pdf.IO;

namespace PDFToJPGConverter
{
    class Program
    {
        static void Main(string[] args)
        {
            string pdfFilePath = "your_pdf_file_path.pdf";
            string outputFolder = "output_folder_path";
            
            using (PdfDocument document = PdfReader.Open(pdfFilePath, PdfDocumentOpenMode.Import))
            {
                for (int pageIndex = 0; pageIndex < document.PageCount; pageIndex++)
                {
                    PdfPage page = document.Pages[pageIndex];
                    XImage image = XImage.FromPdfPage(page);

                    string jpgFilePath = Path.Combine(outputFolder, $"Page{pageIndex + 1}.jpg");
                    image.Save(jpgFilePath, System.Drawing.Imaging.ImageFormat.Jpeg);
                }
            }
        }
    }
}
