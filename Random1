Sub 필터와_정렬()

    ' 필터 해제
    If ActiveSheet.AutoFilterMode Then
        ActiveSheet.AutoFilterMode = False
    End If

    ' 3번째 열과 4번째 열에 동시에 필터 적용
    With ActiveSheet.Range("A3:D" & ActiveSheet.Rows.Count)
        .AutoFilter Field:=3, Criteria1:="S*"
        .AutoFilter Field:=4, Criteria1:=">0"
    End With

    ' 정렬 - 4번째 열을 기준으로 큰 숫자에서 작은 숫자 순서로
    With ActiveSheet.AutoFilter
        .Sort.SortFields.Clear
        .Sort.SortFields.Add Key:=Range("D4"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
        .Sort.Apply
    End With

End Sub
