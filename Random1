으로 추가하여 어디서 오는지 알기 쉽게 작성하겠습니다.

1. MainWindow.xaml (View)
xml
코드 복사
<Window x:Class="ComPortViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="COM Port Viewer" Height="400" Width="500">
    <Grid>
        <Button Content="Load COM Port Settings" 
                Command="{Binding LoadComPortSettingsCommand}" 
                Width="150" Height="30" 
                HorizontalAlignment="Center" 
                VerticalAlignment="Top" 
                Margin="0,10,0,0"/>
        
        <ListBox ItemsSource="{Binding ComPortDetails}" 
                 Width="400" Height="300" 
                 HorizontalAlignment="Center" 
                 VerticalAlignment="Center" 
                 Margin="0,50,0,0">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}"/>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Window>
2. MainViewModel.cs (ViewModel)
csharp
코드 복사
using System; // 기본 시스템 기능
using System.Collections.ObjectModel; // ObservableCollection 클래스
using System.ComponentModel; // INotifyPropertyChanged 인터페이스
using System.Management; // ManagementObjectSearcher 및 WMI 접근
using System.Runtime.CompilerServices; // CallerMemberName 속성
using System.Windows.Input; // ICommand 인터페이스

namespace ComPortViewer
{
    public class MainViewModel : INotifyPropertyChanged
    {
        // COM 포트 세부 정보 저장
        public ObservableCollection<string> ComPortDetails { get; private set; }

        // COM 포트를 로드하는 명령
        public ICommand LoadComPortSettingsCommand { get; private set; }

        public MainViewModel()
        {
            // 컬렉션 초기화
            ComPortDetails = new ObservableCollection<string>();

            // 명령 초기화
            LoadComPortSettingsCommand = new RelayCommand(LoadComPortSettings);
        }

        // COM 포트 설정을 로드하는 메서드
        private void LoadComPortSettings()
        {
            // 기존 포트 설정 정보 지우기
            ComPortDetails.Clear();

            // WMI 쿼리를 통해 COM 포트 정보를 가져옴
            using (ManagementObjectSearcher searcher = new ManagementObjectSearcher("SELECT * FROM Win32_SerialPort"))
            {
                foreach (ManagementObject queryObj in searcher.Get())
                {
                    ComPortDetails.Add($"Port: {queryObj["DeviceID"]}");
                    ComPortDetails.Add($"Name: {queryObj["Name"]}");
                    ComPortDetails.Add($"Baud Rate: {queryObj["MaxBaudRate"]}");
                    ComPortDetails.Add($"ProviderType: {queryObj["ProviderType"]}");
                    ComPortDetails.Add($"Status: {queryObj["Status"]}");
                    ComPortDetails.Add($"Parity: {queryObj["Parity"]}");
                    ComPortDetails.Add($"Stop Bits: {queryObj["StopBits"]}");
                    ComPortDetails.Add("-----------");
                }
            }
        }

        // INotifyPropertyChanged 구현
        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }
    }
}
3. RelayCommand.cs
csharp
코드 복사
using System; // 기본 시스템 기능
using System.Windows.Input; // ICommand 인터페이스

namespace ComPortViewer
{
    public class RelayCommand : ICommand
    {
        private readonly Action _execute;
        private readonly Func<bool> _canExecute;

        public RelayCommand(Action execute, Func<bool> canExecute = null)
        {
            _execute = execute;
            _canExecute = canExecute;
        }

        public bool CanExecute(object parameter)
        {
            return _canExecute == null || _canExecute();
        }

        public void Execute(object parameter)
        {
            _execute();
        }

        public event EventHandler CanExecuteChanged;

        public void RaiseCanExecuteChanged()
        {
            CanExecuteChanged?.Invoke(this, EventArgs.Empty);
        }
    }
}
4. MainWindow.xaml.cs (View Code-behind)
csharp
코드 복사
using System.Windows; // Window 클래스

namespace ComPortViewer
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            DataContext = new MainViewModel();
        }
    }
}
요약