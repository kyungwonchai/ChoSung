VBA 매크로를 사용하여 엑셀에서 MySQL 데이터베이스로 데이터를 삽입하는 코드를 작성해 보겠습니다. 먼저, 엑셀 VBA에서 MySQL에 연결하기 위해 MySQL Connector/ODBC 드라이버가 설치되어 있어야 합니다. 이 드라이버를 설치한 후, 아래 VBA 코드를 사용하면 됩니다.

엑셀 파일에서 VBA 편집기 열기:

엑셀에서 Alt + F11을 눌러 VBA 편집기를 엽니다.
삽입 -> 모듈을 선택하여 새로운 모듈을 추가합니다.
VBA 코드 작성:

vba
코드 복사
Sub InsertDataToMySQL()
    Dim conn As Object
    Dim rs As Object
    Dim connStr As String
    Dim lastRow As Long
    Dim i As Long

    ' MySQL 연결 문자열
    connStr = "Driver={MySQL ODBC 8.0 Driver};" & _
              "Server=your_mysql_host;" & _
              "Database=your_database_name;" & _
              "User=your_username;" & _
              "Password=your_password;" & _
              "Option=3;"

    ' 연결 객체 생성
    Set conn = CreateObject("ADODB.Connection")
    conn.Open connStr

    ' 엑셀에서 사용된 마지막 행 찾기
    lastRow = ThisWorkbook.Sheets("Sheet1").Cells(ThisWorkbook.Sheets("Sheet1").Rows.Count, 1).End(xlUp).Row

    ' 행마다 데이터 삽입
    For i = 2 To lastRow ' 2행부터 마지막 행까지
        Dim dateValue As String
        Dim varcharValue As String
        Dim datetimeValue1 As String
        Dim datetimeValue2 As String

        dateValue = ThisWorkbook.Sheets("Sheet1").Cells(i, 1).Value
        varcharValue = ThisWorkbook.Sheets("Sheet1").Cells(i, 2).Value
        datetimeValue1 = ThisWorkbook.Sheets("Sheet1").Cells(i, 3).Value
        datetimeValue2 = ThisWorkbook.Sheets("Sheet1").Cells(i, 4).Value

        ' SQL 쿼리 생성
        Dim sql As String
        sql = "INSERT INTO your_table_name (date_col, varchar_col, datetime_col1, datetime_col2) VALUES ('" & dateValue & "', '" & varcharValue & "', '" & datetimeValue1 & "', '" & datetimeValue2 & "')"

        ' 쿼리 실행
        conn.Execute sql
    Next i

    ' 연결 종료
    conn.Close
    Set conn = Nothing

    MsgBox "Data inserted successfully"
End Sub
이 코드에서 몇 가지 중요한 부분을 확인하세요:

MySQL 연결 문자열 설정: connStr 변수에 자신의 MySQL 서버 정보를 입력합니다.
엑셀 시트 이름 설정: ThisWorkbook.Sheets("Sheet1") 부분을 자신의 엑셀 시트 이름으로 변경합니다.
데이터베이스 테이블과 열 이름 설정: SQL 쿼리에서 your_table_name, date_col, varchar_col, datetime_col1, datetime_col2를 자신의 데이터베이스 테이블과 열 이름에 맞게 변경합니다.
이 매크로는 엑셀의 2행부터 마지막 행까지 데이터를 읽어와 MySQL 데이터베이스에 삽입합니다. VBA 코드 실행 후, 엑셀에서 Alt + F8을 눌러 매크로를 실행하면 됩니다.