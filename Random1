를 생성하는 작업을 수행하려고 합니다. 여기에 이 작업을 수행하기 위한 SQL 쿼리를 제공합니다. 먼저, 중복 항목을 제거하고 나중에 뷰를 생성할 것입니다.

    중복 항목 제거:
    중복 항목을 제거하려면, 우선 ROW_NUMBER() 함수를 사용하여 각 N_TKey 값에 대해 행 번호를 부여하고, C_수정일시 열을 기준으로 정렬합니다. 그런 다음, 행 번호가 1보다 큰 항목을 삭제하여 각 N_TKey 값에 대해 가장 최근의 항목만 남겨둡니다.

sql

WITH Ranked AS (
    SELECT 
        *, 
        ROW_NUMBER() OVER (PARTITION BY N_TKey ORDER BY C_수정일시 DESC) as rn
    FROM 
        T_설계변경
)
DELETE FROM Ranked
WHERE rn > 1;

    뷰 생성:
    다음으로, 뷰를 생성하여 N_TKey에 대해 중복이 없고 C_수정일시가 최근인 항목만 표시하도록 합니다.

sql

CREATE VIEW Latest_T_설계변경 AS
WITH Ranked AS (
    SELECT 
        *, 
        ROW_NUMBER() OVER (PARTITION BY N_TKey ORDER BY C_수정일시 DESC) as rn
    FROM 
        T_설계변경
)
SELECT * FROM Ranked
WHERE rn = 1;

이제 Latest_T_설계변경 뷰를 조회하면 N_TKey에 대해 중복이 없고 C_수정일시가 최근인 항목만 볼 수 있습니다.

한국어 번역:

    중복 항목 제거:
    중복 항목을 제거하려면, 먼저 ROW_NUMBER() 함수를 사용하여 각 N_TKey 값에 대해 행 번호를 부여하고, C_수정일시 열을 기준으로 정렬합니다. 그런 다음, 행 번호가 1보다 큰 항목을 삭제하여 각 N_TKey 값에 대해 가장 최근의 항목만 남겨둡니다.

    뷰 생성:
    이제 뷰를 생성하여 N_TKey에 대해 중복이 없고 C_수정일시가 최근인 항목만 표시하도록 합니