using System;
using System.IO;
using System.Text;
using DevExpress.XtraBars.Ribbon;

public void ExportRibbonToCsv(RibbonControl ribbonControl, string filePath)
{
    // StringBuilder를 이용하여 CSV 내용을 작성합니다.
    StringBuilder csvContent = new StringBuilder();
    csvContent.AppendLine("Page Text,Group Text,Button Caption,Button Name,Button Tag");

    // 각 리본 페이지에 대해 순회합니다.
    foreach (RibbonPage page in ribbonControl.Pages)
    {
        string pageText = page.Text;

        // 각 그룹에 대해 순회합니다.
        foreach (RibbonPageGroup group in page.Groups)
        {
            string groupText = group.Text;

            // 각 그룹 안의 아이템에 대해 순회합니다.
            foreach (var item in group.ItemLinks)
            {
                if (item is BarButtonItemLink buttonItemLink)
                {
                    BarButtonItem button = buttonItemLink.Item as BarButtonItem;
                    if (button != null)
                    {
                        string buttonCaption = button.Caption;
                        string buttonName = button.Name;
                        string buttonTag = button.Tag != null ? button.Tag.ToString() : "";

                        // CSV 라인 작성
                        string csvLine = string.Format("{0},{1},{2},{3},{4}",
                            pageText,
                            groupText,
                            buttonCaption,
                            buttonName,
                            buttonTag);

                        csvContent.AppendLine(csvLine);
                    }
                }
            }
        }
    }

    // 파일 경로에 CSV 내용을 작성합니다.
    try
    {
        File.WriteAllText(filePath, csvContent.ToString(), Encoding.UTF8);
    }
    catch (Exception ex)
    {
        // 파일 작성 중 오류가 발생하면 예외를 출력합니다.
        Console.WriteLine("CSV 파일 작성 중 오류가 발생했습니다: " + ex.Message);
    }