3. WarningWindowPop1.xaml.cs에서 ObservableCollection 확인 및 바인딩 설정
WarningWindowPop1의 DataContext를 제대로 설정하여 ErrorMessagesPop1가 바인딩될 수 있도록 합니다.

csharp
코드 복사
using System.Collections.ObjectModel;
using System.Windows;

namespace YourNamespace
{
    public partial class WarningWindowPop1 : Window
    {
        public ObservableCollection<ErrorMessagePop1> ErrorMessagesPop1 { get; set; }

        public WarningWindowPop1(ObservableCollection<ErrorMessagePop1> errorMessagesPop1)
        {
            InitializeComponent();
            ErrorMessagesPop1 = errorMessagesPop1;
            DataContext = this;
        }

        public void UpdateMessagesPop1(ObservableCollection<ErrorMessagePop1> errorMessagesPop1)
        {
            ErrorMessagesPop1.Clear();
            foreach (var message in errorMessagesPop1)
            {
                ErrorMessagesPop1.Add(message);
            }
        }

        private void Window_MouseDownPop1(object sender, System.Windows.Input.MouseButtonEventArgs e)
        {
            this.Close(); // 클릭하면 창 닫기
        }
    }
}
4. AddErrorMessagePop1 메서드에서 Dispatcher.Invoke 사용 여부 확인
AddErrorMessagePop1 메서드에서 Dispatcher.Invoke가 필요할 수 있습니다. Application.Current.Dispatcher.Invoke를 사용하여 UI 스레드에서 ObservableCollection을 안전하게 업데이트합니다.

csharp
코드 복사
private void AddErrorMessagePop1(string message)
{
    Application.Current.Dispatcher.Invoke(() =>
    {
        if (_errorMessagesPop1.Any(m => m.ContentPop1 == message)) return;

        Color color = _errorMessagesPop1.Count % 2 == 0 ? Colors.Yellow : Colors.Aqua;
        _errorMessagesPop1.Add(new ErrorMessagePop1(message, new SolidColorBrush(color)));

        if (_errorMessagesPop1.Count == 1)
        {
            ShowWarningWindowPop1(); // 첫 메시지 추가 시 창 표시
        }
        else
        {
            UpdateWarningWindowPop1(); // 메시지 추가 시 창 업데이트
        }

        Debug.WriteLine($"[DEBUG] Error added: {message}");
    });
}
5. 문제 해결 확인 및 테스트
cmdqueue.TriggerErrorPop1("Error message here");를 호출하여 에러가 정상적으로 추가되는지 확인합니다.
에러가 추가될 때 WarningWindowPop1 팝업이 열리고, ItemsControl에 텍스트가 표시되는지 확인합니다.
에러 메시지를 제거할 때는 cmdqueue.ResolveErrorPop1("Error message here");를 호출하여 메시지가 제거되고 창이 닫히는지 확인합니다.
위와 같이 수정 후 다시 실행하여 문제가 해결되