sk 애플리케이션에서 MSSQL 데이터베이스와의 연결을 pymssql을 사용하도록 변경하는 방법을 설명하겠습니다. pymssql은 SQL Server와의 연결을 간편하게 해주는 라이브러리입니다.

먼저 pymssql을 설치해야 합니다:

bash
코드 복사
pip install pymssql
그 다음, app.py 파일을 수정하여 pyodbc 대신 pymssql을 사용하도록 변경합니다.

수정된 app.py 코드
python
코드 복사
from flask import Flask, render_template, jsonify
import pymssql
import datetime

app = Flask(__name__)

# MSSQL 데이터베이스 연결 설정
server = 'YOUR_SERVER'
database = 'YOUR_DATABASE'
username = 'YOUR_USERNAME'
password = 'YOUR_PASSWORD'

def get_data():
    conn = pymssql.connect(server=server, user=username, password=password, database=database)
    cursor = conn.cursor()
    query = '''
    SELECT CLine, CMachine, CPCBTEMP, CMASKTEMP, CHUMID, CSORDER, CPAPER, CSOLVENT, CFILETIME
    FROM Table_MaskCleaning2
    '''
    cursor.execute(query)
    rows = cursor.fetchall()
    conn.close()

    data = []
    now = datetime.datetime.now()

    for row in rows:
        CLine, CMachine, CPCBTEMP, CMASKTEMP, CHUMID, CSORDER, CPAPER, CSOLVENT, CFILETIME = row
        diff_minutes = int((now - CFILETIME).total_seconds() / 60)
        data.append({
            'CLine': CLine,
            'CMachine': CMachine,
            'CPCBTEMP': CPCBTEMP,
            'CMASKTEMP': CMASKTEMP,
            'CHUMID': CHUMID,
            'CSORDER': CSORDER,
            'CPAPER': CPAPER,
            'CSOLVENT': CSOLVENT,
            'CFILETIME': CFILETIME,
            'DIFF': diff_minutes
        })

    return data

@app.route('/')
def index():
    data = get_data()
    return render_template('index.html', data=data)

@app.route('/refresh', methods=['GET'])
def refresh():
    data = get_data()
    return jsonify(data)

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
변경된 부분 설명
라이브러리 변경: import pymssql로 변경하였습니다.

데이터베이스 연결 설정:

python
코드 복사
conn = pymssql.connect(server=server, user=username, password=password, database=database)
pymssql.connect를 사용하여 데이터베이스에 연결합니다.

쿼리 실행: 쿼리 실행과 데이터 조회 부분은 pymssql에서도 동일하게 작동합니다.

바꿔야 하는 부분
서버 주소: server 변수에 MSSQL 서버의 주소를 입력합니다.
데이터베이스 이름: database 변수에 사용할 데이터베이스 이름을 입력합니다.
사용자 이름: username 변수에 MSSQL 사용자의 이름을 입력합니다.
비밀번호: password 변수에 MSSQL 사용자의 비밀번호를 입력합니다.
이 네 가지 정보를 실제 MSSQL 서버 정보로 바꾸면 됩니다. 예를 들어:

python
코드 복사
server = 'your_mssql_server_address'
database = 'your_database_name'
username = 'your_username'
password = 'your_password'
이제 이 수정된 코드를 사용하여 Flask 애플리케이션을 실행하면 pymssql을 통해 MSSQL 데이터베이스와 연결할 수