그룹 우측에 버튼이 생기는 이유는 **HierarchicalDataTemplate**의 모든 항목(그룹 및 라인)에 동일한 템플릿이 적용되었기 때문입니다. 이를 해결하려면 그룹과 라인을 분리하여 각각 다른 템플릿을 적용해야 합니다.

아래는 수정된 코드로, 라인에만 버튼을 표시하도록 변경했습니다.

수정된 XAML 코드
xml
코드 복사
<Window x:Class="TreeViewCheckboxExample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TreeView with VNC Access" Height="600" Width="500">
    <Grid>
        <TreeView x:Name="treeView" ItemsSource="{Binding Groups}" Margin="10">
            <TreeView.Resources>
                <!-- 그룹 템플릿 -->
                <DataTemplate DataType="{x:Type local:Group}">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <!-- 체크박스 -->
                        <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}" 
                                  Checked="CheckBox_Checked" Unchecked="CheckBox_Unchecked" />
                        <!-- 그룹 이름 -->
                        <TextBlock Text="{Binding Name}" Margin="5,0,0,0" />
                    </StackPanel>
                </DataTemplate>

                <!-- 라인 템플릿 -->
                <DataTemplate DataType="{x:Type local:Line}">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <!-- 체크박스 -->
                        <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}" 
                                  Checked="CheckBox_Checked" Unchecked="CheckBox_Unchecked" />
                        <!-- 라인 이름 -->
                        <TextBlock Text="{Binding Name}" Margin="5,0,0,0" />
                        <!-- VNC 버튼 -->
                        <Button Margin="10,0,0,0" ToolTip="VNC 원격 접속"
                                Tag="{Binding Name}" Click="VncButton_Click" Width="25" Height="25">
                            <Button.Content>
                                <Image Source="image1/vnc.png" Stretch="Uniform" />
                            </Button.Content>
                        </Button>
                    </StackPanel>
                </DataTemplate>
            </TreeView.Resources>

            <!-- 계층적 템플릿 -->
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Lines}" />
            </TreeView.ItemTemplate>
        </TreeView>
    </Grid>
</Window>
수정된 C# 코드
C# 코드에는 변경 사항이 없습니다. 기존 코드를 그대로 사용합니다.

csharp
코드 복사
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Windows;

namespace TreeViewCheckboxExample
{
    public partial class MainWindow : Window
    {
        public ObservableCollection<Group> Groups { get; set; }

        public MainWindow()
        {
            InitializeComponent();
            DataContext = this;

            // 데이터 로드 및 초기 설정
            LoadData();
            SetAllChecked(true);
            ExpandAllGroups();
        }

        /// <summary>
        /// 데이터를 로드합니다.
        /// </summary>
        private void LoadData()
        {
            Groups = new ObservableCollection<Group>
            {
                new Group
                {
                    Name = "Group A",
                    Lines = new ObservableCollection<Line>
                    {
                        new Line { Name = "Line 1.1" },
                        new Line { Name = "Line 1.2" }
                    }
                },
                new Group
                {
                    Name = "Group B",
                    Lines = new ObservableCollection<Line>
                    {
                        new Line { Name = "Line 2.1" },
                        new Line { Name = "Line 2.2" }
                    }
                }
            };
        }

        /// <summary>
        /// 모든 그룹과 라인을 체크 상태로 설정합니다.
        /// </summary>
        private void SetAllChecked(bool isChecked)
        {
            foreach (var group in Groups)
            {
                group.IsChecked = isChecked;
                foreach (var line in group.Lines)
                {
                    line.IsChecked = isChecked;
                }
            }
        }

        /// <summary>
        /// 모든 그룹을 확장 상태로 설정합니다.
        /// </summary>
        private void ExpandAllGroups()
        {
            foreach (var group in Groups)
            {
                group.IsExpanded = true;
            }
        }

        /// <summary>
        /// VNC 버튼 클릭 이벤트 처리
        /// </summary>
        private void VncButton_Click(object sender, RoutedEventArgs e)
        {
            if (sender is FrameworkElement element && element.Tag is string lineName)
            {
                // VNC 접속 로직 추가 가능
                MessageBox.Show($"VNC 원격 접속: {lineName}");
            }
        }
    }

    public class Group : INotifyPropertyChanged
    {
        private bool _isChecked;
        private bool _isExpanded;
        public string Name { get; set; }
        public ObservableCollection<Line> Lines { get; set; } = new ObservableCollection<Line>();

        public bool IsChecked
        {
            get => _isChecked;
            set
            {
                if (_isChecked != value)
                {
                    _isChecked = value;
                    OnPropertyChanged(nameof(IsChecked));
                }
            }
        }

        public bool IsExpanded
        {
            get => _isExpanded;
            set
            {
                if (_isExpanded != value)
                {
                    _isExpanded = value;
                    OnPropertyChanged(nameof(IsExpanded));
                }
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    public class Line : INotifyPropertyChanged
    {
        private bool _isChecked;
        public string Name { get; set; }

        public bool IsChecked
        {
            get => _isChecked;
            set
            {
                if (_isChecked != value)
                {
                    _isChecked = value;
                    OnPropertyChanged(nameof(IsChecked));
                }
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }
    }
}
수정된 동작 설명
템플릿 분리:

그룹과 라인을 **DataTemplate**으로 분리하여 각각 다른 UI를 적용.
그룹에는 VNC 버튼이 표시되지 않으며, 라인에만 버튼이 표시됩니다.
VNC 버튼:

버튼은 라인 우측에만 표시됩니다.
버튼 클릭 시 해당 라인의 이름을 메시지 박스로 표시.
이미지 설정:

버튼 내용으로 **image1/vnc.png**를 사용.
빌드 액션은 Resource로 설정.
결과
TreeView:

그룹 우측에는 아무 버튼도 표시되지 않습니다.
라인 우측에만 VNC 버튼(이미지)이 표시됩니다.
VNC 버튼 클릭:
