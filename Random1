죄송합니다. 소켓 서버 인스턴스가 제대로 초기화되지 않아 null인 상태에서 접근하려고 하여 문제가 발생한 것으로 보입니다. 이를 해결하기 위해서는 소켓 서버 인스턴스를 올바르게 초기화하고, 프로그램 시작 시 제대로 설정되도록 해야 합니다.

수정된 코드
다음은 소켓 서버 인스턴스를 올바르게 초기화하는 코드입니다:

csharp
코드 복사
public partial class MainWindow : Window
{
    private SocketServer socketServer;
    private SettingsManager settingsManager;
    private SerialPortManager serialPortManager;

    public MainWindow()
    {
        InitializeComponent();
        Initialize();
    }

    private void Initialize()
    {
        try
        {
            // 설정 관리 클래스 초기화
            settingsManager = SettingsManager.Instance;

            // 소켓 서버 초기화
            socketServer = SocketServer.Instance; // 싱글톤 인스턴스 초기화
            socketServer.DataReceived += OnSocketDataReceived;

            // IP 주소 가져오기 및 표시
            string ipAddress = GetLocalIPAddress();
            IpAddressTextBlock.Text = $"IP Address: {ipAddress}";

            // 포트 선택 콤보박스 초기화
            for (int i = 20000; i <= 65000; i++)
            {
                PortComboBox.Items.Add(i.ToString());
            }

            // 포트 및 설정 불러오기
            PortComboBox.SelectedItem = settingsManager.GetSetting("Port");
            PortComboBox.SelectionChanged += PortComboBox_SelectionChanged;

            // 스캐너 및 타겟 포트 설정 초기화
            InitializePortSettings();
            LoadLastUsedPorts();

            // QR 코드 생성
            GenerateQRCode(ipAddress, PortComboBox.SelectedItem?.ToString() ?? string.Empty);

            // 포트 목록 갱신
            RefreshPorts();
        }
        catch (Exception ex)
        {
            LogMessage($"프로그램 초기화 실패: {ex.Message}");
        }
    }

    private void PortComboBox_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        try
        {
            // 포트 선택이 없을 경우 기본값으로 20000을 사용
            string selectedPort = PortComboBox.SelectedItem?.ToString() ?? "20000";

            // 포트 번호가 유효한지 확인
            if (int.TryParse(selectedPort, out int portNumber))
            {
                // 포트 번호가 유효하다면 소켓 서버를 시작
                socketServer.Start(portNumber);
                settingsManager.SaveSetting("Port", selectedPort);
            }
            else
            {
                // 유효하지 않은 포트 번호인 경우 로그에 오류 메시지 기록
                LogMessage($"포트 번호가 유효하지 않습니다: {selectedPort}");
            }

            // QR 코드 업데이트
            string ipAddress = GetLocalIPAddress();
            GenerateQRCode(ipAddress, selectedPort);
        }
        catch (Exception ex)
        {
            LogMessage($"포트 설정 중 오류 발생: {ex.Message}");
        }
    }

    private string GetLocalIPAddress()
    {
        try
        {
            string localIP = "";
            foreach (var ip in Dns.GetHostAddresses(Dns.GetHostName()))
            {
                if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork)
                {
                    localIP = ip.ToString();
                }
            }
            return localIP;
        }
        catch (Exception ex)
        {
            LogMessage($"IP 주소를 가져오는 중 오류 발생: {ex.Message}");
            return string.Empty;
        }
    }

    private void GenerateQRCode(string ipAddress, string port)
    {
        try
        {
            if (!string.IsNullOrEmpty(ipAddress) && !string.IsNullOrEmpty(port))
            {
                string qrContent = $"{ipAddress}:{port}";
                QRCodeGenerator qrGenerator = new QRCodeGenerator();
                BitmapImage qrCodeImage = qrGenerator.GenerateQRCode(qrContent);

                // QR 코드를 이미지로 표시
                QrCodeImage.Source = qrCodeImage;
            }
        }
        catch (Exception ex)
        {
            LogMessage($"QR 코드 생성 중 오류 발생: {ex.Message}");
        }
    }

    // Other existing methods...
}
주요 변경 사항:
SocketServer 초기화:

socketServer = SocketServer.Instance; 로 싱글톤 패턴으로 소켓 서버 인스턴스를 초기화합니다. 이를 통해 socketServer가 null 상태가 아닌, 정상적인 인스턴스를 가리키게 됩니다.
포트 번호 유효성 검사:

포트 번호가 유효하지 않은 경우를 대비하여 예외 처리를 강화했습니다.
결론
이제 프로그램이 시작될 때 SocketServer 인스턴스가 올바르게 초기화되며, 첫 실행 시에도 소켓 서버를 정상적으로 시작할 수 있습니다. 만약 이 코드로도 문제가 발생한다면, 추가적인 디버깅이 필요할 수 있으므로, 문제 발생 시 구체적인 오류 메시지를 제공해 주시면 추가적으로 도와드리겠습니