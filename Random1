ê² ìŠµë‹ˆë‹¤. StatusWindow.xamlì˜ ë ˆì´ì•„ì›ƒ ë° ì˜¤ë¥˜ ìˆ˜ì •ê³¼ ê´€ë ¨ëœ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.

IsReadOnly ì˜¤ë¥˜ ìˆ˜ì •: GridControlì— ì§ì ‘ IsReadOnly="True" ì†ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  TableViewì˜ AllowEditing="False" ì†ì„±ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤ (ì´ë¯¸ ì ìš©ë˜ì–´ ìˆìŒ). í•´ë‹¹ IsReadOnly ì†ì„±ì„ ì œê±°í•©ë‹ˆë‹¤.
ë ˆì´ì•„ì›ƒ ë³€ê²½ ë° ì°¨íŠ¸ ì¶”ê°€: ì°½ì„ ì¢Œìš° 2ë‹¨ìœ¼ë¡œ ë‚˜ëˆ„ì–´, ì¢Œì¸¡ì—ëŠ” ê¸°ì¡´ì˜ í˜„í™© í‘œ 3ê°œ(ì¢…ë¥˜ë³„, ì¸µë³„, êµ¬ì—­ë³„)ë¥¼ ì„¸ë¡œë¡œ ë°°ì¹˜í•˜ê³ , ìš°ì¸¡ì—ëŠ” ì´ ë°ì´í„°ë¥¼ ì‹œê°í™”í•˜ëŠ” ë§‰ëŒ€ ì°¨íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì°¨íŠ¸ì—ëŠ” ìš°ì„  ì¢…ë¥˜ë³„ í˜„í™© ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ì¢…ë¥˜ë³„ "ì‚¬ìš© ê°œìˆ˜"ì™€ "ì—¬ìœ  ê°œìˆ˜"ë¥¼ ë§‰ëŒ€ë¡œ í‘œì‹œí•˜ê² ìŠµë‹ˆë‹¤.
ìˆ˜ì •/ì¶”ê°€í•´ì•¼ í•  íŒŒì¼ ëª©ë¡:

Views/StatusWindow.xaml (ë ˆì´ì•„ì›ƒ ë³€ê²½, ì°¨íŠ¸ ì¶”ê°€, IsReadOnly ì œê±°)
ViewModels/StatusViewModel.cs (ì´ë²ˆ ìˆ˜ì • ì‚¬í•­ ì—†ìŒ, í™•ì¸ìš©ìœ¼ë¡œ ìµœì¢…ë³¸ ì œê³µ)
ì•„ë˜ì— ì´ ë‘ íŒŒì¼ì˜ ìˆ˜ì •ëœ ì „ì²´ ì½”ë“œ(ì£¼ì„ ì œì™¸, íŒŒì¼ ID í¬í•¨)ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

1. Views/StatusWindow.xaml (ìˆ˜ì •)

XML

<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.StatusWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxc="http://schemas.devexpress.com/winfx/2008/xaml/charts"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    mc:Ignorable="d"
    Title="ì‚¬ë¬¼í•¨ ì‚¬ìš© í˜„í™©" Height="700" Width="1100"
    WindowStartupLocation="CenterOwner" ShowInTaskbar="False"
    Closing="StatusWindow_Closing">

    <dx:ThemedWindow.Resources>
        <Style TargetType="dxg:GridColumnHeader">
            <Setter Property="Background" Value="LightSteelBlue"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        <Style TargetType="dxg:LightweightCellEditor">
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="LeftAlignCellStyle" TargetType="dxg:LightweightCellEditor">
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>
    </dx:ThemedWindow.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Button Grid.Row="0" Content="ğŸ”„ ìƒˆë¡œê³ ì¹¨" Command="{Binding LoadStatusCommand}" HorizontalAlignment="Left" Margin="0,0,0,10" Padding="10,3"/>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Vertical">
                <GroupBox Header="ì¢…ë¥˜ë³„ í˜„í™©" Margin="0,0,5,5">
                    <dxg:GridControl ItemsSource="{Binding StatusByType}" AutoGenerateColumns="None" MaxHeight="180">
                        <dxg:GridControl.View> <dxg:TableView AllowEditing="False" ShowGroupPanel="False"/> </dxg:GridControl.View>
                        <dxg:GridControl.Columns>
                            <dxg:GridColumn FieldName="GroupValue" Header="ì¢…ë¥˜" CellStyle="{StaticResource LeftAlignCellStyle}"/>
                            <dxg:GridColumn FieldName="TotalCount" Header="ì´ ê°œìˆ˜"/>
                            <dxg:GridColumn FieldName="UsedCount" Header="ì‚¬ìš© ê°œìˆ˜"/>
                            <dxg:GridColumn FieldName="AvailableCount" Header="ì—¬ìœ  ê°œìˆ˜"/>
                            <dxg:GridColumn FieldName="UsageRate" Header="ì‚¬ìš©ë¥ (%)"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings DisplayFormat="N1"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                        </dxg:GridControl.Columns>
                    </dxg:GridControl>
                </GroupBox>

                <GroupBox Header="ì¸µë³„ í˜„í™©" Margin="0,5,5,5">
                     <dxg:GridControl ItemsSource="{Binding StatusByFloor}" AutoGenerateColumns="None" MaxHeight="180">
                         <dxg:GridControl.View> <dxg:TableView AllowEditing="False" ShowGroupPanel="False"/> </dxg:GridControl.View>
                         <dxg:GridControl.Columns>
                             <dxg:GridColumn FieldName="GroupValue" Header="ì¸µ"/>
                             <dxg:GridColumn FieldName="TotalCount" Header="ì´ ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="UsedCount" Header="ì‚¬ìš© ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="AvailableCount" Header="ì—¬ìœ  ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="UsageRate" Header="ì‚¬ìš©ë¥ (%)"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings DisplayFormat="N1"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                         </dxg:GridControl.Columns>
                     </dxg:GridControl>
                </GroupBox>

                <GroupBox Header="êµ¬ì—­ë³„ í˜„í™©" Margin="0,5,5,0">
                     <dxg:GridControl ItemsSource="{Binding StatusByZone}" AutoGenerateColumns="None" MaxHeight="180">
                         <dxg:GridControl.View> <dxg:TableView AllowEditing="False" ShowGroupPanel="False"/> </dxg:GridControl.View>
                         <dxg:GridControl.Columns>
                             <dxg:GridColumn FieldName="GroupValue" Header="êµ¬ì—­" CellStyle="{StaticResource LeftAlignCellStyle}"/>
                             <dxg:GridColumn FieldName="TotalCount" Header="ì´ ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="UsedCount" Header="ì‚¬ìš© ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="AvailableCount" Header="ì—¬ìœ  ê°œìˆ˜"/>
                             <dxg:GridColumn FieldName="UsageRate" Header="ì‚¬ìš©ë¥ (%)"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings DisplayFormat="N1"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                         </dxg:GridControl.Columns>
                     </dxg:GridControl>
                </GroupBox>
            </StackPanel>

            <GroupBox Header="ì¢…ë¥˜ë³„ í˜„í™© ì°¨íŠ¸" Grid.Column="1" Margin="5,0,0,0">
                 <dxc:ChartControl DataSource="{Binding StatusByType}">
                     <dxc:ChartControl.Diagram>
                         <dxc:XYDiagram2D>
                             <dxc:XYDiagram2D.Series>
                                 <dxc:BarSideBySideSeries2D DisplayName="ì‚¬ìš©" DataSource="{Binding StatusByType}" ArgumentDataMember="GroupValue" ValueDataMember="UsedCount" BarWidth="0.4"/>
                                 <dxc:BarSideBySideSeries2D DisplayName="ì—¬ìœ " DataSource="{Binding StatusByType}" ArgumentDataMember="GroupValue" ValueDataMember="AvailableCount" BarWidth="0.4"/>
                             </dxc:XYDiagram2D.Series>
                             <dxc:XYDiagram2D.AxisX>
                                 <dxc:AxisX2D>
                                     <dxc:AxisX2D.Title> <dxc:AxisTitle Content="ì‚¬ë¬¼í•¨ ì¢…ë¥˜"/> </dxc:AxisX2D.Title>
                                 </dxc:AxisX2D>
                             </dxc:XYDiagram2D.AxisX>
                             <dxc:XYDiagram2D.AxisY>
                                 <dxc:AxisY2D>
                                     <dxc:AxisY2D.Title> <dxc:AxisTitle Content="ê°œìˆ˜"/> </dxc:AxisY2D.Title>
                                 </dxc:AxisY2D>
                             </dxc:XYDiagram2D.AxisY>
                         </dxc:XYDiagram2D>
                     </dxc:ChartControl.Diagram>
                     <dxc:ChartControl.Legend>
                         <dxc:Legend HorizontalPosition="Center" VerticalPosition="BottomOutside" Orientation="Horizontal"/>
                     </dxc:ChartControl.Legend>
                     <dxc:ChartControl.Titles>
                         <dxc:Title Content="ì‚¬ë¬¼í•¨ ì¢…ë¥˜ë³„ ì‚¬ìš©/ì—¬ìœ  í˜„í™©" HorizontalAlignment="Center"/>
                     </dxc:ChartControl.Titles>
                 </dxc:ChartControl>
            </GroupBox>

        </Grid>
        <StatusBar Grid.Row="2" Background="LightGray" Margin="0,10,0,0">
            <StatusBarItem><TextBlock Text="{Binding StatusMessage}" Margin="5,0"/></StatusBarItem>
        </StatusBar>

        <Button Grid.Row="3" Content="ë‹«ê¸°" Width="80" HorizontalAlignment="Right" Margin="0,10,0,0" Click="CloseButton_Click" IsCancel="True"/>

    </Grid>
</dx:ThemedWindow>
2. ViewModels/StatusViewModel.cs (ìµœì¢… í™•ì¸ìš©)

ì´ íŒŒì¼ì€ ì´ì „ ë‹¨ê³„ì—ì„œ ì œê³µí•œ ì½”ë“œì™€ ë™ì¼í•©ë‹ˆë‹¤. (ë³€ê²½ ì—†ìŒ)

C#

// FILE_ID: ViewModels/StatusViewModel_20250410173000
using LockerManagementApp.Data;
using LockerManagementApp.Models;
using LockerManagementApp.Infrastructure;
using System;
using System.Collections.ObjectModel;
using System.Data.Entity;
using System.Diagnostics;
using System.Linq;
using System.Threading;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;
using System.Collections.Generic;

namespace LockerManagementApp.ViewModels
{
    public class StatusViewModel : ViewModelBase, IDisposable
    {
        private readonly LockerDbContext _context;
        private readonly CancellationTokenSource _cts = new CancellationTokenSource();
        private bool _disposed = false;

        private ObservableCollection<StatusItem> _statusByType;
        private ObservableCollection<StatusItem> _statusByFloor;
        private ObservableCollection<StatusItem> _statusByZone;
        private string _statusMessage;

        public ObservableCollection<StatusItem> StatusByType { get => _statusByType; set => SetProperty(ref _statusByType, value); }
        public ObservableCollection<StatusItem> StatusByFloor { get => _statusByFloor; set => SetProperty(ref _statusByFloor, value); }
        public ObservableCollection<StatusItem> StatusByZone { get => _statusByZone; set => SetProperty(ref _statusByZone, value); }
        public string StatusMessage { get => _statusMessage; set => SetProperty(ref _statusMessage, value); }

        public ICommand LoadStatusCommand { get; }

        public StatusViewModel()
        {
            StatusByType = new ObservableCollection<StatusItem>();
            StatusByFloor = new ObservableCollection<StatusItem>();
            StatusByZone = new ObservableCollection<StatusItem>();

            try { _context = new LockerDbContext(); }
            catch (Exception ex) { if (!App.IsShuttingDown) MessageBox.Show($"[Status] DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); else Debug.WriteLine($"ì¢…ë£Œ ì¤‘ [Status] DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜ ë¬´ì‹œë¨: {ex.Message}"); StatusMessage = "DB ì—°ê²° ì˜¤ë¥˜!"; LoadStatusCommand = new RelayCommand(async _ => await LoadStatusDataAsync(), _ => !_disposed); return; }

            LoadStatusCommand = new RelayCommand(async _ => await LoadStatusDataAsync(), CanExecuteLoad);
            if (_context != null) { _ = LoadStatusDataAsync(); }
        }

        private bool CanExecuteLoad(object parameter = null) => !_disposed && _context != null && !_cts.IsCancellationRequested;

        public async Task LoadStatusDataAsync()
        {
            if (!CanExecuteLoad()) return;
            StatusMessage = "í˜„í™© ë°ì´í„° ë¡œë”© ì¤‘...";
            (LoadStatusCommand as RelayCommand)?.RaiseCanExecuteChanged();
            Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] LoadStatusDataAsync ì‹œì‘...");

            List<LockerAssignment> allAssignments = null;
            try
            {
                if (!CanExecuteLoad()) return;
                allAssignments = await _context.LockerAssignments.AsNoTracking().ToListAsync(_cts.Token);
                if (_disposed || _cts.IsCancellationRequested) return;

                var statusByType = CalculateStatus(allAssignments, a => a.LockerType);
                var statusByFloor = CalculateStatus(allAssignments, a => a.Floor);
                var statusByZone = CalculateStatus(allAssignments, a => a.Zone);

                if (_disposed || _cts.IsCancellationRequested) return;

                Application.Current.Dispatcher.Invoke(() =>
                {
                    if (_disposed || _cts.IsCancellationRequested || Application.Current == null) return;
                    StatusByType = new ObservableCollection<StatusItem>(statusByType);
                    StatusByFloor = new ObservableCollection<StatusItem>(statusByFloor);
                    StatusByZone = new ObservableCollection<StatusItem>(statusByZone);
                    StatusMessage = "í˜„í™© ë°ì´í„° ë¡œë“œ ì™„ë£Œ.";
                });
            }
            catch (OperationCanceledException) { Debug.WriteLine("LoadStatusDataAsync ì‘ì—… ì·¨ì†Œë¨."); if (!_disposed) StatusMessage = "í˜„í™© ë°ì´í„° ë¡œë”© ì·¨ì†Œë¨."; }
            catch (ObjectDisposedException) { Debug.WriteLine("LoadStatusDataAsync ì‹¤í–‰ ì¤‘ DbContext Disposeë¨."); if (!_disposed) StatusMessage = "í˜„í™© ë°ì´í„° ë¡œë”© ì˜¤ë¥˜ (ì»¨í…ìŠ¤íŠ¸ í•´ì œë¨)."; }
            catch (Exception ex) { StatusMessage = $"í˜„í™© ë°ì´í„° ë¡œë”© ì˜¤ë¥˜: {ex.Message}"; Debug.WriteLine($"!!! í˜„í™© ë°ì´í„° ë¡œë”© ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n{ex.ToString()}"); if (!App.IsShuttingDown && !_disposed) MessageBox.Show(StatusMessage, "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
            finally { if (!_disposed) (LoadStatusCommand as RelayCommand)?.RaiseCanExecuteChanged(); Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] LoadStatusDataAsync ì¢…ë£Œ."); }
        }

        private List<StatusItem> CalculateStatus(List<LockerAssignment> assignments, Func<LockerAssignment, string> groupingKeySelector)
        {
            if (assignments == null) return new List<StatusItem>();
            return assignments.GroupBy(groupingKeySelector).Select(g => { int total = g.Count(); int used = g.Count(a => !string.IsNullOrWhiteSpace(a.UserName)); int available = total - used; double rate = (total == 0) ? 0 : ((double)used / total * 100.0); return new StatusItem { GroupValue = g.Key ?? "ë¯¸ì§€ì •", TotalCount = total, UsedCount = used, AvailableCount = available, UsageRate = rate }; }).OrderBy(s => s.GroupValue).ToList();
        }

        #region IDisposable êµ¬í˜„
        protected virtual void Dispose(bool disposing) { if (!_disposed) { _disposed = true; if (disposing) { Debug.WriteLine("StatusViewModel Dispose ì‹œì‘..."); try { _cts?.Cancel(); } catch (Exception ex) { Debug.WriteLine($"!!! StatusVM CTS Cancel ì˜¤ë¥˜: {ex.Message}"); } try { _cts?.Dispose(); } catch (Exception ex) { Debug.WriteLine($"!!! StatusVM CTS Dispose ì˜¤ë¥˜: {ex.Message}"); } try { _context?.Dispose(); } catch (Exception ex) { Debug.WriteLine($"!!! StatusViewModel DbContext Dispose ì˜¤ë¥˜: {ex.Message}"); } Debug.WriteLine("StatusViewModel ë¦¬ì†ŒìŠ¤ í•´ì œ ì™„ë£Œ."); } } }
        public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }
        #endregion
    }
}
í•µì‹¬ ë³€ê²½ ì‚¬í•­:

Views/StatusWindow.xaml:
ë©”ì¸ Gridë¥¼ 2ê°œì˜ ì—´ë¡œ ë‚˜ëˆ„ì—ˆìŠµë‹ˆë‹¤.
ì¢Œì¸¡ ì—´(Grid.Column="0")ì— ê¸°ì¡´ 3ê°œì˜ í˜„í™© í‘œ(GroupBoxì™€ GridControl)ë¥¼ StackPanel ì•ˆì— ë°°ì¹˜í–ˆìŠµë‹ˆë‹¤. ê° GridControlì˜ MaxHeightë¥¼ ì„¤ì •í•˜ì—¬ ì„¸ë¡œ ê³µê°„ì„ ì ì ˆíˆ ë‚˜ëˆ„ë„ë¡ í–ˆìŠµë‹ˆë‹¤.
ìš°ì¸¡ ì—´(Grid.Column="1")ì— dxc:ChartControlì„ ì¶”ê°€í•˜ê³ , StatusByType ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ "ì‚¬ìš©"ê³¼ "ì—¬ìœ " ê°œìˆ˜ë¥¼ ë³´ì—¬ì£¼ëŠ” ë§‰ëŒ€ ì°¨íŠ¸ë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ë²”ë¡€ì™€ ì œëª©ë„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
GridControl íƒœê·¸ì—ì„œ ì˜ëª» ì‚¬ìš©ëœ IsReadOnly="True" ì†ì„±ì„ ì œê±°í–ˆìŠµë‹ˆë‹¤ (TableViewì˜ AllowEditing="False"ê°€ ì˜¬ë°”ë¥¸ ì†ì„±).
ì¶”ê°€ í™•ì¸ ì‚¬í•­:
