에서 특정 실제 크기에 맞춰 인쇄하려면, DPI 변환을 이용하여 화면 상의 UI 요소 크기를 정확히 인쇄할 수 있도록 조정해야 합니다. 사용자가 원하는 인쇄 크기(40mm x 42mm)를 정확히 실측에 맞추기 위해선, 프린터 DPI에 맞춰 XAML의 크기를 변환 후 ScaleTransform을 사용하여 조정합니다.

아래는 가로 40mm, 세로 42mm에 맞춰 인쇄하는 예제 코드입니다.

단계 요약
인쇄할 실제 크기 계산: 40mm와 42mm를 화면의 DPI에 맞는 픽셀 단위로 변환합니다.
ScaleTransform으로 크기 조정: 인쇄할 때 원하는 DPI에 맞춰 Viewbox 내 콘텐츠를 조정합니다.
예제 코드
다음은 이 요구사항을 적용한 전체 코드입니다.

XAML (MainWindow.xaml)
xml
코드 복사
<Window x:Class="LabelPrinter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Label Printer" Height="250" Width="220" Background="White">
    <Grid Name="PrintableArea">
        <Viewbox>
            <!-- 표 구조 시작 -->
            <Grid Background="White" Width="151" Height="159"> <!-- 40mm * 96 / 25.4 ≈ 151 픽셀, 42mm * 96 / 25.4 ≈ 159 픽셀 -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="64"/> <!-- 좌측 컬럼 너비 (약 17mm) -->
                    <ColumnDefinition Width="125"/> <!-- 우측 컬럼 너비 (약 33mm) -->
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/> <!-- 병합된 제목 행 -->
                    <RowDefinition Height="30"/> <!-- 코드 -->
                    <RowDefinition Height="30"/> <!-- LOT -->
                    <RowDefinition Height="30"/> <!-- 업체 -->
                    <RowDefinition Height="30"/> <!-- 라인/모델 -->
                    <RowDefinition Height="30"/> <!-- 관리자 확인 -->
                </Grid.RowDefinitions>

                <!-- 병합된 제목 행: 분할 자재 라벨 -->
                <Border Grid.Row="0" Grid.ColumnSpan="2" BorderThickness="1" BorderBrush="Black" Background="White">
                    <TextBlock Text="분할 자재 라벨" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="5"/>
                </Border>

                <!-- 좌측 컬럼: 라벨명들 -->
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="1" Grid.Column="0">
                    <TextBlock Text="코드:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="2" Grid.Column="0">
                    <TextBlock Text="LOT:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="3" Grid.Column="0">
                    <TextBlock Text="업체:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="4" Grid.Column="0">
                    <TextBlock Text="라인/모델:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="5" Grid.Column="0">
                    <TextBlock Text="관리자 확인:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>

                <!-- 우측 컬럼: 텍스트 입력 (테두리 없이 배경 투명) -->
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="1" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="2" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="3" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="4" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="5" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
            </Grid>
            <!-- 표 구조 끝 -->
        </Viewbox>

        <!-- 출력 버튼 -->
        <Button Content="출력" Width="100" Height="30" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,20" Click="PrintButton_Click"/>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)
프린터의 DPI에 따라 40mm x 42mm 크기로 맞춰 출력하는 코드입니다.

csharp
코드 복사
using System.Windows;
using System.Windows.Controls;
using System.Windows.Media;

namespace LabelPrinter
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void PrintButton_Click(object sender, RoutedEventArgs e)
        {
            PrintDialog printDialog = new PrintDialog();
            if (printDialog.ShowDialog() == true)
            {
                // 원하는 출력 크기 (mm)
                double widthMm = 40;
                double heightMm = 42;

                // 프린터 DPI 가져오기
                double dpiX = printDialog.PrintQueue.DefaultPrintTicket.PageResolution.X ?? 300; // 기본값으로 300 DPI 사용
                double dpiY = printDialog.PrintQueue.DefaultPrintTicket.PageResolution.Y ?? 300;

                // mm를 인치로 변환 후 DPI를 적용하여 픽셀 단위로 변환
                double widthInPixels = (widthMm / 25.4) * dpiX;
                double heightInPixels = (heightMm / 25.4) * dpiY;

                // ScaleTransform을 이용한 크기 조정
                double scaleX = widthInPixels / PrintableArea.ActualWidth;
                double scaleY = heightInPixels / PrintableArea.ActualHeight;
                Transform originalTransform = PrintableArea.LayoutTransform;
                PrintableArea.LayoutTransform = new ScaleTransform(scaleX, scaleY);

                // 강제로 레이아웃을 다시 계산 (새 DPI에 맞게)
                PrintableArea.Measure(new Size(widthInPixels, heightInPixels));
                PrintableArea.Arrange(new Rect(new Size(widthInPixels, heightInPixels)));

                // Viewbox를 실제로 인쇄
                printDialog.PrintVisual(PrintableArea, "Label Print");

                // 원래의 Transform 복원
                PrintableArea.LayoutTransform = originalTransform;
            }
        }
    }
}
설명
실제 크기 설정: widthMm과 heightMm를 원하는 출력 크기인 40mm x 42mm로 설정했습니다.
프린터 DPI 계산: printDialog.PrintQueue.DefaultPrintTicket.PageResolution에서 프린터 DPI 값을 가져와, 설정된 DPI가 없으면 기본값을 300 DPI로 사용합니다.
픽셀 변환: 40mm와 42mm를 각각 인치로 변환한 후, 프린터의 DPI를 곱해 픽셀 크기로 변환합니다.
ScaleTransform 적용: ScaleTransform을 사용해 XAML 요소가 40mm x 42mm 크기에 맞게 확대/축소됩니다.