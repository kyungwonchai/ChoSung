using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        private string connectionString = "Data Source=YourServer;Initial Catalog=YourDatabase;User ID=YourUsername;Password=YourPassword";

        public YourForm()
        {
            InitializeComponent();
        }

        private void YourForm_Load(object sender, EventArgs e)
        {
            // MSSQL에서 값을 가져오는 메서드 호출
            string value = GetSixthValueFromTable();
            MessageBox.Show("6번째 값: " + value);
        }

        private string GetSixthValueFromTable()
        {
            try
            {
                string value = string.Empty;

                using (SqlConnection connection = new SqlConnection(connectionString))
                {
                    connection.Open();

                    string query = "SELECT t1 FROM YourTable";
                    using (SqlCommand command = new SqlCommand(query, connection))
                    {
                        using (SqlDataReader reader = command.ExecuteReader())
                        {
                            if (reader.Read())
                            {
                                string t1Value = reader.GetString(0);

                                // 공백으로 분리
                                string[] values = t1Value.Split(new[] { ' ' }, StringSplitOptions.RemoveEmptyEntries);

                                // 6번째 값을 가져오기
                                if (values.Length >= 6)
                                {
                                    value = values[5];
                                }
                            }
                        }
                    }

                    connection.Close();
                }

                return value;
            }
            catch (Exception ex)
            {
                MessageBox.Show("MSSQL 데이터베이스에서 값 가져오기 중 오류가 발생했습니다:\n" + ex.Message);
                return string.Empty;
            }
        }
    }
}
