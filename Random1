다. 그 에러는 row["BCT1_1"]처럼 딕셔너리처럼 접근했는데, row가 리스트였을 경우 발생하는 오류입니다.

✅ 문제 원인
python
코드 복사
row = cursor.fetchall()  # ← 이건 리스트 of 딕셔너리 (여러 행)
그래서 row["컬럼명"] 은 불가능하고, row[0]["컬럼명"] 처럼 한 행을 먼저 선택해야 합니다.

✅ 해결 방법
1. Streamlit 코드 내 수정 포인트
row = get_latest_data_by_line(selected_line) 아래를 이렇게 바꾸세요:

python
코드 복사
# If row is a list of rows (e.g., from fetchall), pick the first
if isinstance(row, list):
    if len(row) > 0:
        row = row[0]
    else:
        row = None
또는 fetchone()을 사용하세요 (추천)
python
코드 복사
def get_latest_data_by_line(line1):
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor(as_dict=True)  # ✅ must be as_dict
    cursor.execute("EXEC Get_Ct_Min_By_Line_LatestModels %s", (line1,))
    row = cursor.fetchone()  # ✅ returns a dictionary (OK!)
    conn.close()
    return row
이러면 make_ct_table() 안의 row["BCT1_1"]처럼 쓰는 게 정상 작동합니다.

✅ 추가 안전 체크
python
코드 복사
if row is None:
    st.warning("No data found for the selected line.")
else:
    make_ct_table("CT1", "BCT1", "TCT1", "ACT1")
✅ 요약
발생 원인	해결 방법
row가 리스트인데 row["컬럼명"]으로 접근	row[0]처럼 먼저 요소 꺼내기 또는 fetchone() 사용