배열 수식(array formula)은 Excel에서 다수의 셀 범위에 대한 연산을 한 번에 처리할 수 있게 해주는 기능입니다. 일반 수식이 단일 값에 대한 계산을 수행하는 것과는 달리, 배열 수식은 여러 값들을 포함한 배열에 대해 계산을 수행합니다.

예를 들어, 아래와 같은 배열 수식을 생각해 봅시다.

excel

=MAX(IF(INDIRECT(H1)<=180, ABS(0-INDIRECT(H1)), ABS(360-INDIRECT(H1))))

    INDIRECT(H1): H1 셀에 지정된 문자열을 실제 셀 범위로 변환합니다.
    INDIRECT(H1)<=180: 이 조건을 만족하는지 각 셀을 확인합니다. 이 결과는 불리언 배열로 반환됩니다.
    ABS(0-INDIRECT(H1)), ABS(360-INDIRECT(H1)): 조건에 따라 해당 계산을 수행하고 절대값을 취합니다.
    IF(조건, 값1, 값2): 조건을 만족하면 값1을, 만족하지 않으면 값2를 반환합니다.
    MAX(): 이 중에서 가장 큰 값을 찾습니다.

배열 수식을 입력한 후에는 Ctrl+Shift+Enter를 눌러야 일부 Excel 버전에서 정상적으로 작동합니다. 이렇게 하면 수식이 중괄호 {}로 둘러싸여 표시되며, 이것이 배열 수식임을 나타냅니다.

이렇게 배열 수식은 여러 단계의 연산과 여러 셀을 포함할 수 있어 복잡한 계산도 한 번에 수행할 수 있습니다.
