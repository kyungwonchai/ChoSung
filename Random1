using DevExpress.XtraGrid.Columns;
using DevExpress.XtraGrid.Views.Grid;
using DevExpress.XtraEditors;
using DevExpress.XtraEditors.Controls;
using System;
using System.Data;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : XtraForm
    {
        // GridControl과 GridView 객체 선언
        private GridControl gridControl1;
        private GridView gridView1;

        public YourForm()
        {
            InitializeComponent();
        }

        private void YourForm_Load(object sender, EventArgs e)
        {
            // GridControl 및 GridView 초기화
            gridControl1 = new GridControl();
            gridView1 = new GridView();

            // GridControl 및 GridView 설정
            gridControl1.Dock = DockStyle.Fill;
            gridControl1.MainView = gridView1;
            gridControl1.ViewCollection.Add(gridView1);
            Controls.Add(gridControl1);

            // 컬럼 추가
            gridView1.Columns.Add(CreateColumn("품목 코드", "ProductCode"));
            gridView1.Columns.Add(CreateColumn("품목 이름", "ProductName"));
            gridView1.Columns.Add(CreateButtonColumn());

            // 데이터 예시
            DataTable dataTable = new DataTable();
            dataTable.Columns.Add("ProductCode", typeof(string));
            dataTable.Columns.Add("ProductName", typeof(string));
            dataTable.Rows.Add("P001", "품목 1");
            dataTable.Rows.Add("P002", "품목 2");
            gridControl1.DataSource = dataTable;
        }

        // 컬럼 생성 메서드
        private GridColumn CreateColumn(string caption, string fieldName)
        {
            GridColumn column = new GridColumn();
            column.Caption = caption;
            column.FieldName = fieldName;
            column.Visible = true;
            return column;
        }

        // 버튼 컬럼 생성 메서드
        private GridColumn CreateButtonColumn()
        {
            GridColumn buttonColumn = new GridColumn();
            buttonColumn.Caption = "버튼";
            buttonColumn.FieldName = "ButtonColumn";
            buttonColumn.Visible = true;
            buttonColumn.ColumnEdit = CreateButtonEdit();
            return buttonColumn;
        }

        // 버튼 에디터 생성 메서드
        private RepositoryItemButtonEdit CreateButtonEdit()
        {
            RepositoryItemButtonEdit buttonEdit = new RepositoryItemButtonEdit();
            buttonEdit.TextEditStyle = TextEditStyles.HideTextEditor;
            buttonEdit.Buttons[0].Caption = "신청";
            buttonEdit.ButtonClick += Button_Click;
            return buttonEdit;
        }

        // 버튼 클릭 이벤트 핸들러
        private void Button_Click(object sender, ButtonPressedEventArgs e)
        {
            ButtonEdit buttonEdit = (ButtonEdit)sender;
            int rowIndex = gridView1.FocusedRowHandle;

            if (rowIndex >= 0)
            {
                string productCode = gridView1.GetRowCellValue(rowIndex, "ProductCode").ToString();

                // 품목 코드 처리
                // 여기서는 간단히 메시지 박스로 품목 코드 출력
                XtraMessageBox.Show("선택된 행의 품목 코드: " + productCode);
            }
        }
    }
}
