reamlit Code (MSSQL2014 ë°ì´í„° ì¡°íšŒ - cursor.fetchall() ë°©ì‹ìœ¼ë¡œ ë³€ê²½)
ì•„ë˜ ì½”ë“œëŠ” pandas ëŒ€ì‹  cursor.fetchall()ì„ ì‚¬ìš©í•˜ì—¬ Get_min_bestdifferent í”„ë¡œì‹œì €ì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    rows = cursor.fetchall()
    columns = [desc[0] for desc in cursor.description]  # ì»¬ëŸ¼ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
    conn.close()
    
    # ë°ì´í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ ë¦¬ìŠ¤íŠ¸ë¡œ ë³€í™˜
    data = [dict(zip(columns, row)) for row in rows]
    return data, columns

# í…Œì´ë¸”ì—ì„œ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ëŠ” HTML ìŠ¤íƒ€ì¼ í•¨ìˆ˜
def generate_html_table(data, columns):
    html = "<table border='1' style='width:100%; border-collapse: collapse;'>"
    html += "<thead><tr>"
    for col in columns:
        html += f"<th>{col}</th>"
    html += "</tr></thead><tbody>"

    act2_columns = [f'act2_{i}' for i in range(1, 9)]

    for row in data:
        html += "<tr>"
        # act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ ì°¾ê¸°
        act2_values = [row[col] for col in act2_columns]
        max_value = max(act2_values)
        
        for col in columns:
            value = row[col]
            if col in act2_columns and value == max_value:
                html += f"<td style='background-color: yellow;'>{value}</td>"
            else:
                html += f"<td>{value}</td>"
        html += "</tr>"

    html += "</tbody></table>"
    return html

# Streamlit ì•± êµ¬ì„±
def main():
    st.set_page_config(layout="wide")
    st.title("Ranked Data Table - act2_1 ~ act2_8 Highlighting (Cursor ë°©ì‹)")

    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    data, columns = fetch_main_data()
    
    st.subheader("act2_1 ~ act2_8 ë°ì´í„° í…Œì´ë¸”")
    
    # HTML í…Œì´ë¸” ìƒì„± ë° í‘œì‹œ
    html_table = generate_html_table(data, columns)
    st.markdown(html_table, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
ğŸ“Œ ì½”ë“œ ì„¤ëª…
MSSQL ì—°ê²° ì„¤ì • (get_connection())

pymssql.connect()ë¥¼ ì‚¬ìš©í•˜ì—¬ MSSQL ì„œë²„ì— ì—°ê²°í•©ë‹ˆë‹¤.

ì„œë²„ ì •ë³´ (YOUR_SERVER, YOUR_USER, YOUR_PASSWORD, YOUR_DATABASE)ëŠ” ë³¸ì¸ì˜ ê°’ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”.

ë°ì´í„° ì¡°íšŒ (fetch_main_data())

cursor.fetchall() ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

cursor.descriptionìœ¼ë¡œ ì»¬ëŸ¼ ì´ë¦„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ ë”•ì…”ë„ˆë¦¬ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.

HTML í…Œì´ë¸” ìƒì„± (generate_html_table())

ë°ì´í„°ë¥¼ HTML í˜•ì‹ì˜ í…Œì´ë¸”ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤.

Streamlit ì•± êµ¬ì„± (main())

HTML í…Œì´ë¸”ì„ st.markdown()ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.

unsafe_allow_html=True ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ HTML ë Œë”ë§ì„ í—ˆìš©í•©ë‹ˆë‹¤.

ğŸ“Œ ì„¤ì¹˜ í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql
ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬
streamlit run your_script_name.py
ğŸ’¡ ê²°ê³¼ í™”ë©´ ì„¤ëª…
ê° í–‰ë§ˆë‹¤ act2_1 ~ act2_8 ê°’ ì¤‘ ìµœëŒ€ê°’ì´ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°ë©ë‹ˆë‹¤.

pandas ëŒ€ì‹  cursor.fetchall() ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

Streamlitì—ì„œ HTMLë¡œ ë Œë”ë§í•˜ì—¬ í‘œì‹œí•©ë‹ˆë‹¤.