ìˆ˜ì • ì‚¬í•­ ì •ë¦¬
ACT2_1 ~ ACT2_8 ê°’ì€ float íƒ€ì…ìœ¼ë¡œ ë°›ì•„ ì†Œìˆ˜ì  2ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œ (ë°˜ì˜¬ë¦¼).

Streamlitì˜ íƒ­ì„ ì¢Œìƒë‹¨ì— ìœ„ì¹˜ì‹œí‚¤ê³ , í™”ë©´ ì „ì²´ì— ê±¸ì³ í‘œì‹œë˜ë„ë¡ ì„¤ì •.

í‘œì‹œë˜ëŠ” í‘œê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡ wide ëª¨ë“œë¡œ ì „ì²´ í™”ë©´ì„ ì‚¬ìš©.

âœ… ìˆ˜ì •ëœ Streamlit ì½”ë“œ (ì†Œìˆ˜ì  ë°˜ì˜¬ë¦¼ & ì „ì²´ í™”ë©´ í‘œì‹œ)
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql
import pandas as pd

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    rows = cursor.fetchall()
    conn.close()
    return rows

# DataFrame ìƒì„± ë° ìŠ¤íƒ€ì¼ ì ìš© í•¨ìˆ˜
def create_dataframe(rows):
    # ì›ë˜ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì˜¨ ì»¬ëŸ¼ (ACT2_1 ~ ACT2_8 í¬í•¨)
    original_columns = [
        "group1", "line1", "model1", "type1", "ecn1", "edition1",
        "ACT2_1", "ACT2_2", "ACT2_3", "ACT2_4",
        "ACT2_5", "ACT2_6", "ACT2_7", "ACT2_8"
    ]
    
    # ìƒˆë¡œìš´ DataFrame ì»¬ëŸ¼ëª… (MC1 ~ MC8ìœ¼ë¡œ ë³€ê²½)
    new_columns = [
        "group1", "line1", "model1", "type1", "ecn1", "edition1",
        "MC1", "MC2", "MC3", "MC4", "MC5", "MC6", "MC7", "MC8"
    ]

    # DataFrame ìƒì„± (ì›ë˜ ì»¬ëŸ¼ìœ¼ë¡œ)
    df = pd.DataFrame(rows, columns=original_columns)

    # ì»¬ëŸ¼ ì´ë¦„ì„ MC1 ~ MC8ë¡œ ë³€ê²½
    df.columns = new_columns

    # MC1 ~ MC8 ì—´ ë¦¬ìŠ¤íŠ¸
    mc_columns = [f"MC{i}" for i in range(1, 9)]

    # ìˆ«ìê°’ì„ ì†Œìˆ˜ì  2ìë¦¬ë¡œ ë°˜ì˜¬ë¦¼
    df[mc_columns] = df[mc_columns].astype(float).round(2)

    # ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ëŠ” ìŠ¤íƒ€ì¼ í•¨ìˆ˜
    def highlight_max(row):
        max_value = row[mc_columns].max()
        return ['background-color: yellow' if v == max_value else '' for v in row]

    # ìŠ¤íƒ€ì¼ ì ìš©
    styled_df = df.style.apply(highlight_max, subset=mc_columns, axis=1)
    return styled_df

# Streamlit ì•± êµ¬ì„±
def main():
    # ì „ì²´ í™”ë©´ ì‚¬ìš© ì„¤ì •
    st.set_page_config(page_title="MC1 ~ MC8 Data Table", layout="wide")
    st.title("MC1 ~ MC8 Data Table with Styling")

    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    rows = fetch_main_data()

    if not rows:
        st.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í”„ë¡œì‹œì € ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.")
    else:
        # DataFrame ìƒì„± ë° ìŠ¤íƒ€ì¼ ì ìš©
        styled_df = create_dataframe(rows)
        
        # Streamlit í‘œì‹œ (Styled DataFrame)
        st.write(styled_df)

if __name__ == "__main__":
    main()
âœ… ì½”ë“œ ìˆ˜ì • ì‚¬í•­
ì†Œìˆ˜ì  2ìë¦¬ ë°˜ì˜¬ë¦¼ (float)

python
ì½”ë“œ ë³µì‚¬
df[mc_columns] = df[mc_columns].astype(float).round(2)
ëª¨ë“  MC1 ~ MC8 ì—´ì„ floatë¡œ ë³€í™˜í•˜ê³ , ì†Œìˆ˜ì  2ìë¦¬ë¡œ ë°˜ì˜¬ë¦¼.

ë°ì´í„°ê°€ ì†Œìˆ˜ì  2ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œë˜ë„ë¡ ì„¤ì •.

ì „ì²´ í™”ë©´ í‘œì‹œ (st.set_page_config())

python
ì½”ë“œ ë³µì‚¬
st.set_page_config(page_title="MC1 ~ MC8 Data Table", layout="wide")
layout="wide" ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ ì „ì²´ í™”ë©´ ëª¨ë“œë¡œ ì„¤ì •.

í‘œê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡ ìµœëŒ€ í¬ê¸°ë¡œ í‘œì‹œí•¨.

íƒ­ ì œê±° ë° í™”ë©´ ìµœì í™”

íƒ­ ëŒ€ì‹  ì „ì²´ í™”ë©´ì— í‘œì‹œë˜ë„ë¡ ì„¤ì •.

Streamlitì˜ ê¸°ë³¸ ë ˆì´ì•„ì›ƒì„ ì‚¬ìš©í•˜ì—¬ íƒ­ ì—†ì´ í° í™”ë©´ì„ ì‚¬ìš©.

ğŸ“Œ ì„¤ì¹˜ í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql pandas
ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬
streamlit run your_script_name.py
ğŸ”¥ ê²°ê³¼
ACT2_1 ~ ACT2_8 ê°’ì´ floatë¡œ ë³€í™˜ë˜ë©°, ì†Œìˆ˜ì  2ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œë¨.

í‘œëŠ” ì „ì²´ í™”ë©´ì— í‘œì‹œë˜ë©° ì˜ë¦¬ì§€ ì•ŠìŒ.

ìµœëŒ€ê°’ì€ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡° í‘œì‹œë¨.