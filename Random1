ApplyDateTimeFormat()
    Dim ws As Worksheet
    Dim dtimeCol As Range
    Dim lastRow As Long
    Dim colName As String

    ' 적용할 컬럼 이름
    colName = "dtime" ' 변경하려는 열 이름
    
    ' 현재 활성화된 워크시트 선택
    Set ws = ActiveSheet
    
    ' dtime 컬럼 찾기
    On Error Resume Next
    Set dtimeCol = ws.Rows(1).Find(What:=colName, LookIn:=xlValues, LookAt:=xlWhole)
    On Error GoTo 0
    
    ' dtime 컬럼이 존재하면 실행
    If Not dtimeCol Is Nothing Then
        ' 마지막 행 찾기
        lastRow = ws.Cells(ws.Rows.Count, dtimeCol.Column).End(xlUp).Row
        
        ' dtime 컬럼에 셀 서식 적용
        ws.Range(ws.Cells(2, dtimeCol.Column), ws.Cells(lastRow, dtimeCol.Column)).NumberFormat = "yy-MM-dd HH"
        
        MsgBox "dtime 컬럼에 'yy-MM-dd HH' 형식이 적용되었습니다.", vbInformation
    Else
        MsgBox "dtime 컬럼을 찾을 수 없습니다.", vbExclamation
    End If
End Sub
코드 설명
컬럼 이름 찾기:

Find 함수를 사용해 dtime이라는 열 제목을 첫 번째 행에서 검색합니다.
서식 적용 범위:

ws.Range(ws.Cells(2, dtimeCol.Column), ws.Cells(lastRow, dtimeCol.Column))로 dtime 열의 데이터 범위를 지정합니다.
NumberFormat = "yy-MM-dd HH"로 셀 서식을 yy-MM-dd HH로 설정하여 **날짜와 시간(시)**까지만 표시되도록 합니다.
에러 처리:

dtime 컬럼이 없는 경우 에러를 방지하며, 컬럼을 찾을 수 없을 때 경고 메시지를 표시합니다.
실행 결과
이 코드를 실행하면:
