후에 엑셀 파일을 삭제하는 함수를 추가해보겠습니다. 아래의 코드를 MainForm 클래스에 추가해주세요:

csharp

private void DeleteExcelFile(string filePath)
{
    try
    {
        File.Delete(filePath);
    }
    catch (Exception ex)
    {
        // 파일 삭제 실패 시 예외 처리
        MessageBox.Show($"엑셀 파일 삭제 중 오류가 발생했습니다: {ex.Message}");
    }
}

위의 함수는 File.Delete() 메서드를 사용하여 지정된 파일을 삭제합니다. 파일 삭제 중에 예외가 발생하는 경우에는 해당 예외를 캐치하고 에러 메시지를 보여주는 메시지 박스를 표시합니다.

ProcessExcelFile() 메서드의 마지막 부분에서 DeleteExcelFile() 함수를 호출하여 엑셀 파일을 삭제하도록 수정해주세요:

csharp

private void ProcessExcelFile(string filePath)
{
    // 엑셀 파일 처리 로직 구현

    // 파일 처리가 완료되면 엑셀 파일 삭제
    DeleteExcelFile(filePath);
}

이제 데이터 처리가 완료된 후에 엑셀 파일이 삭제될 것입니다. 파일 삭제 시 예외가 발생하면 해당 오류 메시지가 표시됩니다.