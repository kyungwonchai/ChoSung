래는 MPxDATA 컬럼이 숫자가 아닌 경우 해당 값을 99로 처리하도록 수정한 함수입니다.

수정된 AddDefaultColumn 함수
csharp
코드 복사
private void AddDefaultColumn(Dictionary<string, object> row, string columnName, string[] values, int index)
{
    if (index < values.Length && !string.IsNullOrWhiteSpace(values[index]))
    {
        if (float.TryParse(values[index], out var numericValue))
        {
            row[columnName] = numericValue; // 숫자로 변환 가능하면 숫자 값 추가
        }
        else if (columnName.Contains("DATA"))
        {
            row[columnName] = 99; // 숫자가 아니면 99로 처리
        }
        else
        {
            row[columnName] = "NA"; // RESULT 컬럼은 문자열 "NA"로 처리
        }
    }
    else
    {
        // 값이 없으면 기본값 추가
        if (columnName.Contains("DATA"))
        {
            row[columnName] = 0; // 숫자 컬럼 기본값 0
        }
        else
        {
            row[columnName] = "NA"; // 문자열 컬럼 기본값 NA
        }
    }
}
수정된 부분 요약
float.TryParse로 숫자 검증:

DATA 컬럼이 숫자가 아니면 99로 처리:
csharp
코드 복사
else if (columnName.Contains("DATA"))
{
    row[columnName] = 99; // 숫자가 아니면 99로 처리
}
기본값 설정:

값이 없는 경우:
DATA 컬럼: 기본값 0.
RESULT 컬럼: 기본값 "NA".
적용 결과
입력 데이터
plaintext
코드 복사
2025-01-10 10:00:00,ModelA,Good,123.45,Result1,abc,Result2,45.67,Result3,XYZ,Result4,,Result5
처리 결과
plaintext
코드 복사
{
    "InspectionTime": "2025-01-10 10:00:00",
    "ModelName": "ModelA",
    "AlignResult": "Good",
    "MP1DATA": 123.45,
    "MP1RESULT": "Result1",
    "MP2DATA": 99,         // "abc" → 99
    "MP2RESULT": "Result2",
    "MP3DATA": 45.67,
    "MP3RESULT": "Result3",
    "MP4DATA": 99,         // "XYZ" → 99
    "MP4RESULT": "Result4",
    "MP5DATA": 0,          // 값이 없으므로 0
    "MP5RESULT": "NA"      // 값이 없으므로 "NA"
}
이제 MPxDATA 컬럼이 숫자가 아니면 99로 처리되며, 누락된 값은 0 또는 "NA"로 기본 처리됩니다.






나의 말:
아니 씨바 MPRESULT값에는 지금 숫자가 아니라 항상 문자야 그건 제외하고 MPDATA만 ,,,만약 문자라면 숫자99로하라고 다시줘 수정필요한함수
ChatGPT의 말:
ChatGPT
다음은 MPxDATA 값이 숫자가 아닌 경우 99로 설정하고, MPxRESULT는 항상 문자이므로 변경하지 않도록 수정된 함수입니다.

수정된 AddDefaultColumn 함수
csharp
코드 복사
private void AddDefaultColumn(Dictionary<string, object> row, string columnName, string[] values, int index)
{
    if (index < values.Length && !string.IsNullOrWhiteSpace(values[index]))
    {
        if (columnName.Contains("DATA"))
        {
            // DATA 컬럼은 숫자가 아니면 99로 처리
            if (float.TryParse(values[index], out var numericValue))
            {
                row[columnName] = numericValue; // 숫자로 변환 가능하면 숫자 값 추가
            }
            else
            {
                row[columnName] = 99; // 숫자가 아니면 99로 처리
            }
        }
        else if (columnName.Contains("RESULT"))
        {
            // RESULT 컬럼은 항상 문자 그대로 추가
            row[columnName] = values[index];
        }
    }
    else
    {
        // 값이 없으면 기본값 추가
        if (columnName.Contains("DATA"))
        {
            row[columnName] = 0; // DATA 컬럼 기본값 0
        }
        else if (columnName.Contains("RESULT"))
        {
            row[columnName] = "NA"; // RESULT 컬럼 기본값 "NA"
        }
    }
}
수정된 부분 요약
DATA 컬럼 처리:

숫자가 아니면 기본값 99로 설정:
csharp
코드 복사
if (float.TryParse(values[index], out var numericValue))
{
    row[columnName] = numericValue; // 숫자 값 추가
}
else
{
    row[columnName] = 99; // 숫자가 아니면 99로 처리
}
RESULT 컬럼 처리:

항상 문자 그대로 추가:
csharp
코드 복사
row[columnName] = values[index];
기본값 처리:

값이 없는 경우:
DATA: 기본값 0.
RESULT: 기본값 "NA".
적용 결과
입력 데이터
plaintext
코드 복사
2025-01-10 10:00:00,ModelA,Good,123.45,Result1,abc,Result2,45.67,Result3,,Result4,XYZ,Result5
처리 결과
plaintext
코드 복사
{
    "InspectionTime": "2025-01-10 10:00:00",
    "ModelName": "ModelA",
    "AlignResult": "Good",
    "MP1DATA": 123.45,
    "MP1RESULT": "Result1",
    "MP2DATA": 99,         // "abc" → 99
    "MP2RESULT": "Result2",
    "MP3DATA": 45.67,
    "MP3RESULT": "Result3",
    "MP4DATA": 0,          // 값이 없으므로 0
    "MP4RESULT": "Result4",
    "MP5DATA": 99,         // "XYZ" → 99
    "MP5RESULT": "Result5"