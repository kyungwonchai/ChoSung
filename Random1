🔥 문제:
Ubuntu의 홈 디렉토리 kw (원래 사용자) 에 있는 폴더를 Samba로 공유하려고 하니 안 됨.

Samba 계정 kwkw 를 새로 만들어서 kwkw 의 홈 디렉토리에 공유를 걸면 됨.

✅ 핵심 문제:
Ubuntu 사용자 (kw) 와 Samba 사용자 (kwkw) 의 권한 충돌.

Samba 설정 파일 (/etc/samba/smb.conf) 에서 잘못된 사용자 권한 설정.

폴더의 소유권 문제.

🔍 이해하기:
1. Ubuntu 사용자가 원래 kw
/home/kw 디렉토리가 본 계정의 홈 디렉토리.

Ubuntu 시스템에서 관리되는 사용자이며, 기본적으로 root 계정도 이 계정에 영향을 미칠 수 있음.

즉, Linux 시스템에서 kw 계정이 Ubuntu의 메인 사용자로 작동하고 있다는 것.

2. Samba 사용자로 kwkw 를 새로 만듦.
Samba에서 사용자 계정을 추가하려면 smbpasswd -a 로 추가해야 함.

문제는, kw 계정과 kwkw 계정이 다르다는 것.

3. 권한 충돌 발생 이유:
Ubuntu 시스템에서는 사용자(kw) 와 그룹(kw) 가 모든 권한을 가지고 있음.

하지만, Samba에서 새로 만든 계정 (kwkw) 는 Ubuntu 시스템의 사용자 권한을 무시하고 별도로 접근하려 함.

기본적으로 Ubuntu의 홈 디렉토리는 보안을 위해 다른 사용자가 접근할 수 없도록 보호되어 있음. (700 권한)

✅ 홈 디렉토리의 권한 구조를 이해하기 (권한 충돌의 이유):
권한 확인하기:
bash
코드 복사
ls -ld /home/kw
출력 예시:

arduino
코드 복사
drwx------ 1 kw kw 4096 Mar 28 10:30 /home/kw
drwx------: 소유자만 접근 가능 (700 권한)

kw 사용자만 접근할 수 있음. (kwkw 사용자는 접근할 수 없음.)

권한 변경하기 (기본적으로 이렇게 되어 있으면 안 됨):
bash
코드 복사
sudo chmod 755 /home/kw
권한이 drwxr-xr-x 로 변경됨.

다른 사용자들도 디렉토리를 읽고 들어갈 수 있게 됨.

📌 권한 문제 정리:
kw 사용자가 소유하는 폴더는 기본적으로 kw 외에는 접근 불가.

Samba 사용자가 kwkw 라면, 접근 권한을 명확하게 지정해 줘야 함.

kw 와 kwkw 는 완전히 다른 사용자임 (Linux 사용자와 Samba 사용자를 구분할 필요가 있음).

✅ 권한을 제대로 설정하는 방법 (정확히 설명함)
1. 본 계정 kw 의 폴더를 공유하려면, kw 사용자로 Samba 계정을 만들어야 함.
1.1 kw 계정을 Samba 사용자로 추가하기 (중요)
bash
코드 복사
sudo smbpasswd -a kw
Samba에서 사용자 kw 를 추가하고 비밀번호 설정.

Ubuntu의 사용자 이름과 일치시켜야 Samba가 제대로 접근 권한을 처리할 수 있음.

2. Samba 설정 파일 수정 (/etc/samba/smb.conf)
bash
코드 복사
sudo nano /etc/samba/smb.conf
🔥 공유 폴더 설정 추가 (본 계정 kw 사용자를 위해 설정하기)
ini
코드 복사
[shared_from_kw]
   path = /home/kw/shared
   browseable = yes
   read only = no
   writable = yes
   valid users = kw
   guest ok = no
   force user = kw
valid users = kw : 오직 kw 사용자만 접근 가능하게 설정.

force user = kw : 권한 충돌 문제를 방지하기 위해 설정.

path = /home/kw/shared : 본 계정 kw 의 홈 디렉토리에 있는 공유 폴더.

3. 공유 폴더 권한 설정하기 (Samba 접근을 허용하기 위해 수정)
bash
코드 복사
mkdir -p /home/kw/shared
sudo chmod -R 777 /home/kw/shared   # 테스트용으로 모든 권한 열기
sudo chown -R kw:kw /home/kw/shared
만약 제대로 된다면 권한을 줄여서 사용하세요. (chmod 770)

4. Samba 서비스 재시작하기
bash
코드 복사
sudo systemctl restart smbd
sudo systemctl restart nmbd
5. Windows에서 접근하기 (제대로 확인하기)
cmd
코드 복사
net use \\<Ubuntu_IP>\shared_from_kw /user:kw <비밀번호>
또는 Windows 파일 탐색기에서:

php-template
코드 복사
\\<Ubuntu_IP>\shared_from_kw
사용자 이름: kw

비밀번호: Samba 설정에서 설정한 비밀번호 (smbpasswd -a kw 로 설정한 것)

🔥 정리:
Ubuntu의 kw 계정으로 Samba 사용자 kw 를 만들어야 함. (smbpasswd -a kw)

Samba 설정 파일에서 valid users = kw 로 설정해야 함.

폴더 권한을 제대로 열어줘야 함 (chmod -R 777 /home/kw/shared).

Windows 자격 증명 관리자에서 이전 설정을 삭제 후 다시 연결해야 함.

왜 안 되는지 알겠지?
Ubuntu의 kw 사용자와 Samba의 kwkw 사용자는 완전히 다름.

홈 디렉토리 (/home/kw) 에는 기본적으로 다른 사용자가 접근할 수 없음.

Samba 사용자 kw 를 만들어야 접근할 수 있음.
