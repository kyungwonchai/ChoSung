using Microsoft.Web.WebView2.WinForms;
using System.Diagnostics;
using System.Windows.Forms;

public partial class Form1 : Form
{
    private WebView2 webView;
    private Process jupyterProcess;  // Process object to keep track of the Jupyter server

    public Form1()
    {
        InitializeComponent();

        this.webView = new WebView2
        {
            Dock = DockStyle.Fill,
        };

        this.Controls.Add(this.webView);

        StartJupyterServer();

        // Ensure the Jupyter server is closed when the form is closing
        this.FormClosing += (s, e) => {
            if (jupyterProcess != null && !jupyterProcess.HasExited)
            {
                jupyterProcess.Kill();
                jupyterProcess.Dispose();
            }
        };
    }

    private void StartJupyterServer()
    {
        ProcessStartInfo startInfo = new ProcessStartInfo
        {
            FileName = "{PATH_TO_JUPYTER}\\jupyter-notebook.exe",
            Arguments = "--no-browser --NotebookApp.token=''",
            WindowStyle = ProcessWindowStyle.Hidden,
        };

        jupyterProcess = Process.Start(startInfo);

        // Give the server some time to start.
        System.Threading.Thread.Sleep(5000);

        this.webView.Source = new Uri("http://localhost:8888");
    }
}
