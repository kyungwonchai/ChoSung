using System;
using System.Runtime.InteropServices;

class Program
{
    // 외부 라이브러리를 사용하기 위해 DLL 임포트
    [DllImport("user32.dll")]
    static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, uint dwExtraInfo);

    // 컨트롤 키와 화살표 키의 가상 키 코드
    const int VK_CONTROL = 0x11;
    const int VK_LEFT = 0x25;
    const int VK_RIGHT = 0x27;

    // 키 이벤트 상수
    const int KEYEVENTF_KEYUP = 0x2;

    static void Main()
    {
        // 버튼을 누르면 데스크톱을 전환하도록 이벤트 핸들러 등록
        // 이 부분은 버튼을 클릭하는 이벤트 핸들러에 추가해야 합니다.
        Button1.Click += Button1_Click;
    }

    static void Button1_Click(object sender, EventArgs e)
    {
        // 컨트롤 키를 누른 상태로 화살표 키를 누르고 떼어주는 코드
        keybd_event((byte)VK_CONTROL, 0, 0, 0); // 컨트롤 키 누르기
        keybd_event((byte)VK_LEFT, 0, 0, 0); // 왼쪽 화살표 키 누르기

        // 잠시 대기 (데스크톱이 전환되는 동안 기다림)
        System.Threading.Thread.Sleep(1000); // 1초

        keybd_event((byte)VK_LEFT, 0, KEYEVENTF_KEYUP, 0); // 왼쪽 화살표 키 떼기
        keybd_event((byte)VK_CONTROL, 0, KEYEVENTF_KEYUP, 0); // 컨트롤 키 떼기
    }
}
