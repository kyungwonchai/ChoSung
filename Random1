from PIL import Image, ImageDraw, ImageFont

def create_icon(text, font_path, font_size, output_file):
    # 폰트 로드
    font = ImageFont.truetype(font_path, font_size)

    # 텍스트를 라인별로 나눔
    lines = text.splitlines()
    line_height = font.getmetrics()[1]

    # 각 라인의 최대 너비와 전체 높이를 계산
    text_width = max(font.getbbox(line)[2] for line in lines)
    text_height = line_height * len(lines) * 1.2  # 20%의 줄 간격 추가

    # 이미지 크기 계산
    image_width = image_height = max(text_width, text_height) + 10

    # 이미지 생성 (흰색 배경)
    image = Image.new("RGBA", (image_width, image_height), (255, 255, 255, 255))

    # 이미지에 텍스트 그리기
    draw = ImageDraw.Draw(image)
    for i, line in enumerate(lines):
        text_width, _ = font.getbbox(line)[2:4]
        text_x = (image_width - text_width) // 2
        text_y = int(i * line_height * 1.2)  # 20%의 줄 간격 추가
        draw.text((text_x, text_y), line, font=font, fill=(0, 0, 0, 255))  # 검은색 텍스트

    # 이미지 크기 조정
    image = image.resize((640, 640), Image.LANCZOS)

    # PNG 파일로 저장
    image.save(output_file, "PNG")

# 예시 실행
text = "안녕\n세상"  # 사용자가 입력한 텍스트
font_path = "font.ttf"  # 사용할 글꼴 파일 경로 (확장자에 따라 다를 수 있음)
font_size = 500  # 글꼴 크기
output_file = "icon.png"  # 출력 파일명

create_icon(text, font_path, font_size, output_file)
