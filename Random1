using Ghostscript.NET;
using Ghostscript.NET.Rasterizer;
using System.Drawing.Imaging;
using System.IO;

namespace PDFToImageConverter
{
    class Program
    {
        static void Main(string[] args)
        {
            string pdfFilePath = "your_pdf_file_path.pdf";
            string outputFolder = "output_folder_path";

            using (GhostscriptRasterizer rasterizer = new GhostscriptRasterizer())
            {
                using (GhostscriptVersionInfo version = GhostscriptVersionInfo.GetLastInstalledVersion())
                {
                    rasterizer.Open(pdfFilePath, version, false);

                    for (int i = 1; i <= rasterizer.PageCount; i++)
                    {
                        string outputFilePath = Path.Combine(outputFolder, $"Page{i}.jpg");

                        using (System.Drawing.Image img = rasterizer.GetPage(96, 96, i)) // 96 DPI
                        {
                            img.Save(outputFilePath, ImageFormat.Jpeg);
                        }
                    }

                    rasterizer.Close();
                }
            }
        }
    }
}
