 TreeView는 기본적으로 각 노드의 Expanded 상태를 프로그래밍적으로 제어할 수 없습니다. 대신, TreeViewItem의 IsExpanded 속성을 사용해야 합니다. 이를 위해 TreeView의 각 항목에 대한 컨트롤 템플릿을 수정하거나 데이터 바인딩으로 구현할 수 있습니다.

TreeView를 항상 펼쳐진 상태로 유지하는 방법
아래는 모든 항목이 기본적으로 펼쳐지도록 설정하고, 데이터 바인딩을 사용하여 IsExpanded를 제어하는 방법입니다.

수정된 C# 코드
모든 트리 노드가 항상 펼쳐지도록 LineGroup 및 LineInfo 클래스에 IsExpanded 속성을 추가합니다.

csharp
코드 복사
public class LineGroup
{
    public string GroupName { get; set; }
    public List<LineInfo> Lines { get; set; }

    // 그룹의 Expanded 상태를 제어
    public bool IsExpanded { get; set; } = true;

    public bool IsChecked
    {
        get => Lines.All(line => line.IsChecked);
        set
        {
            foreach (var line in Lines)
            {
                line.IsChecked = value;
            }
        }
    }
}

public class LineInfo
{
    public string LineName { get; set; }
    public bool IsChecked { get; set; }
}
수정된 XAML 코드
HierarchicalDataTemplate에서 **IsExpanded**를 LineGroup의 속성으로 바인딩합니다.

xml
코드 복사
<TreeView x:Name="LineTreeView" Margin="0,0,0,10">
    <!-- 그룹 템플릿 -->
    <TreeView.Resources>
        <HierarchicalDataTemplate DataType="{x:Type local:LineGroup}" ItemsSource="{Binding Lines}">
            <StackPanel Orientation="Horizontal">
                <CheckBox Content="{Binding GroupName}" IsChecked="{Binding IsChecked, Mode=TwoWay}" />
            </StackPanel>
            <HierarchicalDataTemplate.Triggers>
                <!-- IsExpanded 상태를 바인딩 -->
                <DataTrigger Binding="{Binding IsExpanded}" Value="True">
                    <Setter Property="TreeViewItem.IsExpanded" Value="True" />
                </DataTrigger>
            </HierarchicalDataTemplate.Triggers>
        </HierarchicalDataTemplate>

        <!-- 라인 템플릿 -->
        <DataTemplate DataType="{x:Type local:LineInfo}">
            <StackPanel Orientation="Horizontal">
                <CheckBox Content="{Binding LineName}" IsChecked="{Binding IsChecked, Mode=TwoWay}" />
            </StackPanel>
        </DataTemplate>
    </TreeView.Resources>
</TreeView>
주요 변경 사항
IsExpanded 속성 추가:

LineGroup 클래스에 IsExpanded 속성을 추가하여 기본값을 true로 설정.
모든 그룹 노드가 초기 상태에서 펼쳐지도록 설정.
HierarchicalDataTemplate.Triggers 추가:

IsExpanded 속성을 TreeViewItem.IsExpanded에 바인딩하여 노드 확장을 제어.
트리 구조의 기본 상태:

모든 그룹(LineGroup)과 그 하위 항목(LineInfo)이 항상 펼쳐진 상태로 유지됩니다.
테스트 시나리오
트리뷰를 로드하면 모든 그룹이 자동으로 펼쳐진 상태로 표시됩니다.
LineGroup의 IsExpanded 속성을 false로 설정하면 해당 그룹만 닫힙니다.
특정 그룹이나 하위 라인의 체크 상태가 반영됩니다.
추가 참고
위 코드에서 트리 노드를 항상 펼쳐진 상태로 유지하거나, 특정 노드를 닫고 싶다면 IsExpanded 속성을 적절히 수정하여 동작을 제어할 수 있습니다.