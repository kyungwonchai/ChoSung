êµ¬ì‚¬í•­ ì •ë¦¬
cursor.fetchall()ë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

rowsë¡œ ë°›ì•„ì„œ ë°˜ë³µë¬¸ìœ¼ë¡œ DataFrameì„ êµ¬ì„±í•œë‹¤ (df.insert).

ë§¤ í–‰ì˜ ê°’ìœ¼ë¡œ DataFrameì„ ì±„ìš´ë‹¤.

DataFrameì— ìŠ¤íƒ€ì¼ì„ ì£¼ê³  í‘œì‹œí•œë‹¤.

ì½”ë“œì˜ ê°€ë…ì„±ì„ ë†’ì´ê³  ì‹¬í”Œí•˜ê²Œ ì‘ì„±í•œë‹¤.

âœ… ìˆ˜ì •ëœ Streamlit ì½”ë“œ
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql
import pandas as pd

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    rows = cursor.fetchall()
    conn.close()
    return rows

# DataFrame ìƒì„± ë° ìŠ¤íƒ€ì¼ ì ìš© í•¨ìˆ˜
def create_dataframe(rows, prefix="MC"):
    # ì»¬ëŸ¼ ì´ë¦„ ì„¤ì • (ë‚´ê°€ ì§ì ‘ ì§€ì •)
    columns = [
        "group1", "line1", "model1", "type1", "ecn1", "edition1",
        f"{prefix}1", f"{prefix}2", f"{prefix}3", f"{prefix}4",
        f"{prefix}5", f"{prefix}6", f"{prefix}7", f"{prefix}8"
    ]

    # ë¹ˆ DataFrame ë§Œë“¤ê¸°
    df = pd.DataFrame(columns=columns)

    # í–‰ ë°ì´í„°ë¥¼ DataFrameì— ì¶”ê°€
    for row in rows:
        df.loc[len(df)] = row

    # act ì»¬ëŸ¼ë“¤
    act_columns = [f"{prefix}{i}" for i in range(1, 9)]

    # ê° í–‰ì˜ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ëŠ” ìŠ¤íƒ€ì¼ ì ìš©
    def highlight_max(row):
        max_value = row[act_columns].max()
        return ['background-color: yellow' if v == max_value else '' for v in row]

    styled_df = df.style.apply(highlight_max, axis=1)
    return styled_df

# Streamlit ì•± êµ¬ì„±
def main():
    st.set_page_config(layout="wide")
    st.title("Custom DataFrame with Styling (pandas ë°©ì‹)")

    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    rows = fetch_main_data()

    if not rows:
        st.error("ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. í”„ë¡œì‹œì € ë˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì„ í™•ì¸í•˜ì„¸ìš”.")
    else:
        prefix = st.text_input("Prefix ì…ë ¥ (ê¸°ë³¸ê°’: MC)", value="MC")
        
        # DataFrame ìƒì„± ë° ìŠ¤íƒ€ì¼ ì ìš©
        styled_df = create_dataframe(rows, prefix)
        
        # Streamlit í‘œì‹œ
        st.write(styled_df)

if __name__ == "__main__":
    main()
âœ… ì½”ë“œ ì„¤ëª…
ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (fetch_main_data())

fetchall()ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ê°€ì ¸ì˜¨ë‹¤.

rowsë¡œ ë°˜í™˜ëœë‹¤.

DataFrame ìƒì„± (create_dataframe())

ë¹ˆ DataFrameì„ ë§Œë“¤ê³  df.loc[len(df)] = row ë°©ì‹ìœ¼ë¡œ í–‰ì„ ì¶”ê°€í•œë‹¤.

ì»¬ëŸ¼ ì´ë¦„ì€ ì§ì ‘ ì§€ì •í•œë‹¤.

ìŠ¤íƒ€ì¼ ì ìš© (highlight_max())

act2_1 ~ act2_8 ì—´ì—ì„œ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•œë‹¤.

DataFrameì˜ .style.apply() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤íƒ€ì¼ì„ ì ìš©í•œë‹¤.

Streamlit ì¶œë ¥ (st.write())

st.write()ë¡œ ìŠ¤íƒ€ì¼ë§ëœ DataFrameì„ í‘œì‹œí•œë‹¤.

ğŸ“Œ ì„¤ì¹˜ í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql pandas
ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬
streamlit run your_script_name.py
âœ… ì½”ë“œ ê°œì„  ì‚¬í•­
ê°€ë…ì„±ì„ ìœ„í•´ ì½”ë“œì˜ ê° ë¶€ë¶„ì„ í•¨ìˆ˜ë¡œ ë¶„ë¦¬.

ìŠ¤íƒ€ì¼ì„ ê°„ë‹¨í•˜ê²Œ ì²˜ë¦¬í•˜ë„ë¡ í•¨ (highlight_max í•¨ìˆ˜).

df.insert() ëŒ€ì‹  df.loc[len(df)] = row ë°©ì‹ìœ¼ë¡œ ë” ì‰½ê²Œ ì¶”ê°€.

st.write()ë¡œ DataFrameì„ ë°”ë¡œ í‘œì‹œ.

ğŸ”¥ ê²°ê³¼ í™”ë©´
í”„ë¡œì‹œì €ë¡œë¶€í„° ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ DataFrameìœ¼ë¡œ ë³€í™˜ í›„ ìŠ¤íƒ€ì¼ë§í•´ì„œ ì¶œë ¥í•œë‹¤.

ìµœëŒ€ê°’ì´ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡° í‘œì‹œëœë‹¤.