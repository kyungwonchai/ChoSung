using DevExpress.XtraTreeList.Nodes;
using System;
using System.Diagnostics;
using System.IO;
using System.Windows.Forms;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        treeList1.OptionsBehavior.Editable = false; // read-only 트리 리스트
        treeList1.FocusedNodeChanged += TreeList1_FocusedNodeChanged;

        // 특정 폴더 설정
        string rootFolder = @"C:\YourFolder";

        // Root 노드 추가
        TreeListNode rootNode = treeList1.AppendNode(new object[] { rootFolder }, null);
        rootNode.Tag = rootFolder;

        // 하위 디렉토리 추가
        AddDirectories(rootNode);
        treeList1.ExpandAll();
    }

    private void AddDirectories(TreeListNode parentNode)
    {
        string path = (string)parentNode.GetValue(0);
        try
        {
            foreach (var dir in Directory.GetDirectories(path))
            {
                TreeListNode node = treeList1.AppendNode(new object[] { dir }, parentNode);
                node.Tag = dir;
                AddDirectories(node);
            }
        }
        catch (Exception)
        {
            // 접근 권한이 없는 경우 무시
        }
    }

    private void TreeList1_FocusedNodeChanged(object sender, DevExpress.XtraTreeList.FocusedNodeChangedEventArgs e)
    {
        string path = (string)e.Node.GetValue(0);
        if (Directory.Exists(path) || File.Exists(path))
        {
            Process.Start("explorer.exe", path);
        }
    }
}
