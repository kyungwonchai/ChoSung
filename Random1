L 2014에서 사용할 수 있는 쿼리를 작성해드리겠습니다. 이 쿼리는 지정한 날짜 범위에 대해 라인별 반납율을 계산하는 데 사용할 수 있습니다. 반납율은 (반납합 / 필요합) * 100으로 계산됩니다.

sql
Copy code
CREATE PROCEDURE GetReturnRate
    @StartDate DATE,
    @EndDate DATE
AS
BEGIN
    SELECT 
        [라인], 
        SUM([필요합]) AS '필요합계', 
        SUM([반납합]) AS '반납합계', 
        (SUM([반납합]) / SUM([필요합])) * 100 AS '반납율'
    FROM 
        YourTableName
    WHERE 
        [날짜] BETWEEN @StartDate AND @EndDate
    GROUP BY 
        [라인]
END
이 프로시저는 @StartDate와 @EndDate 두 개의 인자를 받아, 해당 기간 동안 각 라인별로 필요한 합계, 반납한 합계, 그리고 반납율을 계산합니다. YourTableName을 실제 테이블 이름으로 교체해 주세요.

이 쿼리는 다음과 같이 사용할 수 있습니다:

sql
Copy code
EXEC GetReturnRate '2023-01-01', '2023-12-31';
이 코드는 날짜 범위를 인자로 받아 해당 기간 동안 각 라인의 반납율을 계산합니다. 데이터베이스의 구조와 정확한 필드 이름에 따라 쿼리를 조