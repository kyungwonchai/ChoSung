고, 특정 이름 패턴("SMD_검사기"가 포함된 파일명)을 가진 파일을 선택해야 한다면, Microsoft.Office.Interop.Excel 라이브러리를 사용하여 실행 중인 Excel 인스턴스에 접근하고, 해당 조건에 맞는 워크북을 찾아 작업을 수행할 수 있습니다.

아래는 이러한 요구사항을 충족하는 C# 코드 예시입니다:

csharp
Copy code
using System;
using Microsoft.Office.Interop.Excel;

class Program
{
    static void Main()
    {
        Application excelApp = (Application)System.Runtime.InteropServices.Marshal.GetActiveObject("Excel.Application");
        Workbook selectedWorkbook = null;

        foreach (Workbook workbook in excelApp.Workbooks)
        {
            if (workbook.Name.Contains("SMD_검사기"))
            {
                selectedWorkbook = workbook;
                break;
            }
        }

        if (selectedWorkbook != null)
        {
            Worksheet worksheet = selectedWorkbook.Worksheets["Data"];
            Range usedRange = worksheet.UsedRange;
            int totalColumns = usedRange.Columns.Count;

            for (int col = 2; col <= totalColumns; col++)
            {
                var cellColor = worksheet.Cells[2, col].Interior.Color;
                if (cellColor == XlRgbColor.rgbWhite || cellColor == XlRgbColor.rgbTransparent)
                {
                    if (double.TryParse((worksheet.Cells[3, col] as Range).Text, out double currentValue) && currentValue <= 500)
                    {
                        if (col < totalColumns && string.IsNullOrEmpty((worksheet.Cells[3, col + 1] as Range).Text))
                        {
                            if (double.TryParse((worksheet.Cells[3, col - 1] as Range).Text, out double previousValue))
                            {
                                worksheet.Cells[3, col] = currentValue + previousValue;
                            }
                        }
                        else if (col < totalColumns)
                        {
                            int nextCol = col + 1;
                            if (double.TryParse((worksheet.Cells[3, nextCol] as Range).Text, out double nextValue))
                            {
                                worksheet.Cells[3, nextCol] = currentValue + nextValue;
                            }
                        }
                    }
                }
            }
        }
        else
        {
            Console.WriteLine("해당하는 이름의 엑셀 파일이 열려있지 않습니다.");
        }
    }
}
이 코드는 다음과 같은 작업을 수행합니다:

실행 중인 Excel 인스턴스에 접근합니다.
열려있는 모든 워크북을 순회하며 "SMD_검사기"가 포함된 파일명을 가진 워크북을 찾습니다.
해당 워크북에서 "Data" 시트를 선택하고, 지정된 조건에 따라 데이터를 처리합니다.
만약 해당하는 워크북이 없으면, 콘솔에 메시지를 출력합니다.
참고사항:

이 코드는 Excel이 이미 실행 중이고, 필요한 파일이 열려있어야 합니다.
GetActiveObject 메서드는 현재 시스템에서 실행 중인 Excel 인스턴스에 접근합니다.
엑셀 파일의 구조(셀의 배경색, 데이터 형식 등)에 따라 코드를 조정해야 할 수 