ë™ì  í–‰ êµì²´: LTR(ì„œìª½) ë°©í–¥ì¼ ë•ŒëŠ” í™€ìˆ˜ í–‰ì´ ì•„ë˜(ì£¼ë ¥)ë¡œ, RTL(ë™ìª½) ë°©í–¥ì¼ ë•ŒëŠ” ì§ìˆ˜ í–‰ì´ ì•„ë˜(ì£¼ë ¥)ë¡œ ìœ„ì¹˜ê°€ ë°”ë€Œë„ë¡ í•©ë‹ˆë‹¤.

ì°¸ì¡° í–‰ ì‹œê°í™”: ìœ„ìª½(ì°¸ì¡°) í–‰ ì¤‘ì•™ì— êµµì€ í™”ì‚´í‘œë¥¼ ì¶”ê°€í•˜ì—¬ ì£¼ë ¥ í–‰ì´ ì•„ë‹˜ì„ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. (ë²„íŠ¼ í´ë¦­ì€ ê³„ì† ê°€ëŠ¥)

ì´ ë‘ ê°€ì§€ 'ìµœì²¨ë‹¨' ê¸°ìˆ ì„ ì ìš©í•˜ê¸° ìœ„í•´, ì•„ì´ì½˜(Drawable) 1ê°œ, ë ˆì´ì•„ì›ƒ(activity_main.xml), ê·¸ë¦¬ê³  ë¡œì§(MainActivity.kt)ì„ ëª¨ë‘ ìˆ˜ì •í•˜ê² ìŠµë‹ˆë‹¤.

## 1. 'ì°¸ì¡°' í–‰ì„ ìœ„í•œ í™”ì‚´í‘œ ì•„ì´ì½˜ ì¶”ê°€
ìœ„ìª½ ì¤„ì— í‘œì‹œí•  ì•„ë˜ ë°©í–¥ í™”ì‚´í‘œ ì•„ì´ì½˜ì´ í•„ìš”í•©ë‹ˆë‹¤. res/drawable í´ë”ì— ic_thick_arrow.xml íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“¤ì–´ ì•„ë˜ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.

<details>
<summary><strong>res/drawable/ic_thick_arrow.xml (ìƒˆ íŒŒì¼) - (í´ë¦­í•˜ì—¬ ì½”ë“œ ë³´ê¸°)</strong></summary>

XML

<vector xmlns:android="http://schemas.android.com/apk/res/android"
    android:width="48dp"
    android:height="48dp"
    android:viewportWidth="24"
    android:viewportHeight="24"
    android:tint="?attr/colorControlNormal">
  <path
      android:fillColor="@android:color/white"
      android:pathData="M12,16.5l-6,-6l1.41,-1.41L12,13.67l4.59,-4.58L18,10.5L12,16.5z"/>
</vector>
</details>

## 2. activity_main.xml ë ˆì´ì•„ì›ƒ êµ¬ì¡° ë³€ê²½
ì´ì œ í–‰ì˜ ìœ„ì¹˜ê°€ ë°”ë€Œì–´ì•¼ í•˜ë¯€ë¡œ, ê¸°ì¡´ì˜ buttonRowOdd, buttonRowEven IDë¥¼ topButtonRow, bottomButtonRowë¡œ ë³€ê²½í•©ë‹ˆë‹¤. ë˜í•œ ìœ„ìª½ ì¤„ì—ëŠ” í™”ì‚´í‘œë¥¼ ê²¹ì³ì„œ í‘œì‹œí•˜ê¸° ìœ„í•´ FrameLayoutì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

activity_main.xml íŒŒì¼ ì „ì²´ë¥¼ ì•„ë˜ ì½”ë“œë¡œ êµì²´í•´ì£¼ì„¸ìš”.

XML

<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="8dp"
    tools:context=".MainActivity">

    <com.kyungwon.reellistviewer.CompassView
        android:id="@+id/compassView"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_alignParentTop="true"
        android:layout_alignParentEnd="true"
        android:clickable="true"
        android:focusable="true" />
    <Button
        android:id="@+id/btnOpenFile"
        android:layout_width="wrap_content"
        android:layout_height="40dp"
        android:layout_alignParentTop="true"
        android:layout_marginTop="5dp"
        android:layout_marginEnd="8dp"
        android:layout_toStartOf="@id/compassView"
        android:background="@drawable/button_gradient_purple"
        android:paddingHorizontal="16dp"
        android:text="Open ReelList"
        android:textColor="@android:color/white" />
    <TextView
        android:id="@+id/tvFileName"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentStart="true"
        android:layout_alignParentTop="true"
        android:layout_centerVertical="true"
        android:layout_marginTop="12dp"
        android:layout_toStartOf="@id/btnOpenFile"
        android:ellipsize="end"
        android:maxLines="1"
        android:textSize="16sp"
        android:textStyle="bold"
        tools:text="ì—´ë¦° íŒŒì¼ ì´ë¦„" />

    <com.github.barteksc.pdfviewer.PDFView
        android:id="@+id/pdfView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/pageButtonContainer"
        android:layout_marginTop="8dp" />

    <LinearLayout
        android:id="@+id/pageButtonContainer"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/btnOpenFile"
        android:layout_marginTop="8dp"
        android:orientation="vertical"
        android:visibility="gone"
        tools:visibility="visible">

        <FrameLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content">

            <LinearLayout
                android:id="@+id/topButtonRow"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="horizontal" />

            <ImageView
                android:id="@+id/ivTopRowArrow"
                android:layout_width="48dp"
                android:layout_height="48dp"
                android:layout_gravity="center"
                android:src="@drawable/ic_thick_arrow"
                android:visibility="gone"
                android:clickable="false"
                android:focusable="false"
                tools:visibility="visible"/>

        </FrameLayout>

        <LinearLayout
            android:id="@+id/bottomButtonRow"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" />
    </LinearLayout>

</RelativeLayout>
## 3. MainActivity.kt ìµœì¢… ë¡œì§ ìˆ˜ì •
ì´ì œ regenerateButtons í•¨ìˆ˜ì—ì„œ í˜„ì¬ ë°©í–¥ì— ë”°ë¼ í™€ìˆ˜/ì§ìˆ˜ ë²„íŠ¼ë“¤ì„ topButtonRow ë˜ëŠ” bottomButtonRowì— ë™ì ìœ¼ë¡œ í• ë‹¹í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

MainActivity.kt íŒŒì¼ ì „ì²´ë¥¼ ì•„ë˜ ì½”ë“œë¡œ êµì²´í•´ì£¼ì„¸ìš”.

Kotlin

package com.kyungwon.reellistviewer

import android.content.Context
import android.graphics.Typeface
import android.hardware.Sensor
import android.hardware.SensorEvent
import android.hardware.SensorEventListener
import android.hardware.SensorManager
import android.os.Bundle
import android.util.Log
import android.view.GestureDetector
import android.view.MotionEvent
import android.view.View
import android.widget.Button
import android.widget.LinearLayout
import android.widget.Toast
import androidx.appcompat.app.AppCompatActivity
import androidx.core.content.ContextCompat
import androidx.core.view.GestureDetectorCompat
import androidx.core.view.WindowCompat
import androidx.core.view.WindowInsetsCompat
import androidx.core.view.WindowInsetsControllerCompat
import androidx.core.view.setMargins
import androidx.lifecycle.lifecycleScope
import com.github.barteksc.pdfviewer.listener.OnLoadCompleteListener
import com.github.barteksc.pdfviewer.listener.OnPageErrorListener
import com.kyungwon.reellistviewer.databinding.ActivityMainBinding
import jcifs.CIFSContext
import jcifs.config.PropertyConfiguration
import jcifs.context.BaseContext
import jcifs.smb.NtlmPasswordAuthenticator
import jcifs.smb.SmbFile
import kotlinx.coroutines.Dispatchers
import kotlinx.coroutines.launch
import kotlinx.coroutines.withContext
import java.io.File
import java.io.FileOutputStream
import java.util.Properties

class MainActivity : AppCompatActivity(), OnLoadCompleteListener, OnPageErrorListener, SensorEventListener {

    private lateinit var binding: ActivityMainBinding
    private val SMB_IP = "192.1.1.5"
    private val SMB_SHARED_FOLDER = "tempshare"
    private val SMB_USER = "win10"
    private val SMB_PASS = "tltmxpa2@"
    private var totalPdfPages = 0
    private val skippedButtons = mutableSetOf<Int>()
    private val currentButtons = mutableListOf<Button>()
    private var selectedButton: Button? = null
    private lateinit var gestureDetector: GestureDetectorCompat
    private var tappedButton: Button? = null
    private lateinit var sensorManager: SensorManager
    private val accelerometerReading = FloatArray(3)
    private val magnetometerReading = FloatArray(3)
    private val rotationMatrix = FloatArray(9)
    private val orientationAngles = FloatArray(3)
    private var isGeomagneticModeOn = false
    private var currentDirection = Direction.OTHER

    enum class Direction { EAST, WEST, OTHER }

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)
        hideSystemUI()
        setupGestureDetector()
        setupEventListeners()
        sensorManager = getSystemService(Context.SENSOR_SERVICE) as SensorManager
    }
    
    // ... (onResume, onPause, hideSystemUI ë“± ë§ì€ í•¨ìˆ˜ëŠ” ì´ì „ê³¼ ë™ì¼)

    private fun setupGestureDetector() {
        gestureDetector = GestureDetectorCompat(this, object : GestureDetector.SimpleOnGestureListener() {
            override fun onSingleTapConfirmed(e: MotionEvent): Boolean {
                tappedButton?.let { onPageButtonClick(it) }
                return true
            }
            override fun onDoubleTap(e: MotionEvent): Boolean {
                tappedButton?.let {
                    onPageButtonClick(it)
                    binding.pdfView.resetZoom()
                    Toast.makeText(this@MainActivity, "í™”ë©´ì— ë§ì¶¤", Toast.LENGTH_SHORT).show()
                }
                return true
            }
            override fun onLongPress(e: MotionEvent) {
                tappedButton?.let { onPageButtonLongClick(it) }
            }
        })
    }

    private fun setupEventListeners() {
        binding.btnOpenFile.setOnLongClickListener {
            lifecycleScope.launch(Dispatchers.IO) { showPdfListFromSmb() }
            Toast.makeText(this, "íŒŒì¼ ëª©ë¡ì„ ì—½ë‹ˆë‹¤.", Toast.LENGTH_SHORT).show()
            true
        }
        binding.compassView.setOnLongClickListener {
            isGeomagneticModeOn = !isGeomagneticModeOn
            val modeText = if (isGeomagneticModeOn) "On" else "Off"
            Toast.makeText(this, "ì§€ìê³„ ì˜ì¡´ ëª¨ë“œ: $modeText", Toast.LENGTH_SHORT).show()
            binding.compassView.setGeomagneticMode(isGeomagneticModeOn)
            if (!isGeomagneticModeOn) {
                currentDirection = Direction.OTHER
            }
            updateButtonsAndUI()
            true
        }
    }

    override fun loadComplete(nbPages: Int) {
        totalPdfPages = nbPages
        skippedButtons.clear()
        selectedButton = null
        binding.pageButtonContainer.visibility = View.VISIBLE
        isGeomagneticModeOn = false
        binding.compassView.setGeomagneticMode(false)
        updateButtonsAndUI()
    }

    private fun updateButtonsAndUI() {
        var requiredLogicalButtons=0;var physicalPageCounter=0;var logicalButtonCounter=0
        while(physicalPageCounter<totalPdfPages){logicalButtonCounter++;if(!skippedButtons.contains(logicalButtonCounter)){physicalPageCounter++}};requiredLogicalButtons=logicalButtonCounter
        val currentButtonCount=currentButtons.size
        var newButtonCount=if(requiredLogicalButtons%2!=0)requiredLogicalButtons+1 else requiredLogicalButtons
        if(totalPdfPages>0&&newButtonCount==0)newButtonCount=2;newButtonCount=maxOf(newButtonCount,currentButtonCount)
        regenerateButtons(newButtonCount)
        updateAllButtonStyles()
    }

    /**
     * ë²„íŠ¼ ë™ì  ìƒì„± (í–‰ êµì²´ ë° í™”ì‚´í‘œ í‘œì‹œ ë¡œì§ ì ìš©)
     */
    private fun regenerateButtons(count: Int) {
        binding.topButtonRow.removeAllViews()
        binding.bottomButtonRow.removeAllViews()
        currentButtons.clear()

        val buttonHeight = dpToPx(44)
        val margin = dpToPx(2)
        val buttonParams = LinearLayout.LayoutParams(0, buttonHeight, 1.0f)
        buttonParams.setMargins(margin)
        
        // ğŸ’¡ ì§€ìê³„ ëª¨ë“œ ONì¼ ë•Œë§Œ í™”ì‚´í‘œ í‘œì‹œ
        binding.ivTopRowArrow.visibility = if (isGeomagneticModeOn) View.VISIBLE else View.GONE
        
        // ğŸ’¡ í˜„ì¬ ë°©í–¥ì— ë”°ë¼ í™€ìˆ˜/ì§ìˆ˜ ë²„íŠ¼ì´ ë“¤ì–´ê°ˆ í–‰ì„ ê²°ì •
        val (oddRowContainer, evenRowContainer) = when {
            // ì§€ìê³„ ON & ì„œìª½ ë°©í–¥(LTR) -> í™€ìˆ˜ í–‰ì´ ì•„ë˜(ì£¼ë ¥)
            isGeomagneticModeOn && currentDirection == Direction.WEST -> binding.bottomButtonRow to binding.topButtonRow
            // ì§€ìê³„ ON & ë™ìª½ ë°©í–¥(RTL) -> ì§ìˆ˜ í–‰ì´ ì•„ë˜(ì£¼ë ¥)
            isGeomagneticModeOn && currentDirection == Direction.EAST -> binding.topButtonRow to binding.bottomButtonRow
            // ê·¸ ì™¸ ëª¨ë“  ê²½ìš° (ì§€ìê³„ OFF ë“±) -> ê¸°ë³¸ê°’ (í™€ìˆ˜ ìœ„, ì§ìˆ˜ ì•„ë˜)
            else -> binding.topButtonRow to binding.bottomButtonRow
        }

        // ğŸ’¡ ë°©í–¥ì— ë”°ë¥¸ ì •ë ¬ ë°©ì‹ ê²°ì •
        val isRtl = isGeomagneticModeOn && currentDirection == Direction.EAST

        for (i in 1..count) {
            val button = createPageButton(i, buttonParams.also { it.height = buttonHeight })
            if (i % 2 != 0) { // í™€ìˆ˜ ë²„íŠ¼
                if (isRtl) oddRowContainer.addView(button, 0) else oddRowContainer.addView(button)
            } else { // ì§ìˆ˜ ë²„íŠ¼
                if (isRtl) evenRowContainer.addView(button, 0) else evenRowContainer.addView(button)
            }
            currentButtons.add(button)
        }
    }


    private fun createPageButton(number: Int, layoutParams: LinearLayout.LayoutParams? = null): Button {
        return Button(this).apply {
            text = number.toString(); tag = number
            layoutParams?.let { this.layoutParams = it }
            textSize = 20f; typeface = Typeface.DEFAULT_BOLD
            setOnTouchListener { view, event ->
                tappedButton = view as Button
                gestureDetector.onTouchEvent(event)
                true
            }
        }
    }

    // ... (updateAllButtonStyles ì´í•˜ ëª¨ë“  í•¨ìˆ˜ëŠ” ì´ì „ê³¼ ë™ì¼í•©ë‹ˆë‹¤)
    private fun updateAllButtonStyles() { if (isGeomagneticModeOn) { for (button in currentButtons) { val buttonNumber = button.tag as Int; val isActiveRow = (currentDirection == Direction.WEST && buttonNumber % 2 != 0) || (currentDirection == Direction.EAST && buttonNumber % 2 == 0); when { button == selectedButton -> { button.setBackgroundResource(R.drawable.button_bg_geo_selected); button.setTextColor(ContextCompat.getColor(this, android.R.color.white)) } skippedButtons.contains(buttonNumber) -> { button.setBackgroundResource(R.drawable.button_bg_page_skipped_dark); button.setTextColor(ContextCompat.getColor(this, android.R.color.darker_gray)) } isActiveRow && mapLogicalToPhysical(buttonNumber) in 1..totalPdfPages -> { button.setBackgroundResource(R.drawable.button_bg_geo_active); button.setTextColor(ContextCompat.getColor(this, android.R.color.black)) } else -> { button.setBackgroundResource(R.drawable.button_bg_page_normal); button.setTextColor(ContextCompat.getColor(this, android.R.color.black)) } } } } else { for (button in currentButtons) { val buttonNumber = button.tag as Int; if (button == selectedButton) { button.setBackgroundResource(R.drawable.button_bg_page_selected); button.setTextColor(ContextCompat.getColor(this, android.R.color.black)); continue }; when { skippedButtons.contains(buttonNumber) -> { button.setBackgroundResource(R.drawable.button_bg_page_skipped_dark); button.setTextColor(ContextCompat.getColor(this, android.R.color.darker_gray)) } else -> { val physicalPage = mapLogicalToPhysical(buttonNumber); if (physicalPage in 1..totalPdfPages) { button.setBackgroundResource(R.drawable.button_bg_page_normal); button.setTextColor(ContextCompat.getColor(this, android.R.color.black)) } else { button.setBackgroundResource(R.drawable.button_border_invalid); button.setTextColor(ContextCompat.getColor(this, android.R.color.darker_gray)) } } } } } }
    private fun mapLogicalToPhysical(logicalButtonNum: Int): Int { val skipsBefore = skippedButtons.count { it < logicalButtonNum }; return logicalButtonNum - skipsBefore }
    private fun onPageButtonClick(button: Button) { val buttonNumber = button.tag as Int; if (skippedButtons.contains(buttonNumber)) { Toast.makeText(this, "$buttonNumber í˜ì´ì§€ëŠ” ìŠ¤í‚µë˜ì—ˆìŠµë‹ˆë‹¤.", Toast.LENGTH_SHORT).show(); return }; val physicalPage = mapLogicalToPhysical(buttonNumber); if (physicalPage in 1..totalPdfPages) { binding.pdfView.jumpTo(physicalPage - 1, false); selectedButton = button; updateAllButtonStyles() } else { Toast.makeText(this, "ë‚´ìš©ì´ ì—†ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.", Toast.LENGTH_SHORT).show() } }
    private fun onPageButtonLongClick(view: View) { val button = view as Button; val buttonNumber = button.tag as Int; if (skippedButtons.contains(buttonNumber)) { skippedButtons.remove(buttonNumber); Toast.makeText(this, "$buttonNumber í˜ì´ì§€ ìŠ¤í‚µ í•´ì œ", Toast.LENGTH_SHORT).show() } else { skippedButtons.add(buttonNumber); Toast.makeText(this, "$buttonNumber í˜ì´ì§€ ìŠ¤í‚µ ì„¤ì •", Toast.LENGTH_SHORT).show(); if (selectedButton == button) { selectedButton = null } }; updateButtonsAndUI() }
    override fun onAccuracyChanged(sensor: Sensor?, accuracy: Int) {}
    override fun onSensorChanged(event: SensorEvent) { if (event.sensor.type == Sensor.TYPE_ACCELEROMETER) { System.arraycopy(event.values, 0, accelerometerReading, 0, accelerometerReading.size) } else if (event.sensor.type == Sensor.TYPE_MAGNETIC_FIELD) { System.arraycopy(event.values, 0, magnetometerReading, 0, magnetometerReading.size) }; SensorManager.getRotationMatrix(rotationMatrix, null, accelerometerReading, magnetometerReading); SensorManager.getOrientation(rotationMatrix, orientationAngles); val azimuthInDegrees = Math.toDegrees(orientationAngles[0].toDouble()).toFloat(); val normalizedAzimuth = (azimuthInDegrees + 360) % 360; binding.compassView.updateBearing(normalizedAzimuth); if (isGeomagneticModeOn) { var newDirection = currentDirection; val tolerance = 2.0f; if (normalizedAzimuth in (270f - tolerance)..(270f + tolerance)) { newDirection = Direction.WEST } else if (normalizedAzimuth in (90f - tolerance)..(90f + tolerance)) { newDirection = Direction.EAST }; if (newDirection != currentDirection) { currentDirection = newDirection; updateButtonsAndUI() } } }
    private fun dpToPx(dp: Int): Int { return (dp * resources.displayMetrics.density).toInt() }
    private suspend fun loadPdfFromSmbFile(smbFile: SmbFile) { withContext(Dispatchers.Main) { binding.btnOpenFile.isEnabled = false; binding.btnOpenFile.text = "ë¡œë”©ì¤‘..." }; try { val tempPdfFile = File(cacheDir, smbFile.name); smbFile.inputStream.use { input -> FileOutputStream(tempPdfFile).use { output -> input.copyTo(output) } }; withContext(Dispatchers.Main) { binding.tvFileName.text = smbFile.name.substringBeforeLast("."); binding.pdfView.fromFile(tempPdfFile).onLoad(this@MainActivity).onPageError(this@MainActivity).load() } } catch (e: Exception) { Log.e("SmbTask", "íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨", e) } finally { withContext(Dispatchers.Main) { binding.btnOpenFile.isEnabled = true; binding.btnOpenFile.text = "Open ReelList" } } }
    private suspend fun showPdfListFromSmb(){val smbUrl="smb://$SMB_IP/$SMB_SHARED_FOLDER/";try{val properties=Properties();properties["jcifs.smb.client.minVersion"]="SMB300";properties["jcifs.smb.client.maxVersion"]="SMB311";val config=PropertyConfiguration(properties);val cifsContext:CIFSContext=BaseContext(config);val auth=NtlmPasswordAuthenticator(null,SMB_USER,SMB_PASS);val context=cifsContext.withCredentials(auth);val dir=SmbFile(smbUrl,context);val pdfFiles=dir.listFiles{f->f.name.endsWith(".pdf",ignoreCase=true)};if(pdfFiles.isNullOrEmpty()){withContext(Dispatchers.Main){Toast.makeText(this@MainActivity,"ê³µìœ  í´ë”ì— PDF íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.",Toast.LENGTH_SHORT).show()};return};val fileNames=pdfFiles.map{it.name}.toTypedArray();withContext(Dispatchers.Main){AlertDialog.Builder(this@MainActivity).setTitle("PDF íŒŒì¼ ì„ íƒ").setItems(fileNames){_,which->val selectedFile=pdfFiles[which];lifecycleScope.launch(Dispatchers.IO){loadPdfFromSmbFile(selectedFile)}}.setNegativeButton("ì·¨ì†Œ",null).show()}}catch(e:Exception){Log.e("SmbTask","SMB ì—°ê²° ì‹¤íŒ¨",e);withContext(Dispatchers.Main){Toast.makeText(this@MainActivity,"ê³µìœ  í´ë” ì—°ê²° ì‹¤íŒ¨\nì˜¤ë¥˜: ${e.message}",Toast.LENGTH_LONG).show()}}}