 제거하는 쿼리를 작성해야 합니다. 이를 위해서 CHARINDEX와 PATINDEX를 사용하여 가장 먼저 나오는 _ 이후의 모든 문자를 제거할 수 있습니다.

다음은 그 방법을 보여주는 쿼리입니다:

sql
코드 복사
SELECT 
    CASE 
        WHEN CHARINDEX('_', N_Tkey) > 0 
        THEN LEFT(N_Tkey, CHARINDEX('_', N_Tkey) - 1)
        ELSE N_Tkey
    END AS Result
FROM 
    YourTableName;
이 쿼리는 문자열에서 첫 번째 _ 이전의 모든 문자열을 추출합니다. 만약 _가 존재하지 않으면 원래 문자열을 반환합니다.

그러나 주어진 요구사항에 따라 _ 문자와 그 이후의 모든 문자를 제거하는 경우, 해당 문자열에 _가 여러 번 포함될 수 있는 시나리오를 처리하기 위해서는 정규 표현식을 사용하는 것이 좋습니다. SQL Server에서 정규 표현식을 직접적으로 지원하지 않으므로, 함수 또는 커서 등을 활용해야 할 수 있습니다. 여기서는 여러 _가 있는 경우를 처리하는 더 복잡한 예를 들어 보겠습니다.

sql
코드 복사
CREATE FUNCTION dbo.RemoveAllAfterUnderscore (@input NVARCHAR(MAX))
RETURNS NVARCHAR(MAX)
AS
BEGIN
    DECLARE @output NVARCHAR(MAX)
    SET @output = @input

    WHILE CHARINDEX('_', @output) > 0
    BEGIN
        SET @output = LEFT(@output, CHARINDEX('_', @output) - 1)
    END

    RETURN @output
END
GO

SELECT 
    dbo.RemoveAllAfterUnderscore(N_Tkey) AS Result
FROM 
    YourTableName;
이 함수는 문자열에서 모든 _ 이후의 문자를 제거합니다. dbo.RemoveAllAfterUnderscore 함수는 입력 문자열에서 _를 찾고, 그 이전 부분만을 남기는 작업을 반복하여 수행합니다. 그런 다음, 이 함수를 사용하여 테이블의 각 열에 대해 처리된 결과를 조회합니다.

해당 함수와 쿼리를 실행하여 원하는 결과를 확인할 