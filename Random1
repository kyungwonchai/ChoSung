import pyodbc

# MSSQL 데이터베이스 연결 설정
conn = pyodbc.connect('DRIVER={SQL Server};SERVER=<서버주소>;DATABASE=<데이터베이스명>;UID=<사용자명>;PWD=<비밀번호>')

# 검색 결과 중 유사도 1위 데이터 가져오기
top_result = similar_parts[0]

# 업체PN, 부품코드, 유사도 값 추출
company_pn = top_result['업체PN']
part_code = top_result['부품코드']
similarity = top_result['유사도']

# SQL 쿼리 실행하여 데이터베이스에 값 삽입
cursor = conn.cursor()
query = "INSERT INTO 검색결과 (업체PN, 부품코드, 유사도) VALUES (?, ?, ?)"
cursor.execute(query, (company_pn, part_code, similarity))
conn.commit()

# 데이터베이스 연결 닫기
conn.close()
