using System;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace PrinterSettingsExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void buttonChangeSettings_Click(object sender, EventArgs e)
        {
            // 프린터 설정 다이얼로그 생성
            PrintDialog printDialog = new PrintDialog();

            // 프린터 설정 다이얼로그에서 사용자가 설정을 선택하도록 합니다.
            if (printDialog.ShowDialog() == DialogResult.OK)
            {
                // 사용자가 선택한 프린터 설정을 가져옵니다.
                PrinterSettings printerSettings = printDialog.PrinterSettings;

                // 여기에서 원하는 프린터 설정 변경을 수행합니다.
                // 예를 들면, 용지 크기 변경:
                printerSettings.DefaultPageSettings.PaperSize = new PaperSize("A4", 827, 1169); // 단위: 1/100 인치 (예시: A4 용지 크기)

                // 변경된 설정을 저장합니다.
                printerSettings.PrintToFile = true; // 변경사항을 저장하기 위해 PrintToFile을 true로 설정합니다.
                printerSettings.PrintFileName = "C:\\path\\to\\your\\printer.settings"; // 저장할 파일 경로를 지정합니다.

                // 변경 내용 저장
                printerSettings.Save();
            }
        }
    }
}
