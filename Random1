Microsoft Forms 라이브러리가 엑셀 VBA 프로젝트에 참조되지 않았기 때문입니다. 이를 해결하려면 아래의 방법을 사용하세요.

1. MSForms 라이브러리 참조 설정하기
VBA 에디터 열기
Alt + F11을 누릅니다.

참조 추가

메뉴에서 도구 → 참조를 클릭합니다.
목록에서 **"Microsoft Forms 2.0 Object Library"**를 찾아 체크한 후 확인을 누릅니다.
매크로 다시 실행
이제 MSForms.DataObject가 정상적으로 작동할 것입니다.

2. 대체 방법: WinAPI를 사용해 클립보드에 복사하기
MSForms.DataObject 대신 WinAPI를 사용하면 라이브러리 참조 없이 클립보드에 데이터를 복사할 수 있습니다.

수정된 VBA 코드 (WinAPI 사용)
vba
코드 복사
#If VBA7 Then
    Private Declare PtrSafe Function OpenClipboard Lib "user32" (ByVal hwnd As LongPtr) As Long
    Private Declare PtrSafe Function EmptyClipboard Lib "user32" () As Long
    Private Declare PtrSafe Function CloseClipboard Lib "user32" () As Long
    Private Declare PtrSafe Function SetClipboardData Lib "user32" (ByVal wFormat As Long, ByVal hMem As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal dwBytes As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As Long
#Else
    Private Declare Function OpenClipboard Lib "user32" (ByVal hwnd As Long) As Long
    Private Declare Function EmptyClipboard Lib "user32" () As Long
    Private Declare Function CloseClipboard Lib "user32" () As Long
    Private Declare Function SetClipboardData Lib "user32" (ByVal wFormat As Long, ByVal hMem As Long) As Long
    Private Declare Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal dwBytes As Long) As Long
    Private Declare Function GlobalLock Lib "kernel32" (ByVal hMem As Long) As Long
    Private Declare Function GlobalUnlock Lib "kernel32" (ByVal hMem As Long) As Long
#End If

Const CF_TEXT As Long = 1
Const GMEM_MOVEABLE As Long = &H2

Sub CopyTextToClipboard(Text As String)
    Dim hGlobal As LongPtr
    Dim lpGlobal As LongPtr
    
    ' 클립보드 열기
    If OpenClipboard(0&) Then
        EmptyClipboard
        
        ' 메모리 할당 및 데이터 복사
        hGlobal = GlobalAlloc(GMEM_MOVEABLE, Len(Text) + 1)
        lpGlobal = GlobalLock(hGlobal)
        If lpGlobal Then
            CopyMemory ByVal lpGlobal, ByVal StrPtr(Text), Len(Text)
            GlobalUnlock hGlobal
            SetClipboardData CF_TEXT, hGlobal
        End If
        
        ' 클립보드 닫기
        CloseClipboard
    End If
End Sub

Sub CopySheetWithoutQuotes()
    Dim ws As Worksheet
    Dim rng As Range
    Dim row As Range
    Dim cell As Range
    Dim clipboardData As String
    
    ' 현재 시트와 범위 지정
    Set ws = ThisWorkbook.Sheets(1)
    Set rng = ws.UsedRange ' 시트의 데이터가 있는 전체 범위
    
    ' 시트 내용 읽기
    clipboardData = ""
    For Each row In rng.Rows
        For Each cell In row.Cells
            clipboardData = clipboardData & cell.Value & vbTab
        Next cell
        clipboardData = Left(clipboardData, Len(clipboardData) - 1) & vbCrLf ' 마지막 탭 제거 + 줄바꿈 추가
    Next row
    
    ' 클립보드에 복사
    CopyTextToClipboard clipboardData
    
    MsgBox "시트 내용이 따옴표 없이 클립보드에 복사되었습니다!", vbInformation
End Sub
코드 설명
WinAPI 사용
OpenClipboard, EmptyClipboard, SetClipboardData 등을 사용하여 시스템 클립보드에 데이터를 복사합니다.

따옴표 제거
시트 전체 데이터를 읽고 문자열로 결합한 뒤 클립보드에 붙여넣습니다.

호환성
VBA7 (64비트)와 이전 버전(32비트)에서 모두 작동합니다.

실행 방법
VBA 에디터(Alt + F11)에서 코드를 추가합니다.
CopySheetWithoutQuotes 매크로를 실행합니다.
복사된 내용을 메모장에 붙여넣으면 따옴표 없이 출력됩니다.
결과 예시
시트 내용: