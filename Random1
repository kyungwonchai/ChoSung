using System;
using System.Windows;

namespace YourNamespace
{
    public partial class App : Application
    {
        public App()
        {
            // 생성자에서 UnhandledException 핸들러를 설정할 수 있습니다.
            AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
        }

        protected override void OnStartup(StartupEventArgs e)
        {
            base.OnStartup(e);
            // 또는 OnStartup 메서드에서 설정할 수 있습니다.
            AppDomain.CurrentDomain.UnhandledException += CurrentDomain_UnhandledException;
        }

        private void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
        {
            // 예외 객체를 로그로 남깁니다.
            if (e.ExceptionObject is Exception ex)
            {
                msgvs.Instance.LogT5($"Unhandled exception: {ex.Message}");
                msgvs.Instance.LogT5($"Stack Trace: {ex.StackTrace}");
            }
            else
            {
                msgvs.Instance.LogT5("Unhandled exception: Unknown exception type.");
            }

            // 필수는 아니지만, 필요하다면 애플리케이션을 종료할 수도 있습니다.
            if (e.IsTerminating)
            {
                msgvs.Instance.LogT5("Application is terminating due to an unhandled exception.");
            }
        }
    }
}
