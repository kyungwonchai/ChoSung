using DevExpress.XtraCharts;
using DevExpress.XtraEditors;
using System;
using System.Data;
using System.Drawing;
using System.Windows.Forms;

namespace WinFormsApp
{
    public partial class MainForm : XtraForm
    {
        private PanelControl panelControl;

        public MainForm()
        {
            InitializeComponent();
            InitializePanelControl();
            CreateCharts();
        }

        private void InitializePanelControl()
        {
            panelControl = new PanelControl();
            panelControl.Dock = DockStyle.Fill;
            Controls.Add(panelControl);
        }

        private void CreateCharts()
        {
            int chartCount = 10; // 최대 차트 개수
            int chartHeight = 300; // 차트의 높이
            int spacing = 20; // 차트 간 간격
            int panelHeight = (chartHeight + spacing) * chartCount;

            panelControl.Height = panelHeight;

            // 데이터 가져오기 (예시: DataTable)
            DataTable table1 = GetDataTable(); // 첫 번째 테이블
            DataTable table2 = GetDataTable(); // 두 번째 테이블
            // ...

            // 각 테이블별로 차트 생성 및 패널에 추가
            AddChartToPanel(table1);
            AddChartToPanel(table2);
            // ...
        }

        private void AddChartToPanel(DataTable table)
        {
            // 차트 생성
            ChartControl chartControl = new ChartControl();
            chartControl.Height = 300; // 차트의 높이 설정

            // 차트 옵션 설정 및 데이터 바인딩
            Series series = new Series("Series", ViewType.Pie);
            series.DataSource = table;
            series.ArgumentDataMember = "과제명";
            series.ValueDataMembers.AddRange("시작시간", "종료시간");

            chartControl.Series.Add(series);

            // 차트 레이아웃 설정
            ((SimpleDiagram)chartControl.Diagram).PieAutoSize = false;
            ((SimpleDiagram)chartControl.Diagram).RadiusPercentage = 70;

            // 차트 라벨 설정
            PieSeriesLabel label = (PieSeriesLabel)series.Label;
            label.Position = PieSeriesLabelPosition.Inside;
            label.ResolveOverlappingMode = ResolveOverlappingMode.Default;
            label.TextPattern = "{A}";

            // 차트 툴팁 설정
            chartControl.ToolTipEnabled = true;
            chartControl.ToolTipOptions.ShowForPoints = true;
            chartControl.ToolTipOptions.ToolTipPosition = ToolTipPosition.Cursor;
            chartControl.ToolTipOptions.ToolTipPositionMode = ToolTipPositionMode.Manual;

            // 차트를 패널에 추가
            chartControl.Dock = DockStyle.Top;
            panelControl.Controls.Add(chartControl);
        }

        private DataTable GetDataTable()
        {
            // 테이블 데이터 조회 또는 생성
            DataTable dataTable = new DataTable();
            // ...

            return dataTable;
        }
    }
}
