래는 요청한 작업을 수행하는 VBA 코드입니다. 요청대로 주차2_시트를 변수 그대로 사용하며, C3부터 B100000의 End(xlUp)까지 내려가면서 조건을 충족하는 값을 처리하고, 키를 생성하여 딕셔너리에 저장 및 결과를 AH 열 이후에 출력합니다.

vba
코드 복사
Sub ProcessSheetData()
    Dim lastRow As Long
    Dim currentRow As Long
    Dim dict As Object
    Dim t1 As String
    Dim key As String
    Dim col As Integer

    ' 딕셔너리 생성
    Set dict = CreateObject("Scripting.Dictionary")

    ' C3부터 B100000의 마지막 행까지 확인
    lastRow = 주차2_시트.Cells(주차2_시트.Rows.Count, "B").End(xlUp).Row

    ' 초기 t1 값
    t1 = ""

    ' C3부터 마지막 행까지 반복
    For currentRow = 3 To lastRow
        ' C열 값 가져오기
        Dim cValue As String
        cValue = Trim(주차2_시트.Cells(currentRow, "C").Value)

        ' C열 값이 빈 값이 아니면 t1 업데이트
        If cValue <> "" Then
            t1 = cValue
        End If

        ' D열에서 키 추출
        Dim dValue As String
        dValue = Trim(주차2_시트.Cells(currentRow, "D").Value)
        key = GetKey(dValue)

        ' 키가 유효하고 t1이 비어 있지 않으면 딕셔너리에 저장 및 AH 열 뒤로 출력
        If key <> "" And t1 <> "" Then
            ' 딕셔너리에 키가 없으면 초기화
            If Not dict.exists(key) Then
                dict(key) = Array(0, 0, 0, 0, 0, 0) ' F~K 열 초기값
            End If

            ' F~K 열 값을 딕셔너리에 합산
            For col = 1 To 6
                dict(key)(col - 1) = dict(key)(col - 1) + Val(주차2_시트.Cells(currentRow, 6 + col).Value)
            Next col

            ' AH 열부터 딕셔너리 값 출력
            For col = 1 To 6
                주차2_시트.Cells(currentRow, 33 + col).Value = dict(key)(col - 1)
            Next col
        End If
    Next currentRow

    MsgBox "작업 완료!", vbInformation
End Sub

' 키를 추출하는 함수
Function GetKey(value As String) As String
    Dim i As Long
    Dim char As String
    Dim keyStart As Long
    Dim keyEnd As Long

    keyStart = 0
    keyEnd = InStr(1, value, "/") - 1 ' / 위치 전까지

    If keyEnd > 0 Then
        For i = keyEnd To 1 Step -1
            char = Mid(value, i, 1)
            ' 첫 번째 영어 문자를 발견한 위치
            If char Like "[A-Za-z]" Then
                keyStart = i
                Exit For
            End If
        Next i
    End If

    ' 키 추출
    If keyStart > 0 And keyEnd > 0 Then
        GetKey = Mid(value, keyStart, keyEnd - keyStart + 1)
    Else
        GetKey = "" ' 키가 없으면 빈 문자열 반환
    End If
End Function
주요 구현 내용
C열 값 기억 (t1):

C열 값이 빈 값이 아니면 해당 값을 t1 변수에 저장.
빈 값이면 이전 t1 값을 계속 유지.
키 추출 (GetKey 함수):

D열에서 / 앞에 처음 나타나는 영어 문자부터 /까지의 문자열을 키로 추출.
딕셔너리 관리:

키를 기준으로 F~K 열의 값 합산.
키가 없으면 새로 초기화하고 값을 추가.
결과 출력:

AH 열 이후에 F~K 열 값의 합산 결과를 출력.
사용 방법
VBA 편집기에서 코드 삽입:

Excel VBA 편집기(Alt + F11)에서 새 모듈을 삽입하고 코드를 붙여넣습니다.
매크로 실행: