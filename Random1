public void AddTask(TaskModel task)
{
    // 데이터베이스에 새 작업을 추가하는 로직
    SaveTaskToDatabase(task);

    // 작업 폴더 생성
    CreateTaskFolder(task.FolderPath);
}

// 데이터베이스에 작업을 추가하는 메서드
private void SaveTaskToDatabase(TaskModel task)
{
    using (var connection = new SqlConnection("your_connection_string"))
    {
        connection.Open();

        var command = new SqlCommand(@"
            INSERT INTO T_Tasks (Priority, CreatedTime, UpdateCount, LastUpdateTime, FolderPath, CellColor, Assignee, IsCompleted)
            VALUES (@Priority, @CreatedTime, @UpdateCount, @LastUpdateTime, @FolderPath, @CellColor, @Assignee, @IsCompleted)", connection);

        command.Parameters.AddWithValue("@Priority", task.Priority);
        command.Parameters.AddWithValue("@CreatedTime", task.CreatedTime);
        command.Parameters.AddWithValue("@UpdateCount", task.UpdateCount);
        command.Parameters.AddWithValue("@LastUpdateTime", task.LastUpdateTime);
        command.Parameters.AddWithValue("@FolderPath", task.FolderPath);
        command.Parameters.AddWithValue("@CellColor", task.CellColor);
        command.Parameters.AddWithValue("@Assignee", task.Assignee);
        command.Parameters.AddWithValue("@IsCompleted", task.IsCompleted);

        command.ExecuteNonQuery();
    }
}

// 작업 폴더 생성 메서드
private void CreateTaskFolder(string folderPath)
{
    try
    {
        // 메인 폴더 생성
        if (!Directory.Exists(folderPath))
        {
            Directory.CreateDirectory(folderPath);
        }

        // 하위 폴더 'abc_doc' 및 'abc_solution' 생성
        string folderName = Path.GetFileName(folderPath); // 예: "abc" 폴더명 추출
        string docFolderPath = Path.Combine(folderPath, $"{folderName}_doc"); // 예: "abc_doc"
        string solutionFolderPath = Path.Combine(folderPath, $"{folderName}_solution"); // 예: "abc_solution"

        if (!Directory.Exists(docFolderPath))
        {
            Directory.CreateDirectory(docFolderPath);
        }

        if (!Directory.Exists(solutionFolderPath))
        {
            Directory.CreateDirectory(solutionFolderPath);
        }
    }
    catch (Exception ex)
    {
        // 폴더 생성 중 예외가 발생할 경우 로그로 처리
        msgvs.Instance.LogT5($"작업 폴더 생성 중 오류 발생: {ex.Message}");
    }
}
