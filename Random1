BA

Sub OptimizeRowHeights()
    Dim lastRow As Long
    Dim i As Long
    
    lastRow = Cells(Rows.Count, "A").End(xlUp).Row
    
    If lastRow < 6 Then
        lastRow = 6
    End If

    Dim originalHeights As Collection
    Set originalHeights = New Collection
    
    For i = 6 To lastRow
        originalHeights.Add Rows(i).RowHeight, CStr(i)
    Next i
    
    Rows("6:" & lastRow).EntireRow.AutoFit
    
    For i = 6 To lastRow
        If Rows(i).RowHeight < originalHeights.Item(CStr(i)) Then
            Rows(i).RowHeight = originalHeights.Item(CStr(i))
        End If
    Next i