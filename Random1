private void AnalyzeFolders(string path, bool isRootCall)
{
    try
    {
        DirectoryInfo rootDir = new DirectoryInfo(path);
        foreach (DirectoryInfo dir in rootDir.GetDirectories())
        {
            // 폴더의 마지막 수정 시간 확인
            if (DateTime.Now.Subtract(dir.LastWriteTime).TotalDays > 10)
            {
                continue;  // 마지막 수정 시간이 10일 이전인 경우 검사하지 않음
            }

            folderCount++;
            UpdateFolderCount();  // 라벨 업데이트 함수 호출

            try
            {
                long size = CalculateFolderSize(dir);
                if (size >= 1073741824) // 1GB 이상
                {
                    DateTime lastModified = GetMostRecentFileDate(dir);
                    string info = $"{dir.FullName} ({size} bytes) - Last Modified: {lastModified.ToString("yyyy-MM-dd HH:mm:ss")}";
                    Application.Current.Dispatcher.Invoke(() => UpdateListBoxes(info, lastModified));
                }
                AnalyzeFolders(dir.FullName, false);
            }
            catch (UnauthorizedAccessException)
            {
                continue;
            }
        }

        if (isRootCall)
        {
            Application.Current.Dispatcher.Invoke(() => UpdateListBox1("분석 완료"));
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show($"An error occurred: {ex.Message}");
    }
}
