L 2014 데이터베이스의 테이블에 삽입하는 코드는 다음과 같습니다. 이 예제에서는 행 2부터 시작하여 열 1의 날짜(Date), 열 2의 문자(String), 열 3의 날짜 시간(DateTime) 값을 tbl1 테이블에 삽입합니다. 만약 키 중복 에러가 발생하면 이를 무시하고 다음 행의 데이터를 계속 삽입합니다.

먼저, MS SQL 데이터베이스에 연결하기 위해 ADODB 라이브러리를 사용합니다.

Excel VBA 에디터를 열고, Tools > References에서 Microsoft ActiveX Data Objects 6.1 Library를 체크합니다.

다음 코드를 사용하여 데이터 삽입 작업을 수행합니다:

vba
코드 복사
Sub InsertDataIntoSQL()
    Dim conn As ADODB.Connection
    Dim rs As ADODB.Recordset
    Dim sql As String
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Find the last row with data in column 1
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    ' Create a new ADODB connection
    Set conn = New ADODB.Connection
    
    ' Open the connection to the database
    conn.ConnectionString = "Provider=SQLOLEDB;Data Source=YourServerName;Initial Catalog=YourDatabaseName;User ID=YourUsername;Password=YourPassword;"
    conn.Open
    
    ' Loop through each row from row 2 to the last row
    For i = 2 To lastRow
        On Error Resume Next ' Ignore errors and continue
        
        ' Construct the SQL INSERT statement
        sql = "INSERT INTO tbl1 (date_column, string_column, datetime_column) VALUES (" & _
              "'" & Format(ws.Cells(i, 1).Value, "yyyy-mm-dd") & "', " & _
              "'" & ws.Cells(i, 2).Value & "', " & _
              "'" & Format(ws.Cells(i, 3).Value, "yyyy-mm-dd HH:MM:SS") & "')"
        
        ' Execute the SQL statement
        conn.Execute sql
        
        On Error GoTo 0 ' Turn off error handling
    Next i
    
    ' Close the connection
    conn.Close
    Set conn = Nothing
    
    MsgBox "Data insertion complete."
End Sub
이 코드는 다음과 같이 작동합니다:

Sheet1의 데이터를 읽어와 행 2부터 마지막 행까지 반복합니다.
각 행의 데이터를 tbl1 테이블에 삽입합니다.
키 중복 에러가 발생하면 이를 무시하고 다음 행으로 넘어갑니다.
사용하기 전에 다음 부분을 실제 데이터베이스 정보로 수정해야 합니다:

YourServerName
YourDatabaseName
YourUsername
YourPassword
이 코드를 VBA 모듈에 추가하고 실행하면 엑셀에서 MS SQL 데이터베이스로 데이터를 삽입할 수 있습니다.