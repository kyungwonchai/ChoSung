using System;
using System.IO;
using System.Text;
using DevExpress.XtraBars.Ribbon;

public void ExportRibbonToCsv(RibbonControl ribbonControl, string filePath)
{
    // StringBuilder를 이용하여 CSV 내용을 작성합니다.
    StringBuilder sheet1Content = new StringBuilder();
    sheet1Content.AppendLine("Page Text,Group Text,Button Caption,Button Name,Page Tag");

    StringBuilder sheet2Content = new StringBuilder();
    sheet2Content.AppendLine("Page Text,Group Text,Group Name,Group Tag");

    StringBuilder sheet3Content = new StringBuilder();
    sheet3Content.AppendLine("Page Text,Page Name,Page Tag");

    // 시트 1: 페이지, 그룹, 버튼 정보
    foreach (RibbonPage page in ribbonControl.Pages)
    {
        string pageText = page.Text.Replace("\r", "\\r").Replace("\n", "\\n");
        string pageTag = page.Tag != null ? page.Tag.ToString().Replace("\r", "\\r").Replace("\n", "\\n") : "";
        string pageName = page.Name.Replace("\r", "\\r").Replace("\n", "\\n");

        foreach (RibbonPageGroup group in page.Groups)
        {
            string groupText = group.Text.Replace("\r", "\\r").Replace("\n", "\\n");
            string groupTag = group.Tag != null ? group.Tag.ToString().Replace("\r", "\\r").Replace("\n", "\\n") : "";
            string groupName = group.Name.Replace("\r", "\\r").Replace("\n", "\\n");

            foreach (var item in group.ItemLinks)
            {
                if (item is BarButtonItemLink buttonItemLink)
                {
                    BarButtonItem button = buttonItemLink.Item as BarButtonItem;
                    if (button != null)
                    {
                        string buttonCaption = button.Caption.Replace("\r", "\\r").Replace("\n", "\\n");
                        string buttonName = button.Name.Replace("\r", "\\r").Replace("\n", "\\n");

                        // 시트 1 라인 작성
                        string csvLine = string.Format("{0},{1},{2},{3},{4}",
                            pageText,
                            groupText,
                            buttonCaption,
                            buttonName,
                            pageTag);
                        sheet1Content.AppendLine(csvLine);
                    }
                }
            }

            // 시트 2 라인 작성 (그룹별 Tag 정보)
            string groupCsvLine = string.Format("{0},{1},{2},{3}", pageText, groupText, groupName, groupTag);
            sheet2Content.AppendLine(groupCsvLine);
        }

        // 시트 3 라인 작성 (페이지별 Tag 정보)
        string pageCsvLine = string.Format("{0},{1},{2}", pageText, pageName, pageTag);
        sheet3Content.AppendLine(pageCsvLine);
    }

    // 파일 작성
    try
    {
        File.WriteAllText(filePath.Replace(".csv", "_sheet1.csv"), sheet1Content.ToString(), Encoding.UTF8);
        File.WriteAllText(filePath.Replace(".csv", "_sheet2.csv"), sheet2Content.ToString(), Encoding.UTF8);
        File.WriteAllText(filePath.Replace(".csv", "_sheet3.csv"), sheet3Content.ToString(), Encoding.UTF8);
    }
    catch (Exception ex)
    {
        // 파일 작성 중 오류가 발생하면 예외를 출력합니다.
        Console.WriteLine("CSV 파일 작성 중 오류가 발생했습니다: " + ex.Message);
    }