하도록 하겠습니다. 이는 잘못된 형식의 셀을 건너뛰어 에러를 방지하는 데 도움이 됩니다.

수정된 코드는 다음과 같습니다:

VBA (영문)
Copy code
Sub UpdateWeeklyPlanColor()
    Dim fd As FileDialog
    Dim filePath As String
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim cell As Range
    Dim startDate As Date
    Dim endDate As Date
    Dim cellDate As Date
    Dim dateStr As String
    Dim dateParts() As String

    ' 파일 선택 대화상자 생성
    Set fd = Application.FileDialog(msoFileDialogFilePicker)
    
    ' 파일 선택 대화상자 표시
    If fd.Show = -1 Then
        filePath = fd.SelectedItems(1)
    Else
        Exit Sub
    End If
    
    ' 선택된 파일 열기
    Set wb = Workbooks.Open(filePath)
    Set ws = wb.Sheets("당주계획")

    ' 이번 주 시작일과 종료일 계산
    startDate = Date - Weekday(Date, vbMonday) + 1
    endDate = startDate + 6

    ' 2행의 모든 셀을 순회
    For Each cell In ws.Rows(2).Cells
        dateStr = cell.Value

        ' '/' 또는 '('가 포함된 셀만 처리
        If InStr(dateStr, "/") > 0 And InStr(dateStr, "(") > 0 Then
            ' 날짜 부분만 추출
            dateStr = Left(dateStr, InStr(dateStr, " ") - 1)
            dateParts = Split(dateStr, "/")
            
            If UBound(dateParts) = 1 Then
                ' 날짜 객체 생성
                cellDate = DateSerial(Year(Date), dateParts(0), dateParts(1))
                
                ' 셀의 날짜가 이번 주에 해당하는지 확인
                If cellDate >= startDate And cellDate <= endDate Then
                    ' 배경색을 노랑색으로 변경
                    ws.Columns(cell.Column).Interior.Color = vbYellow
                End If
            End If
        End If
    Next cell

    ' 파일을 닫지 않고 열어둔 상태로 둠
End Sub
이 코드는 2행의 셀들을 순회하면서 '/'와 '('가 모두 포함된 셀에 대해서만 날짜 처리를 수행합니다. 이렇게 하면 형식에 맞지 않는 셀에서 발생할 수 있는 에러를 피할 수 있습니다.





