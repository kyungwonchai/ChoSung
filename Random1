public FileCheckerMES20(ObservableCollection<ProductOrderModel> productOrders, ComportManager comPortManager, ObservableCollection<string> taskList = null)
{
    _productOrders = productOrders; // 주문 목록 컬렉션을 받아 초기화
    _comPortPLC = comPortManager; // ComportManager 인스턴스를 초기화
    _taskList = taskList ?? new ObservableCollection<string>(); // taskList가 null이면 새로운 리스트로 초기화
    _isFirstExecution = true; // 첫 실행 여부를 true로 설정
    _programStartTime = DateTime.Now; // 프로그램 시작 시간을 현재 시간으로 설정
    _isFNLDetected = false; // FNL^ 감지 여부 초기화
    _pendingAction = false; // PLAN Selected 또는 JD^ 대기 상태로 설정

    // 타이머를 1초마다 실행되도록 설정
    _timer = new DispatcherTimer
    {
        Interval = TimeSpan.FromSeconds(1) // 1초마다 Tick 발생
    };
    _timer.Tick += CheckFiles; // 타이머가 작동할 때마다 CheckFiles 실행
    _timer.Start(); // 타이머 시작

    // 로그 출력: 타이머가 시작되었음을 알림
    msgvs.Instance.LogT2("FileCheckerMES20: 타이머가 시작되었습니다.");

    // 현재 감시할 가장 최신 로그 파일을 설정
    _currentMonitoredFile = GetLatestLogFile();
    _lastWriteTime = _currentMonitoredFile != null 
        ? File.GetLastWriteTime(_currentMonitoredFile) 
        : DateTime.MinValue; // 파일이 없는 경우 시간을 MinValue로 설정

    // 로그 출력: 파일 감시 시작 알림
    msgvs.Instance.LogT2($"FileCheckerMES20: {_currentMonitoredFile} 파일 감시를 시작합니다.");
    _lastPlanSelectedDate = DateTime.Now; // 마지막 PLAN Selected 시간을 현재 시간으로 설정
    _lastPlanSelectedPosition = 0; // 파일의 위치를 0으로 초기화
}
