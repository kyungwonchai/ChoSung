래와 같이 SpreadsheetControl과 GridControl을 사용하여 GridControl의 데이터를 SpreadsheetControl의 내용과 함께 엑셀로 내보내는 예제 코드를 제공해드리겠습니다.

예제 코드
XAML (MainWindow.xaml)

xaml
Copy code
<Window x:Class="DevExpressExportExample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxsps="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet"
        Title="MainWindow" Height="450" Width="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- SpreadsheetControl -->
        <dxsps:SpreadsheetControl x:Name="spreadsheetControl" Grid.Row="0" Height="100" Margin="0,10"/>

        <!-- GridControl -->
        <dxg:GridControl x:Name="gridControl" Grid.Row="1">
            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="ID" Header="ID"/>
                <dxg:GridColumn FieldName="Name" Header="Name"/>
                <dxg:GridColumn FieldName="Country" Header="Country"/>
            </dxg:GridControl.Columns>
        </dxg:GridControl>

        <!-- Export Button -->
        <Button Grid.Row="2" Content="Export to Excel" Click="ExportToExcel_Click"/>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)

csharp
Copy code
using System;
using System.Collections.Generic;
using System.Data;
using System.Windows;
using DevExpress.Spreadsheet;
using DevExpress.Xpf.Grid;

namespace DevExpressExportExample
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            // 샘플 데이터 설정
            gridControl.ItemsSource = new List<Record>
            {
                new Record { ID = 1, Name = "John Doe", Country = "USA" },
                new Record { ID = 2, Name = "Jane Smith", Country = "UK" },
                new Record { ID = 3, Name = "Pierre Dupont", Country = "France" }
            };

            // SpreadsheetControl에 기본 데이터 추가
            DevExpress.Spreadsheet.Worksheet sheet = spreadsheetControl.Document.Worksheets[0];
            sheet.Cells["A1"].Value = "Custom Title";
            sheet.Cells["A2"].Value = "Report Date: " + DateTime.Now.ToShortDateString();
            sheet.Cells["A3"].Value = "Generated by: User";
        }

        private void ExportToExcel_Click(object sender, RoutedEventArgs e)
        {
            // 새 스프레드시트 생성
            DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook();
            DevExpress.Spreadsheet.Worksheet worksheet = workbook.Worksheets[0];

            // SpreadsheetControl의 데이터 복사
            DevExpress.Spreadsheet.Worksheet sourceWorksheet = spreadsheetControl.Document.Worksheets[0];
            DevExpress.Spreadsheet.Range sourceRange = sourceWorksheet.GetUsedRange();
            DevExpress.Spreadsheet.Range destinationRange = worksheet.Range.FromLTRB(0, 0, sourceRange.ColumnCount - 1, sourceRange.RowCount - 1);
            destinationRange.CopyFrom(sourceRange);

            // GridControl 데이터를 DataTable로 변환
            DevExpress.Xpf.Grid.TableView tableView = gridControl.View as DevExpress.Xpf.Grid.TableView;
            DataTable gridData = tableView.CreateExportTable();

            // GridControl 데이터를 스프레드시트에 추가
            worksheet.Import(gridData, false, sourceRange.RowCount, 0);

            // 열 너비 조정
            worksheet.Columns.AutoFit(0, gridData.Columns.Count - 1);

            // 파일로 저장
            string filePath = "ExportedGridDataWithHeader.xlsx";
            workbook.SaveDocument(filePath, DevExpress.Spreadsheet.DocumentFormat.OpenXml);

            MessageBox.Show($"Exported to {filePath}", "Export Success", MessageBoxButton.OK, MessageBoxImage.Information);
        }

        // 샘플 레코드 클래스
        public class Record
        {
            public int ID { get; set; }
            public string Name { get; set; }
            public string Country { get; set; }
        }
    }
}
프로젝트 파일 구조

markdown
Copy code
- DevExpressExportExample
  - MainWindow.xaml
  - MainWindow.xaml.cs
  - DevExpressExportExample.csproj
사용된 패키지 및 참조
DevExpress WPF Controls (DevExpress.Xpf.Grid)
DevExpress Spreadsheet Controls (DevExpress.Spreadsheet)
NuGet 패키지 설치 방법
NuGet 패키지 관리자를 사용하여 DevExpress 라이브러리를 설치합니다.

DevExpress.Xpf.Grid
bash
Copy code
Install-Package DevExpress.Xpf.Grid
DevExpress.Spreadsheet
bash
Copy code
Install-Package DevExpr