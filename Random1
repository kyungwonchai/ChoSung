비스로 등록된 프로그램에서 호환성 모드를 적용하는 것은 일반적으로 어려운 일입니다. 특히 Windows 서비스는 기본적으로 GUI 환경 없이 동작하기 때문에, 일반적인 호환성 설정(예: 속성 창에서 설정하는 호환성 모드)은 서비스에 적용되지 않습니다. 하지만, 서비스 시작 시 특정 호환성 관련 설정을 적용하는 방법이 있을 수 있습니다. 여기에 몇 가지 가능한 해결책을 제시하겠습니다.

1. 서비스에 아규먼트로 전달하는 방법
서비스에 Windows 호환성 모드를 직접 인자로 전달하는 것은 Windows 기본 기능으로는 제공되지 않습니다. 하지만 대신 다른 방식으로 이 문제를 해결할 수 있는 몇 가지 대안이 있습니다.

2. 사전 실행 스크립트 사용하기 (Wrapper Script)
VNC 서버가 서비스로 등록되어 있는 경우, 직접 프로그램에 대한 실행 인자나 호환성을 지정하는 방법 대신에, 서비스가 실행되기 전 사전 스크립트를 실행하는 방식으로 해결할 수 있습니다. 스크립트를 사용하여 VNC를 호환성 모드로 실행하도록 래핑(wrapping)하는 것입니다.

배치 파일을 생성하여 실행:

배치 파일 생성: run_vnc_compatibility.bat라는 이름으로 배치 파일을 작성합니다.
다음 내용을 배치 파일에 추가합니다:
bat
코드 복사
@echo off
set exe_path="C:\Program Files\VNC\vncserver.exe"
set compatibility_mode=WIN7RTM
reg add "HKCU\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers" /v %exe_path% /t REG_SZ /d %compatibility_mode% /f
start "" %exe_path%
이 배치 파일은 레지스트리를 사용하여 VNC 실행 파일에 Windows 7 호환성 모드를 설정한 후, 프로그램을 시작합니다.
이 배치 파일을 서비스로 등록하여 실행되도록 구성합니다.
서비스 등록:

sc 명령어 사용:
Windows에서는 sc 명령어를 사용하여 서비스를 등록할 수 있습니다.
cmd
코드 복사
sc create VNCService binPath= "C:\경로\run_vnc_compatibility.bat"
이렇게 하면 배치 파일을 이용하여 VNC 서버가 호환성 모드로 실행되도록 할 수 있습니다.
3. 레지스트리 설정을 통한 호환성 모드 강제 적용
레지스트리에서 호환성 모드 적용:
Windows 레지스트리에서 특정 프로그램이 항상 호환성 모드로 실행되도록 설정할 수 있습니다.
다음 경로에 레지스트리 키를 추가하여 특정 프로그램을 강제로 호환성 모드로 실행되도록 할 수 있습니다:
코드 복사
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers
여기에서 새 문자열 값을 추가하고 이름을 VNC 실행 파일의 전체 경로로 설정하고, 데이터 값을 WIN7RTM으로 설정합니다.
예를 들어:
이름: "C:\Program Files\VNC\vncserver.exe"
값: WIN7RTM
4. 호환성 모드 강제 프로그램 사용
Microsoft Application Compatibility Toolkit 같은 툴을 사용하여 특정 프로그램을 강제로 호환성 모드로 실행되도록 설정할 수 있습니다. 이 툴을 사용하면 서비스에 대해 복잡한 호환성 설정을 적용할 수 있으며, 레지스트리나 GUI를 통한 설정보다 훨씬 세부적인 조정이 가능합니다.
5. 서비스 자체 설정 변경