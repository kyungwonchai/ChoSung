using System;
using System.Drawing;
using System.Windows.Forms;

public class MainForm : Form
{
    public MainForm()
    {
        // 폼 초기화
        this.Text = "Pixel Color Checker";
        this.ClientSize = new Size(400, 300);
        this.Load += MainForm_Load;
    }

    private void MainForm_Load(object sender, EventArgs e)
    {
        // 300, 200 위치의 픽셀 색상 확인 및 클릭
        CheckPixelColor(300, 200);
    }

    private void CheckPixelColor(int x, int y)
    {
        using (Bitmap screenBitmap = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height))
        {
            using (Graphics g = Graphics.FromImage(screenBitmap))
            {
                g.CopyFromScreen(0, 0, 0, 0, screenBitmap.Size);
            }

            Color pixelColor = screenBitmap.GetPixel(x, y);
            if (pixelColor.R <= 75 && pixelColor.G <= 75 && pixelColor.B <= 75)
            {
                Cursor.Position = new Point(x, y);
                DoMouseClick();
            }
        }
    }

    private void DoMouseClick()
    {
        // 마우스 클릭 동작 수행
        // 여기에 원하는 동작을 추가하세요
        MessageBox.Show("Clicked at 300, 200!");
    }

    public static void Main()
    {
        Application.Run(new MainForm());
    }
}
