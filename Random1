코드를 실행하기 위해서는 Pythonnet 라이브러리를 사용할 수 있습니다. 이 라이브러리를 통해 C# 프로그램에서 파이썬 스크립트를 실행할 수 있습니다.

먼저, NuGet 패키지 관리자에서 Pythonnet 라이브러리를 설치하세요.

C# 코드 예시:

csharp

using Python.Runtime;
using System;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void btnExecute_Click(object sender, EventArgs e)
        {
            string filePath = txtFilePath.Text;  // Assuming txtFilePath is your TextBox for the file path
            RunPythonScript(filePath);
        }

        private void RunPythonScript(string filePath)
        {
            // Initialize the Python Runtime
            PythonEngine.Initialize();

            using (Py.GIL())  // acquire the Python GIL (Global Interpreter Lock)
            {
                dynamic py = Py.Import("__main__");

                // Assume you have a Python function called `open_excel_file` that takes a file path
                py.open_excel_file(filePath);
            }

            // Shutdown the Python Runtime
            PythonEngine.Shutdown();
        }
    }
}

이 C# 코드는 Windows Forms 애플리케이션에 적용된 것이며, 텍스트 박스와 버튼 컨트롤이 포함되어 있다고 가정합니다. 버튼을 클릭하면 파이썬 함수 open_excel_file을 실행하는데, 이 함수는 파이썬에서 원하는대로 Excel 파일을 열어 처리하면 됩니다.

파이썬 코드 (open_excel_file 함수) 예시:

python

from openpyxl import load_workbook

def open_excel_file(file_path):
    wb = load_workbook(file_path)
    # Your code to handle the Excel file

이렇게 하면 C# 프로그램에서 버튼을 클릭할 때마다 파이썬 코드가 실행되어 Ex