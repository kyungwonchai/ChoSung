일별 사용 증가량 계산: 이전 날과 비교하여 각 컴퓨터의 일별 사용 증가량을 계산합니다. 이를 위해 LAG 함수를 사용하여 이전 날의 데이터와 비교할 수 있습니다.
sql
Copy code
SELECT
    ComputerID,
    DateRecorded,
    HDDSpaceRemaining,
    LAG(HDDSpaceRemaining, 1) OVER (PARTITION BY ComputerID ORDER BY DateRecorded) AS PreviousDayHDDRemaining,
    PreviousDayHDDRemaining - HDDSpaceRemaining AS DailyIncrease
FROM HDDUsage;
가장 많이 사용된 HDD의 상위 10개 조회: 일별 증가량이 가장 많았던 날을 찾고, 그 날 HDD 사용량이 가장 많았던 상위 10대 컴퓨터를 조회합니다.
sql
Copy code
;WITH DailyIncreases AS (
    SELECT
        DateRecorded,
        ComputerID,
        HDDSpaceRemaining - LAG(HDDSpaceRemaining, 1) OVER (PARTITION BY ComputerID ORDER BY DateRecorded) AS Increase
    FROM HDDUsage
)
SELECT TOP 10
    ComputerID,
    MAX(Increase) AS MaxIncrease
FROM DailyIncreases
GROUP BY ComputerID
ORDER BY MaxIncrease DESC;
이 쿼리들을 사용하여 MSSQL 데이터베이스에서 원하는 정보를 추출하고 분석할 수 있습니다. 이 과정에서 특정 날짜나 조건을 변경하며 필요한 데이터를 세밀하게 조정할 수 있습니다.