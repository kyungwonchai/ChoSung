스토어드 프로시저를 사용하여 지정된 키에 대한 중복 처리를 할 수 있습니다. 아래의 스토어드 프로시저 예시는 키가 중복될 경우 모든 다른 컬럼을 업데이트하고, 중복되지 않으면 새 레코드를 삽입합니다.
MS SQL 스토어드 프로시저 예시

sql

CREATE PROCEDURE sp_InsertOrUpdate
    @C_S1 INT,
    @C_name1 NVARCHAR(50),
    @C_spe1 NVARCHAR(50),
    @C_ddd NVARCHAR(50),
    @OtherColumn1 NVARCHAR(50),
    @OtherColumn2 NVARCHAR(50)
AS
BEGIN
    -- 중복 체크
    IF EXISTS (SELECT 1 FROM 메인확정 WHERE C_S1 = @C_S1 AND C_name1 = @C_name1 AND C_spe1 = @C_spe1 AND C_ddd = @C_ddd)
    BEGIN
        -- 업데이트
        UPDATE 메인확정
        SET OtherColumn1 = @OtherColumn1, OtherColumn2 = @OtherColumn2
        WHERE C_S1 = @C_S1 AND C_name1 = @C_name1 AND C_spe1 = @C_spe1 AND C_ddd = @C_ddd;
    END
    ELSE
    BEGIN
        -- 인서트
        INSERT INTO 메인확정 (C_S1, C_name1, C_spe1, C_ddd, OtherColumn1, OtherColumn2)
        VALUES (@C_S1, @C_name1, @C_spe1, @C_ddd, @OtherColumn1, @OtherColumn2);
    END
END

C# 코드에서 스토어드 프로시저 호출

csharp

using (SqlCommand cmd = new SqlCommand("sp_InsertOrUpdate", conn))
{
    cmd.CommandType = CommandType.StoredProcedure;

    cmd.Parameters.AddWithValue("@C_S1", yourValueForCS1);
    cmd.Parameters.AddWithValue("@C_name1", yourValueForCName1);
    cmd.Parameters.AddWithValue("@C_spe1", yourValueForCSpe1);
    cmd.Parameters.AddWithValue("@C_ddd", yourValueForCDdd);
    cmd.Parameters.AddWithValue("@OtherColumn1", yourValueForOtherColumn1);
    cmd.Parameters.AddWithValue("@OtherColumn2", yourValueForOtherColumn2);

    cmd.ExecuteNonQuery();
}

이렇게 하면 중복된 키에 대해 모든 다른 컬럼을 업데이트하고, 중복되지 않으면 새로운 레코드를 삽입할 수 있습니다.