sual Studio 2022에서 Windows XP용 프로그램을 만드는 방법과 사용자 친화적인 코드를 완벽하게 정리해 드리겠습니다.

우선 결론부터 말씀드리면, 우분투(리눅스)가 아니라 지금 사용 중인 윈도우의 Visual Studio 2022에서 컴파일해야 합니다. 다만, 2022는 최신 툴이라서 **"XP 지원 도구"**를 추가로 설치하고 설정을 조금 바꿔줘야 합니다.

아래 순서대로 따라오시면 **"설치 없이 돌아가는 EXE 파일"**을 만들 수 있습니다.

1. Visual Studio 2022 설정 (가장 중요)
윈도우 XP에서 돌아가는 프로그램을 만들려면 "Windows XP 지원용 C++" 구성 요소를 설치해야 합니다.

Visual Studio Installer 실행 (윈도우 시작 버튼 누르고 검색).

사용 중인 VS 2022 옆의 [수정] 버튼 클릭.

[개별 구성 요소] 탭 클릭.

검색창에 XP라고 입력.

C++ Windows XP Support for VS 2017 (v141) tools [Deprecated] 체크 후 [수정/설치] 버튼 클릭. (이게 있어야 XP용을 만들 수 있습니다.)

2. 프로젝트 생성 및 옵션 세팅 (필수)
이 과정을 안 하면 "올바른 Win32 응용 프로그램이 아닙니다"라는 에러가 뜹니다.

VS 2022 실행 -> 새 프로젝트 만들기 -> 빈 프로젝트 (C++) 선택 -> 프로젝트 이름 SmartStarter 등으로 짓고 생성.

[소스 파일] 우클릭 -> 추가 -> 새 항목 -> main.cpp 생성.

프로젝트 속성 변경 (상단 메뉴 [프로젝트] -> [속성]):

구성(Configuration): Release (배포용이므로 Debug 아님)

플랫폼(Platform): x86 (XP는 대부분 32비트이므로 x86 필수)

[구성 속성] -> [일반] -> [플랫폼 도구 집합]: Visual Studio 2017 - Windows XP (v141_xp) 선택.

[구성 속성] -> [C/C++] -> [코드 생성] -> [런타임 라이브러리]: 다중 스레드(/MT) 선택.

(이게 핵심입니다. DLL 의존성을 없애서 파일 하나로 돌아가게 만듭니다.)

[확인] 클릭.

3. 소스 코드 (복사해서 붙여넣기)
사용자가 메모장으로 열었을 때 직관적으로 보이도록 포맷을 [대기시간초] | [프로그램경로] 형태로 잡았습니다.

C++
#include <windows.h>
#include <iostream>
#include <fstream>
#include <string>
#include <vector>
#include <algorithm>

// 사용할 설정 파일 이름
const std::string CONFIG_FILENAME = "startup_list.txt";

// 문자열 앞뒤 공백 제거 함수
std::string Trim(const std::string& str) {
    size_t first = str.find_first_not_of(" \t\r\n");
    if (std::string::npos == first) return "";
    size_t last = str.find_last_not_of(" \t\r\n");
    return str.substr(first, (last - first + 1));
}

// 현재 실행 파일이 있는 경로(폴더) 알아내기
std::string GetExePath() {
    char buffer[MAX_PATH];
    GetModuleFileNameA(NULL, buffer, MAX_PATH);
    std::string::size_type pos = std::string(buffer).find_last_of("\\/");
    return std::string(buffer).substr(0, pos);
}

// 파일 존재 여부 확인
bool FileExists(const std::string& path) {
    DWORD dwAttrib = GetFileAttributesA(path.c_str());
    return (dwAttrib != INVALID_FILE_ATTRIBUTES && !(dwAttrib & FILE_ATTRIBUTE_DIRECTORY));
}

// 기본 설정 파일 생성
void CreateDefaultConfig(const std::string& fullPath) {
    std::ofstream outFile(fullPath.c_str());
    if (outFile.is_open()) {
        outFile << "# [SMD 설비 시작 프로그램 설정]" << std::endl;
        outFile << "# 작성 방법: 대기시간(초) | 실행할파일경로" << std::endl;
        outFile << "# (줄 내림 순서대로 실행됩니다)" << std::endl;
        outFile << "# -------------------------------------------------" << std::endl;
        outFile << "10 | C:\\Windows\\notepad.exe" << std::endl;
        outFile << "5  | C:\\Program Files\\SMD\\MainSystem.exe" << std::endl;
        outFile.close();
    }
}

int main() {
    // 콘솔 창 숨기기 (필요하면 주석 해제)
    // FreeConsole();

    std::string configPath = GetExePath() + "\\" + CONFIG_FILENAME;
    
    // 1. 설정 파일 없으면 생성하고 안내
    if (!FileExists(configPath)) {
        CreateDefaultConfig(configPath);
        std::string msg = "설정 파일이 생성되었습니다.\n위치: " + configPath + "\n\n파일을 열어 실행할 프로그램 경로를 입력해주세요.";
        MessageBoxA(NULL, msg.c_str(), "설정 필요", MB_OK | MB_ICONINFORMATION);
        // 폴더를 열어줌
        ShellExecuteA(NULL, "open", GetExePath().c_str(), NULL, NULL, SW_SHOWNORMAL);
        return 0;
    }

    std::ifstream file(configPath.c_str());
    std::string line;
    int lineNum = 0;

    while (std::getline(file, line)) {
        lineNum++;
        std::string originLine = line; // 에러 메시지용 원본 저장
        line = Trim(line);

        // 주석(#)이나 빈 줄은 패스
        if (line.empty() || line[0] == '#') continue;

        // 구분자(|) 찾기
        size_t splitPos = line.find('|');
        if (splitPos == std::string::npos) {
            std::string err = "형식 오류 (줄 " + std::to_string(lineNum) + ")\n'|' 기호가 없습니다.\n\n내용: " + originLine;
            MessageBoxA(NULL, err.c_str(), "설정 파일 오류", MB_OK | MB_ICONWARNING);
            continue;
        }

        // 데이터 파싱
        std::string timeStr = Trim(line.substr(0, splitPos));
        std::string pathStr = Trim(line.substr(splitPos + 1));

        // 2. 시간 대기 (딜레이)
        try {
            int delay = std::stoi(timeStr);
            if (delay > 0) {
                std::cout << "Waiting " << delay << " sec before launching..." << std::endl;
                Sleep(delay * 1000);
            }
        } catch (...) {
            std::string err = "시간 설정 오류 (줄 " + std::to_string(lineNum) + ")\n숫자를 입력하세요: " + timeStr;
            MessageBoxA(NULL, err.c_str(), "오류", MB_OK | MB_ICONERROR);
            continue;
        }

        // 3. 파일 검사 및 실행
        if (FileExists(pathStr)) {
            std::cout << "Launching: " << pathStr << std::endl;
            // 실행 파일의 작업 폴더(Working Directory)를 해당 파일이 있는 곳으로 잡아줌 (중요)
            std::string workDir = pathStr.substr(0, pathStr.find_last_of("\\/"));
            
            ShellExecuteA(NULL, "open", pathStr.c_str(), NULL, workDir.c_str(), SW_SHOWNORMAL);
        } else {
            std::string err = "파일을 찾을 수 없습니다 (줄 " + std::to_string(lineNum) + ")\n경로: " + pathStr + "\n\n무시하고 계속 진행할까요?";
            int result = MessageBoxA(NULL, err.c_str(), "파일 경로 오류", MB_YESNO | MB_ICONERROR);
            if (result == IDNO) return 0; // 아니오 누르면 전체 중단
        }
    }

    return 0;
}
4. 빌드 및 배포 방법
VS 상단 메뉴에서 빌드(Build) -> 솔루션 빌드 클릭.

아래 출력창에 성공 1, ... 뜨면 성공.

프로젝트 폴더 안의 Release 폴더에 가보면 .exe 파일이 하나 있습니다.

이 파일만 복사해서 설비 PC의 아무 폴더(예: C:\AutoStart)에 넣으세요.

5. 현장 사용자가 보게 될 startup_list.txt 내용
프로그램을 한번 실행하면 자동으로 아래와 같은 텍스트 파일이 생깁니다. 사용자는 이걸 메모장으로 열어서 숫자와 경로만 바꾸면 됩니다.

Plaintext
# [SMD 설비 시작 프로그램 설정]
# 작성 방법: 대기시간(초) | 실행할파일경로
# (줄 내림 순서대로 실행됩니다)
# -------------------------------------------------
30 | C:\System32\Drivers\InitDriver.exe
5  | C:\Program Files\Panasonic\NPM\Main.exe
10 | C:\Util\MonitoringTool.exe
요약
컴파일: Visual Studio 2022에서 하되, XP 도구 설치 + 플랫폼 도구 집합(v141_xp) + MT(/MT) 설정 필수.

사용자 편의: 사용자는 복잡한 코드 몰라도 txt 파일에서 "30 | C:\경로" 만 수정하면 됨.

안전장치: 경로 틀리면 친절하게 "파일이 없는데 무시하고 진행할까요?"라고 팝업 뜸.