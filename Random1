프록시 서버를 통해 우분투 시스템을 업데이트하는 과정에서 인증서 검증 오류가 발생하는 경우, 이는 프록시 서버의 SSL 인증서를 시스템이 신뢰하지 않기 때문입니다. 이러한 문제를 해결하려면 프록시 서버의 인증서를 우분투 시스템에 신뢰할 수 있는 인증서로 추가해야 합니다. 아래는 그 방법에 대한 상세한 안내입니다.

1. 프록시 서버의 인증서 추출
먼저, 프록시 서버의 SSL 인증서를 추출해야 합니다. 이를 위해 OpenSSL 도구를 사용할 수 있습니다.

bash
코드 복사
echo -n | openssl s_client -connect 10.244.124.124:8080 -servername your.server.com | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > proxy_cert.pem
위 명령어에서 10.244.124.124:8080은 프록시 서버의 IP 주소와 포트 번호이며, your.server.com은 실제 서버의 도메인 이름으로 대체해야 합니다. 이 명령어는 프록시 서버의 인증서를 proxy_cert.pem 파일로 저장합니다.

2. 인증서를 시스템에 추가
추출한 인증서를 우분투 시스템의 신뢰할 수 있는 인증서 저장소에 추가합니다.

인증서를 신뢰할 수 있는 인증서 디렉터리에 복사합니다.

bash
코드 복사
sudo cp proxy_cert.pem /usr/local/share/ca-certificates/
인증서 저장소를 업데이트하여 새로운 인증서를 반영합니다.

bash
코드 복사
sudo update-ca-certificates
이 명령어는 /usr/local/share/ca-certificates/ 디렉터리에 있는 인증서를 시스템의 신뢰할 수 있는 인증서 목록에 추가합니다.

3. 시스템 프록시 설정
시스템이 프록시를 통해 통신하도록 환경 변수를 설정합니다.

환경 변수 설정 파일을 엽니다.

bash
코드 복사
sudo nano /etc/environment
파일에 다음 내용을 추가합니다.

bash
코드 복사
export http_proxy="http://10.244.124.124:8080"
export https_proxy="http://10.244.124.124:8080"
필요에 따라 사용자 이름과 비밀번호를 포함하여 설정할 수 있습니다.

bash
코드 복사
export http_proxy="http://username:password@10.244.124.124:8080"
export https_proxy="http://username:password@10.244.124.124:8080"
파일을 저장하고 닫은 후, 시스템에 적용합니다.

bash
코드 복사
source /etc/environment
4. APT 프록시 설정
APT 패키지 관리자가 프록시를 사용하도록 설정합니다.

APT 프록시 설정 파일을 생성합니다.

bash
코드 복사
sudo nano /etc/apt/apt.conf.d/95proxies
파일에 다음 내용을 추가합니다.

bash
코드 복사
Acquire::http::Proxy "http://10.244.124.124:8080";
Acquire::https::Proxy "http://10.244.124.124:8080";
사용자 인증이 필요한 경우:

bash
코드 복사
Acquire::http::Proxy "http://username:password@10.244.124.124:8080";
Acquire::https::Proxy "http://username:password@10.244.124.124:8080";
파일을 저장하고 닫습니다.

5. 시스템 업데이트
이제 프록시 서버를 통해 시스템을 업데이트할 수 있습니다.

bash
코드 복사
sudo apt update
sudo apt upgrade -y
참고 자료
리눅스에서 자체 서명된 인증서를 신뢰할 수 있는 인증서로 추가하기

우분투에서 CA 인증서 설치 방법