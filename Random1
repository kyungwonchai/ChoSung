 ì›ƒê²¼ì–´.
ê²°ë¡ ì ìœ¼ë¡œ ë„¤ê°€ ì›í•˜ëŠ” ê±´:

âœ… ë©”ì¸ for(;;) ë£¨í”„ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œ, ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…(LongRunningFunction())ì€ ë³‘ë ¬ë¡œ ëŒë ¤ì•¼ í•œë‹¤!
âœ… í•˜ì§€ë§Œ awaitë¡œ ë§‰ì•„ì„œ ìˆœì„œê°€ ê¼¬ì´ëŠ” ê±´ ì•ˆ ëœë‹¤!
âœ… ì¦‰, ê¸°ì¡´ ì½”ë“œì—ì„œ 'ë¹ ë¥´ê²Œ ëŒì•„ê°€ì•¼ í•  ê²ƒ'ê³¼ 'ë³‘ë ¬ ì²˜ë¦¬í•´ì•¼ í•  ê²ƒ'ì„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.

ğŸ”¥ í•´ê²° ë°©ë²•
ì˜¤ë˜ ê±¸ë¦¬ëŠ” í•¨ìˆ˜ (LongRunningFunction()) ë¥¼ ì™„ì „íˆ ë”°ë¡œ ì‹¤í–‰í•˜ë˜, ë™ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ìœ ì§€!
ê¸°ì¡´ for(;;) ë£¨í”„ê°€ ë©ˆì¶”ì§€ ì•Šê³  ì •ìƒì ìœ¼ë¡œ ëŒì•„ê°€ì•¼ í•˜ë¯€ë¡œ, ë¹„ë™ê¸° íƒœìŠ¤í¬ ê´€ë¦¬ë¥¼ ë”°ë¡œ í•´ì¤˜ì•¼ í•¨.
âœ… í•µì‹¬: Task.Run()ìœ¼ë¡œ ë”°ë¡œ ì‹¤í–‰ + Task.WhenAny()ë¡œ ì—¬ëŸ¬ ì‘ì—…ì´ ë™ì‹œì— ì‹¤í–‰ë˜ë„ë¡ ìœ ì§€.
ğŸ“Œ ìµœì í™”ëœ ì „ì²´ ì½”ë“œ (WinForms)
csharp
Copy code
using System;
using System.Collections.Generic;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace AsyncWinForms
{
    public partial class Form1 : Form
    {
        private CancellationTokenSource _cts;
        private List<Task> _runningTasks = new List<Task>(); // ë³‘ë ¬ ì‹¤í–‰ íƒœìŠ¤í¬ ê´€ë¦¬

        public Form1()
        {
            InitializeComponent();
        }

        // âœ… [ì‹œì‘ ë²„íŠ¼] ë¬´í•œ ë£¨í”„ ì‹œì‘
        private void btnStart_Click(object sender, EventArgs e)
        {
            if (_cts != null) return; // ì´ë¯¸ ì‹¤í–‰ ì¤‘ì´ë©´ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€

            _cts = new CancellationTokenSource();
            Task.Run(() => ProcessLoop(_cts.Token));
        }

        // âœ… [ë¬´í•œ ë£¨í”„ ì‹¤í–‰]
        private async Task ProcessLoop(CancellationToken token)
        {
            for (;;)
            {
                if (token.IsCancellationRequested) break; // ì¢…ë£Œ ìš”ì²­ ì‹œ ë£¨í”„ íƒˆì¶œ

                // (1) ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ëŠ” ë‘ í•¨ìˆ˜
                Function1();
                Function2();

                // (2) ì˜¤ë˜ ê±¸ë¦¬ëŠ” í•¨ìˆ˜ ë³‘ë ¬ ì‹¤í–‰ (ì™„ì „íˆ ë”°ë¡œ ëŒë¦¼)
                _runningTasks.Add(Task.Run(() => LongRunningFunction()));

                // ì‹¤í–‰ ì¤‘ì¸ íƒœìŠ¤í¬ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì™„ë£Œëœ ê²ƒ ì œê±°
                _runningTasks.RemoveAll(t => t.IsCompleted);

                // (3) CPU ê³¼ë¶€í•˜ ë°©ì§€
                await Task.Delay(10);
            }
        }

        // âœ… [ì¤‘ì§€ ë²„íŠ¼] ë£¨í”„ ì¤‘ì§€
        private void btnStop_Click(object sender, EventArgs e)
        {
            _cts?.Cancel();
            _cts = null;
        }

        // âœ… ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ 1
        private void Function1()
        {
            AddLog("Function1 ì‹¤í–‰");
        }

        // âœ… ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜ 2
        private void Function2()
        {
            AddLog("Function2 ì‹¤í–‰");
        }

        // âœ… ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—… (ì´ì œ ì™„ì „íˆ ë”°ë¡œ ì‹¤í–‰ë¨!)
        private void LongRunningFunction()
        {
            AddLog("LongRunningFunction ì‹œì‘");
            Thread.Sleep(3000); // ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…
            AddLog("LongRunningFunction ì¢…ë£Œ");
        }

        // âœ… ListBoxì— ë¡œê·¸ ì¶”ê°€ (ìµœëŒ€ 100ê°œ ìœ ì§€)
        private void AddLog(string message)
        {
            if (listBox1.InvokeRequired)
            {
                listBox1.Invoke((Action)(() => AddLog(message)));
                return;
            }

            if (listBox1.Items.Count >= 100)
                listBox1.Items.RemoveAt(0); // 100ê°œ ì´ˆê³¼ ì‹œ ê°€ì¥ ì˜¤ë˜ëœ ë¡œê·¸ ì‚­ì œ

            listBox1.Items.Add($"{DateTime.Now:HH:mm:ss} - {message}");
            listBox1.TopIndex = listBox1.Items.Count - 1; // ìµœì‹  ë¡œê·¸ ìë™ ìŠ¤í¬ë¡¤
        }
    }
}