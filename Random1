Streamlit + PyMSSQLë¡œ ì›¹ êµ¬í˜„ (Ubuntu, Python ê¸°ë°˜)
ëª©í‘œ:

ì¢Œì¸¡: íŠ¹ì • ë¼ì¸ ì„ íƒ ListBox
ìš°ì¸¡: BCT1_1 ~ BCT1_8, TCT1_1 ~ TCT1_8 ë°ì´í„°ë¥¼ í‘œ (Streamlit DataFrame)ë¡œ í‘œì‹œ
í—¤ë”: 1í˜¸ê¸° ~ 8í˜¸ê¸°
ìƒë‹¨: ì„ íƒí•œ ëª¨ë¸ëª…ê³¼ time1 ê°’ í‘œì‹œ
Streamlit + PyMSSQL (MSSQL ì—°ê²°)
Ubuntuì—ì„œ ì‹¤í–‰ ê°€ëŠ¥
âœ… ğŸ”¹ Python (Streamlit) ì½”ë“œ
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql
import pandas as pd

# ğŸ“Œ MSSQL ì—°ê²° ì„¤ì •
DB_CONFIG = {
    "server": "ì„œë²„ì£¼ì†Œ",
    "user": "ì‚¬ìš©ìëª…",
    "password": "ë¹„ë°€ë²ˆí˜¸",
    "database": "DBì´ë¦„"
}

# ğŸ“Œ íŠ¹ì • ë¼ì¸ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
def get_line_data(line_name):
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor(as_dict=True)

    # ìµœì‹  ëª¨ë¸ê³¼ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
    cursor.execute(f"""
        SELECT TOP 1 ëª¨ë¸, time1 
        FROM ExcelData 
        WHERE ë¼ì¸ = %s
        ORDER BY time1 DESC
    """, (line_name,))
    latest = cursor.fetchone()

    if not latest:
        conn.close()
        return None, None, None

    latest_model, latest_time = latest["ëª¨ë¸"], latest["time1"]

    # í•´ë‹¹ ëª¨ë¸ì˜ ìµœì‹  10ê°œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    cursor.execute(f"""
        WITH RecentData AS (
            SELECT TOP 10 * FROM ExcelData
            WHERE ë¼ì¸ = %s AND ëª¨ë¸ = %s
            ORDER BY time1 DESC
        )
        SELECT 
            MIN(CASE WHEN BCT1_1 >= 1 THEN BCT1_1 ELSE NULL END) AS BCT1_1,
            MIN(CASE WHEN BCT1_2 >= 1 THEN BCT1_2 ELSE NULL END) AS BCT1_2,
            MIN(CASE WHEN BCT1_3 >= 1 THEN BCT1_3 ELSE NULL END) AS BCT1_3,
            MIN(CASE WHEN BCT1_4 >= 1 THEN BCT1_4 ELSE NULL END) AS BCT1_4,
            MIN(CASE WHEN BCT1_5 >= 1 THEN BCT1_5 ELSE NULL END) AS BCT1_5,
            MIN(CASE WHEN BCT1_6 >= 1 THEN BCT1_6 ELSE NULL END) AS BCT1_6,
            MIN(CASE WHEN BCT1_7 >= 1 THEN BCT1_7 ELSE NULL END) AS BCT1_7,
            MIN(CASE WHEN BCT1_8 >= 1 THEN BCT1_8 ELSE NULL END) AS BCT1_8,

            MIN(CASE WHEN TCT1_1 >= 1 THEN TCT1_1 ELSE NULL END) AS TCT1_1,
            MIN(CASE WHEN TCT1_2 >= 1 THEN TCT1_2 ELSE NULL END) AS TCT1_2,
            MIN(CASE WHEN TCT1_3 >= 1 THEN TCT1_3 ELSE NULL END) AS TCT1_3,
            MIN(CASE WHEN TCT1_4 >= 1 THEN TCT1_4 ELSE NULL END) AS TCT1_4,
            MIN(CASE WHEN TCT1_5 >= 1 THEN TCT1_5 ELSE NULL END) AS TCT1_5,
            MIN(CASE WHEN TCT1_6 >= 1 THEN TCT1_6 ELSE NULL END) AS TCT1_6,
            MIN(CASE WHEN TCT1_7 >= 1 THEN TCT1_7 ELSE NULL END) AS TCT1_7,
            MIN(CASE WHEN TCT1_8 >= 1 THEN TCT1_8 ELSE NULL END) AS TCT1_8
        FROM RecentData;
    """, (line_name, latest_model))

    data = cursor.fetchone()
    conn.close()

    return latest_model, latest_time, data

# ğŸ“Œ ë¼ì¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
def get_lines():
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor()
    cursor.execute("SELECT DISTINCT ë¼ì¸ FROM ExcelData ORDER BY ë¼ì¸")
    lines = [row[0] for row in cursor.fetchall()]
    conn.close()
    return lines

# ğŸ“Œ Streamlit UI
st.title("ë¼ì¸ ë°ì´í„° ì¡°íšŒ")

# ğŸ“Œ ë¼ì¸ ì„ íƒ
lines = get_lines()
selected_line = st.sidebar.selectbox("ë¼ì¸ ì„ íƒ", lines)

# ğŸ“Œ ë°ì´í„° ì¡°íšŒ
if selected_line:
    latest_model, latest_time, table_data = get_line_data(selected_line)

    if latest_model:
        st.subheader(f"ëª¨ë¸ëª…: {latest_model}")
        st.subheader(f"ìµœì‹  ì‹œê°„: {latest_time}")

        # ğŸ“Œ ë°ì´í„° ë³€í™˜ (ë”•ì…”ë„ˆë¦¬ë¥¼ DataFrameìœ¼ë¡œ ë³€í™˜)
        if table_data:
            df = pd.DataFrame([table_data], index=["BCT & TCT"])
            df.columns = ["1í˜¸ê¸°", "2í˜¸ê¸°", "3í˜¸ê¸°", "4í˜¸ê¸°", "5í˜¸ê¸°", "6í˜¸ê¸°", "7í˜¸ê¸°", "8í˜¸ê¸°"]
            st.table(df)
        else:
            st.warning("í•´ë‹¹ ë¼ì¸ì— ëŒ€í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
    else:
        st.warning("í•´ë‹¹ ë¼ì¸ì— ëŒ€í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
âœ… ì„¤ì¹˜ ë° ì‹¤í–‰
bash
ì½”ë“œ ë³µì‚¬
pip install streamlit pymssql pandas
streamlit run app.py
â¡ ë¸Œë¼ìš°ì €ì—ì„œ http://localhost:8501 ì ‘ì†í•˜ë©´ ì‹¤í–‰ë¨! ğŸš€

âœ… êµ¬í˜„ í™”ë©´
1ï¸âƒ£ ì¢Œì¸¡ â†’ ë¼ì¸ ì„ íƒ (ListBox)
2ï¸âƒ£ ìƒë‹¨ â†’ ëª¨ë¸ëª… & ìµœì‹  ì‹œê°„