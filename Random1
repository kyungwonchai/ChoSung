amework 4.8을 사용하여 오페라 브라우저로 특정 웹 주소를 비동기적으로 열고, 15초 대기 후 추가 작업을 순차적으로 수행하며, 메시지를 ListBox에 기록하고, 항목이 500개를 초과하면 가장 오래된 항목부터 제거하는 기능을 구현할 수 있습니다.

아래는 해당 기능을 구현한 코드 예제입니다:

csharp
코드 복사
using System;
using System.Diagnostics;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace OperaLauncher
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private async Task LaunchOperationAsync()
        {
            string operaPath = @"C:\Program Files\Opera\launcher.exe";
            string url = "https://www.example.com";

            try
            {
                Process.Start(operaPath, url);
                LogMessage("오페라 브라우저를 실행했습니다.");

                await Task.Delay(15000);
                LogMessage("15초 대기 완료.");

                await PerformAdditionalTaskAsync();
            }
            catch (Exception ex)
            {
                LogMessage($"오페라 브라우저 실행 중 오류 발생: {ex.Message}");
            }
        }

        private async Task PerformAdditionalTaskAsync()
        {
            // 여기에 추가 작업 코드를 작성합니다.
            await Task.Run(() =>
            {
                // 예시: 5초 동안 실행되는 작업
                Task.Delay(5000).Wait();
            });

            LogMessage("추가 작업이 완료되었습니다.");
        }

        private void LogMessage(string message)
        {
            if (listBox1.InvokeRequired)
            {
                listBox1.Invoke(new Action(() => AddMessageToListBox(message)));
            }
            else
            {
                AddMessageToListBox(message);
            }
        }

        private void AddMessageToListBox(string message)
        {
            listBox1.Items.Add($"{DateTime.Now}: {message}");

            if (listBox1.Items.Count > 500)
            {
                listBox1.Items.RemoveAt(0);
            }

            listBox1.TopIndex = listBox1.Items.Count - 1;
        }

        private async void ExecuteAllOperationsButton_Click(object sender, EventArgs e)
        {
            await LaunchOperationAsync();
            // 다른 비동기 작업을 순차적으로 호출할 수 있습니다.
            // await AnotherOperationAsync();
        }
    }
}
코드 설명:

LaunchOperationAsync 메서드: 오페라 브라우저를 지정한 URL과 함께 실행하고, 15초 대기한 후 추가 작업을 수행하는 비동기 메서드입니다.

PerformAdditionalTaskAsync 메서드: 추가 작업을 비동기적으로 수행하는 메서드입니다. 예시로 5초 동안 실행되는 작업을 포함하였습니다.

LogMessage 메서드: ListBox에 메시지를 추가하는 메서드로, 스레드 안전하게 UI 컨트롤에 접근하기 위해 InvokeRequired를 확인하고, 필요에 따라 Invoke를 사용합니다.

AddMessageToListBox 메서드: ListBox에 새로운 메시지를 추가하고, 항목 수가 500개를 초과하면 가장 오래된 항목을 제거합니다. 또한, TopIndex를 설정하여 최신 항목이 자동으로 표시되도록 합니다.

ExecuteAllOperationsButton_Click 이벤트 핸들러: 버튼 클릭 시 LaunchOperationAsync 메서드를 호출하여 작업을 시작합니다. 필요에 따라 다른 비동기 작업을 순차적으로 호출할 수 있습니다.