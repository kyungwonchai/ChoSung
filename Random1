using System;
using System.Windows.Forms;
using System.Threading;

namespace DailyJobWinFormsApp
{
    public partial class MainForm : Form
    {
        private Timer timer;

        public MainForm()
        {
            InitializeComponent();

            // 폼 로드 시 타이머를 설정합니다.
            SetupTimer();
        }

        private void SetupTimer()
        {
            // 현재 시간과 3시의 시간 차이를 계산합니다.
            DateTime now = DateTime.Now;
            DateTime targetTime = now.Date.AddHours(3); // 오늘 3시로 설정합니다.
            if (now > targetTime)
            {
                // 이미 3시가 지났으면 다음날 3시로 설정합니다.
                targetTime = targetTime.AddDays(1);
            }

            // 타이머를 생성하고 설정합니다.
            double interval = (targetTime - now).TotalMilliseconds;
            timer = new Timer(TimerCallback, null, (int)interval, Timeout.Infinite);
        }

        private void TimerCallback(object state)
        {
            // 타이머 이벤트가 발생할 때 실행되는 메서드입니다.
            // 매일 새벽 3시에 이곳의 코드 블록이 실행됩니다.

            // 원하는 작업을 이곳에 추가합니다.
            // 예: 특정 작업 수행, 이메일 전송, 파일 처리 등

            // 작업이 완료되면 다시 타이머를 설정합니다.
            SetupTimer();
        }
    }
}
