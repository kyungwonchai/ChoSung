from openpyxl import load_workbook

# 엑셀 파일 로드
file_path = 'your_file_path.xlsx'
wb = load_workbook(file_path)
sheet = wb.active

# 컬럼명 가져오기
columns = []
for cell in sheet[2]:
    column_name = "C_" + cell.value.replace(" ", "")  # 공백 제거
    columns.append(column_name)

# 데이터 타입 가져오기 및 업데이트
data_types = []
for cell in sheet[3]:
    data_type = "VARCHAR(250)"  # 기본 데이터 타입은 VARCHAR(250)로 설정

    if cell.data_type == "n":
        data_type = "INT"
    elif cell.data_type == "d":
        data_type = "DATE"
    
    # 문자열 데이터 타입의 길이에 +5를 더하여 업데이트
    if "VARCHAR" in data_type:
        data_type_length = int(data_type[data_type.find("(") + 1:data_type.find(")")])
        updated_data_type = data_type[:data_type.find("(") + 1] + str(data_type_length + 5) + ")"
        data_type = updated_data_type

    data_types.append(data_type)

# CREATE TABLE 스크립트 출력
create_table_script = "CREATE TABLE your_table (\n"
for column, data_type in zip(columns, data_types):
    create_table_script += f"    {column} {data_type},\n"
create_table_script = create_table_script.rstrip(",\n")  # 마지막 쉼표 및 개행 제거
create_table_script += "\n)"
print(create_table_script)
