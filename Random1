using System;
using Microsoft.Win32;

namespace RegistryExample
{
    class Program
    {
        static void Main(string[] args)
        {
            // 오류 보고에서 제외할 프로그램의 경로 설정
            string exePath = @"C:\Path\To\Your\abcd.exe"; // 예시 경로입니다.

            // 레지스트리 키 경로 (이 경로는 예시이며, 실제로는 다를 수 있음)
            string keyPath = @"Software\Microsoft\Windows\Windows Error Reporting\Exclusions";

            try
            {
                // 레지스트리 키를 열거나, 없으면 생성
                using (RegistryKey key = Registry.LocalMachine.CreateSubKey(keyPath))
                {
                    if (key != null)
                    {
                        // 프로그램 경로를 레지스트리 값으로 추가
                        key.SetValue("YourProgramName", exePath, RegistryValueKind.String);
                        Console.WriteLine($"Program added to exclusions: {exePath}");
                    }
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"An error occurred: {ex.Message}");
            }
        }
    }
}
