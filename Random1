윈도우 10 기준으로 com0com을 설치하고 가상 COM 포트를 설정하여 사용할 수 있는 방법을 아주 상세히 설명드리겠습니다.

com0com 설치 및 설정
1. com0com 다운로드 및 설치
com0com 다운로드:

SourceForge의 com0com 프로젝트 페이지에서 설치 파일을 다운로드합니다.
설치 파일 실행:

다운로드한 설치 파일 (com0com-3.0.0.0-i386-and-x64-signed.exe)을 실행합니다.
설치 도중에 Windows 보안 경고가 나타나면 "이 드라이버 소프트웨어를 설치합니다"를 선택합니다.
2. 가상 COM 포트 페어 생성
com0com Setup Command Prompt 실행:

시작 메뉴에서 com0com 폴더를 찾아 Setup Command Prompt를 관리자 권한으로 실행합니다.
기본 가상 포트 페어 생성:

기본적으로 com0com은 CNCA0와 CNCB0라는 가상 포트 페어를 생성합니다.
이를 COM 포트로 변경하려면 다음 명령어를 입력합니다:
sh
코드 복사
change CNCA0 PortName=COM4
change CNCB0 PortName=COM5
이 명령은 CNCA0를 COM4로, CNCB0를 COM5로 변경합니다.
가상 포트 페어 확인:

현재 설정된 가상 포트 페어를 확인하려면 다음 명령어를 입력합니다:
sh
코드 복사
list
추가 가상 포트 페어 생성 (필요한 경우):

추가 포트 페어가 필요하면 다음 명령어를 사용합니다:
sh
코드 복사
install PortName=COM6 PortName=COM7
3. 가상 COM 포트 사용
이제 가상 COM 포트가 설정되었으므로, C# 프로그램을 통해 데이터를 분배할 수 있습니다.

C# 프로그램 구현
이 프로그램은 실제 바코드 스캐너로부터 입력을 받아 가상 COM 포트로 분배합니다.

프로그램 코드
csharp
코드 복사
using System;
using System.IO.Ports;

namespace COMPortProxy
{
    class Program
    {
        static SerialPort _inputPort;
        static SerialPort _outputPort;

        static void Main(string[] args)
        {
            // 입력 포트 설정 (실제 바코드 스캐너가 연결된 포트)
            _inputPort = new SerialPort("COM3", 9600);
            _inputPort.DataReceived += new SerialDataReceivedEventHandler(DataReceivedHandler);
            _inputPort.Open();

            // 출력 포트 설정 (가상 COM 포트)
            _outputPort = new SerialPort("COM4", 9600);
            _outputPort.Open();

            Console.WriteLine("Press any key to exit...");
            Console.ReadKey();

            _inputPort.Close();
            _outputPort.Close();
        }

        private static void DataReceivedHandler(object sender, SerialDataReceivedEventArgs e)
        {
            SerialPort sp = (SerialPort)sender;
            string inputData = sp.ReadExisting();
            Console.WriteLine("Received: " + inputData);

            // 입력받은 데이터를 출력 포트로 전송
            if (_outputPort.IsOpen)
            {
                _outputPort.Write(inputData);
            }
        }
    }
}
설명
COM 포트 설정: SerialPort 클래스를 사용하여 실제 바코드 스캐너가 연결된 포트(COM3)와 가상 COM 포트(COM4)를 설정합니다.
데이터 수신 처리기: _inputPort.DataReceived 이벤트 핸들러를 사용하여 데이터를 수신하고, 수신된 데이터를 가상 COM 포트로 전달합니다.
포트 열기/닫기: 프로그램 시작 시 실제 COM 포트와 가상 COM 포트를 열고, 종료 시 닫습니다.
가상 COM 포트 페어 원리
com0com은 두 개의 가상 COM 포트를 생성하여, 한 포트에서 입력된 데이터를 다른 포트로 전달합니다. 예를 들어, COM4에 데이터를 쓰면 COM5에서 읽을 수 있습니다. 이를 통해 실제 바코드 스캐너로부터 입력받은 데이터를 가상 COM 포트를 통해 다른 애플리케이션으로 전달할 수 있습니다.

이와 같은 설정을 통해, 특정 애플리케이션이 실제 COM 포트에서 데이터를 수신하는 것처럼 동작하게 할 수 있습니다.

이제, 윈도우 10에서 com0com을 설치하고 설정하는 방법과 이를 이용하여 C# 프로그램을 통해 데이터를 분배하는 과정을 마쳤습니다. 이를 통해 바코드 스캐너 입력을 특정 프로그램에만 전달할 수 있습니다