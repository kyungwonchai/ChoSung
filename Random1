using System;
using System.Data.SqlClient;

class Program
{
    static void Main()
    {
        DateTime? g_lastgiletime = null; // Nullable DateTime
        string g_ipadd = "your_ip_here"; // 여기에 IP 주소를 입력하세요

        using (SqlConnection conn = new SqlConnection("Data Source=your_server;Initial Catalog=your_database;User ID=your_username;Password=your_password"))
        {
            conn.Open();

            string query = "SELECT TOP 1 logtime1 FROM PAI_ChangeDetect WHERE ipadd = @ip AND complet10 IS NULL ORDER BY logtime1 DESC";
            using (SqlCommand cmd = new SqlCommand(query, conn))
            {
                cmd.Parameters.AddWithValue("@ip", g_ipadd);

                SqlDataReader reader = cmd.ExecuteReader();
                if (reader.Read())
                {
                    g_lastgiletime = Convert.ToDateTime(reader["logtime1"]);
                }
                reader.Close();
            }

            conn.Close();
        }

        // g_lastgiletime 변수를 사용할 수 있습니다.
        if (g_lastgiletime.HasValue)
        {
            Console.WriteLine("가장 최근의 logtime1: " + g_lastgiletime.Value);
        }
        else
        {
            Console.WriteLine("조건에 맞는 logtime1 값이 없습니다.");
        }
    }
}
