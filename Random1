<script>
    // 페이지 로드가 완료되면 실행
    window.onload = function() {
        // 부품 코드와 테이블의 업체PN 간에 공통 문자를 찾고 빨간색으로 표시하는 함수
        function highlightPartCode(partCode) {
            var cells = document.querySelectorAll('td:nth-child(1)');  // 첫 번째 열 (업체PN) 선택
            for (var i = 0; i < cells.length; i++) {
                var cellText = cells[i].textContent;
                var newText = '';
                for (var j = 0; j < cellText.length; j++) {
                    if (partCode.includes(cellText[j])) {
                        newText += '<span style="color:red;">' + cellText[j] + '</span>';
                    } else {
                        newText += cellText[j];
                    }
                }
                cells[i].innerHTML = newText;
            }
        }

        // 유사도가 90% 이상인 행의 배경색 설정하는 함수
        function setSimilarityBackground() {
            var rows = document.querySelectorAll('tr');
            for (var i = 1; i < rows.length; i++) {
                var similarity = parseFloat(rows[i].querySelector('td:last-child').textContent);
                if (similarity >= 0.9) {
                    rows[i].classList.add("high-similarity");
                } else {
                    rows[i].classList.remove("high-similarity");
                }
            }
        }

        // 입력 이벤트를 감지하여 결과 업데이트
        document.getElementById('part_code').addEventListener('input', function() {
            var partCode = this.value;  // 입력된 부품 코드 가져오기
            highlightPartCode(partCode);
            setSimilarityBackground();
        });

        // 페이지 로드시 초기 설정
        var initialPartCode = document.getElementById('part_code').value;
        highlightPartCode(initialPartCode);
        setSimilarityBackground();
    }
</script>
