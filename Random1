using System;
using System.Data;
using System.Data.SqlClient;
using System.Windows.Forms;

public partial class MainForm : Form
{
    public MainForm()
    {
        InitializeComponent();
    }

    private void btnLoadData_Click(object sender, EventArgs e)
    {
        // 데이터베이스 연결 문자열
        string connectionString = "YourConnectionString";

        // 실행할 저장 프로시저의 이름
        string storedProcedureName = "YourStoredProcedureName";

        // 세 개의 DataTable을 담을 DataSet 생성
        DataSet dataSet = new DataSet();

        try
        {
            using (SqlConnection connection = new SqlConnection(connectionString))
            {
                connection.Open();

                // 실행할 저장 프로시저의 이름과 연결을 설정하여 SqlDataAdapter 생성
                using (SqlDataAdapter adapter = new SqlDataAdapter(storedProcedureName, connection))
                {
                    // 저장 프로시저에 전달할 매개 변수 설정
                    adapter.SelectCommand.CommandType = CommandType.StoredProcedure;
                    adapter.SelectCommand.Parameters.AddWithValue("@Param1", "Value1");
                    adapter.SelectCommand.Parameters.AddWithValue("@Param2", "Value2");

                    // DataSet에 세 개의 DataTable을 채웁니다.
                    adapter.Fill(dataSet);

                    // 각각의 DataTable은 dataSet.Tables[0], dataSet.Tables[1], dataSet.Tables[2]에 위치합니다.
                    DataTable dataTable1 = dataSet.Tables[0];
                    DataTable dataTable2 = dataSet.Tables[1];
                    DataTable dataTable3 = dataSet.Tables[2];
                }
            }
        }
        catch (Exception ex)
        {
            // 예외 처리
            MessageBox.Show("오류 발생: " + ex.Message);
        }

        // 이후 dataTable1, dataTable2, dataTable3을 사용하여 필요한 작업을 수행합니다.
    }
}
