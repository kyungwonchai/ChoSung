using System;
using System.Drawing;
using System.Threading;
using System.Windows.Forms;

namespace BlinkingTaskbarIcon
{
    public partial class Form1 : Form
    {
        private NotifyIcon notifyIcon;
        private bool isBlinking;
        private Thread blinkThread;

        public Form1()
        {
            InitializeComponent();

            // Form Load 이벤트 핸들러 등록
            this.Load += Form1_Load;
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            // NotifyIcon 초기화
            notifyIcon = new NotifyIcon();
            notifyIcon.Icon = SystemIcons.Application; // 원하는 아이콘으로 변경
            notifyIcon.Visible = true;

            // 작업 표시줄 아이콘 클릭 이벤트 핸들러 등록
            notifyIcon.Click += notifyIcon_Click;

            // 작업 표시줄 아이콘 깜박이기 시작
            StartBlinking();
        }

        private void notifyIcon_Click(object sender, EventArgs e)
        {
            // 작업 표시줄 아이콘 클릭 시 작업 수행
            // 예: 앱 창 표시 또는 숨기기 등
        }

        private void StartBlinking()
        {
            isBlinking = true;
            blinkThread = new Thread(BlinkThread);
            blinkThread.Start();
        }

        private void StopBlinking()
        {
            isBlinking = false;
            blinkThread.Join();
        }

        private void BlinkThread()
        {
            while (isBlinking)
            {
                // 파란색 아이콘으로 변경
                notifyIcon.Icon = new Icon("blue_icon.ico");
                Thread.Sleep(500); // 500밀리초 대기
                // 하늘색 아이콘으로 변경
                notifyIcon.Icon = new Icon("sky_icon.ico");
                Thread.Sleep(500); // 500밀리초 대기
            }
        }

        protected override void Dispose(bool disposing)
        {
            // 폼이 닫힐 때 깜박이기를 중지하고 리소스를 정리합니다.
            StopBlinking();
            notifyIcon.Dispose();
            base.Dispose(disposing);
        }
    }
}
