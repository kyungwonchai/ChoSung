using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;

public class ControlFinder : Form
{
    // Win32 API 함수 사용
    [DllImport("user32.dll", SetLastError = true)]
    public static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

    [DllImport("user32.dll", SetLastError = true)]
    public static extern IntPtr FindWindowEx(IntPtr hwndParent, IntPtr hwndChildAfter, string lpszClass, string lpszWindow);

    [DllImport("user32.dll")]
    public static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);

    [StructLayout(LayoutKind.Sequential)]
    public struct RECT
    {
        public int Left;
        public int Top;
        public int Right;
        public int Bottom;
    }

    public ControlFinder()
    {
        // 버튼 추가
        Button findControlButton = new Button();
        findControlButton.Text = "Find Control";
        findControlButton.Click += FindControlButton_Click;
        Controls.Add(findControlButton);
    }

    private void FindControlButton_Click(object sender, EventArgs e)
    {
        IntPtr windowHandle = FindWindow(null, "MFC Application Title"); // MFC 앱의 제목을 입력하세요.
        IntPtr controlHandle = FindWindowEx(windowHandle, IntPtr.Zero, null, "Control Text"); // 컨트롤 텍스트 또는 클래스를 입력하세요.

        if (controlHandle != IntPtr.Zero)
        {
            RECT rect;
            if (GetWindowRect(controlHandle, out rect))
            {
                MessageBox.Show($"Control Location: {rect.Left}, {rect.Top}");
            }
        }
    }

    public static void Main()
    {
        Application.Run(new ControlFinder());
    }
}
