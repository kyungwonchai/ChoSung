Sub CopyAndPasteData()
    Dim wsTemp1 As Worksheet
    Dim wsTemp2 As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim j As Integer
    
    ' 임시1시트와 임시2시트 지정
    Set wsTemp1 = ThisWorkbook.Sheets("임시1시트")
    On Error Resume Next
    Set wsTemp2 = ThisWorkbook.Sheets("임시2시트")
    On Error GoTo 0
    
    ' 임시2시트가 이미 존재하면 삭제
    If Not wsTemp2 Is Nothing Then
        Application.DisplayAlerts = False
        wsTemp2.Delete
        Application.DisplayAlerts = True
    End If
    
    ' 임시1시트의 2, 3행 복사하여 임시2시트에 붙여넣기
    wsTemp1.Rows("2:3").Copy
    Set wsTemp2 = ThisWorkbook.Sheets.Add
    wsTemp2.Name = "임시2시트"
    wsTemp2.Cells(1, 1).PasteSpecial Paste:=xlPasteAll
    
    ' B열이 있는 행까지 순환
    lastRow = wsTemp1.Cells(wsTemp1.Rows.Count, "B").End(xlUp).Row
    For i = 4 To lastRow ' 4행부터 시작 (2, 3행은 이미 복제)
        ' 현재 컬럼이 "S"로 시작하고 다음 컬럼의 값이 0보다 큰지 확인
        For j = 3 To 19 Step 3 ' 3열부터 U열까지 3칸씩 이동
            If Left(wsTemp1.Cells(i, j).Value, 1) = "S" And wsTemp1.Cells(i, j + 1).Value > 0 Then
                ' 조건을 만족하는 경우 해당 셀 2개를 임시2시트로 복사
                wsTemp1.Range(wsTemp1.Cells(i, j), wsTemp1.Cells(i, j + 1)).Copy Destination:=wsTemp2.Cells(wsTemp2.Cells(wsTemp2.Rows.Count, "A").End(xlUp).Row + 1, 1)
            End If
        Next j
    Next i
End Sub
