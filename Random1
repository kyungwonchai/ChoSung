적으로 생성된 TabControl에 TabItem과 UserControl을 추가하고, 각 UserControl의 함수를 실행하는 방법을 안내하겠습니다. 이 경우, TabControl 자체도 코드에서 동적으로 생성되어야 합니다.
1. 동적 TabControl 생성 및 추가

먼저, 메인 윈도우에 TabControl을 동적으로 추가합니다.

MainWindow.xaml에는 TabControl을 추가할 부모 컨트롤(예: Grid)만 정의합니다.

xml

<Window x:Class="YourNamespace.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="450" Width="800">
    <Grid x:Name="MainGrid">
        <!-- TabControl이 여기에 동적으로 추가됩니다 -->
    </Grid>
</Window>

2. MainWindow.xaml.cs에서 동적 TabControl 및 TabItem 구성

MainWindow.xaml.cs에서 동적으로 TabControl과 TabItem을 생성하고, 각 TabItem에 UserControl을 추가합니다.

csharp

using System.Windows;
using System.Windows.Controls;

namespace YourNamespace
{
    public partial class MainWindow : Window
    {
        private TabControl MyTabControl;

        public MainWindow()
        {
            InitializeComponent();
            CreateDynamicTabControl();
        }

        private void CreateDynamicTabControl()
        {
            MyTabControl = new TabControl();
            MainGrid.Children.Add(MyTabControl); // MainGrid에 TabControl 추가

            for (int i = 0; i < 3; i++) // 예를 들어 3개의 탭 생성
            {
                TabItem tabItem = new TabItem
                {
                    Header = $"Tab {i + 1}"
                };

                MyUserControl myUserControl = new MyUserControl(); // 사용자 정의 컨트롤
                tabItem.Content = myUserControl;

                MyTabControl.Items.Add(tabItem);
            }
        }

        public void ExecuteAllUserControlFunctions()
        {
            foreach (TabItem tab in MyTabControl.Items)
            {
                if (tab.Content is MyUserControl userControl)
                {
                    userControl.PublicMethod(); // PublicMethod는 MyUserControl에 정의된 메서드
                }
            }
        }
    }
}

이 코드는 MainWindow이 로드될 때 TabControl을 동적으로 생성하고, 이 TabControl에 여러 TabItem을 추가합니다. 각 TabItem에는 사용자 정의 UserControl이 할당됩니다.

ExecuteAllUserControlFunctions 메서드는 TabControl의 모든 탭을 순회하면서 각 탭에 있는 UserControl의 PublicMethod 함수를 실행합니다.

이 방식을 통해 동적으로 생성된 TabControl 및 각 탭에 있는 UserControl의 함수를 실행할 수 있습니다. MyUserControl과 PublicMethod는 사용자의 프로젝트에 맞게 적절히 정의되어야 합니다.