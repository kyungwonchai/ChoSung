WITH RankedTable AS (
    SELECT *, 
           LEAD(gg) OVER (PARTITION BY bb, nn ORDER BY time_column ASC) AS NextGG,
           LAG(gg) OVER (PARTITION BY bb, nn ORDER BY time_column ASC) AS PrevGG
    FROM TableA
)
SELECT bb, nn, PrevGG AS PreviousGG, gg AS CurrentGG, NextGG
FROM RankedTable
WHERE gg != NextGG OR gg != PrevGG;
