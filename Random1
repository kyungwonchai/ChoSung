치 여부 확인
두 번째 행에서 ABC 값의 위치 찾기
0, 2번째 행을 ','로 나눈 후 랜덤한 값 가져오기
csharp
Copy code
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.SqlClient;
using System.Linq;

class Program
{
    static void Main()
    {
        string connectionString = "Server=YOUR_SERVER;Database=YOUR_DB;User Id=YOUR_USER;Password=YOUR_PASSWORD;";
        string storedProcedureName = "YOUR_PROCEDURE"; // 프로시저명
        string abcValue = "ABC_SAMPLE"; // 예제 ABC 값

        // 데이터 가져오기
        DataTable dt = GetDataFromProcedure(connectionString, storedProcedureName, abcValue);

        // 검증 및 처리
        if (dt.Rows.Count != 3)
        {
            Console.WriteLine("3개의 행이 아닙니다. 종료.");
            return;
        }

        // 첫 번째 열 값 확인
        string firstColumnValue = dt.Rows[0]["SZMODELNAME"].ToString();
        if (!dt.AsEnumerable().All(row => row["SZMODELNAME"].ToString() == firstColumnValue))
        {
            Console.WriteLine("첫 번째 열 값이 일치하지 않습니다. 종료.");
            return;
        }

        // 두 번째 행 SZBARCODE 값에서 ABC의 위치 찾기
        string[] barcodeValues = dt.Rows[1]["SZBARCODE"].ToString().Split(',');
        int index = Array.IndexOf(barcodeValues, abcValue);
        if (index == -1)
        {
            Console.WriteLine("ABC 값이 SZBARCODE에 존재하지 않습니다. 종료.");
            return;
        }

        // 0, 2번째 행에서 랜덤한 값 선택
        Random rand = new Random();
        string randomValueFromRow0 = GetRandomValue(dt.Rows[0]["SZBARCODE"].ToString(), index, rand);
        string randomValueFromRow2 = GetRandomValue(dt.Rows[2]["SZBARCODE"].ToString(), index, rand);

        // 결과 출력
        Console.WriteLine($"Row 0 Random Value: {randomValueFromRow0}");
        Console.WriteLine($"Row 2 Random Value: {randomValueFromRow2}");
    }

    static DataTable GetDataFromProcedure(string connectionString, string storedProcedureName, string abcValue)
    {
        DataTable dt = new DataTable();
        using (SqlConnection conn = new SqlConnection(connectionString))
        {
            using (SqlCommand cmd = new SqlCommand(storedProcedureName, conn))
            {
                cmd.CommandType = CommandType.StoredProcedure;
                cmd.Parameters.Add(new SqlParameter("@ABC", abcValue)); // ABC 변수 전달

                SqlDataAdapter da = new SqlDataAdapter(cmd);
                da.Fill(dt);
            }
        }
        return dt;
    }

    static string GetRandomValue(string barcodeString, int excludeIndex, Random rand)
    {
        string[] values = barcodeString.Split(',');
        List<string> filteredValues = values.Where((v, i) => i != excludeIndex).ToList();
        return filteredValues.Count > 0 ? filteredValues[rand.Next(filteredValues.Count)] : "N/A";
    }
}
설명
MSSQL 프로시저 호출
GetDataFromProcedure 함수에서 ABC 값을 매개변수로 MSSQL 프로시저를 호출하여 데이터를 가져옴.
3개 행 검증
dt.Rows.Count를 확인하여 3개가 아니면 종료.
첫 번째 열 값 검증
SZMODELNAME이 모든 행에서 동일한지 확인.
ABC 위치 확인
SZBARCODE 값을 ,로 나누고 ABC의 위치를 찾음.
랜덤 값 선택