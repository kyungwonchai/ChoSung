Sub CreateResourceWithLineBreaks()
    Dim wsSource As Worksheet
    Dim wsResult As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim tagName As String
    Dim tagValue As String
    Dim resultRow As Long
    
    ' 태그정리 시트 확인
    On Error Resume Next
    Set wsSource = ThisWorkbook.Worksheets("태그정리")
    On Error GoTo 0
    If wsSource Is Nothing Then
        MsgBox "태그정리 시트를 찾을 수 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 태그HTML 시트 삭제
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsResult = ThisWorkbook.Worksheets("태그HTML")
    If Not wsResult Is Nothing Then wsResult.Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' 태그HTML 시트 생성
    Set wsResult = ThisWorkbook.Sheets.Add
    wsResult.Name = "태그HTML"
    
    ' 태그정리 시트의 마지막 행 가져오기
    lastRow = wsSource.Cells(wsSource.Rows.Count, 2).End(xlUp).Row
    If lastRow < 2 Then
        MsgBox "태그정리 시트에 데이터가 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 리소스 파일 형식으로 작성
    resultRow = 1
    For i = 2 To lastRow
        tagName = wsSource.Cells(i, 2).Value ' 2열: 태그값
        tagValue = wsSource.Cells(i, 1).Value ' 1열: 밸류값
        
        ' 비어있는 값은 건너뜀
        If tagName <> "" And tagValue <> "" Then
            wsResult.Cells(resultRow, 1).Value = "<Data name=""" & tagName & """ xml:space=""preserve"">"
            wsResult.Cells(resultRow + 1, 1).Value = "  <value>" & Replace(tagValue, vbLf, "&#xA;") & "</value>"
            wsResult.Cells(resultRow + 2, 1).Value = "</Data>"
            resultRow = resultRow + 3
        End If
    Next i
    
    ' 결과 시트 컬럼 폭 자동 조정
    wsResult.Cells.EntireColumn.AutoFit
    
    MsgBox "리소스 파일 생성이 완료되었습니다.", vbInformation