WITH RankedData AS (
    SELECT
        ip,
        node,
        pcname,
        ROW_NUMBER() OVER (PARTITION BY ip, node, pcname ORDER BY (SELECT NULL)) AS rn,
        COUNT(*) OVER (PARTITION BY ip, node, pcname) AS cnt
    FROM your_table
)
SELECT
    ip,
    node,
    pcname,
    CASE 
        WHEN cnt > 1 THEN 2
        ELSE 1
    END AS cc
FROM RankedData
WHERE rn = 1;
