프카로 특정 구조의 데이터를 전송할 때 각 키(aa, bb, cc)에 대해 값이 생길 때마다 해당 정보를 포함하고 나머지 키들은 빈 값으로 유지하는 함수를 Python으로 작성하는 것에 대해 도움을 드리겠습니다. 이 경우 Python의 kafka-python 패키지를 사용하여 Kafka로 메시지를 전송하는 예시 코드를 제공할게요. 만약 이 패키지가 설치되어 있지 않다면, pip install kafka-python을 통해 설치할 수 있습니다.

아래의 함수는 send_to_kafka라는 이름으로, 키와 값을 인자로 받아 해당 키에 대한 값이 존재할 때 그 값을 포함하고, 나머지 키들은 빈 값으로 하는 메시지를 생성하여 카프카 토픽에 전송합니다.

python
Copy code
from kafka import KafkaProducer
import json

# KafkaProducer 인스턴스 생성
producer = KafkaProducer(bootstrap_servers=['your_kafka_broker:9092'],
                         value_serializer=lambda v: json.dumps(v).encode('utf-8'))

def send_to_kafka(key, value):
    # 메시지 구조 초기화
    message = {"aa": {}, "bb": {}, "cc": {}}
    
    # 특정 키에 대한 값 설정
    if key in message:
        message[key] = value
    
    # Kafka 토픽에 메시지 전송
    producer.send('your_topic_name', value=message)
    producer.flush()

# 함수 사용 예시
send_to_kafka("aa", {"some": "data"})  # aa에 데이터를 포함하고, bb와 cc는 빈 값으로 유지
이 코드에서 your_kafka_broker:9092는 카프카 브로커의 주소이며, your_topic_name은 메시지를 전송할 카프카 토픽의 이름입니다. 이 부분은 실제 환경에 맞게 수정해야 합니다.

각 키(aa, bb, cc)가 생성될 때 해당 함수를 호출하면, 해당 키에 대한 값이 카프카 토픽으로 전송되고 나머지 키들은 빈 값으로 유지되는 구조의 메시지를 생성할 수 있습니다