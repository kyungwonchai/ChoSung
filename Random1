된 btnStart_Click 함수
csharp
코드 복사
private async void btnStart_Click(object sender, RoutedEventArgs e)
{
    string folderPath = txtFolderPath.Text;
    string fileExtension = cmbFileExtension.Text;
    string driveName = txtFolderPath.Text.Split('\\').FirstOrDefault() + "\\";

    if (string.IsNullOrEmpty(folderPath) || folderPath == "폴더 경로 입력" ||
        string.IsNullOrEmpty(fileExtension))
    {
        System.Windows.Forms.MessageBox.Show("모든 입력값을 제공해주세요.");
        return;
    }

    try
    {
        Dispatcher.Invoke(() => { txtTrainingStatus.Text = "학습 중..."; });

        _trainingData = await Task.Run(() => CollectInitialFileData(folderPath, fileExtension));
        if (_trainingData.Count < MinimumSampleSize)
        {
            System.Windows.Forms.MessageBox.Show($"학습 모델을 훈련시키기에 샘플이 충분하지 않습니다. 최소 샘플 수: {MinimumSampleSize}");
            Dispatcher.Invoke(() => { txtTrainingStatus.Text = "학습 실패: 샘플 부족"; });
            return;
        }

        Dispatcher.Invoke(() =>
        {
            dataGridTrainingData.ItemsSource = _trainingData;
            _mlModelBuilder.TrainModel(_trainingData);
            txtTrainingStatus.Text = "학습 완료";
            txtCurrentPatterns.Text = _mlModelBuilder.GetCurrentPatterns();
        });

        await Task.Run(() => MonitorAndDisplayFilesToDelete(folderPath, fileExtension, driveName));
    }
    catch (Exception ex)
    {
        LogError("모델 훈련 실패: " + ex.Message);
        Dispatcher.Invoke(() => { txtTrainingStatus.Text = "학습 실패: " + ex.Message; });
    }
}
수정된 MonitorAndDisplayFilesToDelete 함수
csharp
코드 복사
private async Task MonitorAndDisplayFilesToDelete(string folderPath, string fileExtension, string driveName)
{
    while (true)
    {
        try
        {
            long freeSpace = await Task.Run(() => _fileCleaner.GetDriveFreeSpace(driveName));
            List<FileInfo> filesToDelete = await Task.Run(() => _fileCleaner.GetFilesToDelete(folderPath, fileExtension));

            Dispatcher.Invoke(() => DisplayFilesToDelete(filesToDelete));

            //await _fileCleaner.DeleteFilesAsync(filesToDelete); // 실제 삭제 코드 (주석 처리)

            await Task.Run(() => _fileCleaner.UpdateFolderStatistics(folderPath, fileExtension));
            await Task.Delay(TimeSpan.FromMinutes(10)); // 10분마다 체크
        }
        catch (Exception ex)
        {
            LogError("모니터링 중 오류 발생: " + ex.Message);
        }
    }
}
이제 백그라운드 작업을 수행하면서도 UI가 반응할 수 있도록 수정했습니다. 필요한 함수만 제공하였으며, btnStart_Click과 MonitorAndDisplayFilesToDelete 함수를 수정하여 비동기로 작업을 수행하도록 했습니다.