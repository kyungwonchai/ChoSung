from sklearn.ensemble import VotingClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.svm import SVC
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import linear_kernel
import pickle

# 데이터 로드
data = ...  # 데이터를 로드해야 함 (예: 데이터베이스 또는 파일에서 가져오기)

# TF-IDF 벡터화
vectorizer = TfidfVectorizer()
tfidf_matrix = vectorizer.fit_transform(data['텍스트 데이터'])

# Random Forest 모델 생성 및 학습
rf = RandomForestClassifier(n_estimators=100)
rf.fit(tfidf_matrix, data['레이블'])

# SVM 모델 생성 및 학습
svm = SVC(kernel='linear', probability=True)
svm.fit(tfidf_matrix, data['레이블'])

# 앙상블 모델 생성 및 학습
ensemble_model = VotingClassifier(estimators=[('rf', rf), ('svm', svm)], voting='soft')
ensemble_model.fit(tfidf_matrix, data['레이블'])

# 모델 저장
pickle.dump(vectorizer, open("tfidf.pkl", "wb"))
pickle.dump(tfidf_matrix, open("tfidf_matrix.pkl", "wb"))
pickle.dump(ensemble_model, open("ensemble_model.pkl", "wb"))
