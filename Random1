SSQL에서 문자열에서 마지막에 나오는 _ 문자와 그 이후의 문자를 제거하는 쿼리는 다음과 같습니다. 이 쿼리는 SUBSTRING과 CHARINDEX 함수를 사용하여 마지막 _의 위치를 찾아 문자열을 잘라냅니다.

sql
코드 복사
SELECT 
    SUBSTRING(N_Tkey, 1, LEN(N_Tkey) - CHARINDEX('_', REVERSE(N_Tkey))) AS Result
FROM 
    YourTableName;
위의 쿼리에서 YourTableName을 실제 테이블 이름으로 대체하십시오.

이 쿼리의 동작 원리를 설명하겠습니다:

REVERSE(N_Tkey) : 문자열을 뒤집습니다. 예를 들어, abc_def가 fed_cba로 변환됩니다.
CHARINDEX('_', REVERSE(N_Tkey)) : 뒤집힌 문자열에서 첫 번째 _의 위치를 찾습니다. 원래 문자열의 마지막 _의 위치와 같습니다.
LEN(N_Tkey) - CHARINDEX('_', REVERSE(N_Tkey)) : 원래 문자열에서 마지막 _ 문자의 위치를 계산합니다.
SUBSTRING(N_Tkey, 1, LEN(N_Tkey) - CHARINDEX('_', REVERSE(N_Tkey))) : 문자열의 첫 번째 문자부터 마지막 _ 이전 문자까지를 추출합니다.
이제 쿼리를 실행하여 원하는 결과를 확인할 수 있습니