import pymysql
import pymysql.cursors

# 데이터베이스 연결 설정
connection = pymysql.connect(host='your_host',
                             user='your_username',
                             password='your_password',
                             database='your_database',
                             cursorclass=pymysql.cursors.DictCursor)

try:
    with connection.cursor() as cursor:
        # uniqname 컬럼 값 조회
        sql = "SELECT id, uniqname FROM your_table;"
        cursor.execute(sql)
        rows = cursor.fetchall()

        # 각 row에 대해 처리
        for row in rows:
            original_uniqname = row['uniqname']
            id = row['id']

            # 마지막 '_' 뒤의 숫자를 3으로 변경
            parts = original_uniqname.rsplit('_', 1)
            if len(parts) == 2 and parts[1].isdigit():
                updated_uniqname = parts[0] + '_3'

                # 데이터베이스 업데이트
                update_sql = "UPDATE your_table SET uniqname = %s WHERE id = %s;"
                cursor.execute(update_sql, (updated_uniqname, id))

    # 변경 사항 커밋
    connection.commit()

finally:
    connection.close()
