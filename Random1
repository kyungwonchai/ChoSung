MSSQL ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ í†µì‹  ë¬¸ì œ:

Streamlitì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ cursor.fetchall()ë¡œ ê°’ì´ ì œëŒ€ë¡œ ì•ˆ ë“¤ì–´ì˜¤ê³  ìˆìŒ.

í”„ë¡œì‹œì €ê°€ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ”ë°ë„ Streamlitì—ì„œ ì œëŒ€ë¡œ í‘œì‹œë˜ì§€ ì•ŠìŒ.

ì»¬ëŸ¼ í—¤ë”ê°’ìœ¼ë¡œ ì±„ì›Œì§„ ì´ìœ :

fetch_main_data() í•¨ìˆ˜ì—ì„œ cursor.descriptionìœ¼ë¡œ ì»¬ëŸ¼ëª…ì„ ê°€ì ¸ì˜¤ëŠ”ë°, ë°ì´í„° ìì²´ê°€ ë¹„ì–´ìˆìœ¼ë©´ rows ë¦¬ìŠ¤íŠ¸ëŠ” ë¹ˆ ê°’ì´ ë˜ê±°ë‚˜ í—¤ë”ê°’ìœ¼ë¡œë§Œ ì±„ì›Œì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¬¸ì œ ì§„ë‹¨:

í”„ë¡œì‹œì €ë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ì—¬ SQL Server Management Studioì—ì„œ ê°’ì´ ì˜ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

Streamlit ì½”ë“œì—ì„œ ë°ì´í„°ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

âœ… ì ê²€ ë°©ë²•
SQL Server Management Studioì—ì„œ ì‹¤í–‰í•˜ê¸°

sql
ì½”ë“œ ë³µì‚¬
EXEC Get_min_bestdifferent;
ê²°ê³¼ ê°’ì´ ì˜ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

Python ì½”ë“œë¡œ ê°’ í™•ì¸í•˜ê¸° (í™•ì¸ìš© ì½”ë“œ ì¶”ê°€)

python
ì½”ë“œ ë³µì‚¬
import pymssql

def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")

    # ì»¬ëŸ¼ ì´ë¦„ í™•ì¸
    columns = [desc[0] for desc in cursor.description]
    print("ì»¬ëŸ¼ ì´ë¦„:", columns)

    # ë°ì´í„° í™•ì¸
    rows = cursor.fetchall()
    print("ê°€ì ¸ì˜¨ ë°ì´í„°:")
    for row in rows:
        print(row)

    conn.close()

fetch_main_data()
âœ… ì´ ì½”ë“œë¡œ í™•ì¸í•  ë‚´ìš©
ì½˜ì†” ì¶œë ¥ í™•ì¸:

ì»¬ëŸ¼ ì´ë¦„ì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸.

ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ ê° í–‰ì´ ì¶œë ¥ë˜ëŠ”ì§€ í™•ì¸.

ì˜ˆìƒ ì¶œë ¥ ì˜ˆì‹œ:

less
ì½”ë“œ ë³µì‚¬
ì»¬ëŸ¼ ì´ë¦„: ['group1', 'line1', 'model1', 'type1', 'ecn1', 'edition1', 'act2_1', 'act2_2', 'act2_3', 'act2_4', 'act2_5', 'act2_6', 'act2_7', 'act2_8']
ê°€ì ¸ì˜¨ ë°ì´í„°:
('A', 'L1', 'M1', 'T1', 'E1', 'ED1', 100, 200, 150, 180, 90, 170, 210, 160)
('A', 'L2', 'M2', 'T2', 'E2', 'ED2', 80, 120, 110, 130, 60, 140, 150, 70)
âœ… ë¬¸ì œ ì›ì¸
Streamlit ë¬¸ì œ:

Streamlitì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ pandasë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  cursor.fetchall()ë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

pandasë¥¼ ì‚¬ìš©í•  ë•Œì™€ ë°ì´í„° ì²˜ë¦¬ ë°©ì‹ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤.

fetchall() ë°ì´í„° ì²˜ë¦¬ ë¬¸ì œ:

fetchall()ë¡œ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ Streamlitì´ ì œëŒ€ë¡œ í‘œì‹œí•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.

ë°ì´í„°ë¥¼ DataFrameìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, HTML í…Œì´ë¸”ë¡œ ì§ì ‘ ë§Œë“¤ì–´ í‘œì‹œí•´ì•¼ í•©ë‹ˆë‹¤.

âœ… ìˆ˜ì •ëœ Streamlit ì½”ë“œ (ì˜¤ë¥˜ í•´ê²°)
python
ì½”ë“œ ë³µì‚¬
import streamlit as st
import pymssql

# MSSQL ì„œë²„ ì—°ê²° ì„¤ì • í•¨ìˆ˜
def get_connection():
    return pymssql.connect(
        server="YOUR_SERVER",
        user="YOUR_USER",
        password="YOUR_PASSWORD",
        database="YOUR_DATABASE"
    )

# Get_min_bestdifferent í”„ë¡œì‹œì € í˜¸ì¶œ í•¨ìˆ˜ (cursor.fetchall() ë°©ì‹)
def fetch_main_data():
    conn = get_connection()
    cursor = conn.cursor()
    cursor.execute("EXEC Get_min_bestdifferent")
    
    # ì»¬ëŸ¼ ì´ë¦„ í™•ì¸
    columns = [desc[0] for desc in cursor.description]
    
    # ë°ì´í„° í™•ì¸
    rows = cursor.fetchall()
    
    conn.close()
    return rows, columns

# í…Œì´ë¸”ì—ì„œ ìµœëŒ€ê°’ì„ ë…¸ë€ìƒ‰ìœ¼ë¡œ ê°•ì¡°í•˜ëŠ” HTML ìŠ¤íƒ€ì¼ í•¨ìˆ˜
def generate_html_table(data, columns):
    html = "<table border='1' style='width:100%; border-collapse: collapse;'>"
    html += "<thead><tr>"
    for col in columns:
        html += f"<th>{col}</th>"
    html += "</tr></thead><tbody>"

    act2_columns = [f'act2_{i}' for i in range(1, 9)]

    for row in data:
        html += "<tr>"
        act2_values = {col: row[idx] for idx, col in enumerate(columns) if col in act2_columns}
        
        if act2_values:
            max_value = max(act2_values.values())
        else:
            max_value = None
        
        for idx, value in enumerate(row):
            column_name = columns[idx]
            if column_name in act2_columns and value == max_value:
                html += f"<td style='background-color: yellow;'>{value}</td>"
            else:
                html += f"<td>{value}</td>"
        html += "</tr>"
    html += "</tbody></table>"
    return html

# Streamlit ì•± êµ¬ì„±
def main():
    st.set_page_config(layout="wide")
    st.title("Ranked Data Table - act2_1 ~ act2_8 Highlighting (Cursor ë°©ì‹)")

    # ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    data, columns = fetch_main_data()
    
    if not data:
        st.error("í”„ë¡œì‹œì €ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ë˜ëŠ” í”„ë¡œì‹œì € ì„¤ì •ì„ í™•ì¸í•˜ì„¸ìš”.")
    else:
        st.subheader("act2_1 ~ act2_8 ë°ì´í„° í…Œì´ë¸”")
        html_table = generate_html_table(data, columns)
        st.markdown(html_table, unsafe_allow_html=True)

if __name__ == "__main__":
    main()
âœ… ì„¤ëª…
SQL ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œ (fetchall()) ë°©ì‹ ìœ ì§€

ì»¬ëŸ¼ ì´ë¦„ì„ cursor.descriptionìœ¼ë¡œ í™•ì¸

Streamlitì—ì„œ HTMLë¡œ ì¶œë ¥í•˜ì—¬ ë°ì´í„°ë¥¼ ì •í™•íˆ í‘œì‹œ

ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•˜ì—¬ ë””ë²„ê¹… ìš©ì´í•˜ê²Œ í•¨

ğŸ“Œ Streamlit ì‹¤í–‰ ë°©ë²•
bash
ì½”ë“œ ë³µì‚¬