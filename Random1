이해합니다. VBA7 기준으로 최신 환경에 최적화된 코드를 제공하겠습니다. 클립보드 복사와 메모리 처리를 안정적으로 구현하여, 따옴표 없이 시트 전체 데이터를 클립보드에 복사하는 솔루션입니다.

최신 VBA7 호환 코드: 시트 전체 클립보드 복사
vba
코드 복사
#If VBA7 Then
    Private Declare PtrSafe Function OpenClipboard Lib "user32" (ByVal hwnd As LongPtr) As Long
    Private Declare PtrSafe Function EmptyClipboard Lib "user32" () As Long
    Private Declare PtrSafe Function CloseClipboard Lib "user32" () As Long
    Private Declare PtrSafe Function SetClipboardData Lib "user32" (ByVal wFormat As Long, ByVal hMem As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalAlloc Lib "kernel32" (ByVal wFlags As Long, ByVal dwBytes As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
    Private Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As Long
#End If

Const CF_TEXT As Long = 1
Const GMEM_MOVEABLE As Long = &H2

Sub CopySheetToClipboardWithoutQuotes()
    Dim ws As Worksheet
    Dim rng As Range
    Dim row As Range
    Dim cell As Range
    Dim clipboardText As String
    
    ' 현재 시트와 범위 설정
    Set ws = ThisWorkbook.Sheets(1) ' 필요한 경우 시트 번호를 조정하세요
    Set rng = ws.UsedRange          ' 데이터가 있는 범위 전체 선택
    
    ' 범위의 내용을 문자열로 변환
    clipboardText = ""
    For Each row In rng.Rows
        For Each cell In row.Cells
            clipboardText = clipboardText & cell.Value & vbTab ' 각 셀 값을 탭으로 구분
        Next cell
        clipboardText = Left(clipboardText, Len(clipboardText) - 1) & vbCrLf ' 줄바꿈 추가
    Next row
    
    ' 클립보드에 복사
    CopyTextToClipboard clipboardText
    
    MsgBox "시트 내용이 클립보드에 복사되었습니다! 따옴표 없이 확인해보세요.", vbInformation
End Sub

Private Sub CopyTextToClipboard(ByVal Text As String)
    Dim hGlobal As LongPtr
    Dim lpGlobal As LongPtr
    
    ' 클립보드 열기
    If OpenClipboard(0&) Then
        EmptyClipboard ' 기존 클립보드 데이터 비우기
        
        ' 메모리 할당
        hGlobal = GlobalAlloc(GMEM_MOVEABLE, LenB(Text) + 1)
        lpGlobal = GlobalLock(hGlobal)
        
        If lpGlobal Then
            ' 문자열 데이터를 메모리에 복사
            Dim i As Long
            For i = 1 To Len(Text)
                Dim charByte As Byte
                charByte = Asc(Mid(Text, i, 1)) ' 문자 하나씩 추출
                CopyMemory ByVal lpGlobal + (i - 1), charByte, 1
            Next i
            
            ' NULL 종료 문자 추가
            CopyMemory ByVal lpGlobal + Len(Text), vbNullChar, 1
            
            ' 메모리 잠금 해제
            GlobalUnlock hGlobal
            
            ' 클립보드에 데이터 설정
            SetClipboardData CF_TEXT, hGlobal
        End If
        
        ' 클립보드 닫기
        CloseClipboard
    Else
        MsgBox "클립보드를 열 수 없습니다. 다른 프로그램에서 클립보드를 점유 중일 수 있습니다.", vbCritical
    End If
End Sub
코드 작동 방식