using System;
using System.IO;
using System.Diagnostics;
using System.Windows.Forms;

namespace WinFormsApp
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void MainForm_Load(object sender, EventArgs e)
        {
            string folderPath = @"C:\abc"; // 인터넷 바로 가기 파일이 있는 폴더 경로
            string[] shortcutFiles = Directory.GetFiles(folderPath, "*.url"); // .url 확장자를 가진 파일들을 가져옴

            foreach (string shortcutFile in shortcutFiles)
            {
                string fileName = Path.GetFileNameWithoutExtension(shortcutFile); // 파일 이름 추출
                listControl.Items.Add(fileName); // ListControl에 항목 추가
            }
        }

        private void listControl_DoubleClick(object sender, EventArgs e)
        {
            if (listControl.SelectedItem != null)
            {
                string selectedItem = listControl.SelectedItem.ToString();
                string shortcutFilePath = Path.Combine(@"C:\abc", selectedItem + ".url"); // 선택한 항목에 해당하는 .url 파일 경로

                if (File.Exists(shortcutFilePath))
                {
                    using (StreamReader reader = new StreamReader(shortcutFilePath))
                    {
                        string contents = reader.ReadToEnd();
                        int urlStartIndex = contents.IndexOf("URL=") + 4; // URL= 다음 문자열부터 URL이 시작됨
                        string url = contents.Substring(urlStartIndex); // URL 추출

                        // Microsoft Edge로 열기
                        Process.Start(new ProcessStartInfo
                        {
                            FileName = "msedge.exe",
                            Arguments = url
                        });
                    }
                }
            }
        }
    }
}
