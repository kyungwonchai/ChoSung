using DevExpress.XtraEditors;
using System;
using System.Drawing;
using System.IO;
using System.Windows.Forms;
using IWshRuntimeLibrary;

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        string folderPath = @"C:\YourFolder";  // 바로가기 파일이 있는 폴더
        string[] shortcutFiles = Directory.GetFiles(folderPath, "*.lnk");

        foreach (var shortcut in shortcutFiles)
        {
            string shortcutTarget = GetShortcutTarget(shortcut);
            if (string.IsNullOrEmpty(shortcutTarget)) continue;

            Icon icon = Icon.ExtractAssociatedIcon(shortcutTarget);

            TileItem item = new TileItem();
            item.BackgroundImage = icon.ToBitmap();
            item.BackgroundImageAlignment = TileItemContentAlignment.MiddleCenter;
            item.Text = Path.GetFileNameWithoutExtension(shortcut);
            item.Tag = shortcutTarget;  // 타일에 타겟 경로 저장

            tileControl1.Groups[0].Items.Add(item);  // 첫 번째 그룹에 타일 추가
        }

        tileControl1.ItemClick += TileControl1_ItemClick;  // 클릭 이벤트 핸들러 추가
    }

    private static string GetShortcutTarget(string shortcutFilename)
    {
        WshShell shell = new WshShell();
        IWshShortcut shortcut = (IWshShortcut)shell.CreateShortcut(shortcutFilename);
        return shortcut.TargetPath;
    }

    private void TileControl1_ItemClick(object sender, TileItemEventArgs e)
    {
        string path = (string)e.Item.Tag;
        System.Diagnostics.Process.Start("explorer.exe", path);
    }
}
