-- Step 1: tablea에서 필요한 데이터 조회
SELECT sensor, valavg, unit, lcl, ucl
FROM tablea
WHERE sensor IN ('temp', 'humid', 'dust');

-- Step 2: module1에 대한 데이터를 피벗하여 추가 정보를 조회
-- 이 부분은 예시로, 구체적인 tablea 구조나 module1 데이터에 대한 정보가 필요합니다.
;WITH ModuleData AS (
    SELECT module, sensor, value
    FROM AnotherTable -- module1 관련 데이터가 저장된 가정된 테이블
)
, PivotedModuleData AS (
    SELECT sensor,
           [Module1_1] AS Module1_1, [Module1_2] AS Module1_2, -- 각 module1의 값을 열 이름으로 사용
           -- 여기에 필요한 모든 module1 값을 추가합니다.
    FROM ModuleData
    PIVOT (
        MAX(value) FOR module IN ([Module1_1], [Module1_2] /*, 기타 모듈 이름 추가 */) -- 모듈 이름은 실제 값에 따라 변경
    ) AS PivotTable
)
SELECT * FROM PivotedModuleData;
