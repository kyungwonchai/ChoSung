evExpress의 GridControl과 SpreadsheetControl을 함께 사용하여 GridControl의 데이터를 엑셀로 내보내는 동시에 SpreadsheetControl의 내용을 엑셀 파일의 위쪽 행에 추가하려면 다음과 같은 방법을 사용할 수 있습니다.

예제 코드
XAML (MainWindow.xaml)
xaml
Copy code
<Window x:Class="WpfApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxsps="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet"
        xmlns:local="clr-namespace:WpfApp"
        Title="MainWindow" Height="450" Width="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- SpreadsheetControl -->
        <dxsps:SpreadsheetControl x:Name="spreadsheetControl" Grid.Row="0" Height="100" Margin="0,10"/>

        <!-- GridControl -->
        <dxg:GridControl x:Name="gridControl" Grid.Row="1">
            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="ID" Header="ID"/>
                <dxg:GridColumn FieldName="Name" Header="Name"/>
                <dxg:GridColumn FieldName="Country" Header="Country"/>
            </dxg:GridControl.Columns>
        </dxg:GridControl>

        <!-- Export Button -->
        <Button Grid.Row="2" Content="Export to Excel" Click="ExportToExcel_Click"/>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)
csharp
Copy code
using DevExpress.Spreadsheet;
using DevExpress.Xpf.Grid;
using System;
using System.Collections.Generic;
using System.Data;
using System.Windows;

namespace WpfApp
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            // Sample data for GridControl
            gridControl.ItemsSource = new List<Record>
            {
                new Record { ID = 1, Name = "John Doe", Country = "USA" },
                new Record { ID = 2, Name = "Jane Smith", Country = "UK" },
                new Record { ID = 3, Name = "Pierre Dupont", Country = "France" }
            };

            // Pre-fill SpreadsheetControl with some data
            Worksheet sheet = spreadsheetControl.Document.Worksheets[0];
            sheet.Cells["A1"].Value = "Custom Title";
            sheet.Cells["A2"].Value = "Report Date: " + DateTime.Now.ToShortDateString();
            sheet.Cells["A3"].Value = "Generated by: User";
        }

        private void ExportToExcel_Click(object sender, RoutedEventArgs e)
        {
            // Create a new spreadsheet document
            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets[0];

            // Copy the content from SpreadsheetControl to the new workbook
            Worksheet sourceWorksheet = spreadsheetControl.Document.Worksheets[0];
            Range sourceRange = sourceWorksheet.GetUsedRange();
            Range destinationRange = worksheet.Range.FromLTRB(0, 0, sourceRange.ColumnCount - 1, sourceRange.RowCount - 1);
            destinationRange.CopyFrom(sourceRange);

            // Export GridControl data to DataTable
            DataTable gridData = ((TableView)gridControl.View).CreateExportTable();

            // Export GridControl data to Excel starting after the existing content
            worksheet.Import(gridData, false, sourceRange.RowCount, 0);

            // Adjust column width to fit content
            worksheet.Columns.AutoFit(0, gridData.Columns.Count - 1);

            // Save the spreadsheet to a file
            string filePath = "ExportedGridDataWithHeader.xlsx";
            workbook.SaveDocument(filePath, DocumentFormat.OpenXml);

            MessageBox.Show($"Exported to {filePath}", "Export Success", MessageBoxButton.OK, MessageBoxImage.Information);
        }

        // Sample record class for demonstration
        public class Record
        {
            public int ID { get; set; }
            public string Name { get; set; }
            public string Country { get; set; }
        }
    }
}
설명
SpreadsheetControl에서 데이터 가져오기:
spreadsheetControl.Document.Worksheets[0]에서 필요한 데이터를 가져옵니다.
GetUsedRange를 사용하여 데이터 범위를 파악하고 CopyFrom을 통해 데이터를 새 엑셀 파일로 복사합니다.
GridControl에서 데이터 가져오기:
((TableView)gridControl.View).CreateExportTable()을 사용하여 GridControl의 데이터를 DataTable로 내보냅니다.
데이터 통합 및 엑셀 내보내기:
Worksheet.Import를 사용하여 GridControl 데이터를 엑셀 파일의 다음 행에 추가합니다.
AutoFit으로 열 너비를 조정합니다.
이 예제는 DevExpress 22.2 버전의 SpreadsheetControl 및 GridControl을 사용하여 엑셀 파일을 내보내는 과정을 보여줍니다.






