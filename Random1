삭제 후에 메인화면으로 나가도록 수정하겠습니다.

수정된 코드
kotlin
코드 복사
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.ui.window.Dialog
import androidx.compose.ui.window.DialogProperties

@Composable
fun ImageDisplayScreen(
    bitmap: Bitmap?,
    imageTitle: String,
    datetime: String,
    onBack: () -> Unit,
    onFit: () -> Unit,
    isRefreshing: Boolean,
    onToggleRefresh: (Boolean) -> Unit
) {
    // ... 기존 코드 ...

    val openDialog = remember { mutableStateOf(false) }

    if (openDialog.value) {
        Dialog(
            onDismissRequest = { openDialog.value = false },
            properties = DialogProperties(dismissOnBackPress = true, dismissOnClickOutside = true)
        ) {
            Surface(
                shape = MaterialTheme.shapes.medium,
                color = MaterialTheme.colors.background
            ) {
                Column(
                    modifier = Modifier.padding(16.dp)
                ) {
                    Text("삭제하시겠습니까?")
                    Spacer(modifier = Modifier.height(8.dp))
                    Row(
                        horizontalArrangement = Arrangement.End,
                        modifier = Modifier.fillMaxWidth()
                    ) {
                        TextButton(onClick = { openDialog.value = false }) {
                            Text("취소")
                        }
                        TextButton(onClick = {
                            scope.launch {
                                deleteImageFromDatabase(imageTitle, datetime)
                                onBack() // 메인화면으로 이동
                            }
                            openDialog.value = false
                        }) {
                            Text("예")
                        }
                    }
                }
            }
        }
    }

    Column(
        modifier = Modifier.align(Alignment.BottomCenter).fillMaxWidth()
            .background(MaterialTheme.colors.surface).padding(horizontal = 20.dp, vertical = 0.dp)
    ) {
        Row(
            modifier = Modifier.fillMaxWidth().padding(8.dp),
            horizontalArrangement = Arrangement.SpaceEvenly
        ) {
            Button(onClick = onBack) {
                Text("Back")
            }
            Button(onClick = {
                scale = 1f
                offset = Offset.Zero
                onFit()
            }) {
                Text("Fit")
            }
            ColorPicker(
                selectedColor = color,
                onColorSelected = { selectedColor -> color = selectedColor }
            )
            Button(onClick = {
                window?.let { captureAndUploadBitmap(it, view, scope) }
            }) {
                Text("Upload")
            }
            Button(onClick = {
                openDialog.value = true
            }) {
                Text("Delete")
            }
            Button(onClick = {
                bitmapLauncher.launch("image/*")
            }) {
                Text("Upload Image")
            }
            Row(
                verticalAlignment = Alignment.CenterVertically
            ) {
                Checkbox(
                    checked = isRefreshing,
                    onCheckedChange = onToggleRefresh
                )
                Text("Auto Refresh")
            }
        }
    }
}

suspend fun deleteImageFromDatabase(imageTitle: String, datetime: String) {
    withContext(Dispatchers.IO) {
        val connection: Connection = DriverManager.getConnection(
            "jdbc:jtds:sqlserver://10.222.222.222:1633;databaseName=ddbb123",
            "yourUsername",
            "yourPassword"
        )
        val preparedStatement: PreparedStatement = connection.prepareStatement(
            "DELETE FROM YourImageTable WHERE imageTitle = ? AND datetime1 = ?"
        )
        preparedStatement.setString(1, imageTitle)
        preparedStatement.setString(2, datetime)
        preparedStatement.executeUpdate()
        preparedStatement.close()
        connection.close()
    }
}
주요 변경 사항:
onBack() 호출: deleteImageFromDatabase 함수 호출 후, onBack()을 호출하여 메인화면으로 이동하도록 설정했습니다.
Dialog 확인 버튼 로직 수정: 삭제 작업이 완료된 후 openDialog.value = false로 설정하여 대화상자를 닫고, onBack() 호출을 통해 메인화면으로 이동합니다.
이제 삭제 확인 대화상자에서 "예"를 클릭하면 데이터베이스에서 해당 이미지가 삭제되고, 메인화면으로 이동합