torch.cuda.is_available()가 False를 반환하는 이유는 여러 가지가 있을 수 있습니다. GPU가 분명히 있는데도 PyTorch가 CPU를 사용하게 되는 원인을 확인하려면 다음을 점검해 보세요.

1. PyTorch가 CUDA 지원 버전인지 확인
PyTorch가 CUDA를 지원하는 버전이 설치되지 않았을 수 있습니다. 먼저 현재 설치된 PyTorch가 CUDA를 사용할 수 있는지 확인하세요.

python
코드 복사
import torch
print(torch.__version__)  # PyTorch 버전 확인
print(torch.version.cuda)  # CUDA 버전 확인
print(torch.backends.cudnn.enabled)  # cuDNN 활성화 여부
출력 결과가 None이면 CUDA가 없는 버전의 PyTorch가 설치된 것입니다. 이 경우, CUDA 지원 버전을 설치해야 합니다.

2. GPU가 정상적으로 인식되는지 확인
CUDA가 정상적으로 설치되었는지 확인하기 위해, nvidia-smi 명령어를 실행하세요.

bash
코드 복사
nvidia-smi
만약 GPU가 표시되지 않는다면 드라이버 문제일 가능성이 높습니다.
CUDA Version이 나와야 정상입니다.
3. CUDA 드라이버 및 라이브러리 확인
PyTorch가 CUDA를 인식하려면 적절한 NVIDIA 드라이버와 CUDA 라이브러리가 필요합니다.

NVIDIA 드라이버 버전 확인:
bash
코드 복사
nvidia-smi
CUDA가 제대로 설치되었는지 확인:
bash
코드 복사
nvcc --version
출력이 없다면 CUDA를 설치해야 합니다. PyTorch 공식 가이드를 참고하여 설치하세요. PyTorch Installation Guide

4. 환경 변수 설정 문제
PyTorch가 올바른 CUDA 경로를 찾지 못할 수도 있습니다. 환경 변수를 확인하세요.

bash
코드 복사
echo $PATH
echo $LD_LIBRARY_PATH
/usr/local/cuda/bin과 /usr/local/cuda/lib64가 포함되어 있어야 합니다. 없으면 ~/.bashrc에 추가하고 적용하세요.

bash
코드 복사
export PATH=/usr/local/cuda/bin:$PATH
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
source ~/.bashrc
5. PyTorch가 GPU를 강제로 사용하도록 설정
PyTorch가 GPU를 감지하지 못하는 경우, 직접 GPU로 할당할 수도 있습니다.

python
코드 복사
import torch

device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
print(f"Using device: {device}")

# GPU 강제 설정
if torch.cuda.is_available():
    torch.cuda.set_device(0)  # GPU 0번 사용
    print(f"Current CUDA device: {torch.cuda.current_device()}")
    print(f"CUDA device name: {torch.cuda.get_device_name(0)}")
이렇게 했을 때도 cuda가 나오지 않으면, PyTorch에서 GPU를 인식하지 못하는 문제일 가능성이 높습니다.

6. 권한 문제 (Ubuntu)
Linux에서는 GPU 관련 권한 문제로 PyTorch가 CUDA를 감지하지 못할 수 있습니다. 아래 명령어를 실행하여 확인하세요.

bash
코드 복사
ls -l /dev/nvidia*
출력이 없다면 NVIDIA 드라이버가 제대로 로드되지 않았을 가능성이 큽니다.

bash
코드 복사
sudo modprobe nvidia
위 명령어를 실행한 후 다시 torch.cuda.is_available()를 확인해 보세요.

7. WSL2 사용 시 (Windows Subsystem for Linux)
WSL2에서 CUDA를 사용하려면 Windows에 CUDA Toolkit과 NVIDIA WSL 드라이버가 설치되어 있어야 합니다. WSL2에서 GPU가 감지되는지 확인하려면:

bash
코드 복사
nvidia-smi
그리고, nvcc --version으로 CUDA 버전을 확인하세요.

결론
위 단계를 차례대로 확인하면 GPU가 감지되지 않는 원인을 찾을 수 있습니다.
특히 PyTorch가 CUDA 버전인지 확인하고, nvidia-smi로 GPU 상태를 체크하는 것이 가장 중요합니다.