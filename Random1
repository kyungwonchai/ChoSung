. 이 코드는 A 열의 날짜, C 열의 Shift, J 열의 시작 시간, K 열의 끝 시간을 사용하여 L 열과 M 열에 날짜를 포함한 시작 시간과 끝 시간을 입력합니다. Shift 3의 경우 끝 시간이 7시 이전이라면 날짜를 하루 빼줍니다.

vba
코드 복사
Sub UpdateShiftTimes()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim startDate As Date
    Dim endDate As Date
    Dim startTime As Date
    Dim endTime As Date
    Dim shift As Integer
    Dim i As Long
    
    ' 시트 설정
    Set ws = ThisWorkbook.Sheets("Sheet1") ' 필요한 시트 이름으로 변경
    
    ' 마지막 행 찾기
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' 각 행에 대해 반복
    For i = 2 To lastRow
        If IsDate(ws.Cells(i, 1).Value) And IsNumeric(ws.Cells(i, 3).Value) Then
            startDate = ws.Cells(i, 1).Value
            shift = ws.Cells(i, 3).Value
            startTime = ws.Cells(i, 10).Value
            endTime = ws.Cells(i, 11).Value
            
            ' 시작 시간과 날짜 계산
            ws.Cells(i, 12).Value = startDate + startTime
            
            ' 끝 시간과 날짜 계산
            If shift = 3 And endTime < TimeValue("07:00:00") Then
                ws.Cells(i, 13).Value = (startDate + 1) + endTime - 1 ' 날짜 하루 빼기
            Else
                ws.Cells(i, 13).Value = startDate + endTime
            End If
        End If
    Next i
End Sub
이 코드는 다음과 같이 동작합니다:

Sheet1로 설정된 워크시트를 사용합니다. 필요한 경우 시트 이름을 변경하세요.
마지막 행을 찾습니다.
각 행에 대해 날짜(A 열)와 Shift(C 열)가 있는지 확인합니다.
Shift 값에 따라 시작 시간(J 열)과 끝 시간(K 열)을 날짜와 함께 계산하여 L 열과 M 열에 입력합니다.
Shift 3의 경우 끝 시간이 7시 이전이면 날짜를 하루 빼줍니다.
이렇게 하면 Shift