using System;
using System.IO;
using System.Text;
using DevExpress.XtraBars.Ribbon;
using OfficeOpenXml;
using System.Linq;

public void ExportRibbonToExcel(RibbonControl ribbonControl, string filePath)
{
    // Excel 패키지를 사용하여 새로운 파일을 작성합니다.
    using (ExcelPackage excelPackage = new ExcelPackage())
    {
        // 시트 1: 페이지, 그룹, 버튼 정보
        var sheet1 = excelPackage.Workbook.Worksheets.Add("Sheet1");
        sheet1.Cells[1, 1].Value = "Page Text";
        sheet1.Cells[1, 2].Value = "Group Text";
        sheet1.Cells[1, 3].Value = "Button Caption";
        sheet1.Cells[1, 4].Value = "Button Name";
        sheet1.Cells[1, 5].Value = "Page Tag";

        int row1 = 2;
        foreach (RibbonPage page in ribbonControl.Pages)
        {
            string pageText = page.Text;
            string pageTag = page.Tag != null ? page.Tag.ToString() : "";

            foreach (RibbonPageGroup group in page.Groups)
            {
                string groupText = group.Text;

                foreach (var item in group.ItemLinks)
                {
                    if (item is BarButtonItemLink buttonItemLink)
                    {
                        BarButtonItem button = buttonItemLink.Item as BarButtonItem;
                        if (button != null)
                        {
                            string buttonCaption = button.Caption;
                            string buttonName = button.Name;

                            sheet1.Cells[row1, 1].Value = pageText;
                            sheet1.Cells[row1, 2].Value = groupText;
                            sheet1.Cells[row1, 3].Value = buttonCaption;
                            sheet1.Cells[row1, 4].Value = buttonName;
                            sheet1.Cells[row1, 5].Value = pageTag;
                            row1++;
                        }
                    }
                }
            }
        }

        // 시트 2: 그룹별 Tag 정보
        var sheet2 = excelPackage.Workbook.Worksheets.Add("Sheet2");
        sheet2.Cells[1, 1].Value = "Group Text";
        sheet2.Cells[1, 2].Value = "Group Tag";

        int row2 = 2;
        foreach (RibbonPage page in ribbonControl.Pages)
        {
            foreach (RibbonPageGroup group in page.Groups)
            {
                string groupText = group.Text;
                string groupTag = group.Tag != null ? group.Tag.ToString() : "";

                sheet2.Cells[row2, 1].Value = groupText;
                sheet2.Cells[row2, 2].Value = groupTag;
                row2++;
            }
        }

        // 시트 3: 페이지별 Tag 정보
        var sheet3 = excelPackage.Workbook.Worksheets.Add("Sheet3");
        sheet3.Cells[1, 1].Value = "Page Text";
        sheet3.Cells[1, 2].Value = "Page Tag";

        int row3 = 2;
        foreach (RibbonPage page in ribbonControl.Pages)
        {
            string pageText = page.Text;
            string pageTag = page.Tag != null ? page.Tag.ToString() : "";

            sheet3.Cells[row3, 1].Value = pageText;
            sheet3.Cells[row3, 2].Value = pageTag;
            row3++;
        }

        // 파일 저장
        FileInfo excelFile = new FileInfo(filePath);
        try
        {
            excelPackage.SaveAs(excelFile);
        }
        catch (Exception ex)
        {
            Console.WriteLine("Excel 파일 저장 중 오류가 발생했습니다: " + ex.Message);
        }
    }