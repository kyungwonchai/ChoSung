네, 맞습니다! IP 주소만 쳤을 때 바로 특정 리액트 앱이 뜨게 하려면, 서버의 80번 포트가 그 앱으로 연결되어야 합니다. 웹 브라우저는 주소창에 http://를 치면 자동으로 80번 포트로 접속하기 때문이죠.

하지만 Nginx를 이미 사용하고 계시기 때문에, docker run에서 -p 80:80으로 직접 연결하는 것은 올바른 방법이 아니며 오류가 발생합니다.

Nginx도 80번 포트를 사용해야 하고, 도커 컨테이너도 80번 포트를 사용하려고 서로 싸우기 때문입니다.

가장 정확하고 올바른 방법을 상세히 알려드리겠습니다.

정석: Nginx가 80번 포트를 관리하게 하라
개념을 쉽게 비유해 드릴게요:

서버의 80번 포트: 건물의 정문입니다. 모든 방문객(웹 트래픽)은 이리로 들어옵니다.

Nginx: 이 정문을 지키는 안내 데스크입니다.

리액트 앱 도커 컨테이너: 각각의 사무실입니다. (9999호, 9998호 같은 자체 내부 번호가 있습니다)

우리가 할 일은 안내 데스크(Nginx)에게 "정문(80번 포트)으로 그냥 들어오는 손님은 무조건 9999호 사무실(리액트 앱)로 보내주세요"라고 설정하는 것입니다.

Step 1: 도커 컨테이너 실행 (포트 확인)
메인 화면으로 쓸 리액트 앱은 서버의 80번 포트가 아닌 다른 포트 (예: 9999)에 연결해야 합니다. Nginx에게 자리를 양보하는 거죠.

Bash

#           [호스트 포트]:[컨테이너 포트]
#            "서버의 9999번 문"과 "컨테이너의 80번 문"을 연결
docker run -d -p 9999:80 --name main-react-app [메인앱-이미지-이름]
80:80이 아닌 9999:80을 사용하는 것이 핵심입니다.

컨테이너 안에서 리액트 앱은 80번 포트를 사용하지만, 컨테이너 **밖(서버)**에서는 9999번 포트로만 접근할 수 있는 상태입니다.

Step 2: Nginx 설정 수정 (가장 중요)
이제 안내 데스크(Nginx)에 규칙을 알려줍니다.

이전에 만들었던 Nginx 설정 파일을 엽니다.

Bash

sudo nano /etc/nginx/sites-available/react-proxy
아래와 같이 location / 부분을 설정합니다. 이것이 IP 주소로만 접속했을 때의 규칙입니다.

Nginx

server {
    # 1. Nginx가 건물의 정문(80번 포트)을 사용하겠다고 선언
    listen 80;
    server_name your-domain.com; # 또는 서버 IP 주소

    # 2. 정문으로 들어온 모든 요청('/')은
    location / {
        # 3. 9999호 사무실(localhost:9999)로 안내(proxy_pass)합니다.
        proxy_pass http://localhost:9999;

        # --- 아래는 통신을 위한 필수 설정들 ---
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # (만약 다른 앱도 있다면) /app2 같은 특정 경로의 손님은 9998호로 안내
    location /app2/ {
        proxy_pass http://localhost:9998/;
        # ... 나머지 설정 동일 ...
    }
}
Step 3: Nginx 재시작
설정을 저장한 뒤, Nginx를 재시작해서 규칙을 적용합니다.

Bash

# 설정 문법 오류 없는지 체크
sudo nginx -t

# 재시작
sudo systemctl restart nginx
결론
docker run -p 80:80 (X): Nginx를 쓸 때는 절대 이렇게 직접 연결하면 안 됩니다. Nginx와 포트 충돌이 일어납니다.

docker run -p 9999:80 (O): 도커는 서버의 다른 포트(9999)를 사용하게 하고,

Nginx 설정 (O): Nginx가 서버의 80번 포트를 대표로 받아서 localhost:9999로 요청을 전달해주는 방식이 정석입니다.