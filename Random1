using System;

namespace StringManipulationExample
{
    class Program
    {
        static void Main(string[] args)
        {
            string C = "This is a sample text with BSM-123_456_11 and more text.";
            string prefix = "BSM-";
            int startIndex = C.IndexOf(prefix);

            if (startIndex != -1)
            {
                int endIndex = C.IndexOf(' ', startIndex);
                endIndex = (endIndex == -1) ? C.Length : endIndex;

                // 원래 문자열에서 BSM-부터 끝까지의 부분을 추출
                string targetString = C.Substring(startIndex, endIndex - startIndex);

                // _로 나눈다.
                string[] parts = targetString.Split('_');

                // 길이가 3 이상이면 [2]의 값을 +1 해서 넣는다.
                if (parts.Length >= 3)
                {
                    int number = int.Parse(parts[2]) + 1;
                    parts[2] = number.ToString("D3");  // 숫자를 3자리로 맞춤
                }
                // 길이가 2 이하면 _001을 추가한다.
                else
                {
                    targetString += "_001";
                }

                // 수정된 부분을 합친다.
                string newString = string.Join('_', parts);

                // 원래 문자열에서 수정된 부분으로 교체한다.
                C = C.Replace(targetString, newString);
            }

            // 수정된 문자열을 출력한다.
            Console.WriteLine("Modified string: " + C);
        }
    }
}
