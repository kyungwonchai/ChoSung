SELECT 
    col1,
    date1,
    CASE 
        WHEN col1 = 'pp1' THEN ROW_NUMBER() OVER (PARTITION BY col1 ORDER BY date1)
        ELSE (SELECT MAX(no1) FROM your_table WHERE col1 = 'pp1')
    END AS no1
FROM 
    your_table
ORDER BY
    col1,
    date1;
