법은 다음과 같습니다.

방법 1: 저장 여부 확인 후 닫기
이 코드에서는 사용자가 변경 사항을 저장할지 묻는 메시지를 표시합니다.

vba
코드 복사
Sub CloseAllWorkbooks()
    Dim wb As Workbook
    
    ' 모든 열린 워크북을 반복
    For Each wb In Application.Workbooks
        wb.Close SaveChanges:=vbPrompt ' 저장 여부를 묻는 메시지 표시
    Next wb
    
    ' Excel 종료
    Application.Quit
End Sub
방법 2: 변경 사항 저장 후 닫기
이 코드는 모든 파일을 자동으로 저장한 후 닫습니다.

vba
코드 복사
Sub CloseAllWorkbooks_Save()
    Dim wb As Workbook
    
    For Each wb In Application.Workbooks
        wb.Close SaveChanges:=True ' 변경 사항 저장 후 닫기
    Next wb
    
    Application.Quit
End Sub
방법 3: 저장하지 않고 강제 닫기
이 코드는 변경 사항이 있어도 저장하지 않고 강제로 닫습니다.

vba
코드 복사
Sub CloseAllWorkbooks_Force()
    Dim wb As Workbook
    
    For Each wb In Application.Workbooks
        wb.Close SaveChanges:=False ' 저장하지 않고 닫기
    Next wb
    
    Application.Quit
End Sub
이 코드 중에서 원하는 방식으로 실행하면 됩니다.

사용자가 직접 저장 여부를 선택하려면 CloseAllWorkbooks()
자동 저장 후 닫으려면 CloseAllWorkbooks_Save()