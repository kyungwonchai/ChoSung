ML 코드로 변환한 결과를 새로운 태그HTML 시트에 작성하는 VBA 매크로입니다. 기존 태그HTML 시트가 있으면 삭제하고 새로 생성합니다.

VBA 코드
vba
코드 복사
Sub GenerateHTMLFromTagSheet()
    Dim wsSource As Worksheet
    Dim wsResult As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim cellValue As String
    Dim resultRow As Long
    
    ' 태그정리 시트를 확인
    On Error Resume Next
    Set wsSource = ThisWorkbook.Worksheets("태그정리")
    On Error GoTo 0
    If wsSource Is Nothing Then
        MsgBox "태그정리 시트를 찾을 수 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' 태그HTML 시트 삭제
    On Error Resume Next
    Application.DisplayAlerts = False
    Set wsResult = ThisWorkbook.Worksheets("태그HTML")
    If Not wsResult Is Nothing Then wsResult.Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    ' 태그HTML 시트 생성
    Set wsResult = ThisWorkbook.Sheets.Add
    wsResult.Name = "태그HTML"
    
    ' 태그정리 시트의 마지막 행 가져오기
    lastRow = wsSource.Cells(wsSource.Rows.Count, 1).End(xlUp).Row
    If lastRow < 2 Then
        MsgBox "태그정리 시트에 데이터가 없습니다.", vbExclamation
        Exit Sub
    End If
    
    ' HTML 코드 변환 및 태그HTML 시트에 작성
    resultRow = 1
    wsResult.Cells(resultRow, 1).Value = "<HTML>"
    resultRow = resultRow + 1
    wsResult.Cells(resultRow, 1).Value = "<BODY>"
    resultRow = resultRow + 1
    
    For i = 2 To lastRow
        cellValue = wsSource.Cells(i, 1).Value ' 태그정리 시트 1열 데이터 읽기
        
        ' 데이터가 비어있지 않은 경우만 처리
        If cellValue <> "" Then
            wsResult.Cells(resultRow, 1).Value = "&lt;p&gt;" & cellValue & "&lt;/p&gt;"
            resultRow = resultRow + 1
        End If
    Next i
    
    ' HTML 닫는 태그 추가
    wsResult.Cells(resultRow, 1).Value = "</BODY>"
    resultRow = resultRow + 1
    wsResult.Cells(resultRow, 1).Value = "</HTML>"
    
    ' 결과 시트 컬럼 폭 자동 조정
    wsResult.Cells.EntireColumn.AutoFit
    
    MsgBox "HTML 코드 생성이 완료되었습니다.", vbInformation
End Sub
코드 설명
태그정리 시트 확인:

태그정리라는 이름의 시트를 사용합니다.
시트가 없으면 오류 메시지를 표시하고 매크로를 종료합니다.
데이터 읽기:

1열 2행부터 마지막 데이터 행까지를 읽습니다.
HTML 코드 변환:

각 셀 값을 <p> 태그로 감싸고, HTML에서 표시할 수 있도록 &lt;와 &gt;로 변환합니다.
태그HTML 시트 생성:

기존 태그HTML 시트가 있다면 삭제하고 새로 생성합니다.
HTML 코드 작성 후 <HTML> 및 <BODY> 태그로 감쌉니다.
결과 저장:

변환된 HTML 코드는 태그HTML 시트에 작성됩니다.
사용 방법
VBA 편집기에서 코드를 추가합니다.
Alt + F8을 눌러 매크로 목록에서 GenerateHTMLFromTagSheet를 실행합니다.
실행 결과
태그정리 시트의 데이터가 다음과 같을 경우:

1열
태그값1
태그값2
태그값3
태그HTML 시트에는 다음과 같은 HTML 코드가 생성됩니다:

1열
<HTML>
<BODY>
&lt;p&gt;태그값1&lt;/p&gt;
&lt;p&gt;태그값2&lt;/p&gt;
&lt;p&gt;태그값3&lt;/p&gt;
</BODY>
</HTML>
HTML 구조:
html
코드 복사
<HTML>
<BODY>
<p>태그값1</p>
<p>태그값2</p>
<p>태그값3</p>