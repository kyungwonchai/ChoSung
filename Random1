using System;
using System.Data;
using System.Data.OleDb;

class Program
{
    static void Main()
    {
        string connectionString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=path_to_excel_file;Extended Properties='Excel 12.0;HDR=YES;'";

        using (OleDbConnection connection = new OleDbConnection(connectionString))
        {
            connection.Open();

            using (OleDbDataAdapter adapter = new OleDbDataAdapter("SELECT * FROM [마스터$]", connection))
            {
                DataTable table = new DataTable();
                adapter.Fill(table);

                // 필터링할 컬럼 이름
                string columnName = "C";

                // 필터링 조건 설정
                string filterExpression = $"LEN(TRIM([{columnName}])) >= 3";

                // 필터링 적용
                table.DefaultView.RowFilter = filterExpression;
                DataTable filteredTable = table.DefaultView.ToTable();

                // 필터링된 테이블 사용 예시: 각 셀 값 출력
                foreach (DataRow row in filteredTable.Rows)
                {
                    foreach (var item in row.ItemArray)
                    {
                        Console.Write(item + "\t");
                    }
                    Console.WriteLine();
                }
            }
        }
    }
}
