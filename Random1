using OpenQA.Selenium;
using OpenQA.Selenium.Edge;
using System;
using System.Diagnostics;
using System.Windows.Forms;

namespace YourNamespace
{
    public partial class YourForm : Form
    {
        public YourForm()
        {
            InitializeComponent();
            GetEdgeInstances();
        }

        private void GetEdgeInstances()
        {
            // 열린 Edge 창의 프로세스를 찾습니다.
            foreach (Process process in Process.GetProcessesByName("msedge"))
            {
                // 창 제목을 ListBox에 추가합니다.
                listbox1.Items.Add(process.MainWindowTitle);
            }
        }

        private void listbox1_DoubleClick(object sender, EventArgs e)
        {
            // 선택한 브라우저 창의 제목을 가져옵니다.
            string selectedTitle = listbox1.SelectedItem.ToString();

            // Edge WebDriver 옵션을 설정합니다.
            EdgeOptions options = new EdgeOptions();
            options.UseChromium = true;

            // WebDriver를 시작합니다.
            EdgeDriver driver = new EdgeDriver(options);

            // 제목이 일치하는 창을 찾습니다.
            driver.SwitchTo().Window(driver.WindowHandles.First(w => driver.Title == selectedTitle));

            // ID를 사용해 체크박스를 찾고 클릭합니다.
            var checkbox = driver.FindElementById("myCheckbox");
            checkbox?.Click();
        }
    }
}
