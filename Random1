래는 Excel 2016에서 VBA 매크로를 작성하여 다운로드 폴더에서 "Mounter"로 시작하는 가장 최근에 수정된 .xlsx 파일을 찾아 열고, 첫 번째 시트를 선택한 후 지정된 작업을 수행하는 코드입니다.

VBA 코드
vba
코드 복사
Sub OpenLatestMounterFileAndProcess()
    Dim fso As Object
    Dim folderPath As String
    Dim file As Object
    Dim latestFile As String
    Dim latestDate As Date
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim cell As Range
    Dim usedRange As Range
    Dim lastRow As Long
    Dim lastCol As Long
    Dim r As Long, c As Long

    ' 다운로드 폴더 경로 설정 (내 컴퓨터의 다운로드 폴더)
    folderPath = Environ("USERPROFILE") & "\Downloads\"

    ' 파일 시스템 개체 생성
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' 폴더 내 파일 검색
    latestFile = ""
    latestDate = 0
    For Each file In fso.GetFolder(folderPath).Files
        If file.Name Like "Mounter*.xlsx" Then
            If file.DateLastModified > latestDate Then
                latestDate = file.DateLastModified
                latestFile = file.Path
            End If
        End If
    Next file

    ' 파일이 없으면 종료
    If latestFile = "" Then
        MsgBox "Mounter로 시작하는 파일이 없습니다.", vbExclamation, "파일 없음"
        Exit Sub
    End If

    ' 가장 최근 파일 열기
    Set wb = Workbooks.Open(latestFile)
    Set ws = wb.Sheets(1)

    ' 사용된 범위 가져오기
    Set usedRange = ws.UsedRange
    lastRow = usedRange.Rows.Count
    lastCol = usedRange.Columns.Count

    ' 2행부터 4행까지 병합 해제 및 빈 셀 채우기
    For r = 2 To 4
        For c = 1 To lastCol
            ws.Cells(r, c).MergeCells = False
        Next c
    Next r
    
    ' 빈 값 채우기 (위쪽 값이 없으면 좌측 값 사용)
    For r = 2 To 4
        For c = 1 To lastCol
            If ws.Cells(r, c).Value = "" Then
                If r > 1 And ws.Cells(r - 1, c).Value <> "" Then
                    ws.Cells(r, c).Value = ws.Cells(r - 1, c).Value
                ElseIf c > 1 And ws.Cells(r, c - 1).Value <> "" Then
                    ws.Cells(r, c).Value = ws.Cells(r, c - 1).Value
                End If
            End If
        Next c
    Next r

    ' 5행부터 마지막 행까지 병합 해제 및 빈 값 채우기
    For r = 5 To lastRow
        For c = 1 To lastCol
            ws.Cells(r, c).MergeCells = False
        Next c
    Next r

    ' 빈 값 위쪽 값으로 채우기
    For r = 5 To lastRow
        For c = 1 To lastCol
            If ws.Cells(r, c).Value = "" And r > 1 Then
                ws.Cells(r, c).Value = ws.Cells(r - 1, c).Value
            End If
        Next c
    Next r

    MsgBox "처리 완료!", vbInformation, "완료"
End Sub
설명
가장 최근 수정된 "Mounter.xlsx" 파일 찾기*

다운로드 폴더에서 Mounter로 시작하는 가장 최근 파일을 찾음.
파일 열기 및 첫 번째 시트 선택

찾은 파일을 엽니다.
첫 번째 시트를 선택합니다.
2~4행의 병합 해제 및 빈 셀 채우기

병합을 해제한 후, 빈 값이면 위쪽 값을 사용하고 위쪽 값이 없으면 왼쪽 값을 채움.
5행부터 마지막 행까지 병합 해제 및 빈 값 위쪽 값으로 채우기

병합을 해제한 후, 빈 값을 위쪽 값으로 채움.
완료 메시지 출력
