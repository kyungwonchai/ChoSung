아래는 MSSQL2014에서 View_LogSensorsALL 뷰를 사용하여 ReceivedMessage 컬럼에서 특정 값을 추출하는 쿼리입니다. NumberL 뒤의 공백 및 숫자는 errN으로, 그 뒤의 Mapped String: 이후 모든 텍스트는 errvalue로 추출하여 linename과 Time1과 함께 조회합니다.

sql
코드 복사
SELECT
    linename,
    -- NumberL 뒤의 숫자를 errN으로 추출
    LTRIM(SUBSTRING(ReceivedMessage, 
                    CHARINDEX('NumberL ', ReceivedMessage) + 8, 
                    CHARINDEX(',', ReceivedMessage, CHARINDEX('NumberL ', ReceivedMessage)) 
                    - CHARINDEX('NumberL ', ReceivedMessage) - 8)) AS errN,
    -- Mapped String: 뒤의 모든 텍스트를 errvalue로 추출
    LTRIM(SUBSTRING(ReceivedMessage, 
                    CHARINDEX('Mapped String:', ReceivedMessage) + 14, 
                    LEN(ReceivedMessage))) AS errvalue,
    Time1
FROM View_LogSensorsALL
WHERE CHARINDEX('NumberL ', ReceivedMessage) > 0
  AND CHARINDEX('Mapped String:', ReceivedMessage) > 0;
쿼리 설명
CHARINDEX('NumberL ', ReceivedMessage):
ReceivedMessage 컬럼에서 'NumberL ' 문자열이 시작되는 위치를 찾습니다.
SUBSTRING(ReceivedMessage, CHARINDEX('NumberL ', ...) + 8, ...):
'NumberL ' 뒤 8번째 문자부터 시작하여 ,까지의 텍스트를 추출합니다.
CHARINDEX('Mapped String:', ReceivedMessage):
Mapped String: 문자열의 시작 위치를 찾습니다.
LEN(ReceivedMessage):
Mapped String: 이후 모든 텍스트를 추출합니다.
LTRIM:
공백 제거.
결과
쿼리는 다음 형식의 데이터를 반환합니다:

linename	errN	errvalue	Time1