static void OnChanged(object source, FileSystemEventArgs e)
{
    string filePath = e.FullPath;
    using (FileStream fs = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
    {
        fs.Seek(lastFilePosition, SeekOrigin.Begin);
        using (StreamReader sr = new StreamReader(fs))
        {
            string line;
            while ((line = sr.ReadLine()) != null)
            {
                if (line.StartsWith("checkPhotoSensor") || line.StartsWith("D:\\Defect"))
                {
                    Regex regex = new Regex(@"(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2}:\d{3}) (.*)");
                    Match match = regex.Match(line);
                    if (match.Success)
                    {
                        string logDate = match.Groups[1].Value;
                        string logTime = match.Groups[2].Value;
                        string logText = match.Groups[3].Value;
                        InsertIntoDatabase(logDate, logTime, logText);
                    }
                }
            }
            lastFilePosition = fs.Position;
        }
    }
}
