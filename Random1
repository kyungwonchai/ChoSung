는 프로시저를 작성하는 것은 일반적인 작업입니다. 여기서는 ipadd1이라는 파라미터를 기준으로 table1에서 해당 값이 존재하면 val1로 업데이트하고, 그렇지 않으면 새로운 레코드를 삽입하는 프로시저의 예시를 보여드리겠습니다.

sql
Copy code
CREATE PROCEDURE sp_InsertOrUpdate
    @ipadd1 VARCHAR(50),
    @val1 VARCHAR(50)
AS
BEGIN
    -- 트랜잭션 시작
    BEGIN TRANSACTION;

    -- 조건 확인
    IF EXISTS (SELECT 1 FROM table1 WHERE ipadd1 = @ipadd1)
    BEGIN
        -- 조건에 맞는 레코드가 있으면 업데이트
        UPDATE table1
        SET val1 = @val1
        WHERE ipadd1 = @ipadd1;
    END
    ELSE
    BEGIN
        -- 없으면 삽입
        INSERT INTO table1 (ipadd1, val1)
        VALUES (@ipadd1, @val1);
    END;

    -- 트랜잭션 커밋
    COMMIT TRANSACTION;
END;
GO
이 스크립트는 기본적인 논리를 보여줍니다. 프로시저 sp_InsertOrUpdate는 ipadd1과 val1이라는 두 개의 파라미터를 받아서 table1에서 ipadd1을 조건으로 검색합니다. 해당하는 레코드가 있으면 val1을 업데이트하고, 없으면 새로운 레코드를 삽입합니다.

실제 사용 시에는 테이블 이름, 필드 이름 및 타입을 실제 환경에 맞게 조정해야 합니다. 또한, 오류 처리 로직 (예: TRY...CATCH 블록)를 추가하여 예외 상황을 처리할 수도 있습니다. 데이터베이스 트랜잭션을 사용하여 더 안정적인 데이터 관리가 가능