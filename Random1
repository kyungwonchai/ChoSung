ì • ë¦¬ë³¸ í˜ì´ì§€ë¥¼ íŠ¹ì • IP ì£¼ì†Œì—ì„œë§Œ í‘œì‹œí•˜ë ¤ë©´, IP ì£¼ì†Œ í™•ì¸ í›„ ë¦¬ë³¸ í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ìˆ¨ê¸°ê±°ë‚˜ í‘œì‹œí•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ëŠ” ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

1. IP í™•ì¸ ë° ì¡°ê±´ ì„¤ì •
IP ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸°
ì‚¬ìš©ìì˜ IP ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì½”ë“œì…ë‹ˆë‹¤:

csharp
ì½”ë“œ ë³µì‚¬
using System.Net;

private string GetLocalIPAddress()
{
    try
    {
        var host = Dns.GetHostEntry(Dns.GetHostName());
        foreach (var ip in host.AddressList)
        {
            if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork)
            {
                return ip.ToString(); // IPv4 ì£¼ì†Œ ë°˜í™˜
            }
        }
        return "127.0.0.1"; // ë¡œì»¬í˜¸ìŠ¤íŠ¸ ë°˜í™˜
    }
    catch
    {
        return string.Empty;
    }
}
2. ë¦¬ë³¸ í˜ì´ì§€ ìˆ¨ê¸°ê¸°/í‘œì‹œ
íŠ¹ì • IPì— ë”°ë¼ ë¦¬ë³¸ í˜ì´ì§€ ì²˜ë¦¬
ë¦¬ë³¸ í˜ì´ì§€ë¥¼ íŠ¹ì • IPì—ì„œë§Œ ë³´ì´ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private void SetRibbonPageVisibility(RibbonPage ribbonPage, string allowedIp)
{
    try
    {
        string localIp = GetLocalIPAddress(); // í˜„ì¬ IP ê°€ì ¸ì˜¤ê¸°

        if (localIp == allowedIp)
        {
            ribbonPage.Visible = true; // í—ˆìš©ëœ IPë¼ë©´ í˜ì´ì§€ í‘œì‹œ
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is visible for IP: {localIp}");
        }
        else
        {
            ribbonPage.Visible = false; // í—ˆìš©ë˜ì§€ ì•Šì€ IPë¼ë©´ ìˆ¨ê¹€
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is hidden for IP: {localIp}");
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetRibbonPageVisibility: {ex.Message}");
    }
}
3. í¼ ë¡œë“œ ì‹œ í˜¸ì¶œ
Form_Loadì—ì„œ íŠ¹ì • ë¦¬ë³¸ í˜ì´ì§€ë¥¼ ì¡°ê±´ì— ë”°ë¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private void Form_Load(object sender, EventArgs e)
{
    try
    {
        // íŠ¹ì • ë¦¬ë³¸ í˜ì´ì§€
        RibbonPage targetPage = favoritesPage; // ì˜ˆ: ì¦ê²¨ì°¾ê¸° í˜ì´ì§€
        string allowedIp = "192.168.1.100"; // í—ˆìš©í•  IP ì£¼ì†Œ

        // ë¦¬ë³¸ í˜ì´ì§€ ê°€ì‹œì„± ì„¤ì •
        SetRibbonPageVisibility(targetPage, allowedIp);

        // ê¸°íƒ€ ì´ˆê¸°í™” ì‘ì—…
        InitializeRibbonButtons();
        SetCurrentUser(null); // ê¸°ë³¸ ë¡œê·¸ì•„ì›ƒ ìƒíƒœ
        InitializeButtons();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] Form_Load: {ex.Message}");
    }
}
4. ì—¬ëŸ¬ IPì— ëŒ€í•´ ì¡°ê±´ ì²˜ë¦¬
ì—¬ëŸ¬ IPë¥¼ í—ˆìš©í•˜ë ¤ë©´, ë¦¬ìŠ¤íŠ¸ë¡œ ê´€ë¦¬í•˜ê³  ì¡°ê±´ì„ ìˆ˜ì •í•©ë‹ˆë‹¤:

IP ë¦¬ìŠ¤íŠ¸ ì •ì˜
csharp
ì½”ë“œ ë³µì‚¬
private readonly List<string> AllowedIps = new List<string>
{
    "192.168.1.100",
    "192.168.1.101"
};
ì¡°ê±´ ìˆ˜ì •
csharp
ì½”ë“œ ë³µì‚¬
private void SetRibbonPageVisibility(RibbonPage ribbonPage, List<string> allowedIps)
{
    try
    {
        string localIp = GetLocalIPAddress();

        if (allowedIps.Contains(localIp))
        {
            ribbonPage.Visible = true;
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is visible for IP: {localIp}");
        }
        else
        {
            ribbonPage.Visible = false;
            Console.WriteLine($"[Info] Ribbon page '{ribbonPage.Text}' is hidden for IP: {localIp}");
        }
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetRibbonPageVisibility: {ex.Message}");
    }
}
ìµœì¢… ê²°ê³¼
íŠ¹ì • IPì—ì„œë§Œ í˜ì´ì§€ ë³´ì„:

IP ì£¼ì†Œê°€ í—ˆìš©ëœ ê²½ìš°ì—ë§Œ í˜ì´ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.
í¼ ë¡œë“œì—ì„œ ìë™ ì²˜ë¦¬:

í”„ë¡œê·¸ë¨ ì‹œì‘ ì‹œ IP ì¡°ê±´ì— ë”°ë¼ í˜ì´ì§€ë¥¼ ìˆ¨ê¸°ê±°ë‚˜ í‘œì‹œ.
ì—¬ëŸ¬ IP ì§€ì›:

List<string>ë¡œ ê´€ë¦¬í•˜ë©´ ì—¬ëŸ¬ IPë¥¼ í—ˆìš© ê°€ëŠ¥.
í…ŒìŠ¤íŠ¸ í›„ ì¶”ê°€ ìš”ì²­ì´ ìˆìœ¼ë©´ ë§ì”€í•´ì£¼ì„¸ìš”! ğŸ˜Š






ë‚˜ì˜ ë§:
í•˜ë‚˜ë¬¼ì–´ë³´ì ë‹¤ë¥¸ê±°   load í•¨ìˆ˜ê°€ async voidì•¼ í¼ ë¡œë“œí•¨ìˆ˜ê°€ ê·¸ ì•ˆì— ë³´ë©´ ë§ˆì§€ë§‰ì— ìŠ¤í”„ë˜ì‹œì°½ì„ ë‹«ëŠ”ê²Œìˆì–´. ê·¼ë° ë¡œë“œê°€ ë‹¤ì•ˆëŒ”ëŠ”ë° ì°½ì´ ë‹«íˆë„¤?r ê·¸ì „ê±°ë¥¼ ê¸°ë‹¤ë¦¬ë ¤ë©´
ChatGPTì˜ ë§:
ChatGPT
async void ë©”ì„œë“œëŠ” ë¹„ë™ê¸° ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ì„œ í˜¸ì¶œìë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•ŠëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, ì‘ì—…ì´ ì™„ë£Œë˜ê¸° ì „ì— ì½”ë“œê°€ ì§„í–‰ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë¥¼ í•´ê²°í•˜ë ¤ë©´ Task ê¸°ë°˜ì˜ ë¹„ë™ê¸° ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ê³ , ì‘ì—…ì´ ì™„ë£Œëœ í›„ì— ìŠ¤í”Œë˜ì‹œ ì°½ì„ ë‹«ëŠ” ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤.

í•´ê²° ë°©ë²•: Task ê¸°ë°˜ ë¹„ë™ê¸° ë¡œë“œ
1. í¼ ë¡œë“œ í•¨ìˆ˜ ìˆ˜ì •
í¼ì˜ Load ì´ë²¤íŠ¸ëŠ” async voidë¡œ ì„¤ì •ëœ ê²½ìš°, ìŠ¤í”Œë˜ì‹œ ì°½ì„ ë‹«ëŠ” ì‘ì—…ì´ ë¡œë“œ ì™„ë£Œë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ë¥¼ ë°©ì§€í•˜ë ¤ë©´, ìŠ¤í”Œë˜ì‹œ ì°½ ë‹«ê¸° ì‘ì—…ì„ ë¹„ë™ê¸° ë¡œë“œ ì‘ì—… ì´í›„ì— ì‹¤í–‰í•˜ë„ë¡ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private async void Form_Load(object sender, EventArgs e)
{
    try
    {
        // ìŠ¤í”Œë˜ì‹œ ì°½ í‘œì‹œ
        ShowSplashScreen();

        // ë¹„ë™ê¸° ì´ˆê¸°í™” ì‘ì—… ì‹¤í–‰
        await InitializeAsync();

        // ì´ˆê¸°í™” ì™„ë£Œ í›„ ìŠ¤í”Œë˜ì‹œ ì°½ ë‹«ê¸°
        CloseSplashScreen();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] Form_Load: {ex.Message}");
        CloseSplashScreen(); // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ìŠ¤í”Œë˜ì‹œ ì°½ ë‹«ê¸°
    }
}
2. ë¹„ë™ê¸° ì´ˆê¸°í™” ì‘ì—… í•¨ìˆ˜ (InitializeAsync)
ëª¨ë“  ì´ˆê¸°í™” ì‘ì—…ì„ ë¹„ë™ê¸°ë¡œ ì‹¤í–‰í•˜ê³  Taskë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private async Task InitializeAsync()
{
    try
    {
        // ë¦¬ë³¸ ë²„íŠ¼ ì´ˆê¸°í™” (ë™ê¸° ì‘ì—… ê°€ëŠ¥)
        InitializeRibbonButtons();

        // ì‚¬ìš©ì ID ì„¤ì • (ë¹„ë™ê¸° ì‘ì—… í¬í•¨)
        await SetCurrentUserAsync(null);

        // ë²„íŠ¼ ì´ˆê¸°í™”
        InitializeButtons();
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] InitializeAsync: {ex.Message}");
    }
}
3. ì‚¬ìš©ì ID ì„¤ì • í•¨ìˆ˜ ë¹„ë™ê¸°í™” (SetCurrentUserAsync)
DB ì‘ì—…ì´ë‚˜ íŒŒì¼ ì‘ì—…ì´ í¬í•¨ëœ ê²½ìš° asyncë¡œ ë³€ê²½í•´ ë¹„ë™ê¸° ì‘ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private async Task SetCurrentUserAsync(string userId)
{
    try
    {
        currentUserId = userId;

        if (!string.IsNullOrWhiteSpace(currentUserId))
        {
            Console.WriteLine($"[Info] Logged in as User ID: {currentUserId}");
            await LoadFavoritesFromDatabaseAsync(); // DB ë°ì´í„° ë¹„ë™ê¸°ë¡œ ë¡œë“œ
            SetFavoritesPageBackground(LoggedInBackgroundColor); // ë¡œê·¸ì¸ ìƒíƒœ ë°°ê²½ìƒ‰
        }
        else
        {
            Console.WriteLine("[Info] Logged out. Using local favorites.");
            await LoadFavoritesFromFileAsync(); // ë¡œì»¬ íŒŒì¼ ë°ì´í„° ë¹„ë™ê¸°ë¡œ ë¡œë“œ
            SetFavoritesPageBackground(LoggedOutBackgroundColor); // ë¡œê·¸ì•„ì›ƒ ìƒíƒœ ë°°ê²½ìƒ‰
        }

        InitializeButtons(); // ë²„íŠ¼ UI ê°±ì‹ 
    }
    catch (Exception ex)
    {
        Console.WriteLine($"[Error] SetCurrentUserAsync: {ex.Message}");
    }
}
4. ìŠ¤í”Œë˜ì‹œ ì°½ ì œì–´ í•¨ìˆ˜
ìŠ¤í”Œë˜ì‹œ ì°½ì„ í‘œì‹œí•˜ê³  ë‹«ëŠ” í•¨ìˆ˜ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

csharp
ì½”ë“œ ë³µì‚¬
private void ShowSplashScreen()
{
    // ìŠ¤í”Œë˜ì‹œ ì°½ í‘œì‹œ
    SplashScreenManager.ShowForm(this, typeof(YourSplashScreen), true, true);
}

private void CloseSplashScreen()
{
    // ìŠ¤í”Œë˜ì‹œ ì°½ ë‹«ê¸°
    if (SplashScreenManager.Default != null)
    {
        SplashScreenManager.CloseForm();
    }
}
ì£¼ìš” ë³€ê²½ ì‚¬í•­
Form_Load í•¨ìˆ˜:

async voidë¡œ ìœ ì§€í•˜ì§€ë§Œ, ì´ˆê¸°í™” ì‘ì—… ì™„ë£Œ í›„ì—ë§Œ ìŠ¤í”Œë˜ì‹œ ì°½ì„ ë‹«ë„ë¡ ìˆ˜ì •.
ë¹„ë™ê¸° ì´ˆê¸°í™” ì‘ì—… í•¨ìˆ˜:

InitializeAsync í•¨ìˆ˜ì—ì„œ ëª¨ë“  ë¹„ë™ê¸° ì‘ì—…ì„ ì²˜ë¦¬.
ë¹„ë™ê¸° ë°ì´í„° ë¡œë“œ:

SetCurrentUserAsync, LoadFavoritesFromDatabaseAsync, LoadFavoritesFromFileAsyncì—ì„œ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë°ì´í„° ë¡œë“œ.
ìŠ¤í”Œë˜ì‹œ ì°½ ì œì–´:

ShowSplashScreenê³¼ CloseSplashScreen í•¨ìˆ˜ë¡œ ìŠ¤í”Œë˜ì‹œ ì°½ ìƒíƒœë¥¼ ê´€ë¦¬.
ìµœì¢… ê²°ê³¼
ìŠ¤í”Œë˜ì‹œ ì°½ ë™ì‘:

ëª¨ë“  ì´ˆê¸°í™” ì‘ì—…ì´ ì™„ë£Œëœ í›„ì—ë§Œ ìŠ¤í”Œë˜ì‹œ ì°½ì´ ë‹«í™ë‹ˆë‹¤.
ë¹„ë™ê¸° ì‘ì—… ì²˜ë¦¬:
