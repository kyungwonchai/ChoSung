Sub 주차2_시트_선택_및_B5_노랑_색상()
    Dim 대상_통합문서 As Workbook
    Dim 주차2_시트 As Worksheet
    Dim 주차_단어 As String
    Dim 숫자_패턴 As Object
    Dim 매치 As Object
    Dim ws As Worksheet
    
    ' 대상 통합문서를 설정 (예: 이미 열려있는 통합문서)
    Set 대상_통합문서 = Workbooks("대상파일이름.xlsx") ' 통합문서 이름에 맞게 수정 필요
    
    ' 통합문서에서 "주차2"가 포함된 시트를 찾고 변수에 설정
    For Each ws In 대상_통합문서.Worksheets
        If InStr(1, ws.Name, "주차2", vbTextCompare) > 0 Then
            Set 주차2_시트 = ws
            Exit For
        End If
    Next ws
    
    ' 주차2 시트를 선택하고 셀 B5의 배경색을 노랑으로 설정
    If Not 주차2_시트 Is Nothing Then
        주차2_시트.Select
        주차2_시트.Range("B5").Interior.Color = RGB(255, 255, 0) ' 노랑색으로 설정
        
        ' C1 값에서 W가 포함되면서 숫자가 2개 있는 경우 숫자 추출 후 "주차" 붙이기
        Set 숫자_패턴 = CreateObject("VBScript.RegExp")
        숫자_패턴.Global = True
        숫자_패턴.IgnoreCase = True
        숫자_패턴.Pattern = "W.*?(\d{1}).*?(\d{1})"
        
        If 숫자_패턴.Test(주차2_시트.Range("C1").Value) Then
            Set 매치 = 숫자_패턴.Execute(주차2_시트.Range("C1").Value)
            주차_단어 = 매치(0).SubMatches(0) & 매치(0).SubMatches(1) & "주차"
        Else
            MsgBox "C1 셀에서 적절한 값을 찾을 수 없습니다."
            Exit Sub
        End If
        
        ' 주차_단어 변수가 포함된 시트 이름을 가진 모든 시트를 순회하며 셀 (1, 1)의 배경을 파랗게 설정
        For Each ws In 대상_통합문서.Worksheets
            If InStr(1, ws.Name, 주차_단어, vbTextCompare) > 0 Then
                ws.Range("A1").Interior.Color = RGB(0, 0, 255) ' 파란색으로 설정
            End If
        Next ws
    Else
        MsgBox "주차2가 포함된 시트를 찾을 수 없습니다."
    End If