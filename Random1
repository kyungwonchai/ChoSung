래는 ModelName의 우측 글자가 L 또는 R일 때, MP1DATA~MP5DATA 값을 각각 -1 또는 +1로 계산하여 조회하는 SQL 쿼리입니다:

sql
코드 복사
SELECT 
    ModelName,
    Timestamp,
    CASE 
        WHEN RIGHT(ModelName, 1) = 'L' THEN MP1DATA - 1
        WHEN RIGHT(ModelName, 1) = 'R' THEN MP1DATA + 1
        ELSE MP1DATA
    END AS MP1DATA,
    CASE 
        WHEN RIGHT(ModelName, 1) = 'L' THEN MP2DATA - 1
        WHEN RIGHT(ModelName, 1) = 'R' THEN MP2DATA + 1
        ELSE MP2DATA
    END AS MP2DATA,
    CASE 
        WHEN RIGHT(ModelName, 1) = 'L' THEN MP3DATA - 1
        WHEN RIGHT(ModelName, 1) = 'R' THEN MP3DATA + 1
        ELSE MP3DATA
    END AS MP3DATA,
    CASE 
        WHEN RIGHT(ModelName, 1) = 'L' THEN MP4DATA - 1
        WHEN RIGHT(ModelName, 1) = 'R' THEN MP4DATA + 1
        ELSE MP4DATA
    END AS MP4DATA,
    CASE 
        WHEN RIGHT(ModelName, 1) = 'L' THEN MP5DATA - 1
        WHEN RIGHT(ModelName, 1) = 'R' THEN MP5DATA + 1
        ELSE MP5DATA
    END AS MP5DATA
FROM 
    View_InspectionResult
WHERE 
    RIGHT(ModelName, 1) IN ('L', 'R')
ORDER BY 
    Timestamp DESC;
설명:
RIGHT(ModelName, 1):

ModelName의 마지막 한 글자를 추출합니다.
L 또는 R 여부를 판별하기 위해 사용됩니다.
CASE 구문:

L이면 MP1DATA~MP5DATA에서 각각 -1을 뺍니다.
R이면 MP1DATA~MP5DATA에 각각 +1을 더합니다.
다른 값일 경우 원래 값을 그대로 반환합니다.
WHERE RIGHT(ModelName, 1) IN ('L', 'R'):

ModelName의 마지막 글자가 L 또는 R인 행만 필터링합니다.
ORDER BY Timestamp DESC:

최신 데이터가 먼저 나오도록 정렬합니다.
테스트 데이터 예시:
원본 데이터 (View_InspectionResult):
ModelName	Timestamp	MP1DATA	MP2DATA	MP3DATA	MP4DATA	MP5DATA
Model1L	2025-01-01 10:00:00	10	20	30	40	50
Model2R	2025-01-01 09:00:00	15	25	35	45	55
쿼리 결과:
ModelName	Timestamp	MP1DATA	MP2DATA	MP3DATA	MP4DATA	MP5DATA
Model1L	2025-01-01 10:00:00	9	19	29	39	49