크립트 (similarity.py):

python

import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
import joblib

# 1. 데이터 전처리
def preprocess_data(data):
    # 필요한 전처리 작업 수행
    # 예: 소문자 변환, 특수 문자 제거 등
    data = data.str.lower()
    data = data.str.replace('[^\w\s]', '')
    return data

# 2. 특징 추출
def extract_features(data):
    vectorizer = TfidfVectorizer()
    features = vectorizer.fit_transform(data)
    return vectorizer, features

# 3. 유사도 계산
def calculate_similarity(query, vectorizer, features):
    query_feature = vectorizer.transform([query])
    similarity_scores = cosine_similarity(query_feature, features)
    return similarity_scores

# 데이터 로드 및 전처리
data = pd.read_csv('data.csv')['part_code']
preprocessed_data = preprocess_data(data)

# 특징 추출
vectorizer, features = extract_features(preprocessed_data)

# 학습된 모델 저장
joblib.dump(vectorizer, 'vectorizer.joblib')
joblib.dump(features, 'features.joblib')

# C# 애플리케이션으로 결과 전송을 위한 예시 함수
def get_top_similar_parts(query, top_k=10):
    # 학습된 모델 로드
    vectorizer = joblib.load('vectorizer.joblib')
    features = joblib.load('features.joblib')

    # 입력 문자열 전처리
    preprocessed_query = preprocess_data(pd.Series([query]))

    # 유사도 계산
    similarity_scores = calculate_similarity(preprocessed_query, vectorizer, features)

    # 상위 유사한 부품 코드 목록 반환
    similar_parts = data[similarity_scores.argsort()[0][-top_k:]].tolist()
    return similar_parts

C# WinForms 애플리케이션 소스 코드:

csharp

using System;
using System.Windows.Forms;
using Python.Runtime;

namespace SimilarityApp
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void btnFindSimilar_Click(object sender, EventArgs e)
        {
            // Python 스크립트 실행을 위한 준비
            using (Py.GIL())
            {
                dynamic similarityScript = Py.Import("similarity");

                // Python 함수 호출
                dynamic getTopSimilarParts = similarityScript.get_top_similar_parts;
                dynamic result = getTopSimilarParts(txtQuery.Text);

                // 결과를 리스트에 표시
                lbSimilarParts.DataSource = result;
            }
        }
    }
}