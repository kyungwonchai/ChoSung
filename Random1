는 Excel VBA로 원하는 기능을 구현한 코드입니다.

1. 병합된 셀의 값 확인 및 딕셔너리에 저장
vba
코드 복사
Sub CheckMergedCells()
    Dim ws As Worksheet
    Dim mergedDict As Object
    Dim cell As Range
    Dim mergedArea As Range
    Dim key As String
    Dim value As String
    
    ' 현재 워크시트 설정
    Set ws = ThisWorkbook.Sheets(1)
    
    ' 딕셔너리 생성
    Set mergedDict = CreateObject("Scripting.Dictionary")
    
    ' 워크시트의 모든 병합된 셀 확인
    For Each cell In ws.UsedRange
        If cell.MergeCells Then
            Set mergedArea = cell.MergeArea
            ' 병합된 영역의 첫 번째 셀 값 확인
            If Not IsEmpty(mergedArea.Cells(1, 1).Value) Then
                key = mergedArea.Address
                value = mergedArea.Cells(1, 1).Value
                
                ' 딕셔너리에 저장
                If Not mergedDict.exists(key) Then
                    mergedDict.Add key, value
                End If
            End If
        End If
    Next cell
    
    ' 딕셔너리 값 출력 예시
    Dim kkk As String
    kkk = "kkk" ' 확인할 값
    
    If mergedDict.exists(kkk) Then
        MsgBox "yyy: " & kkk & "이(가) 딕셔너리에 있습니다."
    Else
        MsgBox "bbb: " & kkk & "이(가) 딕셔너리에 없습니다."
    End If
End Sub
코드 설명
병합된 셀 확인
cell.MergeCells를 사용하여 병합된 셀인지 확인합니다.
병합된 셀의 값은 cell.MergeArea.Cells(1, 1).Value를 통해 가져옵니다.

딕셔너리 사용
Scripting.Dictionary 객체를 사용하여 병합된 셀의 주소를 키로, 해당 값을 값으로 저장합니다.

값 확인
특정 값이 딕셔너리에 있는지 확인하고, 결과에 따라 메시지를 표시합니다.

VBA 코드 실행 방법
Excel에서 ALT + F11을 눌러 VBA 편집기를 엽니다.
삽입 > 모듈을 선택하여 새 모듈을 추가합니다.