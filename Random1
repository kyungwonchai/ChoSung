그룹 정책을 코드로 변경할 수 있습니다. 이를 위해 Windows 명령 프롬프트에서 gpupdate 명령을 사용하거나, 레지스트리 파일(.reg)을 사용하여 직접 레지스트리를 수정하는 방법이 있습니다. PowerShell을 이용하여 그룹 정책 설정을 변경할 수도 있습니다.

레지스트리 파일을 사용하여 그룹 정책 변경
레지스트리 파일 작성: 그룹 정책 설정을 변경하는 .reg 파일을 작성합니다. 예를 들어, NTP 클라이언트를 설정하는 레지스트리 파일은 다음과 같습니다.

plaintext
코드 복사
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W32Time\Parameters]
"Type"="NTP"
레지스트리 파일 적용: 명령 프롬프트나 PowerShell에서 다음 명령을 사용하여 레지스트리 파일을 적용합니다.

shell
코드 복사
reg import path\to\your\file.reg
예를 들어, 파일이 C:\ntp_config.reg에 있다고 하면:

shell
코드 복사
reg import C:\ntp_config.reg
PowerShell을 사용하여 그룹 정책 변경
PowerShell을 이용하여 그룹 정책을 변경하는 방법도 있습니다.

PowerShell 스크립트 작성: PowerShell 스크립트를 작성하여 그룹 정책을 변경합니다. 예를 들어, 다음 스크립트는 시간 동기화 설정을 변경합니다.

powershell
코드 복사
# 시간 동기화 설정을 NTP로 변경
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\W32Time\Parameters" -Name "Type" -Value "NTP"

# 시간 서비스 재시작
Restart-Service w32time

# 시간 동기화
w32tm /resync
PowerShell 스크립트 실행: PowerShell을 관리자 권한으로 실행하고, 스크립트를 실행합니다.

powershell
코드 복사
.\path\to\your\script.ps1
명령 프롬프트에서 그룹 정책 업데이트
gpupdate 명령어 사용: 변경된 그룹 정책 설정을 적용하려면 gpupdate 명령을 사용합니다.

shell
코드 복사
gpupdate /force
이 명령어는 시스템에 적용된 모든 그룹 정책 설정을 업데이트합니다.

요약
레지스트리 파일 사용: .reg 파일을 작성하여 레지스트리 설정을 직접 변경.
PowerShell 사용: PowerShell 스크립트를 통해 그룹 정책 설정을 변경.
gpupdate 사용: gpupdate /force 명령으로 그룹 정책 변경 사항을 적용.
위 방법들을 통해 코드로 그룹 정책 설정을 변경하고, 시간 동기화 설정을 유지할 수 있습니