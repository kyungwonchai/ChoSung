라즈베리파이에서 PM2 서비스를 모두 종료하고 삭제한 후, Watchdog을 활성화하는 방법을 단계별로 설명해 드리겠습니다.

1. PM2 서비스 모두 종료 및 삭제
PM2 서비스를 모두 종료하고 시스템 시작 시 자동으로 실행되지 않도록 설정하는 방법입니다.

실행 중인 모든 PM2 프로세스 목록 확인:

Bash

pm2 list
이 명령어를 통해 현재 실행 중인 모든 PM2 애플리케이션 목록을 확인할 수 있습니다.

모든 PM2 프로세스 종료 및 삭제:

Bash

pm2 stop all
pm2 delete all
pm2 stop all 명령어로 모든 프로세스를 종료하고, pm2 delete all 명령어로 PM2의 프로세스 목록에서 모두 삭제합니다.

PM2의 시작 스크립트 비활성화:

Bash

pm2 unstartup
이 명령어를 실행하면 시스템 부팅 시 PM2가 자동으로 시작되는 설정을 제거합니다.

2. 하드웨어 Watchdog 활성화
하드웨어 Watchdog은 시스템이 응답하지 않을 때 자동으로 재부팅하여 시스템 다운타임을 줄이는 데 사용됩니다. 라즈베리파이에서 Watchdog 타이머를 활성화하는 방법은 다음과 같습니다.

Watchdog 모듈 활성화:
/boot/config.txt 파일을 수정하여 Watchdog 모듈을 활성화해야 합니다.

Bash

sudo nano /boot/config.txt
파일 끝에 다음 줄을 추가합니다.

dtparam=watchdog=on
저장하고 종료합니다 (Ctrl+X, Y, Enter).

Watchdog 데몬 설치 및 설정:
watchdog 데몬을 설치하여 Watchdog 타이머를 주기적으로 갱신하도록 설정합니다.

Bash

sudo apt-get update
sudo apt-get install watchdog
Watchdog 데몬 설정 파일 수정:
watchdog 설정 파일인 /etc/watchdog.conf를 수정합니다.

Bash

sudo nano /etc/watchdog.conf
주로 다음 부분을 수정합니다:

#watchdog-device = /dev/watchdog (주석 해제)

#max-load-1 = 24 (시스템 부하가 높을 때 재부팅, 필요에 따라 주석 해제)

#realtime = yes (실시간 프로세스로 설정, 필요에 따라 주석 해제)

Watchdog 서비스 활성화:
시스템 재부팅 시 watchdog 데몬이 자동으로 실행되도록 설정합니다.

Bash

sudo systemctl enable watchdog
sudo systemctl start watchdog
시스템 재부팅:
모든 변경 사항을 적용하기 위해 라즈베리파이를 재부팅합니다.

Bash

sudo reboot
재부팅 후 watchdog 데몬이 정상적으로 실행되고 있는지 확인하려면 systemctl status watchdog 명령어를 사용합니다.