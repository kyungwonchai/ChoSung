니다. 아래는 수정된 코드입니다:

csharp

using System;
using System.IO;
using System.Linq;

namespace LogManagement
{
    public class LogManager
    {
        private string logFolderPath;
        private string logFilePath;

        public LogManager(string folderPath)
        {
            logFolderPath = folderPath;
            logFilePath = CreateLogFilePath();
            CreateLogFolder();
        }

        private string CreateLogFilePath()
        {
            string fileName = DateTime.Now.ToString("yyyyMMdd") + ".log";
            string filePath = Path.Combine(logFolderPath, fileName);

            if (!File.Exists(filePath))
            {
                File.Create(filePath).Dispose();
            }

            return filePath;
        }

        private void CreateLogFolder()
        {
            if (!Directory.Exists(logFolderPath))
            {
                Directory.CreateDirectory(logFolderPath);
            }
        }

        public void AddLogEntry(string logEntry)
        {
            string logLine = $"[{DateTime.Now.ToString("yyyyMMddHHmmss")}]: {logEntry}";
            using (StreamWriter sw = File.AppendText(logFilePath))
            {
                sw.WriteLine(logLine);
            }

            DeleteOldLogFiles(14); // 최근 2주간의 로그 파일 유지, 나머지 삭제
        }

        private void DeleteOldLogFiles(int retentionDays)
        {
            DateTime retentionDate = DateTime.Now.AddDays(-retentionDays);
            var logFiles = Directory.GetFiles(logFolderPath)
                                    .Where(file => File.GetCreationTime(file) < retentionDate);

            foreach (var file in logFiles)
            {
                File.Delete(file);
            }
        }
    }
}

위의 코드에서 LogManager 클래스의 생성자에서 CreateLogFolder() 메서드를 호출하여 폴더가 없는 경우에도 자동으로 폴더를 생성합니다.

사용 예시:

csharp

using System;
using LogManagement;

namespace LogExample
{
    class Program
    {
        static void Main()
        {
            string logFolderPath = @"C:\Agent\KnoxAPILog";

            LogManager logManager = new LogManager(logFolderPath);
            logManager.AddLogEntry("This is a log entry.");
        }
    }
}

위의 예시에서는 LogManager 클래스의 인스턴스를 생성한 후, AddLogEntry() 메서드를 호출하여 로그를 추가합니다. 이 함수를 호출할 때 경로가 없으면 자동으로 폴더가 생성되며, 최근 2주간의 로그 파일을 유지하고 나머지 파일