using System;
using System.IO;
using System.Windows.Forms;

namespace BackupApplication
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void BackupButton_Click(object sender, EventArgs e)
        {
            string filePath = FilePathTextBox.Text;
            if (string.IsNullOrEmpty(filePath))
            {
                MessageBox.Show("파일 경로를 입력하세요.");
                return;
            }

            string backupDirectory = @"c:\back1\";

            // 파일이 존재하는지 확인
            if (!File.Exists(filePath))
            {
                MessageBox.Show("지정된 파일이 존재하지 않습니다.");
                return;
            }

            // 파일명에서 날짜 정보 추출
            string fileName = Path.GetFileName(filePath);
            string datePart = fileName.Substring(0, 8);
            if (!DateTime.TryParseExact(datePart, "yyyyMMdd", null, System.Globalization.DateTimeStyles.None, out DateTime backupDate))
            {
                MessageBox.Show("파일명에서 날짜를 추출할 수 없습니다.");
                return;
            }

            // 백업 폴더 생성
            string backupFolderPath = Path.Combine(backupDirectory, backupDate.ToString("yyyyMMdd"));
            if (!Directory.Exists(backupFolderPath))
            {
                Directory.CreateDirectory(backupFolderPath);
            }

            // 백업 파일 경로 생성
            string backupFilePath = Path.Combine(backupFolderPath, fileName);

            // 파일 복사
            File.Copy(filePath, backupFilePath, true);

            MessageBox.Show("백업이 완료되었습니다.");
        }
    }
}
