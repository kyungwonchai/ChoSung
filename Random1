PFì˜ Image ì»¨íŠ¸ë¡¤ì„ ì‚¬ìš©í•˜ì—¬ OpenCvSharpì—ì„œ ì²˜ë¦¬í•œ ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•˜ë ¤ë©´, OpenCvSharpì˜ Matì„ BitmapImageë¡œ ë³€í™˜í•´ì•¼ í•©ë‹ˆë‹¤.

1. í•µì‹¬ ê°œë…
OpenCvSharpì—ì„œ Matì„ ìƒì„± (ì´ì§„í™” ì ìš©)
Mat â†’ Bitmap ë³€í™˜ (Mat.ToBitmap())
Bitmap â†’ BitmapImage ë³€í™˜ (MemoryStream ì‚¬ìš©)
WPF Image ì»¨íŠ¸ë¡¤ì˜ Sourceì— ì ìš©
2. WPF í”„ë¡œì íŠ¸ êµ¬ì¡°
MainWindow.xaml
Image ì»¨íŠ¸ë¡¤ ì¶”ê°€
Button í´ë¦­ ì‹œ ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
MainWindow.xaml.cs
í™”ë©´ ìº¡ì²˜ ë° ì´ì§„í™” ì ìš©
ë³€í™˜ëœ ì´ë¯¸ì§€(BitmapImage)ë¥¼ Image.Sourceì— ì ìš©
3. WPF XAML (UI)
ğŸ“Œ Image ì»¨íŠ¸ë¡¤ê³¼ Buttonì„ ì¶”ê°€í•˜ì—¬ í´ë¦­í•˜ë©´ ê²°ê³¼ë¥¼ í‘œì‹œí•˜ë„ë¡ ì„¤ì •

xml
ì½”ë“œ ë³µì‚¬
<Window x:Class="WpfOpenCv.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="OpenCV ì´ë¯¸ì§€ ì²˜ë¦¬" Height="600" Width="800">
    <Grid>
        <Button Content="ì´ì§„í™” ì ìš©" Width="150" Height="40"
                HorizontalAlignment="Left" VerticalAlignment="Top"
                Click="OnApplyThresholdClick"/>
        
        <Image Name="ResultImage" Width="600" Height="400"
               HorizontalAlignment="Center" VerticalAlignment="Center"/>
    </Grid>
</Window>
4. WPF C# ì½”ë“œ (MainWindow.xaml.cs)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Drawing;
using System.IO;
using System.Windows;
using System.Windows.Media.Imaging;
using OpenCvSharp;
using OpenCvSharp.Extensions;
using Point = System.Drawing.Point;

namespace WpfOpenCv
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        // ë²„íŠ¼ í´ë¦­ ì‹œ ì‹¤í–‰
        private void OnApplyThresholdClick(object sender, RoutedEventArgs e)
        {
            // í™”ë©´ ìº¡ì²˜
            Bitmap screenshot = CaptureScreen();
            
            // OpenCV Mat ë³€í™˜ ë° ì´ì§„í™” ì ìš©
            Mat matImage = BitmapConverter.ToMat(screenshot);
            Mat gray = new Mat();
            Cv2.CvtColor(matImage, gray, ColorConversionCodes.BGR2GRAY);
            Mat binary = new Mat();
            Cv2.Threshold(gray, binary, 200, 255, ThresholdTypes.Binary);

            // WPF Image ì»¨íŠ¸ë¡¤ì— í‘œì‹œ
            ResultImage.Source = ConvertMatToBitmapImage(binary);
        }

        // í™”ë©´ ìº¡ì²˜ í•¨ìˆ˜
        private Bitmap CaptureScreen()
        {
            Rectangle bounds = System.Windows.Forms.Screen.PrimaryScreen.Bounds;
            Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height);
            using (Graphics g = Graphics.FromImage(bitmap))
            {
                g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
            }
            return bitmap;
        }

        // Mat â†’ BitmapImage ë³€í™˜
        private BitmapImage ConvertMatToBitmapImage(Mat mat)
        {
            using (Bitmap bitmap = mat.ToBitmap())
            {
                MemoryStream memoryStream = new MemoryStream();
                bitmap.Save(memoryStream, System.Drawing.Imaging.ImageFormat.Png);
                memoryStream.Position = 0;

                BitmapImage bitmapImage = new BitmapImage();
                bitmapImage.BeginInit();
                bitmapImage.StreamSource = memoryStream;
                bitmapImage.CacheOption = BitmapCacheOption.OnLoad;
                bitmapImage.EndInit();

                return bitmapImage;
            }
        }
    }
}
5. ì½”ë“œ ì„¤ëª…
ë²„íŠ¼ í´ë¦­ ì‹œ OnApplyThresholdClick ì‹¤í–‰
í™”ë©´ì„ ìº¡ì²˜í•˜ì—¬ Bitmap ìƒì„±
Mat ë³€í™˜ í›„ ì´ì§„í™” ì ìš©
csharp
ì½”ë“œ ë³µì‚¬
Cv2.CvtColor(matImage, gray, ColorConversionCodes.BGR2GRAY);
Cv2.Threshold(gray, binary, 200, 255, ThresholdTypes.Binary);
ì´ì§„í™”ëœ Matì„ BitmapImageë¡œ ë³€í™˜ (ConvertMatToBitmapImage)
csharp
ì½”ë“œ ë³µì‚¬
Bitmap bitmap = mat.ToBitmap();
MemoryStream memoryStream = new MemoryStream();
bitmap.Save(memoryStream, System.Drawing.Imaging.ImageFormat.Png);
Image ì»¨íŠ¸ë¡¤ì— ê²°ê³¼ í‘œì‹œ
csharp
ì½”ë“œ ë³µì‚¬
ResultImage.Source = ConvertMatToBitmapImage(binary);
6. ì‹¤í–‰ ê²°ê³¼
í”„ë¡œê·¸ë¨ ì‹¤í–‰ í›„ ì´ì§„í™” ì ìš© ë²„íŠ¼ í´ë¦­
í˜„ì¬ í™”ë©´ì˜ ê³µì§€ì‚¬í•­ ì°½ì´ ê°ì§€ë˜ê³ ,