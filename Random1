import bpy

# 기존 객체 삭제
bpy.ops.object.select_all(action='SELECT')
bpy.ops.object.delete(use_global=False)

# 단어 목록 정의 및 위치 초기값 설정
words = ["MX", "Global", "SMD", "Platform"]
y_position = 0  # Y축 위치 시작값

# 각 단어를 3D 텍스트로 생성하고 아래로 배치
for word in words:
    bpy.ops.object.text_add(location=(0, 0, y_position))
    text_obj = bpy.context.object
    text_obj.data.body = word
    text_obj.data.extrude = 0.1  # 텍스트 깊이 설정
    text_obj.location = (-1, 0, y_position)  # Y축 아래로 배치
    y_position -= 1.5  # 다음 단어를 더 아래에 배치

    # 푸른 보석 색상 재질 설정
    material = bpy.data.materials.get("BlueGemMaterial") or bpy.data.materials.new(name="BlueGemMaterial")
    material.use_nodes = True
    nodes = material.node_tree.nodes
    nodes["Principled BSDF"].inputs['Base Color'].default_value = (0.0, 0.1, 1.0, 1.0)  # 푸른 보석 색상
    nodes["Principled BSDF"].inputs['Roughness'].default_value = 0.2
    nodes["Principled BSDF"].inputs['Metallic'].default_value = 0.8
    text_obj.data.materials.append(material)

# 카메라 생성 및 설정
bpy.ops.object.camera_add(location=(0, -8, -1), rotation=(1.57, 0, 0))
camera = bpy.context.object
camera.data.lens = 35
camera.data.clip_end = 1000

# 카메라가 텍스트를 꽉 차게 보이도록 설정
bpy.context.scene.camera = camera

# 배경 투명 설정
bpy.context.scene.render.film_transparent = True

# 렌더링 설정
bpy.context.scene.render.image_settings.file_format = 'PNG'
bpy.context.scene.render.filepath = "//MX_Global_SMD_Platform_Render.png"

# 렌더링 실행
bpy.ops.render.render(write_still=True)
