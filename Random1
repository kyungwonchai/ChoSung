PF에서 Viewbox를 사용하여 XAML 전체를 캡처한 이미지처럼 확대/축소하여 인쇄할 수 있습니다. 이를 통해 인쇄 크기를 조정하는 과정을 단순화할 수 있습니다. Viewbox는 자식 요소를 확장하거나 축소하여 정해진 크기에 맞춰주므로, 이 방식을 사용하면 XAML을 별도로 크기 조정하지 않아도 됩니다.

아래 예제에서는 Viewbox에 XAML 전체 레이아웃을 감싸고, PrintDialog를 사용해 해당 Viewbox를 이미지처럼 확대하여 인쇄하는 방식을 구현합니다.

XAML (MainWindow.xaml)
xml
코드 복사
<Window x:Class="LabelPrinter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Label Printer" Height="250" Width="220" Background="White">
    <Grid Name="PrintableArea">
        <Viewbox>
            <!-- 표 구조 시작 -->
            <Grid Background="White" Width="189" Height="180">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="64"/> <!-- 좌측 컬럼 너비 (약 17mm) -->
                    <ColumnDefinition Width="125"/> <!-- 우측 컬럼 너비 (약 33mm) -->
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30"/> <!-- 병합된 제목 행 -->
                    <RowDefinition Height="30"/> <!-- 코드 -->
                    <RowDefinition Height="30"/> <!-- LOT -->
                    <RowDefinition Height="30"/> <!-- 업체 -->
                    <RowDefinition Height="30"/> <!-- 라인/모델 -->
                    <RowDefinition Height="30"/> <!-- 관리자 확인 -->
                </Grid.RowDefinitions>

                <!-- 병합된 제목 행: 분할 자재 라벨 -->
                <Border Grid.Row="0" Grid.ColumnSpan="2" BorderThickness="1" BorderBrush="Black" Background="White">
                    <TextBlock Text="분할 자재 라벨" FontSize="12" HorizontalAlignment="Center" VerticalAlignment="Center" Padding="5"/>
                </Border>

                <!-- 좌측 컬럼: 라벨명들 -->
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="1" Grid.Column="0">
                    <TextBlock Text="코드:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="2" Grid.Column="0">
                    <TextBlock Text="LOT:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="3" Grid.Column="0">
                    <TextBlock Text="업체:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="4" Grid.Column="0">
                    <TextBlock Text="라인/모델:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="5" Grid.Column="0">
                    <TextBlock Text="관리자 확인:" FontSize="8" VerticalAlignment="Center" Padding="5"/>
                </Border>

                <!-- 우측 컬럼: 텍스트 입력 (테두리 없이 배경 투명) -->
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="1" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="2" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="3" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="4" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
                <Border BorderThickness="1" BorderBrush="Black" Grid.Row="5" Grid.Column="1">
                    <TextBox FontSize="8" Background="Transparent" BorderThickness="0" VerticalContentAlignment="Center"/>
                </Border>
            </Grid>
            <!-- 표 구조 끝 -->
        </Viewbox>

        <!-- 출력 버튼 -->
        <Button Content="출력" Width="100" Height="30" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,20" Click="PrintButton_Click"/>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)
C# 코드에서 PrintDialog를 사용하여 PrintableArea를 PrintVisual로 인쇄합니다. Viewbox에 의해 화면에 보이는 크기와 관계없이 지정한 크기로 확대 또는 축소하여 인쇄됩니다.

csharp
코드 복사
using System.Windows;
using System.Windows.Controls;

namespace LabelPrinter
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private void PrintButton_Click(object sender, RoutedEventArgs e)
        {
            PrintDialog printDialog = new PrintDialog();
            if (printDialog.ShowDialog() == true)
            {
                // Viewbox가 포함된 PrintableArea를 전체적으로 인쇄
                printDialog.PrintVisual(PrintableArea, "Label Print");
            }
        }
    }
}
설명
Viewbox 사용: Grid를 Viewbox로 감쌌기 때문에, PrintDialog.PrintVisual을 호출할 때 Viewbox가 Grid와 하위 요소들을 자동으로 크기 조정합니다.
인쇄 크기 조정: Viewbox가 자동으로 크기를 조정하므로 별도의 DPI 변환이 필요 없습니다. 지정한 크기에 따라 출력할 때, 원하는 크기로 인쇄됩니다.