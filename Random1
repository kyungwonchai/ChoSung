private List<string> GetAllTabNames(string processName)
{
    List<string> tabNames = new List<string>();

    Process[] processes = Process.GetProcessesByName(processName);
    if (processes.Length == 0)
    {
        MessageBox.Show($"프로세스 '{processName}'을(를) 찾을 수 없습니다.");
        return tabNames;
    }

    Process targetProcess = processes[0];

    IntPtr mainWindowHandle = targetProcess.MainWindowHandle;
    if (mainWindowHandle == IntPtr.Zero)
    {
        MessageBox.Show($"프로세스 '{processName}'의 메인 윈도우 핸들을 가져올 수 없습니다.");
        return tabNames;
    }

    AutomationElement rootElement = AutomationElement.FromHandle(mainWindowHandle);
    AutomationElementCollection tabElements = rootElement.FindAll(TreeScope.Descendants, Condition.TrueCondition);
    foreach (AutomationElement tabElement in tabElements)
    {
        if (tabElement.Current.ControlType == ControlType.TabItem)
        {
            tabNames.Add(tabElement.Current.Name);
        }
    }

    return tabNames;
}

// 사용 예시
private void btnGetTabNames_Click(object sender, EventArgs e)
{
    string processName = "ExternalProcessName";

    List<string> tabNames = GetAllTabNames(processName);
    if (tabNames.Count > 0)
    {
        // 탭 이름을 사용하여 선택하도록 유저 인터페이스 구현
        // 예: 콤보박스에 탭 이름 추가하여 유저가 선택할 수 있도록 함
    }
    else
    {
        MessageBox.Show($"프로세스 '{processName}'에 탭이 없습니다.");
    }
}
