미지를 PictureBox에 표시하는 코드를 제공하겠습니다. 이 코드는 클릭을 주석 처리하여 검토할 수 있도록 하겠습니다.

전체 코드
csharp
코드 복사
using System;
using System.Drawing;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using AForge.Imaging;
using AForge.Imaging.Filters;

namespace CalendarClicker
{
    public partial class Form1 : Form
    {
        [DllImport("user32.dll")]
        static extern bool SetCursorPos(int X, int Y);

        [DllImport("user32.dll")]
        static extern void mouse_event(uint dwFlags, int dx, int dy, uint dwData, int dwExtraInfo);

        const uint MOUSEEVENTF_LEFTDOWN = 0x02;
        const uint MOUSEEVENTF_LEFTUP = 0x04;

        private Button clickButton;
        private PictureBox pictureBox;

        public Form1()
        {
            InitializeComponent();

            // 버튼 추가
            clickButton = new Button();
            clickButton.Text = "Detect and Highlight Green Areas";
            clickButton.Location = new Point(10, 10);
            clickButton.Click += new EventHandler(OnButtonClick);
            this.Controls.Add(clickButton);

            // PictureBox 추가
            pictureBox = new PictureBox();
            pictureBox.Location = new Point(10, 50);
            pictureBox.Size = new Size(800, 600);
            this.Controls.Add(pictureBox);
        }

        private void OnButtonClick(object sender, EventArgs e)
        {
            // 스크린샷 캡처
            Bitmap screenshot = CaptureScreen();

            // 필터 적용
            EuclideanColorFiltering filter = new EuclideanColorFiltering();
            filter.CenterColor = new RGB(Color.FromArgb(0, 255, 0)); // 녹색 중심
            filter.Radius = 100; // 색상 반경
            filter.ApplyInPlace(screenshot);

            // 그레이스케일 변환
            Grayscale grayscaleFilter = new Grayscale(0.2125, 0.7154, 0.0721);
            Bitmap grayImage = grayscaleFilter.Apply(screenshot);

            // 엣지 감지
            DifferenceEdgeDetector edgeDetector = new DifferenceEdgeDetector();
            Bitmap edges = edgeDetector.Apply(grayImage);

            // 윤곽선 찾기
            BlobCounter blobCounter = new BlobCounter();
            blobCounter.FilterBlobs = true;
            blobCounter.MinHeight = 10;
            blobCounter.MinWidth = 10;
            blobCounter.ProcessImage(edges);
            Blob[] blobs = blobCounter.GetObjectsInformation();

            using (Graphics g = Graphics.FromImage(screenshot))
            {
                foreach (Blob blob in blobs)
                {
                    // 클릭 위치 계산
                    int centerX = blob.Rectangle.X + blob.Rectangle.Width / 2;
                    int centerY = blob.Rectangle.Y + blob.Rectangle.Height / 2;

                    // 클릭 위치에 빨간 원 그리기
                    g.DrawEllipse(Pens.Red, centerX - 5, centerY - 5, 10, 10);

                    // 클릭 이벤트 시뮬레이션 (주석 처리)
                    // SetCursorPos(centerX, centerY);
                    // mouse_event(MOUSEEVENTF_LEFTDOWN, centerX, centerY, 0, 0);
                    // mouse_event(MOUSEEVENTF_LEFTUP, centerX, centerY, 0, 0);
                }
            }

            // PictureBox에 이미지 표시
            pictureBox.Image = screenshot;
        }

        private Bitmap CaptureScreen()
        {
            Rectangle bounds = Screen.GetBounds(Point.Empty);
            Bitmap bitmap = new Bitmap(bounds.Width, bounds.Height);

            using (Graphics g = Graphics.FromImage(bitmap))
            {
                g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
            }

            return bitmap;
        }
    }
}
주요 기능
버튼 추가: 버튼을 추가하여 클릭 시 녹색 영역을 감지하고 빨간 원으로 표시합니다.
PictureBox 추가: PictureBox를 추가하여 처리된 이미지를 표시합니다.
스크린 캡처: CaptureScreen 메서드를 사용하여 전체 화면을 캡처하고 Bitmap으로 반환합니다.
녹색 필터 적용: EuclideanColorFiltering을 사용하여 녹색 색상을 필터링합니다.
그레이스케일 변환: Grayscale 필터를 사용하여 이미지를 그레이스케일로 변환합니다.
엣지 감지: DifferenceEdgeDetector를 사용하여 엣지를 감지합니다.
윤곽선 찾기: BlobCounter를 사용하여 윤곽선을 찾고, 각 윤곽선의 중심에 빨간 원을 그립니다.
이미지 표시: PictureBox에 처리된 이미지를 표시합니다.
이 코드를 실행하면 버튼 클릭 시 전체 화면에서 녹색 영역을 감지하여 빨간 원으로 표시하고, 처리된 이미지를 PictureBox에 표시합니다. 필요한 경우 세부적인 부분을 조정하여 사용할 