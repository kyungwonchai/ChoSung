import pdfplumber

def extract_labeled_table_data(pdf_path):
    labeled_data = []
    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages):
            tables = page.extract_tables()
            for table_num, table in enumerate(tables):
                for row_idx, row in enumerate(table):
                    for col_idx, cell_text in enumerate(row):
                        if cell_text:  # 셀 내용이 있는 경우에만 추가
                            labeled_data.append({
                                'page': page_num + 1,
                                'table': table_num + 1,
                                'row': row_idx,
                                'col': col_idx,
                                'text': cell_text.strip()
                            })
    return labeled_data

# PDF 파일 경로
pdf_file = 'sample.pdf' 
# 함수 실행
extracted_data = extract_labeled_table_data(pdf_file)

# 결과 출력
for item in extracted_data:
    print(f"Page: {item['page']}, Table: {item['table']}, Row: {item['row']}, Col: {item['col']}, Text: '{item['text']}'")