C#에서 윈도우 프로그램을 삭제하려면 WMI (Windows Management Instrumentation)를 사용하여 설치된 프로그램을 찾아 제거할 수 있습니다. WMI를 이용해 프로그램을 삭제하는 방식은 사용자가 확인 창을 통해 프로그램 삭제를 승인할 수 있도록 할 수 있습니다. 아래는 이를 구현한 코드입니다.

csharp
코드 복사
using System;
using System.Management;
using System.Windows.Forms;

namespace UninstallApp
{
    public class Program
    {
        [STAThread]
        static void Main(string[] args)
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new UninstallForm());
        }
    }

    public class UninstallForm : Form
    {
        private TextBox programNameTextBox;
        private Button uninstallButton;

        public UninstallForm()
        {
            Text = "프로그램 삭제";
            Width = 300;
            Height = 150;

            Label label = new Label
            {
                Text = "삭제할 프로그램 이름:",
                Top = 20,
                Left = 10,
                Width = 200
            };
            programNameTextBox = new TextBox
            {
                Top = 50,
                Left = 10,
                Width = 200
            };
            uninstallButton = new Button
            {
                Text = "삭제",
                Top = 90,
                Left = 10,
                Width = 100
            };
            uninstallButton.Click += UninstallButton_Click;

            Controls.Add(label);
            Controls.Add(programNameTextBox);
            Controls.Add(uninstallButton);
        }

        private void UninstallButton_Click(object sender, EventArgs e)
        {
            string programName = programNameTextBox.Text.Trim();
            if (string.IsNullOrEmpty(programName))
            {
                MessageBox.Show("삭제할 프로그램 이름을 입력하세요.", "오류", MessageBoxButtons.OK, MessageBoxIcon.Error);
                return;
            }

            var result = MessageBox.Show($"{programName} 프로그램을 삭제하시겠습니까?", "삭제 확인", MessageBoxButtons.YesNo, MessageBoxIcon.Question);
            if (result == DialogResult.Yes)
            {
                bool uninstallSuccess = UninstallProgram(programName);
                if (uninstallSuccess)
                {
                    MessageBox.Show("프로그램이 성공적으로 삭제되었습니다.", "완료", MessageBoxButtons.OK, MessageBoxIcon.Information);
                }
                else
                {
                    MessageBox.Show("프로그램을 찾을 수 없거나 삭제할 수 없습니다.", "오류", MessageBoxButtons.OK, MessageBoxIcon.Error);
                }
            }
        }

        private bool UninstallProgram(string programName)
        {
            try
            {
                string query = $"SELECT * FROM Win32_Product WHERE Name = '{programName}'";
                using (ManagementObjectSearcher searcher = new ManagementObjectSearcher(query))
                using (ManagementObjectCollection results = searcher.Get())
                {
                    foreach (ManagementObject obj in results)
                    {
                        obj.InvokeMethod("Uninstall", null);
                        return true; // 삭제 성공 시 true 반환
                    }
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show($"오류 발생: {ex.Message}", "오류", MessageBoxButtons.OK, MessageBoxIcon.Error);
            }
            return false; // 삭제 실패 시 false 반환
        }
    }
}
코드 설명
Program Class: 애플리케이션 시작점으로, UninstallForm을 실행합니다.
UninstallForm Class: 프로그램 삭제 UI를 구성하며, 사용자에게 프로그램 이름을 입력받고 삭제 버튼을 제공합니다.
UninstallButton_Click: 사용자가 삭제 버튼을 클릭하면 삭제할 프로그램의 이름을 입력했는지 확인하고, 삭제를 진행할지 묻는 확인 창을 표시합니다.
UninstallProgram: WMI를 사용해 지정된 이름의 프로그램을 찾고, Uninstall 메서드를 호출하여 프로그램을 삭제합니다.
주의 사항
이 코드는 프로그램 이름을 정확하게 입력해야 작동합니다.