using System;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace PrinterSettingsExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void buttonChangeSettings_Click(object sender, EventArgs e)
        {
            try
            {
                // 프린터 설정 다이얼로그 생성
                PrintDialog printDialog = new PrintDialog();

                // 프린터 설정 다이얼로그에서 사용자가 설정을 선택하도록 합니다.
                if (printDialog.ShowDialog() == DialogResult.OK)
                {
                    // 사용자가 선택한 프린터 설정을 가져옵니다.
                    PrinterSettings printerSettings = printDialog.PrinterSettings;

                    // 여기에서 원하는 프린터 설정 변경을 수행합니다.
                    // 예를 들면, 용지 크기 변경:
                    printerSettings.DefaultPageSettings.PaperSize = new PaperSize("A4", 827, 1169); // 단위: 1/100 인치 (예시: A4 용지 크기)

                    // 변경된 설정을 현재 프린터에 적용합니다.
                    // (옵션) 만약, 프린터 설정 대화상자를 띄우지 않으려면 다음 코드를 사용합니다.
                    // PrintDocument printDocument = new PrintDocument();
                    // printDocument.PrinterSettings = printerSettings;

                    // 변경 내용을 저장하고 프린터에 적용합니다.
                    printerSettings.PrintToFile = false; // 프린터 설정 파일로 저장하지 않도록 설정 (false)
                    printerSettings.PrinterName = "YourPrinterName"; // 프린터 이름 지정 (예시: "HP LaserJet P1006")

                    // 변경된 프린터 설정을 적용합니다.
                    printDialog.PrinterSettings = printerSettings;
                }
            }
            catch (Exception ex)
            {
                // 오류 처리
                MessageBox.Show("프린터 설정을 변경하는 중 오류가 발생했습니다:\n" + ex.Message);
            }
        }
    }
}
