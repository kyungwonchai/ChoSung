private void StopQueueProcessing(CommandItem errorCommand)
{
    _isQueueStopped = true;

    App.Current.Dispatcher.Invoke(() =>
    {
        if (ErrorCommands.Count >= 20)
        {
            // 에러가 20개를 넘으면 가장 오래된 에러를 제거
            ErrorCommands.RemoveAt(0);
        }

        errorCommand.CommandTime = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss");  // 에러 발생 시간 기록
        ErrorCommands.Add(errorCommand);  // 새로운 에러 추가
    });

    ShowAlarm("Queue has been stopped due to a Timeout or failure.");
}
