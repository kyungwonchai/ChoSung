using DevExpress.XtraPivotGrid;

// PivotGridControl 생성
PivotGridControl pivotGrid = new PivotGridControl();

// PivotGrid 설정
pivotGrid.BeginUpdate();
pivotGrid.DataSource = table_rpa_runlog; // 테이블 조회 결과를 바인딩

PivotGridField fieldDate = new PivotGridField();
fieldDate.FieldName = "rpastart"; // 날짜 필드
fieldDate.Caption = "날짜";
fieldDate.Area = PivotArea.ColumnArea;
fieldDate.GroupInterval = PivotGroupInterval.Date; // 날짜별 그룹화
pivotGrid.Fields.Add(fieldDate);

PivotGridField fieldTask = new PivotGridField();
fieldTask.FieldName = "과제명"; // 과제명 필드
fieldTask.Caption = "과제명";
fieldTask.Area = PivotArea.RowArea;
pivotGrid.Fields.Add(fieldTask);

PivotGridField fieldSuccessCount = new PivotGridField();
fieldSuccessCount.FieldName = "mailok"; // 성공 횟수 필드
fieldSuccessCount.Caption = "성공 횟수";
fieldSuccessCount.Area = PivotArea.DataArea;
fieldSuccessCount.SummaryType = PivotSummaryType.Count;
fieldSuccessCount.FilterValues.Add(true); // 성공인 경우 필터링
pivotGrid.Fields.Add(fieldSuccessCount);

PivotGridField fieldAttemptCount = new PivotGridField();
fieldAttemptCount.FieldName = "mailok"; // 시도 횟수 필드
fieldAttemptCount.Caption = "시도 횟수";
fieldAttemptCount.Area = PivotArea.DataArea;
fieldAttemptCount.SummaryType = PivotSummaryType.Count;
pivotGrid.Fields.Add(fieldAttemptCount);

pivotGrid.EndUpdate();
