. SaveFileDialog는 사용자가 파일 저장 위치와 이름을 선택할 수 있게 해줍니다. 아래는 DevExpress Spreadsheet 기능을 사용하여 SQL 데이터를 Excel 파일로 저장할 때, 저장할 위치를 사용자에게 물어보는 전체 코드입니다.

먼저, NuGet 패키지 매니저 콘솔을 통해 필요한 DevExpress 패키지를 설치하세요:

powershell
코드 복사
Install-Package DevExpress.Document.Processor -Version 22.2.4
Install-Package DevExpress.Spreadsheet.Core -Version 22.2.4
그런 다음, C# 코드를 다음과 같이 작성합니다:

csharp
코드 복사
using System;
using System.Data.SqlClient;
using System.Windows.Forms;
using DevExpress.Spreadsheet;

private void btnSaveToExcel_Click(object sender, EventArgs e) {
    // 데이터베이스 연결 문자열
    string connectionString = "Data Source=서버이름;Initial Catalog=데이터베이스이름;Integrated Security=True";
    string query = "SELECT * FROM Employees";  // Excel로 저장할 테이블

    using (SqlConnection con = new SqlConnection(connectionString)) {
        SqlCommand cmd = new SqlCommand(query, con);
        con.Open();

        using (SqlDataReader reader = cmd.ExecuteReader()) {
            DevExpress.Spreadsheet.Workbook workbook = new DevExpress.Spreadsheet.Workbook();
            DevExpress.Spreadsheet.Worksheet worksheet = workbook.Worksheets[0];

            // 컬럼 헤더 설정
            for (int i = 0; i < reader.FieldCount; i++) {
                worksheet.Cells[0, i].Value = reader.GetName(i);
            }

            int row = 1;
            while (reader.Read()) {
                for (int i = 0; i < reader.FieldCount; i++) {
                    worksheet.Cells[row, i].Value = reader[i].ToString();
                }
                row++;
            }

            // 파일 저장 위치를 사용자에게 물어보기
            using (SaveFileDialog saveFileDialog = new SaveFileDialog()) {
                saveFileDialog.Filter = "Excel files (*.xlsx)|*.xlsx|All files (*.*)|*.*";
                saveFileDialog.FilterIndex = 1;
                saveFileDialog.RestoreDirectory = true;
                saveFileDialog.FileName = "Employees.xlsx";

                if (saveFileDialog.ShowDialog() == DialogResult.OK) {
                    string savePath = saveFileDialog.FileName;
                    workbook.SaveDocument(savePath);
                    MessageBox.Show("파일이 성공적으로 저장되었습니다: " + savePath, "저장 완료", MessageBoxButtons.OK, MessageBoxIcon.Information);
                }
            }
        }

        con.Close();
    }
}
이 코드는 사용자가 파일을 저장할 위치를 선택할 수 있도록 SaveFileDialog를 사용하여 파일 경로를 얻습니다. 그런 다음, DevExpress의 Workbook 객체를 사용하여 Excel 파일로 데이터를 저장합니다. 파일이 성공적으로 저장되면, 사용자에게 메시지 박스를 통해 알립니다.

위 코드를 통해 사용자에게 파일 저장 위치를 물어보고, 선택된 위치에 데