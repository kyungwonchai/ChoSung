-MM-dd HH:mm:ss 형식의 문자열로 날짜와 시간을 넣도록 수정된 코드는 다음과 같습니다:

vba
코드 복사
Sub UpdateShiftTimes()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim startDate As Date
    Dim endDate As Date
    Dim startTime As Date
    Dim endTime As Date
    Dim shift As Integer
    Dim i As Long
    
    ' 시트 설정
    Set ws = ThisWorkbook.Sheets("Sheet1") ' 필요한 시트 이름으로 변경
    
    ' 마지막 행 찾기
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' 각 행에 대해 반복
    For i = 2 To lastRow
        If IsDate(ws.Cells(i, 1).Value) And IsNumeric(ws.Cells(i, 3).Value) Then
            startDate = ws.Cells(i, 1).Value
            shift = ws.Cells(i, 3).Value
            startTime = ws.Cells(i, 10).Value
            endTime = ws.Cells(i, 11).Value
            
            ' 시작 시간과 날짜 계산 및 형식 지정
            ws.Cells(i, 12).Value = Format(startDate + startTime, "yyyy-MM-dd HH:mm:ss")
            
            ' 끝 시간과 날짜 계산 및 형식 지정
            If shift = 3 And endTime < TimeValue("07:00:00") Then
                ws.Cells(i, 13).Value = Format((startDate + 1) + endTime - 1, "yyyy-MM-dd HH:mm:ss") ' 날짜 하루 빼기
            Else
                ws.Cells(i, 13).Value = Format(startDate + endTime, "yyyy-MM-dd HH:mm:ss")
            End If
        End If
    Next i
End Sub
이 코드는 각 시간 계산 후 Format 함수를 사용하여 yyyy-MM-dd HH:mm:ss 형식의 문자열로 변환합니다. 이렇게 하면 시작 시간과 끝 시간이 원하는 형식으로 시트에 입력됩니다