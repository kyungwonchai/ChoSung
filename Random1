
C#에서 엑셀 파일을 처리하기 위해, EPPlus 라이브러리를 사용할 수 있습니다. 이 라이브러리는 엑셀 파일을 읽고 쓰는 데 유용합니다. 여기서는 EPPlus를 사용하여 지정된 조건에 따라 엑셀 시트의 데이터를 처리하는 예제 코드를 제공하겠습니다.

먼저, EPPlus 라이브러리를 프로젝트에 추가해야 합니다. NuGet 패키지 관리자를 통해 EPPlus를 설치할 수 있습니다.

다음은 요구사항에 맞춰 작성한 코드 예시입니다:

csharp
Copy code
using OfficeOpenXml;
using System;
using System.Drawing;
using System.IO;

class Program
{
    static void Main()
    {
        FileInfo fileInfo = new FileInfo("path/to/your/excel.xlsx");
        using (var package = new ExcelPackage(fileInfo))
        {
            var sheet = package.Workbook.Worksheets["Data"];
            for (int col = 2; col <= sheet.Dimension.End.Column; col++)
            {
                if (sheet.Cells[2, col].Style.Fill.BackgroundColor.Rgb == Color.White.ToArgb().ToString("X") ||
                    sheet.Cells[2, col].Style.Fill.BackgroundColor.Rgb == Color.Transparent.ToArgb().ToString("X"))
                {
                    if (int.TryParse(sheet.Cells[3, col].Text, out int currentValue) && currentValue <= 500)
                    {
                        if (col < sheet.Dimension.End.Column && string.IsNullOrEmpty(sheet.Cells[3, col + 1].Text))
                        {
                            if (int.TryParse(sheet.Cells[3, col - 1].Text, out int previousValue))
                            {
                                sheet.Cells[3, col].Value = currentValue + previousValue;
                            }
                        }
                        else if (col < sheet.Dimension.End.Column)
                        {
                            int nextCol = col + 1;
                            if (int.TryParse(sheet.Cells[3, nextCol].Text, out int nextValue))
                            {
                                sheet.Cells[3, nextCol].Value = currentValue + nextValue;
                            }
                        }
                    }
                }
            }

            package.Save();
        }
    }
}
이 코드는 다음과 같은 작업을 수행합니다:

지정된 엑셀 파일을 엽니다.
"Data" 시트를 선택합니다.
2열부터 마지막 열까지 반복합니다.
2행의 셀 배경색이 흰색이거나 투명색인 경우에만 조건을 체크합니다.
3행의 값이 500 이하인 숫자인 경우, 다음 열의 3행에 숫자가 없으면 현재 값과 이전 열의 값을 더합니다.
다음 열의 3행에 숫자가 있으면, 그 숫자에 현재 값을 더합니다.
변경된 내용을 저장합니다.
참고사항:

path/to/your/excel.xlsx는 실제 엑셀 파일의 경로로 변경해야 합니다.
엑셀 파일의 구조(셀의 배경색, 데이터 형식 등)에 따라 코드를 조정해야 할 수 있습니다.
EPPlus는 .NET Core와 .NET Framework 모두에서 사용할 수 있습니다.
이 코드는 최신 버전의 EPPlus와 .NET 환경에서 작동하도록 작성되었습니다