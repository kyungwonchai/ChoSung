다. STRING_AGG 함수는 SQL Server 2017 이상에서만 사용 가능하므로, SQL Server 2014에서는 다른 방법을 사용해야 합니다. 아래는 SQL Server 2014에서 동일한 작업을 수행하는 스토어드 프로시저 예시입니다.
MS SQL 스토어드 프로시저 예시

sql

CREATE PROCEDURE sp_InsertOrUpdate
    @N_datek DATE,
    @C_Site_Name NVARCHAR(50),
    @C_Resource_Name NVARCHAR(50),
    @C_Basic_Name__Fix_ NVARCHAR(50)
AS
BEGIN
    DECLARE @sql NVARCHAR(MAX);
    DECLARE @updateCols NVARCHAR(MAX) = '';

    -- 업데이트 할 컬럼 명을 가져옵니다.
    DECLARE @columnName NVARCHAR(128)
    DECLARE cur CURSOR FOR 
    SELECT column_name 
    FROM information_schema.columns 
    WHERE table_name = '메인확정'
    AND column_name NOT IN ('N_datek', 'C_Site_Name', 'C_Resource_Name', 'C_Basic_Name__Fix_')

    OPEN cur
    FETCH NEXT FROM cur INTO @columnName

    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @updateCols += @columnName + ' = source.' + @columnName + ', '
        FETCH NEXT FROM cur INTO @columnName
    END

    CLOSE cur
    DEALLOCATE cur

    -- 마지막 콤마(,) 제거
    SET @updateCols = LEFT(@updateCols, LEN(@updateCols) - 1)

    SET @sql = 'MERGE INTO 메인확정 AS target
                USING (SELECT @N_datek as N_datek, @C_Site_Name as C_Site_Name, @C_Resource_Name as C_Resource_Name, @C_Basic_Name__Fix_ as C_Basic_Name__Fix_) AS source
                ON target.N_datek = source.N_datek AND target.C_Site_Name = source.C_Site_Name AND target.C_Resource_Name = source.C_Resource_Name AND target.C_Basic_Name__Fix_ = source.C_Basic_Name__Fix_
                WHEN MATCHED THEN 
                    UPDATE SET ' + @updateCols +
                ' WHEN NOT MATCHED THEN
                    INSERT (N_datek, C_Site_Name, C_Resource_Name, C_Basic_Name__Fix_) VALUES (@N_datek, @C_Site_Name, @C_Resource_Name, @C_Basic_Name__Fix_);'

    EXEC sp_executesql @sql, 
                       N'@N_datek DATE, @C_Site_Name NVARCHAR(50), @C_Resource_Name NVARCHAR(50), @C_Basic_Name__Fix_ NVARCHAR(50)',
                       @N_datek, @C_Site_Name, @C_Resource_Name, @C_Basic_Name__Fix_;
END

이 스토어드 프로시저는 커서를 사용하여 SQL Server 2014에서 동일한 작업을 수행합니다. 키 컬럼인 N_datek, C_Site_Name, C_Resource_Name, C_Basic_Name__Fix_이 같으면 다른 모든 컬럼을 업데이트하고, 그렇지 않으면 새로운 레코드를 삽입합니