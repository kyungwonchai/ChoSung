 ë¬¸ì œ ì •ë¦¬ ë° í•´ê²° ë°©í–¥
ë°ì´í„° ì¡°íšŒ í›„ ì¦‰ì‹œ ë¹„ë™ê¸° ì²˜ë¦¬ í•„ìš” â†’ async Task ì‚¬ìš©í•˜ì—¬ awaitë¡œ ë¹„ë™ê¸° ì‹¤í–‰
ë§¤í¬ë¡œ ë™ì‘ì´ ì—¬ëŸ¬ ê°œì´ë¯€ë¡œ í•„ìš”í•œ ë™ì‘ ì„¸íŠ¸ ê´€ë¦¬ í•„ìš” â†’ íŒ¨í‚¤ì§€ ë‹¨ìœ„ë¡œ êµ¬ì„±
ê° íŒ¨í‚¤ì§€ëŠ” ë…ë¦½ëœ íŒŒì¼ë¡œ ë‘ê³  ë©”ì¸ì—ì„œ ì‹¤í–‰ â†’ ìœ ì§€ë³´ìˆ˜ì„±ê³¼ ê°€ë…ì„± í–¥ìƒ
ê° ë°ì´í„° í–‰ì„ íŠ¹ì • íŒ¨í‚¤ì§€ì—ì„œ ë§¤í¬ë¡œ ë™ì‘ìœ¼ë¡œ ë³€í™˜ ê°€ëŠ¥í•´ì•¼ í•¨
ğŸ“‚ 1. ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ êµ¬ì¡° (íŒ¨í‚¤ì§€ ê¸°ë°˜ ì„¤ê³„)
pgsql
ì½”ë“œ ë³µì‚¬
ğŸ“¦ AutoHandleSolution
 â”£ ğŸ“‚ AAutoHandle
 â”ƒ â”£ ğŸ“‚ Commands
 â”ƒ â”ƒ â”£ ğŸ“œ IMacroCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ KeyboardCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MouseClickCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ DelayCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ ScreenCaptureCommand.cs
 â”ƒ â”ƒ â”— ğŸ“œ CVCommand.cs
 â”ƒ â”£ ğŸ“‚ Core
 â”ƒ â”ƒ â”£ ğŸ“œ MacroExecutor.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroManager.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroLogger.cs
 â”ƒ â”£ ğŸ“‚ Database
 â”ƒ â”ƒ â”£ ğŸ“œ MySqlHelper.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MsSqlHelper.cs
 â”ƒ â”ƒ â”— ğŸ“œ DatabaseReader.cs
 â”ƒ â”£ ğŸ“‚ MacroPackages  â˜… ë§¤í¬ë¡œ ë™ì‘ íŒ¨í‚¤ì§€ ëª¨ìŒ
 â”ƒ â”ƒ â”£ ğŸ“œ MacroPackageA.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroPackageB.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroPackageC.cs
 â”ƒ â”£ ğŸ“‚ Forms
 â”ƒ â”ƒ â”— ğŸ“œ MainForm.cs
 â”ƒ â”£ ğŸ“œ Program.cs
 â”ƒ â”— ğŸ“œ AAutoHandle.csproj
 â”— ğŸ“œ AutoHandleSolution.sln
ğŸ“œ 2. ë¹„ë™ê¸° ë°ì´í„° ì¡°íšŒ ë° íŒ¨í‚¤ì§€ ê¸°ë°˜ ì²˜ë¦¬
ğŸ”¹ 1ï¸âƒ£ DatabaseReader.cs (ë¹„ë™ê¸° ë°ì´í„° ì¡°íšŒ ë° ì²˜ë¦¬)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using MySql.Data.MySqlClient;
    using System.Data.SqlClient;

    public class DatabaseReader
    {
        private readonly MySqlHelper _mySqlHelper;
        private readonly MsSqlHelper _msSqlHelper;

        public DatabaseReader(string mysqlConnString, string mssqlConnString)
        {
            _mySqlHelper = new MySqlHelper(mysqlConnString);
            _msSqlHelper = new MsSqlHelper(mssqlConnString);
        }

        public async Task ReadMySqlDataAsync(string procedureName, Func<DataRow, Task> processRow, params MySqlParameter[] parameters)
        {
            var table = _mySqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                await processRow(row);
            }
        }

        public async Task ReadMsSqlDataAsync(string procedureName, Func<DataRow, Task> processRow, params SqlParameter[] parameters)
        {
            var table = _msSqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                await processRow(row);
            }
        }
    }
}
âœ… Func<DataRow, Task> ì‚¬ìš©í•˜ì—¬ ë©”ì¸ í•¨ìˆ˜ì—ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ ê°€ëŠ¥!
âœ… ë°˜ë³µ ì²˜ë¦¬ë¥¼ awaitë¡œ ì‹¤í–‰í•˜ì—¬ ë™ì‘ ìˆœì„œê°€ ë³´ì¥ë¨

ğŸ”¹ 2ï¸âƒ£ MacroPackageA.cs (ë§¤í¬ë¡œ ë™ì‘ íŒ¨í‚¤ì§€ A)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.MacroPackages
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using AAutoHandle.Core;
    using AAutoHandle.Commands;

    public class MacroPackageA
    {
        public async Task ExecuteAsync(DataRow row)
        {
            var macroManager = MacroManager.Instance;

            int x = Convert.ToInt32(row["x"]);
            int y = Convert.ToInt32(row["y"]);
            string capturePath = row["capturePath"].ToString();

            macroManager.AddCommand(new MouseClickCommand(x, y));
            macroManager.AddCommand(new DelayCommand(500));
            macroManager.AddCommand(new ScreenCaptureCommand(capturePath));

            await macroManager.StartExecutionAsync();
        }
    }
}
âœ… ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ë™ì‘ì„ ì •ì˜í•˜ëŠ” íŒ¨í‚¤ì§€ A
âœ… ë°ì´í„° í–‰ ê°’ì— ë”°ë¼ ë§¤í¬ë¡œ ë™ì‘ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ

ğŸ”¹ 3ï¸âƒ£ MainForm.cs (UIì—ì„œ ë™ì‘ ì‹¤í–‰)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Data;
using System.Threading.Tasks;
using System.Windows.Forms;
using AAutoHandle.Database;
using AAutoHandle.MacroPackages;
using MySql.Data.MySqlClient;
using System.Data.SqlClient;

namespace AAutoHandle
{
    public partial class MainForm : Form
    {
        private DatabaseReader _dbReader;
        private MacroPackageA _macroPackageA;

        public MainForm()
        {
            InitializeComponent();

            string mysqlConn = "Server=localhost;Database=mydb;User=root;Password=1234;";
            string mssqlConn = "Server=myserver;Database=mydb;User Id=myuser;Password=mypassword;";

            _dbReader = new DatabaseReader(mysqlConn, mssqlConn);
            _macroPackageA = new MacroPackageA();
        }

        private async void btnLoadMySqlData_Click(object sender, EventArgs e)
        {
            listBoxLogs.Items.Clear();
            await _dbReader.ReadMySqlDataAsync("sp_GetData",
                async row =>
                {
                    listBoxLogs.Items.Add($"{row["id"]}: {row["name"]}");
                    await _macroPackageA.ExecuteAsync(row);
                });
        }

        private async void btnLoadMsSqlData_Click(object sender, EventArgs e)
        {
            listBoxLogs.Items.Clear();
            await _dbReader.ReadMsSqlDataAsync("sp_GetData",
                async row =>
                {
                    listBoxLogs.Items.Add($"{row["id"]}: {row["name"]}");
                    await _macroPackageA.ExecuteAsync(row);
                });
        }
    }
}
âœ… DatabaseReaderì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ MacroPackageAì—ì„œ ìë™ ì‹¤í–‰!
âœ… UI ListBoxì—ë„ ë°”ë¡œ ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë¨

ğŸ“œ 3. ì‹¤í–‰ íë¦„
âœ… btnLoadMySqlData_Click() ì‹¤í–‰ â†’
MySQL sp_GetData í”„ë¡œì‹œì € ì‹¤í–‰ â†’ DataRow ê°€ì ¸ì˜¤ê¸°
MacroPackageA.ExecuteAsync(row) ë¹„ë™ê¸° ì‹¤í–‰
ë§ˆìš°ìŠ¤ í´ë¦­ â†’ 0.5ì´ˆ ë”œë ˆì´ â†’ í™”ë©´ ìº¡ì²˜ ì‹¤í–‰
ListBoxì— ë°ì´í„°ë„ ì¶”ê°€ë¨
ğŸ“œ 4. í™•ì¥ ê°€ëŠ¥ì„±
âœ… í•„ìš”í•œ ë™ì‘ ì„¸íŠ¸(íŒ¨í‚¤ì§€)ë§Œ ê³¨ë¼ ì‹¤í–‰ ê°€ëŠ¥!
âœ… íŒ¨í‚¤ì§€ ì¶”ê°€ ì‹œ MacroPackageB.cs, MacroPackageC.cs ë“± ìƒì„±í•˜ë©´ ë
âœ… ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ìë™ ì‹¤í–‰ì´ë¯€ë¡œ ìœ ì—°ì„±ì´ ê·¹ëŒ€í™”ë¨
âœ… UIì—ì„œ ë²„íŠ¼ í•˜ë‚˜ë§Œ ëˆŒëŸ¬ë„ ì—¬ëŸ¬ ë§¤í¬ë¡œ ë™ì‘ì´ ìˆœì°¨ ì‹¤í–‰ë¨

ğŸ“Œ ê²°ë¡ 
ë°ì´í„° ì¡°íšŒ â†’ ì¦‰ì‹œ ë¹„ë™ê¸° ì²˜ë¦¬ (async Task)
íŒ¨í‚¤ì§€ ë‹¨ìœ„ë¡œ ë§¤í¬ë¡œ ë™ì‘ì„ ì •ì˜ (MacroPackages)
UIì—ì„œ í•„ìš”í•œ íŒ¨í‚¤ì§€ë§Œ ê³¨ë¼ ì‹¤í–‰
ë§¤í¬ë¡œ ë™ì‘ì´ ë³µì¡í•´ì ¸ë„ íŒ¨í‚¤ì§€ë³„ íŒŒì¼ ë¶„ë¦¬ë¡œ ê°€ë…ì„± ìœ ì§€