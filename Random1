import bpy
from math import radians

# 기존 씬의 모든 오브젝트 삭제
bpy.ops.object.select_all(action='SELECT')
bpy.ops.object.delete(use_global=False)

# 텍스트 오브젝트 추가
bpy.ops.object.text_add(location=(0, 0, 0))
text_obj = bpy.context.object
text_obj.data.body = "Router ACR Middleware"  # 텍스트 내용 설정
text_obj.data.size = 3.0  # 텍스트 크기 증가

# 3D 효과를 위한 두께 추가
text_obj.data.extrude = 0.3
text_obj.data.bevel_depth = 0.03  # 모서리 둥글게 설정

# 재질 추가 및 설정
mat = bpy.data.materials.new(name="TextMaterial")
mat.use_nodes = True
bsdf = mat.node_tree.nodes["Principled BSDF"]
bsdf.inputs['Base Color'].default_value = (1, 0.84, 0, 1)  # 황금색 설정
bsdf.inputs['Roughness'].default_value = 0.2  # 광택을 높여 반사감 추가
text_obj.data.materials.append(mat)

# 카메라 설정 (텍스트 전체가 화면에 꽉 차도록 조정)
bpy.ops.object.camera_add(location=(0, -8, 1))
camera = bpy.context.object
camera.rotation_euler = (radians(90), 0, radians(0))  # 텍스트 정면에서 바라보게 설정
bpy.context.scene.camera = camera

# 광원 설정 - 황금 시간대 느낌 조명 추가
bpy.ops.object.light_add(type='SUN', location=(5, -5, 10))
sun_light = bpy.context.object
sun_light.data.energy = 5
sun_light.data.color = (1, 0.75, 0.5)
sun_light.rotation_euler = (radians(45), radians(-20), 0)

# 배경 투명하게 설정
bpy.context.scene.render.film_transparent = True  # 투명 배경 설정

# 렌더링 설정
bpy.context.scene.render.engine = 'CYCLES'
bpy.context.scene.cycles.samples = 500
bpy.context.scene.render.resolution_x = 1920
bpy.context.scene.render.resolution_y = 1080
bpy.context.scene.render.image_settings.file_format = 'PNG'  # PNG 포맷으로 설정
bpy.context.scene.render.image_settings.color_mode = 'RGBA'  # 알파 채널 포함

# 파일 저장 경로 설정 (예시: 바탕화면 경로)
bpy.context.scene.render.filepath = "C:/Users/YourUsername/Desktop/router_acr_middleware_render.png"

# 렌더링 실행
bpy.ops.render.render(write_still=True)
