using System;
using System.Windows.Forms;
using Microsoft.Web.WebView2.WinForms;

namespace WebView2CtrlCTest
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
            InitializeAsync();
        }

        async void InitializeAsync()
        {
            await webView.EnsureCoreWebView2Async(null);
            webView.CoreWebView2.Settings.AreDefaultContextMenusEnabled = false; // 기본 컨텍스트 메뉴를 비활성화합니다.
            webView.CoreWebView2.AcceleratorKeyPressed += CoreWebView2_AcceleratorKeyPressed;
        }

        private void CoreWebView2_AcceleratorKeyPressed(object sender, Microsoft.Web.WebView2.Core.CoreWebView2AcceleratorKeyPressedEventArgs e)
        {
            if (e.VirtualKey == 67 && e.KeyEventKind == Microsoft.Web.WebView2.Core.CoreWebView2KeyEventKind.KeyDown) // 67 = 'C'
            {
                if ((ModifierKeys & Keys.Control) == Keys.Control)
                {
                    // WebView2의 현재 선택한 텍스트를 클립보드에 복사
                    webView.CoreWebView2.ExecuteScriptAsync("window.getSelection().toString()").ContinueWith(task =>
                    {
                        string selectedText = task.Result;
                        Clipboard.SetText(selectedText);
                        MessageBox.Show("텍스트가 클립보드에 복사되었습니다.");
                    });
                }
            }
        }
    }
}
