ngname을 괄호 앞까지 분리하고, 괄호 뒤부터는 무시하도록 수정된 쿼리를 작성하겠습니다.

수정된 쿼리:
sql
코드 복사
SELECT 
    *,
    SUBSTRING(
        ReceivedMessage,
        CHARINDEX('send:', ReceivedMessage) + 5, 
        CHARINDEX(' ', ReceivedMessage + ' ', CHARINDEX('send:', ReceivedMessage) + 5) - CHARINDEX('send:', ReceivedMessage) - 5
    ) AS magno,
    SUBSTRING(
        ReceivedMessage,
        CHARINDEX('receive:', ReceivedMessage) + 8, 
        CHARINDEX('(', ReceivedMessage + '(', CHARINDEX('receive:', ReceivedMessage) + 8) - CHARINDEX('receive:', ReceivedMessage) - 8
    ) AS ngname
FROM YourTableName
WHERE CHARINDEX('send:', ReceivedMessage) > 0 AND CHARINDEX('receive:', ReceivedMessage) > 0;
쿼리 설명:
magno 추출:

동일하게 send: 이후 첫 공백까지의 문자열을 추출.
ngname 추출:

CHARINDEX('receive:', ReceivedMessage)로 receive:의 위치를 찾습니다.
+8을 더해 receive: 뒤의 첫 번째 문자의 위치를 계산합니다.
그 이후 괄호 (의 위치를 찾아 해당 위치까지만 추출합니다.
나머지 처리:

괄호 뒤의 문자는 무시합니다.
실행 예시:
ReceivedMessage 예제 데이터:

kotlin
코드 복사
send: MAG001 receive: NGNameExample (extra data)
send: MAG002 receive: AnotherNGName (discard this)
결과:

ReceivedMessage	magno	ngname
send: MAG001 receive: NGNameExample (extra data)	MAG001	NGNameExample