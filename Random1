Sub 병합계획과SOP파일병합()
    Dim 파일1 As Variant
    Dim 파일2 As Variant
    Dim wb1 As Workbook
    Dim wb2 As Workbook
    Dim ws1 As Worksheet
    Dim ws2 As Worksheet
    Dim 목표시트 As Worksheet
    
    ' 두 개의 엑셀 파일 선택
    파일1 = Application.GetOpenFilename("Excel 파일 (*.xlsx), *.xlsx")
    파일2 = Application.GetOpenFilename("Excel 파일 (*.xlsx), *.xlsx")
    
    If 파일1 = "False" Or 파일2 = "False" Then
        MsgBox "파일을 선택하지 않았습니다. 작업을 종료합니다."
        Exit Sub
    End If
    
    ' 선택한 파일 열기
    Set wb1 = Workbooks.Open(파일1)
    Set wb2 = Workbooks.Open(파일2)
    
    ' 첫 번째 파일에서 통합계획으로 시작하는 시트 확인
    For Each ws1 In wb1.Sheets
        If Left(ws1.Name, 5) = "통합계획" Then
            Set 목표시트 = ws1
            Exit For
        End If
    Next ws1
    
    ' 두 번째 파일에서 SOP로 시작하는 시트 확인
    For Each ws2 In wb2.Sheets
        If Left(ws2.Name, 3) = "SOP" Then
            ' SPI계획 시트로 복사
            On Error Resume Next
            wb1.Sheets("SPI계획").Delete ' 기존 시트 삭제
            On Error GoTo 0
            ws2.Copy After:=wb1.Sheets(wb1.Sheets.Count)
            ActiveSheet.Name = "SPI계획"
            Exit For
        End If
    Next ws2
    
    ' 병합된 파일 저장
    wb1.Save
    wb1.Close
    wb2.Close
    
    MsgBox "작업이 완료되었습니다."
End Sub
