 시트의 특정 영역 전체를 복사한 후 텍스트 파일로 내보낼 때 따옴표를 제거하고 줄바꿈을 유지하는 코드입니다.
이 코드는 지정된 범위(또는 전체 시트)의 값을 텍스트 파일에 태그 포함 형태로 저장합니다.

VBA 코드: 시트 영역 전체 내보내기
vba
코드 복사
Sub ExportRangeToTextFile()
    Dim ws As Worksheet
    Dim rng As Range
    Dim filePath As String
    Dim fileNum As Integer
    Dim row As Range
    Dim cell As Range
    Dim outputLine As String
    
    ' 작업할 시트 설정
    Set ws = ThisWorkbook.Sheets(1) ' 1번 시트 기준
    Set rng = ws.UsedRange ' 시트 전체 영역 지정 (UsedRange: 데이터가 있는 범위만)
    
    ' 파일 저장 경로 설정
    filePath = Application.GetSaveAsFilename("ExportedFile.txt", "Text Files (*.txt), *.txt")
    If filePath = "False" Then Exit Sub ' 사용자가 취소한 경우
    
    ' 파일 열기
    fileNum = FreeFile
    Open filePath For Output As #fileNum
    
    ' 파일에 <value> 태그 추가
    Print #fileNum, "<value>"
    
    ' 범위의 각 행과 셀 처리
    For Each row In rng.Rows
        outputLine = "" ' 행 데이터 초기화
        For Each cell In row.Cells
            ' 셀 값 가져오기 및 탭으로 구분
            outputLine = outputLine & cell.Value & vbTab
        Next cell
        
        ' 마지막 탭 제거 및 줄바꿈 추가
        outputLine = Left(outputLine, Len(outputLine) - 1)
        Print #fileNum, outputLine
    Next row
    
    ' 파일에 </value> 태그 추가
    Print #fileNum, "</value>"
    
    ' 파일 닫기
    Close #fileNum
    
    MsgBox "시트 내용이 텍스트 파일로 저장되었습니다!", vbInformation
End Sub
코드 설명
UsedRange 사용
UsedRange를 사용하여 시트의 데이터가 있는 범위만 처리합니다.

파일에 쓰기

각 행의 값을 가져와서 탭(vbTab)으로 셀 값을 구분합니다.
줄바꿈은 Print를 통해 자동으로 추가됩니다.
태그 추가

파일의 시작에 <value>를 추가하고 끝에 </value>를 추가합니다.
결과 예시
엑셀 데이터가 아래와 같다고 가정:

makefile
코드 복사
A1: v1   B1: w1
A2: v2   B2: w2
저장된 파일 내용:

php
코드 복사
<value>
v1   w1
v2   w2
</value>
실행 방법
VBA 에디터 열기
Alt + F11을 누르고 새로운 모듈을 추가합니다.

코드 복사
위의 코드를 붙여넣습니다.

매크로 실행
Alt + F8을 누른 후 ExportRangeToTextFile 매크로를 실행합니다.

파일 저장
파일 저장 창이 나타나면 경로와 파일명을 지정합니다.

확인
메모장에서 파일을 열어보면 따옴표 없이 태그와 텍스트만 출력됩니다.