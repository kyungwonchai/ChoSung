using DevExpress.XtraGrid;
using DevExpress.XtraGrid.Views.Grid;
using DevExpress.XtraGrid.Columns;
using DevExpress.XtraGrid.Views.Base;
using DevExpress.XtraGrid.Views.Grid.ViewInfo;
using System.Drawing;

// GridControl 및 GridView 생성
GridControl gridControl1 = new GridControl();
GridView gridView1 = new GridView(gridControl1);

// 데이터 소스 설정
gridControl1.DataSource = GetViewData(); // View_AOITimeSyncNG 테이블 데이터를 가져오는 함수(GetViewData)를 사용하시면 됩니다.

// 컬럼 설정
gridView1.Columns["timediff1"].Caption = "timediff1";
gridView1.Columns["nptserer"].Caption = "nptserer";
gridView1.Columns["ver"].Caption = "ver";
gridView1.Columns["runtime1"].Caption = "runtime1";

// 컬럼에 따른 셀 스타일 설정
gridView1.CustomDrawCell += GridView1_CustomDrawCell;

// GridControl에 GridView 설정
gridControl1.MainView = gridView1;
gridControl1.Dock = DockStyle.Fill;

// 폼에 GridControl 추가
this.Controls.Add(gridControl1);

// GridView의 CustomDrawCell 이벤트 핸들러
private void GridView1_CustomDrawCell(object sender, RowCellCustomDrawEventArgs e)
{
    GridView view = sender as GridView;
    if (e.Column.FieldName == "timediff1")
    {
        int? timediff1 = view.GetRowCellValue(e.RowHandle, "timediff1") as int?;
        if (timediff1.HasValue && timediff1.Value > 5)
        {
            e.Appearance.BackColor = Color.Yellow;
        }
    }
    else if (e.Column.FieldName == "nptserer")
    {
        string nptserer = view.GetRowCellValue(e.RowHandle, "nptserer") as string;
        if (!string.IsNullOrEmpty(nptserer) && !nptserer.Contains("10.244"))
        {
            e.Appearance.BackColor = Color.Yellow;
        }
    }
    else if (e.Column.FieldName == "ver")
    {
        string ver = view.GetRowCellValue(e.RowHandle, "ver") as string;
        if (!string.IsNullOrEmpty(ver) && !ver.StartsWith("ver23"))
        {
            e.Appearance.BackColor = Color.Yellow;
        }
    }
    else if (e.Column.FieldName == "runtime1")
    {
        int? runtime1 = view.GetRowCellValue(e.RowHandle, "runtime1") as int?;
        if (runtime1.HasValue && runtime1.Value >= 5)
        {
            e.Appearance.BackColor = Color.Yellow;
        }
    }
}
