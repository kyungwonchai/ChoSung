using System.Windows.Forms;
using System.Windows.Forms.Integration;

public partial class MainForm : Form
{
    public MainForm()
    {
        InitializeComponent();
    }

    private void OpenWpfFormButton_Click(object sender, EventArgs e)
    {
        WpfWindow wpfWindow = new WpfWindow();
        wpfWindow.VariableA = "Value for VariableA";

        ElementHost elementHost = new ElementHost();
        elementHost.Dock = DockStyle.Fill;
        elementHost.Child = wpfWindow;

        UserControlB userControlB = new UserControlB();
        userControlB.Controls.Add(elementHost);

        Form formB = new Form();
        formB.Controls.Add(userControlB);
        formB.Show();
    }
}
