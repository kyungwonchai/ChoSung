-- FILE_ID: SQL/AppSettings_AddSupportNames_20250411093000

USE LockerManagementDB; -- ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ í™•ì¸
GO

-- ê¸°ëŠ¥ë¬¸ì˜ ë‹´ë‹¹ì ì´ˆê¸°ê°’ ì„¤ì •
IF NOT EXISTS (SELECT 1 FROM dbo.AppSettings WHERE SettingKey = 'FeatureSupportName')
    INSERT INTO dbo.AppSettings (SettingKey, SettingValue) VALUES ('FeatureSupportName', 'í™ê¸¸ë™');
ELSE
    UPDATE dbo.AppSettings SET SettingValue = 'í™ê¸¸ë™' WHERE SettingKey = 'FeatureSupportName' AND SettingValue IS NULL; -- ê¸°ì¡´ ê°’ì´ ì—†ì„ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸ (ì„ íƒ ì‚¬í•­)

PRINT 'FeatureSupportName ì„¤ì • í™•ì¸/ì¶”ê°€ ì™„ë£Œ.';

-- ì‹œìŠ¤í…œë¬¸ì˜ ë‹´ë‹¹ì ì´ˆê¸°ê°’ ì„¤ì •
IF NOT EXISTS (SELECT 1 FROM dbo.AppSettings WHERE SettingKey = 'SystemSupportName')
    INSERT INTO dbo.AppSettings (SettingKey, SettingValue) VALUES ('SystemSupportName', 'ê¹€ì² ìˆ˜');
ELSE
    UPDATE dbo.AppSettings SET SettingValue = 'ê¹€ì² ìˆ˜' WHERE SettingKey = 'SystemSupportName' AND SettingValue IS NULL; -- ê¸°ì¡´ ê°’ì´ ì—†ì„ ê²½ìš°ì—ë§Œ ì—…ë°ì´íŠ¸ (ì„ íƒ ì‚¬í•­)

PRINT 'SystemSupportName ì„¤ì • í™•ì¸/ì¶”ê°€ ì™„ë£Œ.';
GO
```

---

**2. `Models/AppSetting.cs` (ìµœì¢… í™•ì¸ìš©)**


```csharp
// FILE_ID: Models/AppSetting_20250410104500
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;
using LockerManagementApp.Infrastructure;

namespace LockerManagementApp.Models
{
    [Table("AppSettings")]
    public class AppSetting : ViewModelBase
    {
        private string _settingKey;
        private string _settingValue;

        [Key]
        [StringLength(100)]
        public string SettingKey
        {
            get => _settingKey;
            set => SetProperty(ref _settingKey, value);
        }

        [Column(TypeName = "NVARCHAR(MAX)")]
        public string SettingValue
        {
            get => _settingValue;
            set => SetProperty(ref _settingValue, value);
        }
    }
}
```

---

**3. `Data/LockerDbContext.cs` (ìµœì¢… í™•ì¸ìš©)**

(IP ë¡œê¹…, ë¹„ë²ˆ ë¡œê·¸ ì œì™¸, SaveChanges ì¬ì •ì˜ ë°©ì‹, `DbSet<AppSetting>` í¬í•¨ ë²„ì „)


```csharp
// FILE_ID: Data/LockerDbContext_20250411092500
using LockerManagementApp.Models;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data.Entity;
using System.Data.Entity.Infrastructure;
using System.Data.Entity.Validation;
using System.Linq;
using System.Threading.Tasks;
using Newtonsoft.Json;
using System.Diagnostics;
using System.Data.SqlClient;
using System.Data.Entity.Core;
using System.Threading;
using System.ComponentModel.DataAnnotations.Schema;
using System.Net;

namespace LockerManagementApp.Data
{
    public class LockerDbContext : DbContext
    {
        public DbSet<LockerAssignment> LockerAssignments { get; set; }
        public DbSet<AuditLog> AuditLogs { get; set; }
        public DbSet<LockerType> LockerTypes { get; set; }
        public DbSet<Floor> Floors { get; set; }
        public DbSet<Zone> Zones { get; set; }
        public DbSet<SubPart> SubParts { get; set; }
        public DbSet<Administrator> Administrators { get; set; }
        public DbSet<AppSetting> AppSettings { get; set; }

        private const string ConnectionStringName = "LockerDbConnection";

        public LockerDbContext() : base(GetConnectionString())
        {
             Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] LockerDbContext instance created.");
        }

        private static string GetConnectionString()
        {
            try { var cs = ConfigurationManager.ConnectionStrings[ConnectionStringName]; if (cs == null || string.IsNullOrWhiteSpace(cs.ConnectionString)) throw new ConfigurationErrorsException($"App.configì—ì„œ '{ConnectionStringName}' ì—°ê²° ë¬¸ìì—´ ì—†ìŒ/ë¹„ì–´ìˆìŒ."); Debug.WriteLine($"ConnectionString '{ConnectionStringName}' ë¡œë“œ ì„±ê³µ."); return cs.ConnectionString; }
            catch (ConfigurationErrorsException confEx) { Debug.WriteLine($"!!! ì„¤ì • íŒŒì¼ ì˜¤ë¥˜: {confEx.ToString()}"); throw new Exception("App.config ì„¤ì • ì˜¤ë¥˜.", confEx); }
            catch (Exception ex) { Debug.WriteLine($"!!! ì—°ê²° ë¬¸ìì—´ ë¡œë“œ ì¤‘ ì˜ˆì™¸: {ex.ToString()}"); throw new Exception($"App.config ì—°ê²° ë¬¸ìì—´ ì½ê¸° ì˜¤ë¥˜.", ex); }
        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<LockerAssignment>().Property(p => p.UserName).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.KnoxId).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.SubPart).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.Administrator).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.TransferStatus).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.Details).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.Remarks).IsOptional();
            modelBuilder.Entity<LockerAssignment>().Property(p => p.Notes).IsOptional();
            modelBuilder.Entity<AppSetting>().HasKey(s => s.SettingKey);
            base.OnModelCreating(modelBuilder);
        }

        protected override DbEntityValidationResult ValidateEntity(DbEntityEntry entityEntry, IDictionary<object, object> items)
        {
            var result = base.ValidateEntity(entityEntry, items);
            if (entityEntry.Entity is LockerAssignment assignment && (entityEntry.State == EntityState.Added || entityEntry.State == EntityState.Modified)) { var userNameErrors = result.ValidationErrors.Where(err => err.PropertyName == nameof(LockerAssignment.UserName) && string.IsNullOrWhiteSpace(assignment.UserName)).ToList(); if (userNameErrors.Any()) { Debug.WriteLine($"ê²½ê³ : LockerAssignment(ID:{assignment.Id})ì˜ UserName í•„ìˆ˜ ì˜¤ë¥˜ ë¬´ì‹œ."); foreach (var error in userNameErrors) { result.ValidationErrors.Remove(error); } } }
            return result;
        }

        #region SaveChanges Overrides for Audit Logging

        public override int SaveChanges()
        {
            Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] SaveChanges(ë™ê¸°) Override ì‹œì‘...");
            List<AuditLog> auditEntries = null;
            try { auditEntries = CreateAuditEntries(); Debug.WriteLine($"  -> ìƒì„±ëœ ë¡œê·¸ ìˆ˜ = {auditEntries?.Count ?? 0}"); }
            catch (Exception ex) { Debug.WriteLine($"!!! ê°ì‚¬ ë¡œê·¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {ex.ToString()}"); }

            if (auditEntries != null && auditEntries.Any()) { try { this.AuditLogs.AddRange(auditEntries); Debug.WriteLine($"  -> ë¡œê·¸ {auditEntries.Count}ê°œ AddRange ì™„ë£Œ."); } catch (Exception ex) { Debug.WriteLine($"!!! ê°ì‚¬ ë¡œê·¸ AddRange ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {ex.ToString()}"); } }
            else { Debug.WriteLine("  -> ì¶”ê°€í•  ë¡œê·¸ ì—†ìŒ."); }

            try { Debug.WriteLine($"  -> base.SaveChanges() í˜¸ì¶œ ì‹œë„..."); var result = base.SaveChanges(); Debug.WriteLine($"  -> base.SaveChanges() ì™„ë£Œ. ê²°ê³¼ = {result}"); return result; }
            catch (DbEntityValidationException vex) { LogValidationErrors(vex); throw; }
            catch (DbUpdateException dbEx) { LogDbUpdateException(dbEx); throw; }
            catch (Exception ex) { Debug.WriteLine($"!!! SaveChanges ì¤‘ ì¼ë°˜ ì˜¤ë¥˜ (ë™ê¸°): {ex.ToString()}"); throw; }
            finally { Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] SaveChanges(ë™ê¸°) Override ì¢…ë£Œ."); }
        }

        public override async Task<int> SaveChangesAsync(CancellationToken cancellationToken)
        {
             Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] SaveChangesAsync(CancellationToken) Override ì‹œì‘...");
             List<AuditLog> auditEntries = null;
            try { auditEntries = CreateAuditEntries(); Debug.WriteLine($"  -> ìƒì„±ëœ ë¡œê·¸ ìˆ˜ = {auditEntries?.Count ?? 0}"); }
            catch (Exception ex) { Debug.WriteLine($"!!! ê°ì‚¬ ë¡œê·¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {ex.ToString()}"); }

            if (auditEntries != null && auditEntries.Any()) { try { this.AuditLogs.AddRange(auditEntries); Debug.WriteLine($"  -> ë¡œê·¸ {auditEntries.Count}ê°œ AddRange ì™„ë£Œ."); } catch (Exception ex) { Debug.WriteLine($"!!! ê°ì‚¬ ë¡œê·¸ AddRange ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {ex.ToString()}"); } }
             else { Debug.WriteLine("  -> ì¶”ê°€í•  ë¡œê·¸ ì—†ìŒ."); }

            try { Debug.WriteLine($"  -> base.SaveChangesAsync(cancellationToken) í˜¸ì¶œ ì‹œë„..."); var result = await base.SaveChangesAsync(cancellationToken); Debug.WriteLine($"  -> base.SaveChangesAsync(cancellationToken) ì™„ë£Œ. ê²°ê³¼ = {result}"); return result; }
            catch (DbEntityValidationException vex) { LogValidationErrors(vex); throw; }
            catch (DbUpdateException dbEx) { LogDbUpdateException(dbEx); throw; }
            catch (OperationCanceledException) { Debug.WriteLine("SaveChangesAsync(CancellationToken) ì‘ì—… ì·¨ì†Œë¨."); throw; }
            catch (Exception ex) { Debug.WriteLine($"!!! SaveChangesAsync(CancellationToken) ì¤‘ ì¼ë°˜ ì˜¤ë¥˜ (ë¹„ë™ê¸°): {ex.ToString()}"); throw; }
            finally { Debug.WriteLine($"[{DateTime.Now:HH:mm:ss.fff}] SaveChangesAsync(CancellationToken) Override ì¢…ë£Œ."); }
        }

        private List<AuditLog> CreateAuditEntries()
        {
            Debug.WriteLine("  CreateAuditEntries ì‹œì‘...");
            string userIdentifier = GetLocalIPAddress();
            var auditEntries = new List<AuditLog>();
            var changedEntries = ChangeTracker.Entries().Where(e => e.State != EntityState.Unchanged && e.State != EntityState.Detached).ToList();

            if (!changedEntries.Any()) { Debug.WriteLine("  CreateAuditEntries: ê°ì§€ëœ ë³€ê²½ ì—”í‹°í‹° ì—†ìŒ."); return auditEntries; }

            Debug.WriteLine($"  CreateAuditEntries: ê°ì§€ëœ ë³€ê²½ ì—”í‹°í‹° ìˆ˜ = {changedEntries.Count}");
            var jsonSettings = new JsonSerializerSettings { ReferenceLoopHandling = ReferenceLoopHandling.Ignore, PreserveReferencesHandling = PreserveReferencesHandling.None, Formatting = Formatting.None };

            foreach (var entry in changedEntries)
            {
                if (entry.Entity is AuditLog) { Debug.WriteLine("    - AuditLog ì—”í‹°í‹° ë³€ê²½ ê°ì§€ë¨ (ë¡œê¹… ê±´ë„ˆëœ€)."); continue; }
                if (entry.Entity is AppSetting appSetting && (appSetting.SettingKey == "MasterKey" || appSetting.SettingKey == "NormalKey")) { Debug.WriteLine($"    - AppSetting (Key={appSetting.SettingKey}) ë³€ê²½ ê°ì§€ë¨ (ë¡œê¹… ê±´ë„ˆëœ€)."); continue; }

                var auditEntry = new AuditLog { Timestamp = DateTime.Now, UserName = userIdentifier, TableName = entry.Entity.GetType().Name, Action = entry.State.ToString() };
                try { auditEntry.RecordId = entry.State == EntityState.Deleted ? entry.OriginalValues["Id"]?.ToString() : entry.CurrentValues["Id"]?.ToString() ?? "N/A"; } catch (Exception ex) { Debug.WriteLine($"    - ê°ì‚¬ ë¡œê·¸: 'Id' PK ì¡°íšŒ ì‹¤íŒ¨ ({auditEntry.TableName}) - {ex.Message}"); auditEntry.RecordId = "PK Error"; }
                var oldValues = new Dictionary<string, object>(); var newValues = new Dictionary<string, object>(); var affectedColumns = new List<string>();
                if (entry.State == EntityState.Added) { foreach (var pn in entry.CurrentValues.PropertyNames) newValues[pn] = entry.CurrentValues[pn]; try { auditEntry.NewValues = JsonConvert.SerializeObject(newValues, jsonSettings); } catch (Exception serEx) { Debug.WriteLine($"    !!! ê°ì‚¬ ë¡œê·¸ Added ì§ë ¬í™” ì˜¤ë¥˜: {serEx.Message}"); auditEntry.NewValues = "Serialization Error"; } }
                else if (entry.State == EntityState.Deleted) { foreach (var pn in entry.OriginalValues.PropertyNames) oldValues[pn] = entry.OriginalValues[pn]; try { auditEntry.OldValues = JsonConvert.SerializeObject(oldValues, jsonSettings); } catch (Exception serEx) { Debug.WriteLine($"    !!! ê°ì‚¬ ë¡œê·¸ Deleted ì§ë ¬í™” ì˜¤ë¥˜: {serEx.Message}"); auditEntry.OldValues = "Serialization Error"; } }
                else if (entry.State == EntityState.Modified) { bool propertyChanged = false; foreach (var pn in entry.OriginalValues.PropertyNames) { var ov = entry.OriginalValues[pn]; var cv = entry.CurrentValues[pn]; if (!Equals(ov, cv)) { propertyChanged = true; affectedColumns.Add(pn); oldValues[pn] = ov; newValues[pn] = cv; } } if (propertyChanged) { auditEntry.AffectedColumns = string.Join(",", affectedColumns); try { auditEntry.OldValues = JsonConvert.SerializeObject(oldValues, jsonSettings); } catch (Exception serEx) { Debug.WriteLine($"    !!! ê°ì‚¬ ë¡œê·¸ Modified Old ì§ë ¬í™” ì˜¤ë¥˜: {serEx.Message}"); auditEntry.OldValues = "Serialization Error"; } try { auditEntry.NewValues = JsonConvert.SerializeObject(newValues, jsonSettings); } catch (Exception serEx) { Debug.WriteLine($"    !!! ê°ì‚¬ ë¡œê·¸ Modified New ì§ë ¬í™” ì˜¤ë¥˜: {serEx.Message}"); auditEntry.NewValues = "Serialization Error"; } } else { Debug.WriteLine($"    - ì—”í‹°í‹° {auditEntry.TableName} (ID: {auditEntry.RecordId})ëŠ” Modified ìƒíƒœì§€ë§Œ ì‹¤ì œ ê°’ ë³€ê²½ ì—†ìŒ. ë¡œê·¸ ê±´ë„ˆëœ€."); continue; } }
                auditEntries.Add(auditEntry);
                Debug.WriteLine($"    - ë¡œê·¸ ìƒì„±ë¨: {auditEntry.TableName}, Action: {auditEntry.Action}, RecordId: {auditEntry.RecordId}, User: {auditEntry.UserName}");
            }
            UpdateLockerAssignmentTimestamps(changedEntries);
            Debug.WriteLine("  CreateAuditEntries ì¢…ë£Œ.");
            return auditEntries;
        }
        private void UpdateLockerAssignmentTimestamps(List<DbEntityEntry> changedEntries) { var lockerEntries = changedEntries.Where(e => e.Entity is LockerAssignment && (e.State == EntityState.Added || e.State == EntityState.Modified)); int count = 0; foreach (var entry in lockerEntries) { ((LockerAssignment)entry.Entity).LastUpdated = DateTime.Now; count++; } if (count > 0) Debug.WriteLine($"UpdateLockerAssignmentTimestamps: {count}ê°œ LockerAssignment íƒ€ì„ìŠ¤íƒ¬í”„ ì—…ë°ì´íŠ¸ë¨."); }
        private string GetLocalIPAddress() { try { var host = Dns.GetHostEntry(Dns.GetHostName()); foreach (var ip in host.AddressList) { if (ip.AddressFamily == System.Net.Sockets.AddressFamily.InterNetwork) { return ip.ToString(); } } } catch (Exception ex) { Debug.WriteLine($"!!! ë¡œì»¬ IP ì£¼ì†Œ ì¡°íšŒ ì‹¤íŒ¨: {ex.Message}"); } return "Unknown IP"; }

        #endregion

        #region Error Logging Helpers
        private void LogDbUpdateException(DbUpdateException dbEx) { Debug.WriteLine($"!!! DbUpdateException ë°œìƒ: {dbEx.ToString()}"); if (dbEx.InnerException != null) Debug.WriteLine($"  InnerException: {dbEx.InnerException.ToString()}"); foreach (var entry in dbEx.Entries) { Debug.WriteLine($"  - ì˜¤ë¥˜ ì—”í‹°í‹°: {entry.Entity.GetType().Name}, ìƒíƒœ: {entry.State}"); } }
        private void LogValidationErrors(DbEntityValidationException vex) { Debug.WriteLine($"!!! DbEntityValidationException ë°œìƒ: {vex.Message}"); foreach (var validationErrors in vex.EntityValidationErrors) { Debug.WriteLine($"  - ì—”í‹°í‹° íƒ€ì…: {validationErrors.Entry.Entity.GetType().Name}, ìƒíƒœ: {validationErrors.Entry.State}"); foreach (var validationError in validationErrors.ValidationErrors) { Debug.WriteLine($"    - ì†ì„±: {validationError.PropertyName}, ì˜¤ë¥˜: {validationError.ErrorMessage}"); } } }
        #endregion
    }
}
```

---

**4. `ViewModels/HelpViewModel.cs` (ì‹ ê·œ íŒŒì¼)**

`ViewModels` í´ë”ì— ìƒˆë¡œ ì¶”ê°€í•˜ì„¸ìš”.

```csharp
// FILE_ID: ViewModels/HelpViewModel_20250411093000
using LockerManagementApp.Data;
using LockerManagementApp.Infrastructure;
using LockerManagementApp.Models;
using System;
using System.Data.Entity;
using System.Diagnostics;
using System.Linq;
using System.Runtime.InteropServices;
using System.Security;
using System.Threading;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Input;

namespace LockerManagementApp.ViewModels
{
    public class HelpViewModel : ViewModelBase, IDisposable
    {
        private readonly LockerDbContext _context;
        private readonly CancellationTokenSource _cts = new CancellationTokenSource();
        private bool _disposed = false;

        private string _authorityManagerNameDisplay;
        private string _systemManagerNameDisplay;
        private string _authorityManagerNameEdit;
        private string _systemManagerNameEdit;
        private SecureString _masterPasswordInput;
        private bool _isMasterVerified = false;
        private string _statusMessage;

        public string AuthorityManagerNameDisplay { get => _authorityManagerNameDisplay; private set => SetProperty(ref _authorityManagerNameDisplay, value); }
        public string SystemManagerNameDisplay { get => _systemManagerNameDisplay; private set => SetProperty(ref _systemManagerNameDisplay, value); }
        public string AuthorityManagerNameEdit { get => _authorityManagerNameEdit; set => SetProperty(ref _authorityManagerNameEdit, value); }
        public string SystemManagerNameEdit { get => _systemManagerNameEdit; set => SetProperty(ref _systemManagerNameEdit, value); }
        public SecureString MasterPasswordInput { get => _masterPasswordInput; set => SetProperty(ref _masterPasswordInput, value); }
        public bool IsMasterVerified { get => _isMasterVerified; private set => SetProperty(ref _isMasterVerified, value); }
        public string StatusMessage { get => _statusMessage; set => SetProperty(ref _statusMessage, value); }

        public ICommand LoadCommand { get; }
        public ICommand CheckMasterKeyCommand { get; }
        public ICommand SaveSettingsCommand { get; }

        public HelpViewModel()
        {
            try { _context = new LockerDbContext(); }
            catch (Exception ex) { if (!App.IsShuttingDown) MessageBox.Show($"[Help] DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜:\n{ex.ToString()}", "ì´ˆê¸°í™” ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); else Debug.WriteLine($"ì¢…ë£Œ ì¤‘ [Help] DB ì»¨í…ìŠ¤íŠ¸ ìƒì„± ì˜¤ë¥˜ ë¬´ì‹œë¨: {ex.Message}"); StatusMessage = "DB ì—°ê²° ì˜¤ë¥˜!"; LoadCommand = new RelayCommand(async _ => await LoadDataAsync(), _ => !_disposed); CheckMasterKeyCommand = new RelayCommand(async _ => await CheckMasterKeyAsync(), _ => !_disposed); SaveSettingsCommand = new RelayCommand(async _ => await SaveSettingsAsync(), _ => !_disposed && IsMasterVerified); return; }

            LoadCommand = new RelayCommand(async _ => await LoadDataAsync(), _ => !_disposed);
            CheckMasterKeyCommand = new RelayCommand(async _ => await CheckMasterKeyAsync(), _ => !_disposed);
            SaveChangesCommand = new RelayCommand(async _ => await SaveSettingsAsync(), _ => !_disposed && IsMasterVerified);

            _ = LoadDataAsync();
        }

        private async Task LoadDataAsync()
        {
            if (_context == null || _disposed || _cts.IsCancellationRequested) return;
            StatusMessage = "ë‹´ë‹¹ì ì •ë³´ ë¡œë”© ì¤‘...";
            try
            {
                var settings = await _context.AppSettings
                                             .Where(s => s.SettingKey == "AuthorityManagerName" || s.SettingKey == "SystemManagerName")
                                             .AsNoTracking()
                                             .ToListAsync(_cts.Token);

                if (_cts.IsCancellationRequested || _disposed) return;

                AuthorityManagerNameDisplay = settings.FirstOrDefault(s => s.SettingKey == "AuthorityManagerName")?.SettingValue ?? "ë¯¸ì§€ì •";
                SystemManagerNameDisplay = settings.FirstOrDefault(s => s.SettingKey == "SystemManagerName")?.SettingValue ?? "ë¯¸ì§€ì •";
                AuthorityManagerNameEdit = AuthorityManagerNameDisplay; // í¸ì§‘ í•„ë“œ ì´ˆê¸°í™”
                SystemManagerNameEdit = SystemManagerNameDisplay; // í¸ì§‘ í•„ë“œ ì´ˆê¸°í™”
                StatusMessage = "ë‹´ë‹¹ì ì •ë³´ ë¡œë“œ ì™„ë£Œ.";
            }
            catch (OperationCanceledException) { Debug.WriteLine("LoadDataAsync (HelpVM) ì‘ì—… ì·¨ì†Œë¨."); if (!_disposed) StatusMessage = "ë¡œë”© ì·¨ì†Œë¨."; }
            catch (Exception ex) { StatusMessage = $"ë‹´ë‹¹ì ì •ë³´ ë¡œë”© ì˜¤ë¥˜: {ex.Message}"; if (!App.IsShuttingDown && !_disposed) MessageBox.Show($"{StatusMessage}\n\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
        }

        private async Task CheckMasterKeyAsync()
        {
            if (_context == null || _disposed || _cts.IsCancellationRequested) return;
            StatusMessage = "ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì¤‘...";
            try
            {
                var masterKeySetting = await _context.AppSettings.AsNoTracking().FirstOrDefaultAsync(s => s.SettingKey == "MasterKey", _cts.Token);
                if (_cts.IsCancellationRequested || _disposed) return;
                if (masterKeySetting == null || string.IsNullOrEmpty(masterKeySetting.SettingValue)) { MessageBox.Show("ë°ì´í„°ë² ì´ìŠ¤ì— ë§ˆìŠ¤í„° í‚¤(MasterKey) ì„¤ì • ì—†ìŒ.", "ì„¤ì • ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning); StatusMessage = "ë§ˆìŠ¤í„° í‚¤ ì„¤ì • ì—†ìŒ."; return; }

                string plainPassword = ConvertToUnsecureString(MasterPasswordInput);
                if (plainPassword == masterKeySetting.SettingValue)
                {
                    IsMasterVerified = true;
                    StatusMessage = "ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì™„ë£Œ. í¸ì§‘ ê°€ëŠ¥.";
                    MessageBox.Show("ë§ˆìŠ¤í„° í‚¤ê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.", "ì„±ê³µ", MessageBoxButton.OK, MessageBoxImage.Information);
                }
                else
                {
                    IsMasterVerified = false;
                    StatusMessage = "ë§ˆìŠ¤í„° í‚¤ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                    MessageBox.Show(StatusMessage, "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Warning);
                }
            }
            catch (OperationCanceledException) { Debug.WriteLine("CheckMasterKeyAsync ì‘ì—… ì·¨ì†Œë¨."); StatusMessage = "í™•ì¸ ì‘ì—… ì·¨ì†Œë¨."; }
            catch (Exception ex) { StatusMessage = $"ë§ˆìŠ¤í„° í‚¤ í™•ì¸ ì˜¤ë¥˜: {ex.Message}"; if (!App.IsShuttingDown && !_disposed) MessageBox.Show($"{StatusMessage}\n\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); IsMasterVerified = false; }
            finally { (SaveChangesCommand as RelayCommand)?.RaiseCanExecuteChanged(); }
        }

        private async Task SaveSettingsAsync()
        {
            if (!IsMasterVerified || _context == null || _disposed || _cts.IsCancellationRequested) return;
            StatusMessage = "ë‹´ë‹¹ì ì •ë³´ ì €ì¥ ì¤‘...";
            RaiseCanExecuteChanged();
            try
            {
                bool changed = false;
                var authSetting = await _context.AppSettings.FindAsync(_cts.Token, "AuthorityManagerName");
                if (authSetting == null) { authSetting = _context.AppSettings.Add(new AppSetting { SettingKey = "AuthorityManagerName" }); }
                if (authSetting.SettingValue != (AuthorityManagerNameEdit ?? "")) { authSetting.SettingValue = AuthorityManagerNameEdit ?? ""; changed = true; }

                var sysSetting = await _context.AppSettings.FindAsync(_cts.Token, "SystemManagerName");
                if (sysSetting == null) { sysSetting = _context.AppSettings.Add(new AppSetting { SettingKey = "SystemManagerName" }); }
                if (sysSetting.SettingValue != (SystemManagerNameEdit ?? "")) { sysSetting.SettingValue = SystemManagerNameEdit ?? ""; changed = true; }

                if (changed)
                {
                    int result = await _context.SaveChangesAsync(_cts.Token);
                    StatusMessage = $"ë‹´ë‹¹ì ì •ë³´ ì €ì¥ ì™„ë£Œ ({result}ê±´).";
                    MessageBox.Show("ë‹´ë‹¹ì ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.", "ì €ì¥ ì™„ë£Œ", MessageBoxButton.OK, MessageBoxImage.Information);
                    await LoadDataAsync(); // ì €ì¥ í›„ ë‹¤ì‹œ ë¡œë“œí•˜ì—¬ Display ì—…ë°ì´íŠ¸
                }
                else
                {
                    StatusMessage = "ë³€ê²½ëœ ë‚´ìš©ì´ ì—†ì–´ ì €ì¥í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.";
                }
            }
            catch (OperationCanceledException) { Debug.WriteLine("SaveSettingsAsync ì‘ì—… ì·¨ì†Œë¨."); StatusMessage = "ì €ì¥ ì‘ì—… ì·¨ì†Œë¨."; }
            catch (Exception ex) { StatusMessage = $"ë‹´ë‹¹ì ì •ë³´ ì €ì¥ ì˜¤ë¥˜: {ex.Message}"; if (!App.IsShuttingDown && !_disposed) MessageBox.Show($"{StatusMessage}\n\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
            finally { RaiseCanExecuteChanged(); }
        }

        private void RaiseCanExecuteChanged()
        {
            (LoadCommand as RelayCommand)?.RaiseCanExecuteChanged();
            (CheckMasterKeyCommand as RelayCommand)?.RaiseCanExecuteChanged();
            (SaveChangesCommand as RelayCommand)?.RaiseCanExecuteChanged();
        }

        private string ConvertToUnsecureString(SecureString securePassword) { if (securePassword == null) return string.Empty; IntPtr ptr = IntPtr.Zero; try { ptr = Marshal.SecureStringToGlobalAllocUnicode(securePassword); return Marshal.PtrToStringUni(ptr); } finally { Marshal.ZeroFreeGlobalAllocUnicode(ptr); } }

        #region IDisposable êµ¬í˜„
        protected virtual void Dispose(bool disposing) { if (!_disposed) { _disposed = true; if (disposing) { Debug.WriteLine("HelpViewModel Dispose ì‹œì‘..."); try { _cts?.Cancel(); } catch (Exception ex) { Debug.WriteLine($"!!! HelpVM CTS Cancel ì˜¤ë¥˜: {ex.Message}"); } try { _cts?.Dispose(); } catch (Exception ex) { Debug.WriteLine($"!!! HelpVM CTS Dispose ì˜¤ë¥˜: {ex.Message}"); } try { _context?.Dispose(); } catch (Exception ex) { Debug.WriteLine($"!!! HelpViewModel DbContext Dispose ì˜¤ë¥˜: {ex.Message}"); } Debug.WriteLine("HelpViewModel ë¦¬ì†ŒìŠ¤ í•´ì œ ì™„ë£Œ."); } } }
        public void Dispose() { Dispose(true); GC.SuppressFinalize(this); }
        #endregion
    }
}
```

---

**5. `Views/HelpWindow.xaml` (ì‹ ê·œ íŒŒì¼)**

`Views` í´ë”ì— ìƒˆë¡œ ì¶”ê°€í•˜ì„¸ìš”.

```xml
<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.HelpWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure"
    mc:Ignorable="d"
    Title="Help / ë‹´ë‹¹ì ì •ë³´" Height="350" Width="450" SizeToContent="Height"
    WindowStartupLocation="CenterOwner" ShowInTaskbar="False" ResizeMode="NoResize"
    Closing="HelpWindow_Closing">

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </dx:ThemedWindow.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Text="ë‹´ë‹¹ì ì •ë³´" FontSize="16" FontWeight="Bold" Margin="0,0,0,15"/>

        <Grid Grid.Row="1" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="ê¸°ëŠ¥ ë¬¸ì˜:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBlock Grid.Column="1" Text="{Binding AuthorityManagerNameDisplay}" VerticalAlignment="Center"/>
        </Grid>

        <Grid Grid.Row="2" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Text="ì‹œìŠ¤í…œ ë¬¸ì˜:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBlock Grid.Column="1" Text="{Binding SystemManagerNameDisplay}" VerticalAlignment="Center"/>
        </Grid>

        <Separator Grid.Row="3"/>

        <StackPanel Grid.Row="4" Margin="0,15,0,0" Visibility="{Binding IsMasterVerified, Converter={StaticResource BooleanToVisibilityConverter}}">
            <TextBlock Text="ë‹´ë‹¹ì ì´ë¦„ ë³€ê²½ (ë§ˆìŠ¤í„° ì „ìš©)" FontWeight="Bold" Margin="0,0,0,5"/>
            <Grid>
                 <Grid.ColumnDefinitions> <ColumnDefinition Width="Auto"/><ColumnDefinition Width="*"/> </Grid.ColumnDefinitions>
                 <Grid.RowDefinitions> <RowDefinition Height="Auto"/><RowDefinition Height="Auto"/> </Grid.RowDefinitions>
                 <TextBlock Grid.Row="0" Grid.Column="0" Text="ê¸°ëŠ¥ ë¬¸ì˜:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                 <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding AuthorityManagerNameEdit, UpdateSourceTrigger=PropertyChanged}" Margin="0,3"/>
                 <TextBlock Grid.Row="1" Grid.Column="0" Text="ì‹œìŠ¤í…œ ë¬¸ì˜:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                 <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SystemManagerNameEdit, UpdateSourceTrigger=PropertyChanged}" Margin="0,3"/>
            </Grid>
            <Button Content="ë‹´ë‹¹ì ì •ë³´ ì €ì¥" Command="{Binding SaveSettingsCommand}" HorizontalAlignment="Right" Margin="0,10,0,0"/>
        </StackPanel>

        <StackPanel Grid.Row="5" Orientation="Horizontal" Margin="0,15,0,0" HorizontalAlignment="Right" Visibility="{Binding IsMasterVerified, ConverterParameter=Inverse, Converter={StaticResource BooleanToVisibilityConverter}}">
             <TextBlock Text="ë§ˆìŠ¤í„° í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
             <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
             <Button Content="í™•ì¸" Margin="5,0,0,0" Command="{Binding CheckMasterKeyCommand}"/>
        </StackPanel>

        <Grid Grid.Row="6" Margin="0,15,0,0">
             <TextBlock Text="{Binding StatusMessage}" Foreground="Red" HorizontalAlignment="Left" VerticalAlignment="Center"/>
             <Button Content="ë‹«ê¸°" Width="80" HorizontalAlignment="Right" Click="CloseButton_Click" IsCancel="True"/>
        </Grid>

    </Grid>
</dx:ThemedWindow>
```

---

**6. `Views/HelpWindow.xaml.cs` (ì‹ ê·œ íŒŒì¼)**

`Views` í´ë”ì— ìƒˆë¡œ ì¶”ê°€í•˜ì„¸ìš”.

```csharp
// FILE_ID: Views/HelpWindow_CS_20250411093000
using DevExpress.Xpf.Core;
using LockerManagementApp.ViewModels; // HelpViewModel ì°¸ì¡°
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Windows;

namespace LockerManagementApp.Views
{
    public partial class HelpWindow : ThemedWindow
    {
        public HelpWindow()
        {
            InitializeComponent();
        }

        private HelpViewModel ViewModel => DataContext as HelpViewModel;

        private void CloseButton_Click(object sender, RoutedEventArgs e)
        {
            this.Close();
        }

        private void HelpWindow_Closing(object sender, CancelEventArgs e)
        {
            if (ViewModel is IDisposable disposableViewModel)
            {
                try
                {
                    disposableViewModel.Dispose();
                    Debug.WriteLine("HelpViewModel ë¦¬ì†ŒìŠ¤ê°€ HelpWindow Closingì—ì„œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
                }
                catch (Exception ex)
                {
                    Debug.WriteLine($"!!! HelpViewModel Dispose ì¤‘ ì˜¤ë¥˜ ë°œìƒ (HelpWindow Closing): {ex.Message}");
                }
            }
        }
    }
}
```

---

**7. `Views/MainWindow.xaml` (ìˆ˜ì •)**

StatusBar ì•ˆì— Help ë²„íŠ¼ì„ ì¶”ê°€í•©ë‹ˆë‹¤.

```xml
<dx:ThemedWindow
    x:Class="LockerManagementApp.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxgt="http://schemas.devexpress.com/winfx/2008/xaml/grid/themekeys"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
    xmlns:local="clr-namespace:LockerManagementApp.Views"
    xmlns:viewmodels="clr-namespace:LockerManagementApp.ViewModels"
    xmlns:models="clr-namespace:LockerManagementApp.Models"
    xmlns:infra="clr-namespace:LockerManagementApp.Infrastructure"
    Title="ì‚¬ë¬¼í•¨ ê´€ë¦¬ í”„ë¡œê·¸ë¨ (DevExpress MVVM - .NET Framework 4.8)" Height="750" Width="1300"
    Loaded="MainWindow_Loaded" Closing="MainWindow_Closing"
    FontSize="14"
    >

    <dx:ThemedWindow.DataContext>
        <viewmodels:MainViewModel/>
    </dx:ThemedWindow.DataContext>

    <dx:ThemedWindow.Resources>
        <infra:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <infra:HighlightCellConverter x:Key="HighlightCellConverter"/>

        <Style x:Key="LightBlueHeaderStyle" TargetType="dxg:BaseGridHeader"> <Setter Property="Background" Value="LightBlue"/> <Setter Property="HorizontalContentAlignment" Value="Center"/> <Setter Property="FontWeight" Value="Bold"/> <Setter Property="Foreground" Value="Black"/> </Style>
        <Style TargetType="dxg:GridColumnHeader" BasedOn="{StaticResource LightBlueHeaderStyle}"/>
        <Style TargetType="dxg:BandHeaderControl" BasedOn="{StaticResource LightBlueHeaderStyle}"/>

        <Style x:Key="HighlightCellStyle" TargetType="dxg:CellContentPresenter">
            <Setter Property="Background">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource HighlightCellConverter}">
                        <Binding Path="Value"/>
                        <Binding Path="Column.FieldName"/>
                        <Binding Path="View.DataContext.SelectedCellValue"/>
                        <Binding Path="View.DataContext.SelectedCellColumnFieldName"/>
                    </MultiBinding>
                </Setter.Value>
            </Setter>
        </Style>

    </dx:ThemedWindow.Resources>

    <Grid>
        <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <DockPanel Grid.Row="0" LastChildFill="True">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" Margin="5">
                 <TextBlock Text="ì¼ë°˜ í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                 <PasswordBox x:Name="NormalPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding NormalPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                 <Button Content="í™•ì¸" Margin="5,0,15,0" Command="{Binding CheckNormalPasswordCommand}"/>

                <TextBlock Text="ë§ˆìŠ¤í„° í‚¤:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <PasswordBox x:Name="MasterPasswordBox" Width="100" VerticalAlignment="Center" infra:PasswordHelper.Attach="True" infra:PasswordHelper.Password="{Binding MasterPasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Button Content="í™•ì¸" Margin="5,0,0,0" Command="{Binding CheckMasterPasswordCommand}"/>
            </StackPanel>
            <Border Background="LightGray" Padding="5">
                 <StackPanel Orientation="Horizontal">
                    <Button Content="ğŸ”„ ìƒˆë¡œê³ ì¹¨" Margin="3" Command="{Binding LoadDataCommand}"/>
                    <Button Content="ğŸ’¾ ë³€ê²½ ì‚¬í•­ ì €ì¥" Margin="3" Command="{Binding SaveChangesCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="âš™ï¸ ë§ˆìŠ¤í„° ë°ì´í„° ê´€ë¦¬" Margin="15,3,3,3" Command="{Binding OpenMasterDataWindowCommand}" ToolTip="ë§ˆìŠ¤í„° ë°ì´í„°(ì¸µ, êµ¬ì—­ ë“±)ë¥¼ ê´€ë¦¬í•˜ëŠ” ìƒˆ ì°½ì„ ì—½ë‹ˆë‹¤." Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½" Margin="5,3,3,3" Command="{Binding OpenPasswordChangeWindowCommand}" ToolTip="ë§ˆìŠ¤í„° í‚¤ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤." Visibility="{Binding IsMasterModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="ğŸ“œ ë¡œê·¸ ë³´ê¸°" Margin="5,3,3,3" Command="{Binding OpenLogWindowCommand}" ToolTip="ë°ì´í„° ë³€ê²½ ì´ë ¥ ë¡œê·¸ë¥¼ í™•ì¸í•©ë‹ˆë‹¤."/>
                    <Button Content="ğŸ“Š í˜„í™© ë³´ê¸°" Margin="15,3,3,3" Command="{Binding OpenStatusWindowCommand}" ToolTip="ì‚¬ë¬¼í•¨ ì‚¬ìš© í˜„í™©ì„ í™•ì¸í•©ë‹ˆë‹¤."/>
                    <Button Content="ğŸ“„ ì—‘ì…€ ì €ì¥" Margin="5,3,3,3" Click="ExportExcelButton_Click" ToolTip="í˜„ì¬ í‘œ ë‚´ìš©ì„ ì—‘ì…€ íŒŒì¼ë¡œ ì €ì¥í•©ë‹ˆë‹¤."/>
                 </StackPanel>
            </Border>
        </DockPanel>

        <Grid Grid.Row="1" Margin="5">
            <Grid.RowDefinitions> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/> </Grid.RowDefinitions>
            <Border Grid.Row="0" Background="WhiteSmoke" Padding="3">
                <StackPanel Orientation="Horizontal">
                    <Button Content="â• ìƒˆ ì‚¬ë¬¼í•¨ ì¶”ê°€" Margin="3" Command="{Binding AddNewCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                    <Button Content="âŒ ì„ íƒ í•­ëª© ì‚­ì œ" Margin="3" Command="{Binding DeleteCommand}" Visibility="{Binding IsEditModeEnabled, Converter={StaticResource BooleanToVisibilityConverter}, FallbackValue=Collapsed}"/>
                </StackPanel>
            </Border>
            <dxg:GridControl Grid.Row="1" x:Name="mainGridControl" ItemsSource="{Binding LockerAssignments}" SelectedItem="{Binding SelectedAssignment, Mode=TwoWay}"
                             CurrentItemChanged="GridControl_CurrentItemChanged"
                             CustomColumnSort="GridControl_CustomColumnSort">
                <dxg:GridControl.View>
                    <dxg:TableView x:Name="mainTableView" AllowPerPixelScrolling="True" ShowGroupPanel="True" AllowEditing="True"
                                   NavigationStyle="Cell" ShowAutoFilterRow="True" NewItemRowPosition="None"
                                   ShowIndicator="True" ShowSearchPanelMode="Always"
                                   FocusedColumnChanged="TableView_FocusedColumnChanged"
                                   UseLightweightTemplates="None">
                        <dxg:TableView.RowCellMenuCustomizations>
                            <dxb:BarItemSeparator/>
                            <dxb:BarButtonItem Content="í–‰ ì‚­ì œ" Command="{Binding View.DataContext.DeleteCommand}" Glyph="{dx:DXImage Svg/Actions/Delete.svg}"/>
                        </dxg:TableView.RowCellMenuCustomizations>
                    </dxg:TableView>
                </dxg:GridControl.View>
                <dxg:GridControl.Columns>
                    <dxg:GridColumn FieldName="LockerType" Header="ì¢…ë¥˜" Width="100" Fixed="Left" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllLockerTypes}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Floor" Header="ì¸µ" Width="60" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllFloors}" DisplayMember="Name" ValueMember="Name" IsTextEditable="False" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Zone" Header="êµ¬ì—­" Width="80" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllZones}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SpecificLocation" Header="ì„¸ë¶€ ìœ„ì¹˜" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" SortMode="Custom"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="UserName" Header="ì„±ëª…" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="KnoxId" Header="Knox ID" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="SubPart" Header="ì†ŒíŒŒíŠ¸" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllSubParts}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Administrator" Header="ê´€ë¦¬ ë‹´ë‹¹ì" Width="120" HeaderStyle="{StaticResource LightBlueHeaderStyle}" CellStyle="{StaticResource HighlightCellStyle}"> <dxg:GridColumn.EditSettings> <dxe:ComboBoxEditSettings ItemsSource="{Binding AllAdministrators}" DisplayMember="Name" ValueMember="Name" IsTextEditable="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="TransferStatus" Header="ì „ë°°ë³µì§" Width="100" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Details" Header="ë‚´ìš©" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Remarks" Header="íŠ¹ì´ì‚¬í•­" Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Notes" Header="ë¹„ê³ " Width="150" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:TextEditSettings HorizontalContentAlignment="Left"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="LastUpdated" Header="ìµœì¢… ìˆ˜ì •ì¼ì‹œ" Width="150" AllowEditing="False" ReadOnly="True" HeaderStyle="{StaticResource LightBlueHeaderStyle}"> <dxg:GridColumn.EditSettings> <dxe:DateEditSettings MaskType="DateTime" Mask="yyyy-MM-dd HH:mm:ss" MaskUseAsDisplayFormat="True" HorizontalContentAlignment="Center"/> </dxg:GridColumn.EditSettings> </dxg:GridColumn>
                    <dxg:GridColumn FieldName="Id" Header="ID" Visible="False" ReadOnly="True"/>
                </dxg:GridControl.Columns>
            </dxg:GridControl>
        </Grid>

        <StatusBar Grid.Row="2" Background="LightGray">
            <StatusBarItem><TextBlock Text="{Binding StatusBarText}" Margin="5,0"/></StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                 <StackPanel Orientation="Horizontal">
                     <TextBlock Text="ê¸°ëŠ¥ë¬¸ì˜:" Margin="0,0,5,0" FontWeight="SemiBold"/>
                     <TextBlock Text="{Binding AuthorityManagerName}" Margin="0,0,15,0"/>
                     <TextBlock Text="ì‹œìŠ¤í…œë¬¸ì˜:" Margin="0,0,5,0" FontWeight="SemiBold"/>
                     <TextBlock Text="{Binding SystemManagerName}" Margin="0,0,15,0"/>
                     <Button Content="Help" Padding="5,0" Click="HelpButton_Click"/>
                 </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>

</dx:ThemedWindow>
```

---

**8. `Views/MainWindow.xaml.cs` (ìˆ˜ì •)**

`HelpButton_Click` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

```csharp
// FILE_ID: Views/MainWindow_CS_20250411093000
using DevExpress.Xpf.Core;
using DevExpress.Xpf.Grid;
using LockerManagementApp.Models;
using LockerManagementApp.ViewModels;
using Microsoft.Win32;
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Windows;
using DevExpress.Xpf.Printing;
using DevExpress.XtraPrinting;
using DevExpress.Utils;
using System.Collections.Generic;
using System.Linq;

namespace LockerManagementApp.Views
{
    public partial class MainWindow : ThemedWindow
    {
        public MainWindow()
        {
            InitializeComponent();
        }

        private MainViewModel ViewModel => DataContext as MainViewModel;

        private void MainWindow_Loaded(object sender, RoutedEventArgs e) { }

        private void MainWindow_Closing(object sender, CancelEventArgs e)
        {
            if (ViewModel is IDisposable disposableViewModel)
            {
                try { disposableViewModel.Dispose(); }
                catch (Exception ex) { Debug.WriteLine($"!!! MainViewModel Dispose ì˜¤ë¥˜: {ex.Message}"); }
            }
        }

        private void TableView_FocusedColumnChanged(object sender, FocusedColumnChangedEventArgs e)
        {
            if (ViewModel == null || !(sender is TableView view)) return;
            var currentItem = view.Grid.CurrentItem as LockerAssignment;
            string newFieldName = e.NewColumn?.FieldName;
            ViewModel.UpdateHighlightInfo(newFieldName, currentItem);
        }

        private void GridControl_CurrentItemChanged(object sender, CurrentItemChangedEventArgs e)
        {
            if (ViewModel == null || !(sender is GridControl grid)) return;
            var view = grid.View as TableView;
            string currentFieldName = view?.FocusedColumn?.FieldName;
            var newItem = e.NewItem as LockerAssignment;
            ViewModel.UpdateHighlightInfo(currentFieldName, newItem);
        }

        private void ExportExcelButton_Click(object sender, RoutedEventArgs e)
        {
            SaveFileDialog saveFileDialog = new SaveFileDialog { Filter = "Excel Workbook (*.xlsx)|*.xlsx", FileName = $"ì‚¬ë¬¼í•¨í˜„í™©_{DateTime.Now:yyyyMMdd}.xlsx", Title = "ì—‘ì…€ íŒŒì¼ ì €ì¥" };
            if (saveFileDialog.ShowDialog() == true)
            {
                string filePath = saveFileDialog.FileName;
                GridSortInfo[] originalSortInfo = null; int originalGroupCount = 0; GridControl grid = mainGridControl; // ì´ë¦„ ë³€ê²½ë¨
                PrintingSystemBase printingSystem = new PrintingSystemBase(); PrintableControlLink link1 = null; PrintableControlLink link2 = null;
                try { if(ViewModel != null) ViewModel.StatusBarText = "ì—‘ì…€ íŒŒì¼ ìƒì„± ì¤‘..."; link1 = new PrintableControlLink((TableView)mainTableView) { SheetName = "ì „ì²´ì‹œíŠ¸" }; originalSortInfo = grid.SortInfo.ToArray(); originalGroupCount = grid.GroupCount; grid.ClearGrouping(); grid.GroupBy("SubPart"); grid.ExpandAllGroups(); link2 = new PrintableControlLink((TableView)mainTableView) { SheetName = "ì†ŒíŒŒíŠ¸ë³„ì‹œíŠ¸" }; var links = new List<IPrintable> { link1, link2 }; var compositeLink = new CompositeLink(links); compositeLink.PrintingSystemBase = printingSystem; var options = new XlsxExportOptionsEx { ExportType = DevExpress.Export.ExportType.DataAware, ShowGridLines = true, ShowColumnHeaders = DefaultBoolean.True, ShowGroupSummaries = DefaultBoolean.True }; compositeLink.ExportToXlsx(filePath, options); if(ViewModel != null) ViewModel.StatusBarText = "ì—‘ì…€ íŒŒì¼ ì €ì¥ ì™„ë£Œ."; MessageBox.Show($"ì—‘ì…€ íŒŒì¼ ì €ì¥ ì™„ë£Œ:\n{filePath}", "ì €ì¥ ì„±ê³µ", MessageBoxButton.OK, MessageBoxImage.Information); }
                catch (Exception ex) { if(ViewModel != null) ViewModel.StatusBarText = "ì—‘ì…€ íŒŒì¼ ì €ì¥ ì˜¤ë¥˜."; MessageBox.Show($"ì—‘ì…€ íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:\n{ex.ToString()}", "ì €ì¥ ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error); }
                finally { link1?.Dispose(); link2?.Dispose(); printingSystem?.Dispose(); try { grid.ClearGrouping(); if (originalSortInfo != null) { grid.SortInfo.Clear(); foreach(var sortInfo in originalSortInfo) { grid.SortInfo.Add(sortInfo); } } Debug.WriteLine("Grid layout restored after export."); } catch(Exception layoutEx) { Debug.WriteLine($"!!! ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ë³µêµ¬ ì¤‘ ì˜¤ë¥˜: {layoutEx.Message}"); } }
            }
        }

        private void GridControl_CustomColumnSort(object sender, CustomColumnSortEventArgs e)
        {
            if (e.Column.FieldName == "SpecificLocation")
            {
                e.Handled = true;
                string value1 = e.Value1 as string;
                string value2 = e.Value2 as string;

                if (string.IsNullOrEmpty(value1) && string.IsNullOrEmpty(value2)) { e.Result = 0; return; }
                if (string.IsNullOrEmpty(value1)) { e.Result = -1; return; }
                if (string.IsNullOrEmpty(value2)) { e.Result = 1; return; }

                string prefix1 = new string(value1.TakeWhile(c => !char.IsDigit(c)).ToArray());
                string prefix2 = new string(value2.TakeWhile(c => !char.IsDigit(c)).ToArray());
                string numberPart1 = new string(value1.SkipWhile(c => !char.IsDigit(c)).ToArray());
                string numberPart2 = new string(value2.SkipWhile(c => !char.IsDigit(c)).ToArray());

                int prefixCompare = string.Compare(prefix1, prefix2, StringComparison.OrdinalIgnoreCase);
                if (prefixCompare != 0) { e.Result = prefixCompare; return; }

                int.TryParse(numberPart1, out int number1);
                int.TryParse(numberPart2, out int number2);
                e.Result = number1.CompareTo(number2);
            }
        }

        /// <summary>
        /// ì‹ ê·œ: Help ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        /// </summary>
        private void HelpButton_Click(object sender, RoutedEventArgs e)
        {
            try
            {
                using (var helpVM = new HelpViewModel()) // HelpViewModelì€ IDisposable êµ¬í˜„ ê°€ì •
                {
                    var helpWindow = new HelpWindow
                    {
                        DataContext = helpVM,
                        Owner = this // MainWindow
                    };
                    helpWindow.ShowDialog();
                    // Help ì°½ì—ì„œ ë³€ê²½ëœ ë‚´ìš©(ë‹´ë‹¹ì ì´ë¦„)ì„ ë©”ì¸ ì°½ì— ì¦‰ì‹œ ë°˜ì˜í•˜ë ¤ë©´
                    // MainViewModelì˜ ê´€ë ¨ ì†ì„±ì„ ë‹¤ì‹œ ë¡œë“œí•´ì•¼ í•¨
                    ViewModel?.LoadAppSettingsAsync(); // MainViewModelì— í•´ë‹¹ ë©”ì„œë“œ í•„ìš”
                }
            }
            catch (Exception ex)
            {
                if (!App.IsShuttingDown && ViewModel != null && !ViewModel._disposed) // ViewModel null ì²´í¬ ì¶”ê°€
                    MessageBox.Show($"Help ì°½ ì—´ê¸° ì˜¤ë¥˜:\n{ex.ToString()}", "ì˜¤ë¥˜", MessageBoxButton.OK, MessageBoxImage.Error);
                else
                    Debug.WriteLine($"ì¢…ë£Œ ì¤‘ Help ì°½ ì—´ê¸° ì˜¤ë¥˜ ë¬´ì‹œë¨: {ex.Message}");
            }
        }
    }
}
```

**í•µì‹¬ ë³€ê²½ ì‚¬í•­:**

* **`Views/MainWindow.xaml`:** í•˜ë‹¨ `StatusBar` ì˜¤ë¥¸ìª½ì— `StackPanel`ì„ ì¶”ê°€í•˜ê³ , ê·¸ ì•ˆì— "ê¸°ëŠ¥ë¬¸ì˜:", "ì‹œìŠ¤í…œë¬¸ì˜:" ë¼ë²¨ê³¼ ë‹´ë‹¹ì ì´ë¦„ì„ ë³´ì—¬ì¤„ `TextBlock`(ê°ê° `AuthorityManagerName`, `SystemManagerName`ì— ë°”ì¸ë”©), ê·¸ë¦¬ê³  "Help" ë²„íŠ¼(`Click="HelpButton_Click"`)ì„ ë°°ì¹˜í–ˆìŠµë‹ˆë‹¤.
* **`Views/MainWindow.xaml.cs`:** `HelpButton_Click` ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. ì´ í•¸ë“¤ëŸ¬ëŠ” `HelpViewModel`ê³¼ `HelpWindow`ë¥¼ ìƒì„±í•˜ê³  `ShowDialog()`ë¡œ ëª¨ë‹¬ ì°½ì„ ì—½ë‹ˆë‹¤. ì°½ì´ ë‹«íŒ í›„ì—ëŠ” `MainViewModel`ì˜ `LoadAppSettingsAsync()` ë©”ì„œë“œ(ì´ì „ ë‹¨ê³„ì—ì„œ ì¶”ê°€ë¨)ë¥¼ í˜¸ì¶œí•˜ì—¬ í˜¹ì‹œ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆëŠ” ë‹´ë‹¹ì ì´ë¦„ì„ ìƒíƒœ í‘œì‹œì¤„ì— ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.