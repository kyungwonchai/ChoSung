ì¢Œì¸¡: íŠ¹ì • ë¼ì¸ ì„ íƒ ListBox
ìš°ì¸¡: BCT1_1 ~ BCT1_8, TCT1_1 ~ TCT1_8 ë°ì´í„°ë¥¼ í‘œ (HTML Table)ë¡œ í‘œì‹œ
í—¤ë”: 1í˜¸ê¸° ~ 8í˜¸ê¸°
ìƒë‹¨: ì„ íƒí•œ ëª¨ë¸ëª…ê³¼ time1 ê°’ í‘œì‹œ
Flask + Quart (ë¹„ë™ê¸° ì„œë²„) + PyMSSQL (MSSQL ì—°ê²°)
Ubuntu ê¸°ë°˜ Python ì„œë²„ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥
âœ… ğŸ”¹ Python (Flask & Quart) ì½”ë“œ
python
ì½”ë“œ ë³µì‚¬
from quart import Quart, render_template, request, jsonify
import pymssql

app = Quart(__name__)

# ğŸ“Œ MSSQL ì—°ê²° ì„¤ì •
DB_CONFIG = {
    "server": "ì„œë²„ì£¼ì†Œ",
    "user": "ì‚¬ìš©ìëª…",
    "password": "ë¹„ë°€ë²ˆí˜¸",
    "database": "DBì´ë¦„"
}

# ğŸ“Œ íŠ¹ì • ë¼ì¸ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
async def get_line_data(line_name):
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor(as_dict=True)

    # ìµœì‹  ëª¨ë¸ê³¼ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
    cursor.execute(f"""
        SELECT TOP 1 ëª¨ë¸, time1 
        FROM ExcelData 
        WHERE ë¼ì¸ = %s
        ORDER BY time1 DESC
    """, (line_name,))
    latest = cursor.fetchone()

    if not latest:
        conn.close()
        return None, None, []

    latest_model, latest_time = latest["ëª¨ë¸"], latest["time1"]

    # í•´ë‹¹ ëª¨ë¸ì˜ ìµœì‹  10ê°œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    cursor.execute(f"""
        WITH RecentData AS (
            SELECT TOP 10 * FROM ExcelData
            WHERE ë¼ì¸ = %s AND ëª¨ë¸ = %s
            ORDER BY time1 DESC
        )
        SELECT 
            MIN(CASE WHEN BCT1_1 >= 1 THEN BCT1_1 ELSE NULL END) AS BCT1_1,
            MIN(CASE WHEN BCT1_2 >= 1 THEN BCT1_2 ELSE NULL END) AS BCT1_2,
            MIN(CASE WHEN BCT1_3 >= 1 THEN BCT1_3 ELSE NULL END) AS BCT1_3,
            MIN(CASE WHEN BCT1_4 >= 1 THEN BCT1_4 ELSE NULL END) AS BCT1_4,
            MIN(CASE WHEN BCT1_5 >= 1 THEN BCT1_5 ELSE NULL END) AS BCT1_5,
            MIN(CASE WHEN BCT1_6 >= 1 THEN BCT1_6 ELSE NULL END) AS BCT1_6,
            MIN(CASE WHEN BCT1_7 >= 1 THEN BCT1_7 ELSE NULL END) AS BCT1_7,
            MIN(CASE WHEN BCT1_8 >= 1 THEN BCT1_8 ELSE NULL END) AS BCT1_8,

            MIN(CASE WHEN TCT1_1 >= 1 THEN TCT1_1 ELSE NULL END) AS TCT1_1,
            MIN(CASE WHEN TCT1_2 >= 1 THEN TCT1_2 ELSE NULL END) AS TCT1_2,
            MIN(CASE WHEN TCT1_3 >= 1 THEN TCT1_3 ELSE NULL END) AS TCT1_3,
            MIN(CASE WHEN TCT1_4 >= 1 THEN TCT1_4 ELSE NULL END) AS TCT1_4,
            MIN(CASE WHEN TCT1_5 >= 1 THEN TCT1_5 ELSE NULL END) AS TCT1_5,
            MIN(CASE WHEN TCT1_6 >= 1 THEN TCT1_6 ELSE NULL END) AS TCT1_6,
            MIN(CASE WHEN TCT1_7 >= 1 THEN TCT1_7 ELSE NULL END) AS TCT1_7,
            MIN(CASE WHEN TCT1_8 >= 1 THEN TCT1_8 ELSE NULL END) AS TCT1_8
        FROM RecentData;
    """, (line_name, latest_model))

    data = cursor.fetchone()
    conn.close()

    return latest_model, latest_time, data

# ğŸ“Œ ë¼ì¸ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
async def get_lines():
    conn = pymssql.connect(**DB_CONFIG)
    cursor = conn.cursor()
    cursor.execute("SELECT DISTINCT ë¼ì¸ FROM ExcelData ORDER BY ë¼ì¸")
    lines = [row[0] for row in cursor.fetchall()]
    conn.close()
    return lines

# ğŸ“Œ ë©”ì¸ í˜ì´ì§€
@app.route("/")
async def index():
    lines = await get_lines()
    return await render_template("index.html", lines=lines)

# ğŸ“Œ AJAX ìš”ì²­: íŠ¹ì • ë¼ì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
@app.route("/get_data", methods=["POST"])
async def get_data():
    data = await request.json
    line_name = data["line_name"]

    latest_model, latest_time, table_data = await get_line_data(line_name)
    return jsonify({
        "model": latest_model,
        "time": latest_time,
        "data": table_data
    })

if __name__ == "__main__":
    app.run(debug=True)
âœ… ğŸ”¹ HTML (Jinja2) íŒŒì¼ (templates/index.html)
html
ì½”ë“œ ë³µì‚¬
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë¼ì¸ ë°ì´í„° ì¡°íšŒ</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h2>ë¼ì¸ ì„ íƒ</h2>
    <select id="lineSelect">
        {% for line in lines %}
            <option value="{{ line }}">{{ line }}</option>
        {% endfor %}
    </select>

    <h2>ëª¨ë¸ëª…: <span id="model"></span></h2>
    <h3>ìµœì‹  ì‹œê°„: <span id="time"></span></h3>

    <table border="1">
        <thead>
            <tr>
                <th>êµ¬ë¶„</th>
                <th>1í˜¸ê¸°</th><th>2í˜¸ê¸°</th><th>3í˜¸ê¸°</th><th>4í˜¸ê¸°</th>
                <th>5í˜¸ê¸°</th><th>6í˜¸ê¸°</th><th>7í˜¸ê¸°</th><th>8í˜¸ê¸°</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>BCT</td><td id="BCT1"></td><td id="BCT2"></td><td id="BCT3"></td><td id="BCT4"></td>
                <td id="BCT5"></td><td id="BCT6"></td><td id="BCT7"></td><td id="BCT8"></td></tr>
            <tr><td>TCT</td><td id="TCT1"></td><td id="TCT2"></td><td id="TCT3"></td><td id="TCT4"></td>
                <td id="TCT5"></td><td id="TCT6"></td><td id="TCT7"></td><td id="TCT8"></td></tr>
        </tbody>
    </table>

    <script>
        $(document).ready(function () {
            $("#lineSelect").change(function () {
                let lineName = $(this).val();
                $.post("/get_data", JSON.stringify({ line_name: lineName }), function (response) {
                    $("#model").text(response.model);
                    $("#time").text(response.time);

                    for (let i = 1; i <= 8; i++) {
                        $("#BCT" + i).text(response.data["BCT1_" + i] || 0);
                        $("#TCT" + i).text(response.data["TCT1_" + i] || 0);
                    }
                }, "json");
            });

            $("#lineSelect").trigger("change");
        });
    </script>
</body>
</html>
âœ… ì„¤ì¹˜ ë° ì‹¤í–‰
bash
ì½”ë“œ ë³µì‚¬
pip install quart pymssql