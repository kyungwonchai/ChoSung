겠습니다. MainWindow 클래스가 App.xaml.cs에서 참조될 수 있도록 필요한 변경을 적용하겠습니다. 이를 위해 MainWindow 클래스를 적절히 선언하고, App.xaml.cs에서 인식할 수 있도록 해야 합니다.

1. MainWindow.xaml.cs
먼저 MainWindow 클래스가 App 클래스에서 접근 가능하도록 public으로 선언합니다.

csharp
코드 복사
using System;
using System.Runtime.InteropServices;
using System.Windows;
using DevExpress.Xpf.Core;
using DevExpress.Xpf.Layout.Core;

namespace ClipboardApp
{
    public partial class MainWindow : DXWindow
    {
        private static MainWindow _instance;
        public static MainWindow Instance
        {
            get { return _instance; }
        }

        // 외부 DLL 호출
        [DllImport("user32.dll")]
        private static extern bool SetForegroundWindow(IntPtr hWnd);
        [DllImport("user32.dll")]
        private static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

        public MainWindow()
        {
            InitializeComponent();
            LoadClipboardContent();
            _instance = this; // 현재 인스턴스를 저장합니다.
        }

        private void LoadClipboardContent()
        {
            if (Clipboard.ContainsText())
            {
                string clipboardText = Clipboard.GetText();
                myTextBox.Text = clipboardText;
            }
        }

        public void DockNewWindow(string content)
        {
            NewWindow newWindow = new NewWindow
            {
                Owner = this
            };
            newWindow.newTextBox.Text = content;

            var newPanel = new LayoutPanel
            {
                Content = newWindow.Content,
                Caption = "New Tab"
            };

            dockLayoutManager.DockController.Dock(newPanel, dockLayoutManager.LayoutRoot, DockType.Fill);
        }

        public static void ActivateExistingInstance(string content)
        {
            if (_instance != null)
            {
                _instance.Dispatcher.Invoke(() =>
                {
                    IntPtr hWnd = FindWindow(null, "Clipboard App");
                    if (hWnd != IntPtr.Zero)
                    {
                        SetForegroundWindow(hWnd);
                        _instance.DockNewWindow(content);
                    }
                });
            }
        }
    }
}
2. App.xaml.cs
App.xaml.cs에서 MainWindow 인스턴스를 생성하고 관리합니다.

csharp
코드 복사
using System;
using System.Threading;
using System.Windows;

namespace ClipboardApp
{
    public partial class App : Application
    {
        private static Mutex mutex = null;

        protected override void OnStartup(StartupEventArgs e)
        {
            const string appName = "ClipboardApp";
            bool createdNew;

            mutex = new Mutex(true, appName, out createdNew);

            if (!createdNew)
            {
                // 이미 실행 중인 경우 기존 인스턴스 활성화 및 새 탭 추가
                string clipboardContent = Clipboard.GetText();
                MainWindow.ActivateExistingInstance(clipboardContent);
                Application.Current.Shutdown();
                return;
            }

            base.OnStartup(e);
            MainWindow mainWindow = new MainWindow();
            MainWindow.Instance.Show();
        }
    }
}
3. NewWindow.xaml.cs
이 부분은 그대로 두어도 됩니다.

csharp
코드 복사
using System.Windows;

namespace ClipboardApp
{
    public partial class NewWindow : Window
    {
        public NewWindow()
        {
            InitializeComponent();
        }
    }
}
위의 코드로, App.xaml.cs에서 MainWindow 인스턴스를 생성하고, 중복 실행 시 기존 인스턴스를 활성화하여 새 탭을 추가하도록 구현했습니다. 이를 통해 MainWindow 클래스를 올바르게 인식하고 사용할 수