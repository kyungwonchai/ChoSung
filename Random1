 SpreadsheetControl과 GridControl을 사용하여 엑셀로 내보내는 예제를 클래스 명시와 using 지시문을 포함한 형태로 다시 제공합니다.

예제 코드
XAML (MainWindow.xaml)

xaml
Copy code
<Window x:Class="DevExpressWpfExport.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
        xmlns:dxsps="http://schemas.devexpress.com/winfx/2008/xaml/spreadsheet"
        Title="MainWindow" Height="450" Width="800">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- SpreadsheetControl -->
        <dxsps:SpreadsheetControl x:Name="spreadsheetControl" Grid.Row="0" Height="100" Margin="0,10"/>

        <!-- GridControl -->
        <dxg:GridControl x:Name="gridControl" Grid.Row="1">
            <dxg:GridControl.Columns>
                <dxg:GridColumn FieldName="ID" Header="ID"/>
                <dxg:GridColumn FieldName="Name" Header="Name"/>
                <dxg:GridColumn FieldName="Country" Header="Country"/>
            </dxg:GridControl.Columns>
        </dxg:GridControl>

        <!-- Export Button -->
        <Button Grid.Row="2" Content="Export to Excel" Click="ExportToExcel_Click"/>
    </Grid>
</Window>
C# 코드 (MainWindow.xaml.cs)

csharp
Copy code
using System;
using System.Collections.Generic;
using System.Data;
using System.Windows;
using DevExpress.Spreadsheet;
using DevExpress.Xpf.Grid;
using DevExpress.Xpf.Grid.View;

namespace DevExpressWpfExport
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            // Sample data for GridControl
            gridControl.ItemsSource = new List<Record>
            {
                new Record { ID = 1, Name = "John Doe", Country = "USA" },
                new Record { ID = 2, Name = "Jane Smith", Country = "UK" },
                new Record { ID = 3, Name = "Pierre Dupont", Country = "France" }
            };

            // Pre-fill SpreadsheetControl with some data
            Worksheet sheet = spreadsheetControl.Document.Worksheets[0];
            sheet.Cells["A1"].Value = "Custom Title";
            sheet.Cells["A2"].Value = "Report Date: " + DateTime.Now.ToShortDateString();
            sheet.Cells["A3"].Value = "Generated by: User";
        }

        private void ExportToExcel_Click(object sender, RoutedEventArgs e)
        {
            // Create a new spreadsheet document
            Workbook workbook = new Workbook();
            Worksheet worksheet = workbook.Worksheets[0];

            // Copy the content from SpreadsheetControl to the new workbook
            Worksheet sourceWorksheet = spreadsheetControl.Document.Worksheets[0];
            Range sourceRange = sourceWorksheet.GetUsedRange();
            Range destinationRange = worksheet.Range.FromLTRB(0, 0, sourceRange.ColumnCount - 1, sourceRange.RowCount - 1);
            destinationRange.CopyFrom(sourceRange);

            // Export GridControl data to DataTable
            TableView tableView = gridControl.View as TableView;
            DataTable gridData = tableView.CreateExportTable();

            // Export GridControl data to Excel starting after the existing content
            worksheet.Import(gridData, false, sourceRange.RowCount, 0);

            // Adjust column width to fit content
            worksheet.Columns.AutoFit(0, gridData.Columns.Count - 1);

            // Save the spreadsheet to a file
            string filePath = "ExportedGridDataWithHeader.xlsx";
            workbook.SaveDocument(filePath, DocumentFormat.OpenXml);

            MessageBox.Show($"Exported to {filePath}", "Export Success", MessageBoxButton.OK, MessageBoxImage.Information);
        }

        // Sample record class for demonstration
        public class Record
        {
            public int ID { get; set; }
            public string Name { get; set; }
            public string Country { get; set; }
        }
    }
}
프로젝트 파일 구조

markdown
Copy code
- DevExpressWpfExport
  - MainWindow.xaml
  - MainWindow.xaml.cs
  - DevExpressWpfExport.csproj
사용된 패키지 및 참조:
DevExpress WPF Controls (DevExpress.Xpf.Grid, DevExpress.Xpf.Grid.View)
DevExpress Spreadsheet Controls (DevExpress.Spreadsheet)
NuGet 패키지 설치 방법
DevExpress 라이브러리를 설치하지 않은 경우, DevExpress 설치 또는 NuGet 패키지 관리자를 통해 다음 패키지들을 설치해야 합니다:
DevExpress.Xpf.Grid
DevExpress.Spreadsheet
프로젝트 설정을 위한 지침
NuGet 패키지 설치:
NuGet 패키지 관리자를 통해 필요한 DevExpress 패키지들을 설치합니다.
Assembly 참조:
프로젝트에 DevExpress 어셈블리 참조를 추가합니다.
위의 코드는 DevExpress 버전 22.2에서 SpreadsheetControl과 GridControl을 함께 사용하여 엑셀 파일을 내보내