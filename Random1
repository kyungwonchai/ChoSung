엑셀 실적시트에 J열은 점수를 표시하는 열인데 B,C,I열은 구역,조,라인이야 이값을 전체데이타시트에서 h,c,b 구역,조,라인 이렇게 있는것을 참조해서 그 해당값의 평균되는 E열의 값을 가져온다음 그 값이 실적시트의 T3~ㅉ9까지의 표를 참고해서 점수를 알려줘야되 U열은 하한값 V열은 상한값 이게 이상 이하일때의 조건이고 점수는 W열이야 J열의 점수에 들어갈 수식을주세요





생각하는 과정 표시
안녕하세요! 요청하신 엑셀 수식을 만들어 드리겠습니다.

상황 요약:

실적시트 (Performance Sheet):

J열: 최종 점수가 표시될 열입니다.
B열: 구역
C열: 조
I열: 라인
T3:W9 (아마도 "ㅉ9"는 W9를 의미하시는 것 같습니다): 점수 참조표
U열 (U3:U9): 하한값 (Lower bound)
V열 (V3:V9): 상한값 (Upper bound)
W열 (W3:W9): 점수 (Score)
전체데이타시트 (Overall Data Sheet):

H열: 구역
C열: 조
B열: 라인
E열: 평균을 계산할 값
작업 흐름:

실적시트의 현재 행(예: 2행)에서 B열(구역), C열(조), I열(라인) 값을 가져옵니다.
이 값들을 기준으로 전체데이타시트에서 일치하는 데이터를 찾습니다 (H열=구역, C열=조, B열=라인).
일치하는 데이터들의 E열 값들의 평균을 계산합니다.
계산된 평균값을 실적시트의 점수 참조표(U열:하한값, V열:상한값)와 비교하여 해당하는 W열의 점수를 가져옵니다.
수식:

실적시트의 J2 셀에 다음 수식을 입력하고 아래로 복사하여 적용하세요. (최신 버전의 Excel을 사용하시는 경우 LET 함수를 사용하면 더 깔끔하게 작성할 수 있습니다.)

1. LET 함수 사용 가능 시 (Excel 2021, Microsoft 365):
이 방법이 더 읽기 쉽고 효율적입니다.

Excel

=LET(
    평균값, AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2),
    점수, SUMPRODUCT(--(평균값 >= U$3:U$9), --(평균값 <= V$3:V$9), W$3:W$9),
    IFERROR(점수, "평균값 없음 또는 점수 범위 해당 없음")
)
설명:

LET(이름1, 값1, [이름2, 값2, ...], 계산): 중간 계산 결과를 이름으로 저장하여 사용할 수 있게 합니다.
평균값, AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2):
전체데이타시트!E:E: 평균을 구할 범위입니다.
전체데이타시트!H:H, B2: 전체데이타시트 H열(구역)이 실적시트 B2셀(구역)과 같은 조건입니다.
전체데이타시트!C:C, C2: 전체데이타시트 C열(조)이 실적시트 C2셀(조)과 같은 조건입니다.
전체데이타시트!B:B, I2: 전체데이타시트 B열(라인)이 실적시트 I2셀(라인)과 같은 조건입니다.
위 세 가지 조건을 모두 만족하는 E열 값들의 평균을 계산하여 평균값이라는 이름으로 저장합니다.
점수, SUMPRODUCT(--(평균값 >= U$3:U$9), --(평균값 <= V$3:V$9), W$3:W$9):
평균값 >= U$3:U$9: 계산된 평균값이 점수표의 하한값(U3:U9)보다 크거나 같은지 비교합니다 (결과는 TRUE/FALSE 배열).
평균값 <= V$3:V$9: 계산된 평균값이 점수표의 상한값(V3:V9)보다 작거나 같은지 비교합니다 (결과는 TRUE/FALSE 배열).
--(...): TRUE/FALSE를 숫자 1/0으로 변환합니다.
SUMPRODUCT는 이 세 배열을 곱한 후 합산합니다. 즉, 평균값이 하한과 상한 사이에 해당하는 행의 점수(W열)를 가져옵니다. (점수표의 범위가 서로 겹치지 않는다고 가정합니다.)
IFERROR(점수, "평균값 없음 또는 점수 범위 해당 없음"):
만약 AVERAGEIFS에서 조건에 맞는 데이터가 없어 #DIV/0! 오류가 발생하거나, SUMPRODUCT에서 적절한 점수 범위를 찾지 못해 결과가 0 또는 예상치 못한 값이 나올 경우 (보통 0으로 나옴) 지정된 메시지를 표시합니다. 만약 오류 시 0점을 부여하고 싶다면 "평균값 없음 또는 점수 범위 해당 없음" 대신 0을 쓰면 됩니다.
2. LET 함수 사용 불가능 시 (구버전 Excel):

Excel

=IFERROR(SUMPRODUCT(--(AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2) >= U$3:U$9), --(AVERAGEIFS(전체데이타시트!E:E, 전체데이타시트!H:H, B2, 전체데이타시트!C:C, C2, 전체데이타시트!B:B, I2) <= V$3:V$9), W$3:W$9), "평균값 없음 또는 점수 범위 해당 없음")
이 수식은 AVERAGEIFS 부분이 반복되지만 동일한 로직으로 작동합니다.

참고 사항:

실적시트와 전체데이타시트의 시트 이름이 정확한지 확인해주세요.
점수표의 범위(U$3:U$9, V$3:V$9, W$3:W$9)는 절대 참조($)를 사용하여 수식을 아래로 복사해도 고정되도록 했습니다.
AVERAGEIFS의 조건에 해당하는 데이터가 전체데이타시트에 없을 경우 #DIV/0! 오류가 발생할 수 있으며, IFERROR 함수로 처리했습니다.
점수표(T3:W9)의 하한값(U열)과 상한값(V열) 범위가 모든 평균값을 커버하고, 서로 겹치지 않도록 설정되어 있어야 정확한 점수가 나옵니다. 만약 평균값이 어떤 범위에도 해당하지 않으면 SUMPRODUCT는 0을 반환합니다. (위 IFERROR 처리 부분에서 이 경우도 포함하여 메시지를 표시하도록 했습니다.)
이 수식을 적용해 보시고, 궁금한 점이나 수정이 필요한 부분이 있다면 다시 알려주세요.


실적 시트의 O열에는 평균을 구하는게 있는데 아까 그 조건으로 해서 평균값만 표시하는거 수식주세요 그리고 전체데이타시트가 아니라 시트이름이 전체데이타입니다





생각하는 과정 표시
네, 알겠습니다. 실적시트의 O열에 해당 조건에 맞는 평균값만 표시하는 수식을 알려드리겠습니다. 시트 이름도 전체데이타로 수정하여 반영하겠습니다.

실적시트의 O2 셀에 다음 수식을 입력하고 아래로 드래그하여 적용하세요:

Excel

=IFERROR(AVERAGEIFS(전체데이타!E:E, 전체데이타!H:H, B2, 전체데이타!C:C, C2, 전체데이타!B:B, I2), "조건 일치 데이터 없음")
수식 설명:

AVERAGEIFS(average_range, criteria_range1, criteria1, [criteria_range2, criteria2], ...): 여러 조건을 만족하는 숫자들의 평균을 계산합니다.
전체데이타!E:E: 평균을 계산할 값들이 있는 범위입니다. (전체데이타 시트의 E열)
전체데이타!H:H, B2: 첫 번째 조건입니다.
전체데이타!H:H: 전체데이타 시트의 H열 (구역) 범위입니다.
B2: 실적시트의 현재 행(2행) B열 (구역) 값입니다.
전체데이타!C:C, C2: 두 번째 조건입니다.
전체데이타!C:C: 전체데이타 시트의 C열 (조) 범위입니다.
C2: 실적시트의 현재 행(2행) C열 (조) 값입니다.
전체데이타!B:B, I2: 세 번째 조건입니다.
전체데이타!B:B: 전체데이타 시트의 B열 (라인) 범위입니다.
I2: 실적시트의 현재 행(2행) I열 (라인) 값입니다.
IFERROR(value, value_if_error): 수식(value)의 결과가 오류일 경우 지정된 값(value_if_error)을 반환합니다.
만약 AVERAGEIFS 함수가 주어진 조건(구역, 조, 라인)에 일치하는 데이터를 전체데이타 시트에서 찾지 못하면 #DIV/0! 오류가 발생합니다.