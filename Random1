체 코드를 제공하겠습니다.

SerialPortManager.cs
csharp
코드 복사
using System;
using System.IO.Ports;

public class SerialPortManager
{
    private static SerialPortManager _instance;
    private SerialPort _scannerPort;

    public static SerialPortManager Instance => _instance ??= new SerialPortManager();

    public SerialPort ScannerPort => _scannerPort;

    private SerialPortManager()
    {
        // 초기화 코드
    }

    public void OpenScannerPort(string portName, int baudRate, Parity parity, int dataBits, StopBits stopBits)
    {
        try
        {
            if (_scannerPort != null && _scannerPort.IsOpen)
            {
                _scannerPort.Close();
            }

            _scannerPort = new SerialPort(portName, baudRate, parity, dataBits, stopBits)
            {
                ReadTimeout = 500,
                WriteTimeout = 500
            };
            _scannerPort.Open();
        }
        catch (Exception ex)
        {
            throw new InvalidOperationException("스캐너 포트를 열 수 없습니다.", ex);
        }
    }

    public string ReadScannerPortData()
    {
        try
        {
            if (_scannerPort != null && _scannerPort.IsOpen)
            {
                return _scannerPort.ReadLine();
            }
        }
        catch (TimeoutException)
        {
            // 읽기 시간 초과 시 빈 문자열 반환
            return string.Empty;
        }
        catch (Exception ex)
        {
            throw new InvalidOperationException("스캐너 포트에서 데이터를 읽을 수 없습니다.", ex);
        }

        return string.Empty;
    }

    public void SendDataToPort(string portName, string data)
    {
        try
        {
            using (SerialPort port = new SerialPort(portName))
            {
                if (!port.IsOpen)
                {
                    port.Open();
                }

                port.WriteLine(data);
            }
        }
        catch (Exception ex)
        {
            throw new InvalidOperationException($"포트 {portName}로 데이터를 전송할 수 없습니다.", ex);
        }
    }
}
설명:
OpenScannerPort:

스캐너 포트를 열고, 포트가 이미 열려 있다면 닫습니다. 새로운 포트를 열 때는 지정된 통신 파라미터를 사용합니다.
ReadScannerPortData:

스캐너 포트에서 데이터를 읽어오는 메서드입니다. 시간 초과 시 빈 문자열을 반환하고, 예외가 발생하면 오류 메시지와 함께 예외를 던집니다.
SendDataToPort:

지정된 포트로 데이터를 전송하는 메서드입니다. 포트가 열려 있지 않으면 포트를 연 후 데이터를 전송하고, 완료 후 포트를 닫습니다.
이 코드가 올바르게 동작하도록 SerialPortManager