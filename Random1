private void ProcessExcelFile(string filePath)
{
    Microsoft.Office.Interop.Excel.Application excelApp = new Microsoft.Office.Interop.Excel.Application();
    Workbook workbook = excelApp.Workbooks.Open(filePath);
    Worksheet worksheet = workbook.Sheets[1];

    bool hasData = true;
    int row = 4; // B4부터 시작

    while (hasData)
    {
        Range partCodeRange = worksheet.Cells[row, 2];
        Range vendorRange = worksheet.Cells[row, 3];
        Range partNumberRange = worksheet.Cells[row, 4];
        Range approvalStatusRange = worksheet.Cells[row, 5];
        Range approvalDateRange = worksheet.Cells[row, 6];
        Range productNameRange = worksheet.Cells[row, 12];
        Range specificationRange = worksheet.Cells[row, 13];

        if (partCodeRange.Value2 != null && vendorRange.Value2 != null)
        {
            string partCode = partCodeRange.Value2.ToString();
            string vendor = vendorRange.Value2.ToString();
            string partNumber = partNumberRange.Value2?.ToString();
            string approvalStatus = approvalStatusRange.Value2?.ToString();
            string approvalDateStr = approvalDateRange.Value2?.ToString();
            string productName = productNameRange.Value2?.ToString();
            string specification = specificationRange.Value2?.ToString();

            DateTime approvalDate;
            if (DateTime.TryParse(approvalDateStr, out approvalDate))
            {
                string key = partCode + vendor;

                InsertOrUpdateData(key, partCode, vendor, partNumber, approvalStatus, approvalDate, productName, specification);
            }
        }
        else
        {
            hasData = false;
            break;
        }

        row++;
    }

    workbook.Close();
    excelApp.Quit();
}
