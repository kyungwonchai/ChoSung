시줄에 없는 모든 Excel 프로세스를 종료하려면, 아래의 C# 코드를 사용하면 됩니다. 이 코드는 현재 실행 중인 모든 Excel 프로세스를 찾아 작업 표시줄에 없는 프로세스만 종료합니다.

csharp

using System;
using System.Diagnostics;
using System.Runtime.InteropServices;

class Program
{
    [DllImport("user32.dll", SetLastError = true)]
    static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

    [DllImport("user32.dll", SetLastError = true)]
    static extern int GetWindowThreadProcessId(IntPtr hWnd, out int lpdwProcessId);

    static void Main()
    {
        foreach (Process proc in Process.GetProcessesByName("EXCEL"))
        {
            IntPtr hwnd = proc.MainWindowHandle;
            if (hwnd == IntPtr.Zero)
            {
                // 작업 표시줄에 표시되지 않는 Excel 프로세스
                proc.Kill();
            }
        }
    }
}

설명:

    FindWindow와 GetWindowThreadProcessId는 사용자32.dll에 있는 네이티브 함수로, 윈도우를 찾고 해당 윈도우의 프로세스 ID를 얻어옵니다.
    Process.GetProcessesByName("EXCEL")는 현재 실행 중인 모든 Excel 프로세스를 가져옵니다.
    proc.MainWindowHandle은 프로세스의 주 윈도우 핸들을 반환합니다. 이 값이 IntPtr.Zero이면 해당 프로세스는 작업 표시줄에 표시되지 않는 것입니다.
    proc.Kill()은 해당 프로세스를 종료합니다.

작업 표시줄에 있는 Excel을 닫지 않도록 주의하십시오. 항상 이 코드를 실행하기 전에 중요한 작업을 저장하고 Excel을 닫아주세요