using System;
using System.Drawing;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace PrinterSettingsExample
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void buttonPrint_Click(object sender, EventArgs e)
        {
            // 프린터 설정 다이얼로그 생성
            PrintDialog printDialog = new PrintDialog();
            
            // PrintDocument 생성
            PrintDocument printDocument = new PrintDocument();
            printDocument.PrintPage += new PrintPageEventHandler(PrintDocument_PrintPage);

            // 프린터 설정 다이얼로그에서 사용자가 설정을 선택하도록 합니다.
            if (printDialog.ShowDialog() == DialogResult.OK)
            {
                // 프린터 설정을 가져와서 PrintDocument에 적용합니다.
                printDocument.PrinterSettings = printDialog.PrinterSettings;

                // 프린터 설정을 현재 페이지에 맞춤으로 설정합니다.
                printDocument.DefaultPageSettings.PaperSize = new PaperSize("Custom", YourPageWidth, YourPageHeight); // 단위: 1/100 인치 (예: 850, 1100)

                // 프린터 작업 시작
                printDocument.Print();
            }
        }

        private void PrintDocument_PrintPage(object sender, PrintPageEventArgs e)
        {
            // 여기에 인쇄할 내용을 그리는 코드를 추가합니다.
            // e.Graphics를 사용하여 그리기 작업을 수행합니다.
        }
    }
}
