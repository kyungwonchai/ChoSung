래는 VBA를 사용하여 특정 셀의 날짜 값을 기준으로 A열에서 검색하고, 일치하는 값이 있으면 해당 셀의 주소를 반환하는 코드입니다. 이 코드는 워크시트의 셀을 순회하며 검색 결과를 확인합니다.

vba
코드 복사
Sub FindMatchingDate()
    Dim ws As Worksheet
    Dim searchValue As String
    Dim searchRange As Range
    Dim resultCell As Range
    Dim resultAddress As String
    
    ' 현재 워크시트 참조
    Set ws = ThisWorkbook.Sheets("Sheet1") ' 시트 이름을 원하는 이름으로 변경하세요
    
    ' 검색할 값 설정 (일반 서식 셀에 입력된 값)
    searchValue = ws.Range("B1").Value ' B1 셀에 검색할 날짜가 있다고 가정
    
    ' 검색 범위 설정 (A열 전체)
    Set searchRange = ws.Range("A:A")
    
    ' A열에서 값 검색
    On Error Resume Next
    Set resultCell = searchRange.Find(What:=searchValue, LookIn:=xlValues, LookAt:=xlWhole)
    On Error GoTo 0
    
    ' 검색 결과 확인
    If Not resultCell Is Nothing Then
        resultAddress = resultCell.Address
        MsgBox "일치하는 날짜를 찾았습니다: " & resultAddress
    Else
        MsgBox "일치하는 날짜를 찾을 수 없습니다."
    End If
End Sub
코드 설명
searchValue 변수: B1 셀의 값을 검색 값으로 설정합니다. 필요한 셀 주소로 변경 가능합니다.
searchRange 변수: A:A 범위를 검색 대상으로 지정합니다.
Find 메서드: searchValue와 동일한 값을 찾습니다. xlValues를 사용하여 표시된 값 기준으로 검색합니다.
결과 처리:
일치하는 셀이 있으면 해당 셀의 주소를 resultAddress 변수에 저장하고 메시지 박스를 표시합니다.
일치하는 셀이 없으면 "찾을 수 없습니다."라는 메시지를 표시합니다.
참고 사항
날짜 형식 처리: 셀 서식이 yyyy-mm-dd로 설정되어 있어야 하며, VBA는 Excel의 날짜 값을 내부적으로 숫자로 처리하므로 searchValue가 정확한 형식인지 확인하세요.
대소문자 구분 없음: 날짜 비교는 대소문자에 영향을 받지 않습니다.