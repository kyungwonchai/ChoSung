코드를 사용하여 Excel 시트에서 지정된 피벗 테이블을 갱신하고 특정 조건에 맞는 필드를 자동으로 선택하는 것은 가능합니다. 요청하신 기능을 수행하는 VBA 코드는 다음과 같습니다:

vba

Sub UpdatePivotTableAndSelectFields()
    Dim ws As Worksheet
    Dim pt As PivotTable
    Dim pf As PivotField
    Dim field As String
    
    ' "SOP 14주" 시트 설정
    Set ws = ThisWorkbook.Sheets("SOP 14주")

    ' "피벗테이블1" 피벗 테이블 설정
    Set pt = ws.PivotTables("피벗테이블1")

    ' 피벗 테이블 갱신
    pt.RefreshTable

    ' 피벗 필드를 순회하면서 조건에 맞는 필드 선택
    For Each pf In pt.PivotFields
        field = pf.Name
        ' 필드 이름이 6자리 숫자이며 2로 시작하는 경우 체크
        If Len(field) = 6 And IsNumeric(field) And Left(field, 1) = "2" Then
            pf.Orientation = xlRowField
            pf.Position = pt.RowFields.Count
        End If
    Next pf
End Sub

이 코드는 "SOP 14주"라는 이름의 시트에 있는 "피벗테이블1"이라는 피벗 테이블을 찾아 갱신하고, 피벗 테이블의 필드 중에서 이름이 6자리 숫자이며 2로 시작하는 필드들을 자동으로 선택합니다. 이 코드