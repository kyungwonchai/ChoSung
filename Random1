using System;
using System.Drawing;
using System.Drawing.Printing;
using System.Windows.Forms;

namespace PrinterSettingsExample
{
    public partial class MainForm : Form
    {
        // 사용자가 입력한 페이지 크기 (단위: 1/100 인치)
        private int currentPageWidth = 850; // 예시: 8.5 inches
        private int currentPageHeight = 1100; // 예시: 11 inches

        public MainForm()
        {
            InitializeComponent();
        }

        private void buttonPrint_Click(object sender, EventArgs e)
        {
            // 프린터 설정 다이얼로그 생성
            PrintDialog printDialog = new PrintDialog();

            // PrintDocument 생성
            PrintDocument printDocument = new PrintDocument();
            printDocument.PrintPage += new PrintPageEventHandler(PrintDocument_PrintPage);

            // 프린터 설정 다이얼로그에서 사용자가 설정을 선택하도록 합니다.
            if (printDialog.ShowDialog() == DialogResult.OK)
            {
                // 프린터 설정을 가져와서 PrintDocument에 적용합니다.
                printDocument.PrinterSettings = printDialog.PrinterSettings;

                // 프린터 설정을 현재 페이지에 맞춤으로 설정합니다.
                printDocument.DefaultPageSettings.PaperSize = new PaperSize("Custom", currentPageWidth, currentPageHeight); // 단위: 1/100 인치

                // 프린터 작업 시작
                printDocument.Print();
            }
        }

        private void PrintDocument_PrintPage(object sender, PrintPageEventArgs e)
        {
            // 여기에 인쇄할 내용을 그리는 코드를 추가합니다.
            // e.Graphics를 사용하여 그리기 작업을 수행합니다.

            // 사용자가 입력한 페이지 크기와 용지 크기를 비교하여 스케일을 조정합니다.
            float scaleWidth = e.PageBounds.Width / (float)currentPageWidth;
            float scaleHeight = e.PageBounds.Height / (float)currentPageHeight;
            float scale = Math.Min(scaleWidth, scaleHeight);

            e.Graphics.ScaleTransform(scale, scale);

            // 스케일 조정된 그리기 작업 수행
            // 예를 들면: e.Graphics.DrawRectangle(Pens.Black, 0, 0, currentPageWidth, currentPageHeight);
        }
    }
}
