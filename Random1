ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ & ë§¤í¬ë¡œ ì‹¤í–‰ì„ í•˜ë‚˜ì˜ ë™ì‘ ì‹œí€€ìŠ¤ë¡œ í†µí•©
âœ… MacroAction ë‚´ë¶€ì—ì„œ ë°ì´í„° ì¡°íšŒ & ìˆœì°¨ ì²˜ë¦¬ (ë²„íŠ¼ í´ë¦­ X)
âœ… ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ê³ , ê·¸ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë§¤í¬ë¡œ ë™ì‘ ì‹¤í–‰
âœ… ëª¨ë“  ë™ì‘ì€ MacroManagerì— ë“±ë¡ë˜ì–´ ë¹„ë™ê¸° ì‹¤í–‰
âœ… ì˜ˆì•½ì–´ ì¶©ëŒ í•´ê²° (MacroActions í´ë” ìœ ì§€)

ğŸ“‚ 1. ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ êµ¬ì¡°
pgsql
ì½”ë“œ ë³µì‚¬
ğŸ“¦ AutoHandleSolution
 â”£ ğŸ“‚ AAutoHandle
 â”ƒ â”£ ğŸ“‚ Commands
 â”ƒ â”ƒ â”£ ğŸ“œ IMacroCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ KeyboardCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MouseClickCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ DelayCommand.cs
 â”ƒ â”ƒ â”£ ğŸ“œ ScreenCaptureCommand.cs
 â”ƒ â”ƒ â”— ğŸ“œ CVCommand.cs
 â”ƒ â”£ ğŸ“‚ Core
 â”ƒ â”ƒ â”£ ğŸ“œ MacroExecutor.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroManager.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroLogger.cs
 â”ƒ â”£ ğŸ“‚ Database
 â”ƒ â”ƒ â”£ ğŸ“œ MySqlHelper.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MsSqlHelper.cs
 â”ƒ â”ƒ â”— ğŸ“œ DatabaseReader.cs
 â”ƒ â”£ ğŸ“‚ MacroActions  â˜… ë§¤í¬ë¡œ ë™ì‘ ì •ì˜
 â”ƒ â”ƒ â”£ ğŸ“œ MacroActionA.cs
 â”ƒ â”ƒ â”£ ğŸ“œ MacroActionB.cs
 â”ƒ â”ƒ â”— ğŸ“œ MacroActionC.cs
 â”ƒ â”£ ğŸ“‚ Forms
 â”ƒ â”ƒ â”— ğŸ“œ MainForm.cs
 â”ƒ â”£ ğŸ“œ Program.cs
 â”ƒ â”— ğŸ“œ AAutoHandle.csproj
 â”— ğŸ“œ AutoHandleSolution.sln
ğŸ“œ 2. ë°ì´í„° ì¡°íšŒ í›„ ë§¤í¬ë¡œ ì‹¤í–‰ (MacroActionA.cs)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.MacroActions
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using AAutoHandle.Core;
    using AAutoHandle.Commands;
    using AAutoHandle.Database;
    using MySql.Data.MySqlClient;
    using System.Data.SqlClient;

    public class MacroActionA
    {
        private readonly DatabaseReader _dbReader;

        public MacroActionA(string mysqlConn, string mssqlConn)
        {
            _dbReader = new DatabaseReader(mysqlConn, mssqlConn);
        }

        public async Task ExecuteAsync()
        {
            var macroManager = MacroManager.Instance;

            // **1ï¸âƒ£ MySQLì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ ë§¤í¬ë¡œ ì‹¤í–‰**
            await _dbReader.ReadMySqlDataAsync("sp_GetData",
                async row =>
                {
                    int x = Convert.ToInt32(row["x"]);
                    int y = Convert.ToInt32(row["y"]);
                    string capturePath = row["capturePath"].ToString();

                    macroManager.AddCommand(new MouseClickCommand(x, y));
                    macroManager.AddCommand(new DelayCommand(500));
                    macroManager.AddCommand(new ScreenCaptureCommand(capturePath));

                    await macroManager.StartExecutionAsync();
                });

            // **2ï¸âƒ£ MSSQLì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ ë§¤í¬ë¡œ ì‹¤í–‰**
            await _dbReader.ReadMsSqlDataAsync("sp_GetData",
                async row =>
                {
                    string key = row["keypress"].ToString();
                    macroManager.AddCommand(new KeyboardCommand((System.Windows.Forms.Keys)Enum.Parse(typeof(System.Windows.Forms.Keys), key)));
                    await macroManager.StartExecutionAsync();
                });
        }
    }
}
âœ… MySQL â†’ MouseClickCommand, ScreenCaptureCommand ì‹¤í–‰
âœ… MSSQL â†’ KeyboardCommand ì‹¤í–‰
âœ… ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë§¤í¬ë¡œ ì‹¤í–‰

ğŸ“œ 3. DatabaseReader.cs (ë¹„ë™ê¸° ë°ì´í„° ì¡°íšŒ ë° ìˆœì°¨ ì‹¤í–‰)
csharp
ì½”ë“œ ë³µì‚¬
namespace AAutoHandle.Database
{
    using System;
    using System.Data;
    using System.Threading.Tasks;
    using MySql.Data.MySqlClient;
    using System.Data.SqlClient;

    public class DatabaseReader
    {
        private readonly MySqlHelper _mySqlHelper;
        private readonly MsSqlHelper _msSqlHelper;

        public DatabaseReader(string mysqlConnString, string mssqlConnString)
        {
            _mySqlHelper = new MySqlHelper(mysqlConnString);
            _msSqlHelper = new MsSqlHelper(mssqlConnString);
        }

        public async Task ReadMySqlDataAsync(string procedureName, Func<DataRow, Task> processRow, params MySqlParameter[] parameters)
        {
            var table = _mySqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                await processRow(row);
            }
        }

        public async Task ReadMsSqlDataAsync(string procedureName, Func<DataRow, Task> processRow, params SqlParameter[] parameters)
        {
            var table = _msSqlHelper.ExecuteStoredProcedure(procedureName, parameters);
            foreach (DataRow row in table.Rows)
            {
                await processRow(row);
            }
        }
    }
}
âœ… ë°ì´í„°ë¥¼ Func<DataRow, Task>ë¡œ ì¦‰ì‹œ ì²˜ë¦¬ ê°€ëŠ¥
âœ… ë°˜ë³µ ì‹¤í–‰ ìˆœì„œ ë³´ì¥ (await ì‚¬ìš©)

ğŸ“œ 4. MainForm.cs (í…ŒìŠ¤íŠ¸ ì‹¤í–‰)
csharp
ì½”ë“œ ë³µì‚¬
using System;
using System.Windows.Forms;
using AAutoHandle.MacroActions;

namespace AAutoHandle
{
    public partial class MainForm : Form
    {
        private MacroActionA _macroActionA;

        public MainForm()
        {
            InitializeComponent();

            string mysqlConn = "Server=localhost;Database=mydb;User=root;Password=1234;";
            string mssqlConn = "Server=myserver;Database=mydb;User Id=myuser;Password=mypassword;";

            _macroActionA = new MacroActionA(mysqlConn, mssqlConn);
        }

        private async void btnStartMacro_Click(object sender, EventArgs e)
        {
            await _macroActionA.ExecuteAsync();
        }
    }
}
âœ… ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ MacroActionA.ExecuteAsync() ì‹¤í–‰ë¨
âœ… ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë§¤í¬ë¡œ ìë™ ì‹¤í–‰

ğŸ“œ 5. ì‹¤í–‰ íë¦„
1ï¸âƒ£ MacroActionA.ExecuteAsync() ì‹¤í–‰
2ï¸âƒ£ MySQLì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ â†’ ë§¤í¬ë¡œ ì‹¤í–‰ (MouseClickCommand, ScreenCaptureCommand)
3ï¸âƒ£ MSSQLì—ì„œ ë°ì´í„° ê°€ì ¸ì™€ â†’ í‚¤ë³´ë“œ ì…ë ¥ ì‹¤í–‰ (KeyboardCommand)
4ï¸âƒ£ ëª¨ë“  ì‘ì—…ì´ ë¹„ë™ê¸°ë¡œ ìˆœì°¨ ì‹¤í–‰ë¨ (await ë³´ì¥)

ğŸ“œ 6. í™•ì¥ ê°€ëŠ¥ì„±
âœ… ë§¤í¬ë¡œ ì‹¤í–‰ ì‹œ ë°ì´í„° ì¡°íšŒê°€ ìì—°ìŠ¤ëŸ½ê²Œ í¬í•¨ë¨
âœ… MacroActionì„ ì¶”ê°€í•˜ì—¬ ë‹¤ì–‘í•œ ë™ì‘ ì¶”ê°€ ê°€ëŠ¥ (MacroActionB, MacroActionC ë“±)
âœ… ë°ì´í„° êµ¬ì¡°ë§Œ ë³€ê²½í•˜ë©´ ìƒˆë¡œìš´ ë§¤í¬ë¡œ ì‹¤í–‰ ê°€ëŠ¥
âœ… ë²„íŠ¼ ì—†ì´ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥ â†’ ìë™í™” ìµœì í™”

ğŸ“Œ ê²°ë¡ 
ğŸ”¹ ë°ì´í„° ì¡°íšŒë„ ë§¤í¬ë¡œ ì‹¤í–‰ì˜ ì¼ë¶€ â†’ MacroActionA ë‚´ë¶€ì—ì„œ ì‹¤í–‰
ğŸ”¹ ë²„íŠ¼ ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥ â†’ ìë™í™” ìµœì í™”
ğŸ”¹ ë¹„ë™ê¸° ë°ì´í„° ì¡°íšŒ & ì‹¤í–‰ ìˆœì„œ ë³´ì¥ (await ì²˜ë¦¬)
ğŸ”¹ í•„ìš”í•œ ë™ì‘ ì„¸íŠ¸(MacroActionA, MacroActionB ë“±)ë§Œ ê³¨ë¼ ì‹¤í–‰ ê°€ëŠ¥